(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"+SqX":function(t,e,a){"use strict";var n={name:"page-title",props:["title"]},s=a("psIG"),i=Object(s.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h1",{staticClass:"text-h5 text-left py-3"},[a("span",[t._v(t._s(t.title))]),t._t("titleActions"),t._v(" "),t._t("spinner")],2)}),[],!1,null,null,null);e.a=i.exports},"/NG7":function(t,e,a){"use strict";a.r(e);var n={};a.r(n),a.d(n,"fetch",(function(){return N})),a.d(n,"deleteSlaveAppsDownloadState",(function(){return V})),a.d(n,"bulkControlApps",(function(){return L})),a.d(n,"bulkDownloadSlaveApps",(function(){return E})),a.d(n,"bulkInstallSlaveApps",(function(){return R})),a.d(n,"fetchDownloadState",(function(){return T})),a.d(n,"clearDownloadState",(function(){return P})),a.d(n,"fetchAppReleases",(function(){return M})),a.d(n,"fetchAppsReleases",(function(){return $})),a.d(n,"downloadAppData",(function(){return B})),a.d(n,"deleteAppData",(function(){return z})),a.d(n,"fetchJSONConfig",(function(){return U})),a.d(n,"fetchEnvConfig",(function(){return j})),a.d(n,"saveJSONConfig",(function(){return W})),a.d(n,"saveENVConfig",(function(){return G})),a.d(n,"fetchAppConfig",(function(){return H})),a.d(n,"saveAppConfig",(function(){return J})),a.d(n,"downloadAppConfig",(function(){return q})),a.d(n,"deleteJSONConfig",(function(){return Y})),a.d(n,"deleteENVConfig",(function(){return K})),a.d(n,"deleteAppConfig",(function(){return Q})),a.d(n,"uninstallApp",(function(){return X})),a.d(n,"changeServiceStatus",(function(){return Z})),a.d(n,"uploadApp",(function(){return tt})),a.d(n,"installApp",(function(){return et})),a.d(n,"fetchAppStatus",(function(){return at})),a.d(n,"fetchLatestAppVersion",(function(){return nt}));var s=a("tZmG"),i=a.n(s),o=a("06Hw"),l=a.n(o),r=a("YYXh"),c=a.n(r),p=a("Kz1y"),u=a.n(p),d=a("TcPG"),v=a.n(d),f=a("mQ3e"),h=a.n(f),m=a("7Ipj"),g=a("nz6T"),_=a("/9Wh"),w=a.n(_),b=a("OBCi"),D=a.n(b),S=a("uzYq"),A=a("NWgQ"),C=a.n(A),x=a("N4QW"),k=a("A5Vd"),y=a("+n12"),I="/slave-apps",N=function(){return S.a.get(""+I,{restrictToast:!0})},V=function(){};function O(t){return t.reduce((function(t,e){return t[e.slaveId]||(t[e.slaveId]=[]),t[e.slaveId].push({service:e.service,version:e.version}),t}),{})}var F,L=function(t,e){return S.a.post(I+"/control",function(t,e){return t.reduce((function(t,a){return t[a.slaveId]||(t[a.slaveId]=[]),t[a.slaveId].push({service:a.service,action:e}),t}),{})}(t,e))},E=function(t){return S.a.post(I+"/download",O(t))},R=function(t){return S.a.post(I+"/install",O(t))},T=function(){return S.a.get(I+"/download-state",{restrictToast:!0})},P=function(t){var e=C.a.stringify({slaveUUIDs:t});return S.a.delete(I+"/download-state?"+e)},M=function(t){return S.a.get(I+"/releases/"+t)},$=function(t){return D.a.all(t.map((function(t){return M(t).catch((function(t){return[]}))})))},B=(F=c()(l.a.mark((function t(e,a){var n,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.a();case 2:return n=t.sent,s=n.data+"slave/"+a+"/api/app/download_data?service="+e,t.abrupt("return",S.a.get(s,{headers:{"Content-Type":"application/zip"},responseType:"blob"}));case 5:case"end":return t.stop()}}),t,void 0)}))),function(t,e){return F.apply(this,arguments)}),z=function(t,e){return S.a.post(I+"/delete-app-data",{service:t,slaveId:e})},U=function(t,e,a){return S.a.get(I+"/slaves/"+e+"/json-config/"+t,a)},j=function(t,e,a){return S.a.get(I+"/slaves/"+e+"/env/"+t,a)},W=function(t,e,a){return S.a.put(I+"/slaves/"+e+"/json-config",{service:t,data:a})},G=function(t,e,a){return S.a.put(I+"/slaves/"+e+"/env",{service:t,data:a})},H=function(t,e,a){var n=a.slaveId;if(e===k.h.PYTHON_APP)return U(t,n,a).then((function(t){return t.data}));if(e===k.h.FRONTEND_APP)return j(t,n,a).then((function(t){return t.data}));throw new Error("App type not supported for editing config")},J=function(t,e,a,n){if(e===k.h.PYTHON_APP)return W(t,n,a||{});if(e===k.h.FRONTEND_APP)return G(t,n,a||"");throw new Error("App type not supported for editing config")},q=function(t,e,a,n){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(n===k.h.PYTHON_APP)return U(t,e,s).then((function(e){var n=e.data;Object(y.h)(t+"-"+a+"-config",w()(n))}));if(n===k.h.FRONTEND_APP)return j(t,e,s).then((function(e){var n=e.data;Object(y.f)(t+"-"+a,n)}));throw new Error("App type not supported for download config")},Y=function(t,e){return S.a.delete(I+"/slaves/"+t+"/json-config",{data:{service:e}})},K=function(t,e){return S.a.delete(I+"/slaves/"+t+"/env",{data:{service:e}})},Q=function(t,e,a){if(a===k.h.PYTHON_APP)return Y(t,e);if(a===k.h.FRONTEND_APP)return K(t,e);throw new Error("App type not supported for deletion")},X=function(t,e){return S.a.post(I+"/uninstall",{service:e,slaveId:t})},Z=function(t,e,a){return S.a.post(I+"/slaves/"+a+"/control",[{action:t,service:e}])},tt=function(t,e,a,n){var s=new FormData;return s.append("file",t),s.append("service",e),s.append("version",a),S.a.post(I+"/slaves/"+n+"/app-upload",s,{headers:{"Content-Type":"multipart/form-data"}})},et=function(t,e){return S.a.post(I+"/slaves/"+e+"/install",[t])},at=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments[2];return S.a.get(I+"/slaves/"+a+"/stats/"+t,e)},nt=function(){return S.a.get(I+"/latest-version")},st={name:"app-edit-config",props:["appDetail","closeDialog","isSlaveApp"],data:function(){return{config:null,slaveId:null,apiService:null,isFetchingConfig:!1,isSavingConfig:!1,isConfigJSON:!1}},mounted:function(){this.isSlaveApp?(this.slaveId=this.appDetail.slaveId,this.apiService=n):this.apiService=g,this.fetchAppConfig(),this.isConfigJSON=this.isJSON(this.appDetail.app_type)},methods:{isJSON:function(t){return k.b[t]===k.e},fetchAppConfig:function(){var t=this,e=this.appDetail.service,a=this.appDetail.app_type;this.isFetchingConfig=!0,this.apiService.fetchAppConfig(e,a,{restrictToast:!0,slaveId:this.slaveId}).then((function(e){t.config=e})).catch((function(t){})).finally((function(){t.isFetchingConfig=!1}))},saveConfig:function(){var t=this,e=this.appDetail.service,a=this.appDetail.display_name,n=this.appDetail.app_type;this.isSavingConfig=!0,this.apiService.saveAppConfig(e,n,this.config,this.slaveId).then((function(e){t.$toasted.show("Successfully updated config for "+a),t.closeDialog()})).catch((function(e){t.$toasted.show("Failed to update config for "+a,{type:"error"})})).finally((function(){t.isSavingConfig=!1}))}}},it=a("psIG"),ot=Object(it.a)(st,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{loading:t.isFetchingConfig}},[a("v-card-title",[t._v(t._s(t.appDetail.display_name)+" | Edit Config")]),t._v(" "),a("v-card-text",[a("v-container",[t.isConfigJSON?a("v-jsoneditor",{attrs:{options:{mode:"code"},plus:!1,height:"400px"},model:{value:t.config,callback:function(e){t.config=e},expression:"config"}}):t._e(),t._v(" "),t.isConfigJSON?t._e():a("v-textarea",{attrs:{outlined:"",name:"input-7-4",label:"Enter ENV config"},model:{value:t.config,callback:function(e){t.config=e},expression:"config"}})],1)],1),t._v(" "),a("v-card-actions",[a("v-btn",{attrs:{color:"primary",loading:t.isSavingConfig},on:{click:t.saveConfig}},[t._v(" Save ")]),t._v(" "),a("v-btn",{attrs:{text:""},on:{click:t.closeDialog}},[t._v(" Cancel ")])],1)],1)}),[],!1,null,"add13d3c",null).exports,lt=a("MKDl"),rt=a("7Vew");function ct(t){return t.status&&k.a.RUBIX_PLAT!==t.service}var pt={name:"apps-download-multi-step",props:["app-details","close-dialog","deleteDownloadState","currentDownloadState","fetchDownloadAppState","clearDownloadAppStateInterval"],components:{AppStatusChip:lt.a,TextFieldDisplay:rt.a},data:function(){return{valid:!1,currentView:1,appReleases:[],serviceStatus:{},isFetchingAppStatus:!1,selectedVersion:null,multiStepViewConfig:{1:{back:1,forward:2,title:"App Status",hasBack:!1,disabled:!1,hasForward:!0,buttonLabel:function(t){return ct(t)?"Stop":"Continue"},loader:!1},2:{back:1,forward:3,title:"Download App",hasBack:!0,disabled:!1,hasForward:!0,buttonLabel:"Download",loader:!1},3:{back:2,forward:4,title:"Install App",hasBack:!0,hasForward:!0,buttonLabel:"Install",loader:!1,disabled:!1},4:{back:3,forward:4,title:"Installation Complete",hasBack:!0,hasForward:!0,buttonLabel:"Ok",loader:!1,disabled:!1}},loading:!0,rules:{required:function(t){return!!t||"Required."}},versionRules:[function(t){return!!t||"Version No. is required."}]}},mounted:function(){var t=this;return c()(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.appDetails.service,t.loading=!0,e.next=4,t.fetchAppStatus();case 4:return e.next=6,g.fetchAppReleases(a).then((function(e){t.appReleases=e,t.loading=!1})).catch((function(t){console.error(t)})).finally((function(){t.loading=!1}));case 6:case"end":return e.stop()}}),e,t)})))()},updated:function(){this.currentDownloadState!==k.c.DOWNLOAD_IN_PROGRESS&&this.currentDownloadState?this.multiStepViewConfig[3].disabled=!1:this.multiStepViewConfig[3].disabled=!0},watch:{currentDownloadState:function(t,e){this.showDownloadStateView(t)}},methods:{showDownloadStateView:function(t){switch(t){case k.c.DOWNLOAD_IN_PROGRESS:this.currentView=3;break;case k.c.DOWNLOAD_COMPLETE:this.currentView=3,this.clearDownloadAppStateInterval()}},back:function(){this.currentView=this.currentView-1},cancel:function(){3!==this.currentView&&2!==this.currentView||this.deleteDownloadState(),this.closeDialog(!0)},next:function(t){var e=this;return c()(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.currentView,t.t0=a,t.next=1===t.t0?4:2===t.t0?6:3===t.t0?8:4===t.t0?10:12;break;case 4:return e.stopAndContinue(),t.abrupt("break",14);case 6:return e.download(),t.abrupt("break",14);case 8:return e.install(),t.abrupt("break",14);case 10:return e.continue(),t.abrupt("break",14);case 12:return e.currentView++,t.abrupt("break",14);case 14:case"end":return t.stop()}}),t,e)})))()},stopAndContinue:function(){var t=this,e=(this.serviceStatus.status,this.serviceStatus.service);ct(this.serviceStatus)?(this.spinLoader(!0),g.changeServiceStatus(k.g.STOP,e).then((function(e){return t.spinLoader(!1),t.currentView++,t.fetchAppStatus()})).catch((function(e){t.spinLoader(!1)}))):this.currentView++},continue:function(){this.closeDialog(!0)},spinLoader:function(t){this.multiStepViewConfig[this.currentView].loader=t},download:function(){var t=this;return c()(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$refs.downloadForm.validate()){e.next=3;break}return e.abrupt("return");case 3:t.spinLoader(!0),a={service:t.appDetails.service,version:t.selectedVersion},g.downloadApp(a).then((function(e){t.currentView=3,t.fetchDownloadAppState(),t.spinLoader(!1)})).catch((function(e){e&&e.message&&(t.versionRules.push((function(){return e.message})),t.$refs.downloadForm.validate(),t.versionRules.pop()),t.spinLoader(!1)}));case 6:case"end":return e.stop()}}),e,t)})))()},install:function(){var t=this;this.spinLoader(!0);var e={service:this.appDetails.service,version:this.selectedVersion};g.installApp(e).then((function(e){t.spinLoader(!1),t.fetchAppStatus(),t.currentView++})).catch((function(e){t.spinLoader(!1),t.currentView--,e&&e.message&&(t.versionRules.push((function(){return e.message})),t.$refs.downloadForm.validate(),t.versionRules.pop())})).finally((function(){t.deleteDownloadState()}))},fetchAppStatus:function(){var t=this;return this.isFetchingAppStatus=!0,g.fetchAppStatus(this.appDetails.service,{restrictToast:!0}).then((function(e){t.selectedVersion=e.version,t.serviceStatus=e})).catch((function(e){t.selectedVersion=null,t.serviceStatus={}})).finally((function(){t.isFetchingAppStatus=!1}))}}},ut=Object(it.a)(pt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{loading:t.isFetchingAppStatus}},[a("v-card-title",[t.multiStepViewConfig[t.currentView].hasBack?a("v-btn",{staticClass:"white--text mr-1",attrs:{icon:"",medium:""},on:{click:t.back}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-arrow-left ")])],1):t._e(),t._v(" "),a("span",{staticClass:"headline"},[t._v(t._s(t.multiStepViewConfig[t.currentView].title))])],1),t._v(" "),a("v-card-text",[a("v-stepper",{model:{value:t.currentView,callback:function(e){t.currentView=e},expression:"currentView"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:t.currentView>1,step:"1"}},[t._v(" 1 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>2,step:"2"}},[t._v(" 2 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>3,step:"3"}},[t._v(" 3 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{step:"4"}},[t._v(" 4 ")])],1),t._v(" "),a("v-stepper-items",[a("v-stepper-content",{attrs:{step:"1"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Name",value:t.appDetails.display_name}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[a("text-field-display",{attrs:{label:"Active",value:(!t.isFetchingAppStatus&&t.serviceStatus.time_since?t.serviceStatus.time_since:"-")||"N/A"}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[a("app-status-chip",{attrs:{state:t.serviceStatus.state}})],1),t._v(" "),a("v-col",{staticClass:"text-right",attrs:{cols:"1"}},[a("v-btn",{staticClass:"white--text",attrs:{icon:"",medium:"",color:"success"},on:{click:t.fetchAppStatus}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-refresh ")])],1)],1)],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Version",value:!t.isFetchingAppStatus&&t.serviceStatus.version?t.serviceStatus.version:"-"}})],1)],1)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{ref:"downloadForm",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Name",value:t.appDetails.display_name}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[a("text-field-display",{attrs:{label:"Active",value:(!t.isFetchingAppStatus&&t.serviceStatus.time_since?t.serviceStatus.time_since:"-")||"N/A"}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[a("app-status-chip",{attrs:{state:t.serviceStatus.state}})],1),t._v(" "),a("v-col",{staticClass:"text-right",attrs:{cols:"1"}},[a("v-btn",{staticClass:"white--text",attrs:{icon:"",medium:"",color:"success"},on:{click:t.fetchAppStatus}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-refresh ")])],1)],1)],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Version",value:!t.isFetchingAppStatus&&t.serviceStatus.version?t.serviceStatus.version:"-"}})],1)],1),t._v(" "),a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-combobox",{attrs:{loading:t.loading,items:t.appReleases,label:"Select Release Version",hideSelected:"",clearable:"","item-text":"name","item-value":"tag_name",rules:t.versionRules},model:{value:t.selectedVersion,callback:function(e){t.selectedVersion=e},expression:"selectedVersion"}})],1)],1)],1)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"3"}},[a("div",{staticClass:"text-left"},[t.currentDownloadState?t._e():a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n              Fetching download status "),a("strong",[t._v("Please Wait!")])]),t._v(" "),"DOWNLOAD_IN_PROGRESS"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n              Downloading Selected App "),a("strong",[t._v("Please Wait!")])]):t._e(),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"success"}},[t._v("\n              Downloading Completed\n            ")]):t._e()],1),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("div",{staticClass:"pt-3"},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"6"}},[a("div",{staticClass:"grey--text mb-2 caption"},[t._v("Name")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                  "+t._s(t.appDetails.display_name+" - "+t.appDetails.service)+"\n                ")])]),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text mb-2 caption"},[t._v("Version")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                  "+t._s(t.isFetchingAppStatus?"-":t.selectedVersion)+"\n                ")])])],1)],1):t._e()]),t._v(" "),a("v-stepper-content",{attrs:{step:"4"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"12"}},[a("div",{staticClass:"font-weight-large"},[t._v("Successfully installed "+t._s(t.appDetails.display_name)+" app.")])])],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text caption mb-2"},[t._v("Name")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.appDetails.display_name)+"\n              ")])]),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text caption mb-2"},[a("span",[t._v("Version")])]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.selectedVersion)+"\n              ")])])],1)],1)],1)],1)],1),t._v(" "),a("v-card-actions",[t.multiStepViewConfig[t.currentView].hasForward?a("v-btn",{attrs:{color:"primary",disabled:t.multiStepViewConfig[t.currentView].disabled,loading:t.multiStepViewConfig[t.currentView].loader},on:{click:t.next}},[t._v("\n      "+t._s("function"==typeof t.multiStepViewConfig[t.currentView].buttonLabel?t.multiStepViewConfig[t.currentView].buttonLabel(t.serviceStatus):t.multiStepViewConfig[t.currentView].buttonLabel)+"\n    ")]):t._e(),t._v(" "),a("v-btn",{attrs:{text:""},on:{click:t.cancel}},[t._v(" Cancel ")])],1)],1)}),[],!1,null,null,null).exports,dt=a("OKta");function vt(t){return t.status&&k.a.RUBIX_PLAT!==t.service}var ft,ht={name:"apps-upload-multi-step",props:["app-details","close-dialog","isSlaveApp"],components:{AppStatusChip:lt.a,TextFieldDisplay:rt.a,RbxButton:dt.a},data:function(){return{isDeleteAppData:!1,isDeletingAppData:!1,valid:!1,currentView:1,version:null,serviceStatus:{},isFetchingAppStatus:!1,isStartingApp:!1,errorMessage:"",file:null,rubixAppTypes:k.h,apiService:null,slaveId:null,multiStepViewConfig:{1:{back:1,forward:2,title:function(t){return t+" | App Status"},hasBack:!1,hasForward:!0,buttonLabel:function(t){return vt(t)?"Stop":"Continue"},loader:!1},2:{back:1,forward:3,title:function(t){return t+" | Upload App"},hasBack:!0,hasForward:!0,buttonLabel:"Upload",loader:!1},3:{back:2,forward:4,title:function(t){return t+" | Install App"},hasBack:!0,hasForward:!0,buttonLabel:"Install",loader:!1},4:{back:3,forward:4,title:function(t){return t+" | Installation Complete"},hasBack:!0,hasForward:!0,buttonLabel:"Ok",loader:!1}},loading:!0,rules:{required:function(t){return!!t||"Required."}},versionRules:[function(t){return!!t||"Version No. is required."}]}},mounted:function(){var t=this;return c()(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isSlaveApp?(t.apiService=n,t.slaveId=t.appDetails.slaveId):t.apiService=g,e.next=3,t.fetchAppStatus();case 3:case"end":return e.stop()}}),e,t)})))()},methods:{back:function(){this.currentView=this.currentView-1},cancel:function(){this.closeDialog(!0)},next:function(t){var e=this;return c()(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.currentView,t.t0=a,t.next=1===t.t0?4:2===t.t0?6:3===t.t0?8:4===t.t0?10:12;break;case 4:return e.stopAndContinue(),t.abrupt("break",14);case 6:return e.upload(),t.abrupt("break",14);case 8:return e.install(),t.abrupt("break",14);case 10:return e.continue(),t.abrupt("break",14);case 12:return e.currentView++,t.abrupt("break",14);case 14:case"end":return t.stop()}}),t,e)})))()},stopAndContinue:function(){var t=this,e=(this.serviceStatus.status,this.serviceStatus.service);vt(this.serviceStatus)?(this.spinLoader(!0),this.apiService.changeServiceStatus(k.g.STOP,e,this.slaveId).then((function(e){return t.spinLoader(!1),t.currentView++,t.fetchAppStatus()})).catch((function(e){t.spinLoader(!1)}))):this.currentView++},startApp:function(){var t=this,e=this.serviceStatus.service;this.isStartingApp=!0,this.apiService.changeServiceStatus(k.g.START,e,this.slaveId).then((function(a){return t.$toasted.show("Successfully started "+e),t.continue(),t.fetchAppStatus()})).catch((function(a){t.$toasted.show("Could not start "+e,{type:"error"})})).finally((function(){t.isStartingApp=!1}))},continue:function(){this.closeDialog(!0)},spinLoader:function(t){this.multiStepViewConfig[this.currentView].loader=t},upload:function(){var t=this;this.$refs.uploadForm.validate()&&(this.spinLoader(!0),this.apiService.uploadApp(this.file,this.appDetails.service,this.version,this.slaveId).then((function(e){t.currentView++})).catch((function(e){e&&e.message&&(t.errorMessage=e.message)})).finally((function(){t.spinLoader(!1)})))},install:function(){var t=this;this.spinLoader(!0);var e={service:this.appDetails.service,version:this.version};this.apiService.installApp(e,this.slaveId).then((function(e){t.spinLoader(!1),t.fetchAppStatus(),t.currentView++,t.errorMessage=""})).catch((function(e){t.spinLoader(!1),vt(t.serviceStatus)?t.currentView--:t.currentView++,e&&e.message&&vt(t.serviceStatus)&&(t.errorMessage=e.message)}))},fetchAppStatus:function(){var t=this;return this.isFetchingAppStatus=!0,this.apiService.fetchAppStatus(this.appDetails.service,{restrictToast:!0},this.slaveId).then((function(e){t.serviceStatus=e})).catch((function(e){t.serviceStatus={}})).finally((function(){t.isFetchingAppStatus=!1}))},onFileSelect:function(){if(this.file&&this.file.name){var t=this.file.name,e=new RegExp("[0-9].[0-9].[0-9]"),a=t.match(e,"");a&&Array.isArray(a)&&(a=a[0],this.version="v"+a)}},deleteAppData:function(){var t=this;this.isDeletingAppData=!0,this.apiService.deleteAppData(this.serviceStatus.service,this.slaveId).then((function(){t.$toasted.show("Successfully deleted app data"),t.isDeleteAppData=!1})).catch((function(){t.$toasted.show("Cannot deleted app data",{type:"error"})})).finally((function(){t.isDeletingAppData=!1}))},toggleDeleteAppData:function(){this.isDeleteAppData=!this.isDeleteAppData}}},mt=Object(it.a)(ht,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{loading:t.isFetchingAppStatus}},[a("v-card-title",[t.multiStepViewConfig[t.currentView].hasBack?a("v-btn",{staticClass:"white--text mr-1",attrs:{icon:"",medium:""},on:{click:t.back}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-arrow-left ")])],1):t._e(),t._v(" "),a("span",{staticClass:"sub-headline"},[t._v(t._s(t.multiStepViewConfig[t.currentView].title(t.appDetails.display_name)))])],1),t._v(" "),a("v-card-text",[a("v-stepper",{model:{value:t.currentView,callback:function(e){t.currentView=e},expression:"currentView"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:t.currentView>1,step:"1"}},[t._v(" 1 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>2,step:"2"}},[t._v(" 2 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>3,step:"3"}},[t._v(" 3 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{step:"4"}},[t._v(" 4 ")])],1),t._v(" "),a("v-stepper-items",[a("v-stepper-content",{attrs:{step:"1"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Name",value:t.appDetails.display_name}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"2"}},[a("text-field-display",{attrs:{label:"Active",value:(!t.isFetchingAppStatus&&t.serviceStatus.time_since?t.serviceStatus.time_since:"-")||"N/A"}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[t.isFetchingAppStatus?t._e():a("app-status-chip",{attrs:{state:t.serviceStatus.state}})],1),t._v(" "),a("v-col",{staticClass:"text-right",attrs:{cols:"1"}},[a("v-btn",{staticClass:"white--text",attrs:{icon:"",medium:"",color:"success"},on:{click:t.fetchAppStatus}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-refresh ")])],1)],1)],1)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{ref:"uploadForm",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Name",value:t.appDetails.display_name}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"2"}},[a("text-field-display",{attrs:{label:"Active",value:(!t.isFetchingAppStatus&&t.serviceStatus.time_since?t.serviceStatus.time_since:"-")||"N/A"}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[t.isFetchingAppStatus?t._e():a("app-status-chip",{attrs:{state:t.serviceStatus.state}})],1),t._v(" "),a("v-col",{staticClass:"text-right",attrs:{cols:"1"}},[a("v-btn",{staticClass:"white--text",attrs:{icon:"",medium:"",color:"success"},on:{click:t.fetchAppStatus}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-refresh ")])],1)],1)],1),t._v(" "),a("v-row",{staticClass:"pa-3",attrs:{cols:"8"}},[a("v-file-input",{attrs:{rules:[t.rules.required],counter:"","show-size":"","truncate-length":"15"},on:{change:t.onFileSelect},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}})],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"text-left ml-8",attrs:{cols:"12"}},[a("v-text-field",{attrs:{label:"Version",type:"text","single-line":"",rules:[t.rules.required]},model:{value:t.version,callback:function(e){t.version=e},expression:"version"}})],1)],1),t._v(" "),t.errorMessage?a("v-alert",{staticClass:"text-left",attrs:{dense:"",outlined:"",type:"error"}},[t._v("\n              "+t._s(t.errorMessage)+"\n            ")]):t._e()],1)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"3"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"6"}},[a("div",{staticClass:"grey--text mb-2 caption"},[t._v("Name")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.appDetails.display_name+" - "+t.appDetails.service)+"\n              ")])]),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text mb-2 caption"},[t._v("Version")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.version)+"\n              ")])]),t._v(" "),t.serviceStatus.app_type===t.rubixAppTypes.PYTHON_APP?a("v-col",{staticClass:"text-left",attrs:{cols:"12"}},[t.isDeleteAppData?t._e():a("rbx-button",{attrs:{color:"pink",click:t.toggleDeleteAppData,title:"Delete App Data"}}),t._v(" "),t.isDeleteAppData?a("v-card",[a("v-card-title",{staticClass:"headline"},[t._v(" Confirm? ")]),t._v(" "),a("v-card-text",[t._v("Do you want to delete app data?")]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(e){t.isDeleteAppData=!1}}},[t._v(" Cancel ")]),t._v(" "),a("v-btn",{attrs:{color:"red darken-1",loading:t.isDeletingAppData,text:""},on:{click:t.deleteAppData}},[t._v(" Yes ")])],1)],1):t._e()],1):t._e()],1)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"4"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"12"}},[a("div",{staticClass:"font-weight-large"},[t._v("Successfully installed "+t._s(t.appDetails.display_name)+" app.")])])],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text caption mb-2"},[t._v("Name")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.appDetails.display_name)+"\n              ")])]),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text caption mb-2"},[a("span",[t._v("Version")])]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.serviceStatus.version)+"\n              ")])]),t._v(" "),a("v-col",{attrs:{cols:"4"}},[a("rbx-button",{attrs:{color:"success",click:t.startApp,loading:t.isStartingApp,title:"Start App"}})],1)],1)],1)],1)],1)],1),t._v(" "),a("v-card-actions",[t.multiStepViewConfig[t.currentView].hasForward?a("v-btn",{attrs:{color:"primary",loading:t.multiStepViewConfig[t.currentView].loader},on:{click:t.next}},[t._v("\n      "+t._s("function"==typeof t.multiStepViewConfig[t.currentView].buttonLabel?t.multiStepViewConfig[t.currentView].buttonLabel(t.serviceStatus):t.multiStepViewConfig[t.currentView].buttonLabel)+"\n    ")]):t._e(),t._v(" "),a("v-btn",{attrs:{text:""},on:{click:t.cancel}},[t._v(" Cancel ")])],1)],1)}),[],!1,null,null,null).exports,gt=(a("KSAc"),"DOWNLOAD_IN_PROGRESS"),_t="DOWNLOAD_COMPLETE",wt=(ft={props:["selectedApps","clearSelectedApps","closeDialog","fetchDownloadAppState","currentDownloadState","appDownloadStates","clearDownloadAppStateInterval","deleteDownloadState"],components:{AppStatusChip:lt.a,TextFieldDisplay:rt.a},data:function(){return{versionForm:!1,renderReleaseCount:0,isFetchingAppStatuses:!1,successInstallApps:[],failureInstallApps:[],currentView:1,refreshTime:1e4,versionRules:[function(t){return!!t||"Version No. is required."}],multiStepViewConfig:{1:{hasBack:!1,hasForward:!0,title:"Selected Apps",buttonLabel:"Continue",loader:!1,disabled:!1,hasCancel:!0},2:{hasBack:!0,hasForward:!0,title:"Download",buttonLabel:"Download App",loader:!1,disabled:!1,hasCancel:!0},3:{hasBack:!1,hasForward:!0,title:"Download",buttonLabel:"Install",hasCancelInstallation:!0,loader:!1,disabled:!0,hasCancel:!0,cancelTitle:"Close"},4:{hasBack:!1,hasForward:!0,title:"Installation Complete",buttonLabel:"Ok",loader:!1,disabled:!1,hasCancel:!1}}}},updated:function(){this.hasSelectedApps||this.currentDownloadState||this.currentDownloadState===_t?this.multiStepViewConfig[1].disabled=!1:(this.currentView=1,this.multiStepViewConfig[1].disabled=!0),this.currentDownloadState!==gt&&this.currentDownloadState?this.multiStepViewConfig[3].disabled=!1:this.multiStepViewConfig[3].disabled=!0},watch:{currentDownloadState:function(t,e){this.showDownloadStateView(t)}},created:function(){this.showDownloadStateView(this.currentDownloadState)},computed:{currentBulkAppDownloadState:function(){return this.$store.state.currentBulkAppDownloadState},hasSelectedApps:function(){return this.selectedApps.length>0},apps:function(){return this.selectedApps.map((function(t){return{serviceName:t.service,state:t.state,version:t.version,latestVersion:t.latest_version,minVersion:t.min_support_version,displayName:t.display_name,loadingReleases:!1,releases:[]}}))},downloadStates:function(){return Array.isArray(this.appDownloadStates)&&this.appDownloadStates.length>0&&(this.currentView=3),(this.appDownloadStates||[]).map((function(t){return{isDownloading:!t.download,version:t.version,serviceName:t.service,hasError:!!t.error,errorMessage:t.error}}))}}},v()(ft,"created",(function(){this.fetchAppsReleases()})),v()(ft,"methods",{back:function(){this.currentView=this.currentView-1},spinLoader:function(t){this.multiStepViewConfig[this.currentView].loader=t},showDownloadStateView:function(t){switch(t){case gt:this.currentView=3;break;case _t:this.currentView=3,this.clearDownloadAppStateInterval()}},fetchAppsReleases:function(){var t=this,e=this.selectedApps.map((function(t){return t.service}));return this.apps.forEach((function(t){t.loadingReleases=!0})),g.fetchAppsReleases(e).then((function(e){t.apps.forEach((function(t,a){t.releases=e[a]}))})).catch((function(){t.$toasted.show("Error fetching available releases")})).finally((function(){t.apps.forEach((function(t){t.loadingReleases=!1})),t.renderReleaseCount++}))},disableInstallationButton:function(){this.multiStepViewConfig[3].disabled=!0},bulkDownloadApps:function(){var t=this;this.currentView=3,this.disableInstallationButton();var e=this.apps.map((function(t){return{version:t.version,service:t.serviceName}}));return this.spinLoader(!0),g.bulkDownloadApps(e).then((function(){t.spinLoader(!1),t.fetchDownloadAppState()})).catch((function(e){t.spinLoader(!1)}))},next:function(t){var e=this;return c()(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.currentView,t.t0=a,t.next=1===t.t0?4:2===t.t0?6:3===t.t0?8:4===t.t0?10:12;break;case 4:return e.stopAndContinue(),t.abrupt("break",14);case 6:return e.download(),t.abrupt("break",14);case 8:return e.install(),t.abrupt("break",14);case 10:return e.continue(),t.abrupt("break",14);case 12:return e.currentView++,t.abrupt("break",14);case 14:case"end":return t.stop()}}),t,e)})))()},stopAndContinue:function(){this.currentView++},download:function(){this.$refs.versionForm.validate()&&this.bulkDownloadApps()},install:function(){var t=this,e=this.downloadStates.filter((function(t){return!t.hasError})).map((function(t){return{service:t.serviceName,version:t.version}}));return this.spinLoader(!0),g.bulkInstallApps(e).then((function(e){t.spinLoader(!1),t.currentView=4,t.successInstallApps=e.filter((function(t){return t.installation})),t.failureInstallApps=e.filter((function(t){return!t.installation}))})).catch((function(e){t.spinLoader(!1),t.deleteDownloadState(),t.$toasted.show("Unexpected error occured while bulk installing apps. Please try again")}))},continue:function(){this.resetDialog()},cancel:function(){this.fetchDownloadAppState(),this.closeDialog()},cancelInstallation:function(){this.resetDialog()},resetDialog:function(){this.versionForm=!1,this.renderReleaseCount=0,this.isFetchingAppStatuses=!1,this.currentView=1,this.multiStepViewConfig={1:{hasBack:!1,hasForward:!0,title:"Selected Apps",buttonLabel:"Continue",loader:!1},2:{hasBack:!0,hasForward:!0,title:"Download",buttonLabel:"Download App",loader:!1},3:{hasBack:!1,hasForward:!0,title:"Download",buttonLabel:"Install",loader:!1},4:{hasBack:!1,hasForward:!0,title:"Installation Complete",buttonLabel:"Ok",loader:!1}},this.deleteDownloadState(),this.fetchAppsReleases(),this.clearSelectedApps(),this.closeDialog(!0,{unmount:!0})}}),ft),bt=Object(it.a)(wt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{loading:t.isFetchingAppStatuses}},[a("v-card-title",[t.multiStepViewConfig[t.currentView].hasBack?a("v-btn",{staticClass:"white--text mr-1",attrs:{icon:"",medium:""},on:{click:t.back}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-arrow-left ")])],1):t._e(),t._v(" "),a("span",{staticClass:"sub-headline"},[t._v(" Bulk Apps | "+t._s(t.multiStepViewConfig[t.currentView].title)+" ")])],1),t._v(" "),a("v-card-text",[a("v-stepper",{model:{value:t.currentView,callback:function(e){t.currentView=e},expression:"currentView"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:t.currentView>1,step:"1"}},[t._v(" 1 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>2,step:"2"}},[t._v(" 2 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>3,step:"3"}},[t._v(" 3 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{step:"4"}},[t._v(" 4 ")])],1),t._v(" "),a("v-stepper-items",[a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"1"}},[t.hasSelectedApps?t._e():a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n            Please select apps from the grid to bulk download.\n          ")]),t._v(" "),a("v-list",{staticClass:"text-left",attrs:{flat:"",subheader:"",dense:""}},[a("v-subheader",[t._v("Selected Apps")]),t._v(" "),t._l(t.apps,(function(e,n){return a("v-list-item",{key:"selected_apps-"+n},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.displayName)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.version)}})],1),t._v(" "),a("v-list-item-icon",[a("app-status-chip",{attrs:{state:e.state}})],1)],1)}))],2)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{ref:"versionForm",attrs:{"lazy-validation":""},model:{value:t.versionForm,callback:function(e){t.versionForm=e},expression:"versionForm"}},[a("v-row",{staticClass:"text-left",attrs:{dense:""}},t._l(t.apps,(function(e,n){return a("v-col",{key:"version-form-"+t.renderReleaseCount+"-"+n,attrs:{cols:"12"}},[a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Name",value:e.displayName}})],1),t._v(" "),a("v-col",{attrs:{cols:"8"}},[a("v-combobox",{attrs:{loading:e.loadingReleases,items:e.releases,label:"Select Release Version",hideSelected:"",clearable:"","item-text":"name","item-value":"tag_name",rules:t.versionRules},model:{value:e.version,callback:function(a){t.$set(e,"version",a)},expression:"app.version"}})],1)],1)],1)})),1)],1)],1),t._v(" "),a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"3"}},[a("div",["DOWNLOAD_IN_PROGRESS"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n              Downloading Selected App(s) "),a("strong",[t._v("Please Wait!")])]):t._e(),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"success"}},[t._v("\n              Downloading Completed\n            ")]):t._e()],1),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-list",{staticClass:"text-left",attrs:{flat:"",subheader:"",dense:""}},[a("v-subheader",[t._v("App Download Statuses")]),t._v(" "),t._l(t.downloadStates,(function(e,n){return a("v-list-item",{key:"download-statuses-"+n},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.serviceName)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.version)}})],1),t._v(" "),a("v-list-item-icon",[e.isDownloading?a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"yellow"}},[t._v("Downloading")])],1)]):e.hasError?a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"red"}},[t._v("Failed")])],1)]):e.isDownloading||e.hasError?t._e():a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"green"}},[t._v("Downloaded")])],1)])])],1)}))],2):t._e()],1),t._v(" "),a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"4"}},["DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-list",{staticClass:"text-left",attrs:{flat:"",subheader:"",dense:""}},[t.successInstallApps.length>0?a("v-list-item-group",[a("v-subheader",[t._v("Installation Completed Apps")]),t._v(" "),t._l(t.successInstallApps,(function(e,n){return a("v-list-item",{key:"install-complete-"+n},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.service)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.version)}})],1),t._v(" "),a("v-list-item-icon",[a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"blue"}},[t._v("Installed")])],1)])])],1)}))],2):t._e(),t._v(" "),t.failureInstallApps.length>0?a("v-list-item-group",[a("v-subheader",[t._v(" Installation Failed Apps")]),t._v(" "),t._l(t.failureInstallApps,(function(e,n){return a("v-list-item",{key:"installation-failed-"+n},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.service)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.version)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.error)}})],1),t._v(" "),a("v-list-item-icon",[a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"red"}},[t._v("Failed")])],1)])])],1)}))],2):t._e()],1):t._e()],1)],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-card-actions",[t.multiStepViewConfig[t.currentView].hasForward?a("v-btn",{attrs:{color:"primary",loading:t.multiStepViewConfig[t.currentView].loader,disabled:t.multiStepViewConfig[t.currentView].disabled},on:{click:t.next}},[t._v("\n        "+t._s("function"==typeof t.multiStepViewConfig[t.currentView].buttonLabel?t.multiStepViewConfig[t.currentView].buttonLabel(t.serviceStatus):t.multiStepViewConfig[t.currentView].buttonLabel)+"\n      ")]):t._e(),t._v(" "),t.multiStepViewConfig[t.currentView].hasCancelInstallation?a("v-btn",{attrs:{color:"pink",disabled:t.multiStepViewConfig[t.currentView].disabled,text:""},on:{click:t.cancelInstallation}},[t._v("\n        Cancel Install\n      ")]):t._e(),t._v(" "),t.multiStepViewConfig[t.currentView].hasCancel?a("v-btn",{attrs:{text:""},on:{click:t.cancel}},[t._v(" Close ")]):t._e()],1)],1)],1)}),[],!1,null,null,null).exports,Dt=a("lkCm"),St="DOWNLOAD_IN_PROGRESS",At="DOWNLOAD_COMPLETE",Ct={name:"systemServices",components:{AppsEditConfig:ot,GridToolbar:m.a,AppsDownloadMultiStepView:ut,ConfirmDialog:Dt.a,AppStatusChip:lt.a,AppsUploadMultiStepView:mt,AppsBulkDownloadMultiStepView:bt},data:function(){var t,e={install:"install",uninstall:"uninstall",upload:"upload",deleteDatabase:"deleteDatabase",editConfig:"editConfig",deleteAppConfig:"deleteAppConfig",bulkDownload:"bulkDownload",restartService:"restartService"};return{selectedItems:[],isRestartingService:!1,refreshTime:5e3,singleDownloadRefreshTIme:1e3,appDownloadStates:[],selectedApp:null,dialogNames:e,isFetchingAppDetails:!1,isBulkDownloadAppPersistent:!0,isDeletingConfig:!1,isDeletingDatabase:!1,isUninstallingApp:!1,currentDownloadState:null,fetchDownloadStateInterval:null,isDeletingDownloadState:!1,dialog:(t={},v()(t,e.install,!1),v()(t,e.restartService,!1),v()(t,e.upload,!1),v()(t,e.uninstall,!1),v()(t,e.deleteDatabase,!1),v()(t,e.editConfig,!1),v()(t,e.deleteAppConfig,!1),v()(t,e.bulkDownload,!1),t),remountDialog:v()({},e.bulkDownload,!0),headers:[{text:"Label",align:"start",value:"display_name"},{text:"Name",align:"start",value:"service"},{text:"Status",align:"center",value:"state"},{text:"Restart",align:"center",sortable:!1,value:"restart"},{text:"Installed Version",align:"center",value:"installedVersion",sortable:!1},{text:"Latest Available Version",align:"center",value:"latest_version"},{text:"Actions",align:"center",value:"actions"},{text:"Config File",align:"center",value:"configFile"},{text:"Database",align:"end",value:"databaseOperations"}],tableProps:u()({},k.d)}},computed:{appDetails:function(){return this.formatAppDetails(this.$store.state.appDetails)},setting:function(){return this.$store.state.setting},showCheckDownloadIcon:function(){return this.currentDownloadState===At},showDownloadProgressIcon:function(){return this.currentDownloadState===St}},mounted:function(){this.fetchDownloadAppState()},created:function(){this.fetchAppDetails()},destroyed:function(){this.fetchDownloadStateInterval=null},methods:{closeDialog:function(t,e){var a=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.dialog[t]=!1,n.unmount&&this.remountDialog[t]&&(this.remountDialog[t]=!1,setTimeout((function(){a.remountDialog[t]=!0}),500)),e&&this.fetchAppDetails(!0)},openDialog:function(t){this.dialog[t]=!0},toggleDialog:function(t,e){if(!this.dialog[t])switch(t){case this.dialogNames.install:if(this.currentDownloadState)return this.$toasted.show("Please resolve bulk download apps in the top left first.",{type:"info"})}this.dialog[t]=!this.dialog[t],this.dialog[t]?this.selectedApp=e:this.selectedApp=null},formatAppDetails:function(t){return t.map((function(t){return u()({},t,{activeLabel:t.status?"Running":"Stopped",isUninstallable:t.is_installed,installedVersion:t.version?t.version:"-",downloadUrl:t.browser_download_url?t.browser_download_url:null,updatedAt:t.date_since?new Date(t.date_since).toLocaleDateString():"-"})}))},fetchAppDetails:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.isFetchingAppDetails=!0,g.fetchApps().then((function(a){t.$store.commit("changeAppDetails",a),e&&t.fetchAllInstalledApps()})).finally((function(){t.isFetchingAppDetails=!1}))},fetchAllInstalledApps:function(){var t=this;g.fetchAllInstalledApps().then((function(e){t.$store.commit("changeInstalledServices",e)})).catch((function(t){}))},deleteDatabase:function(){var t=this;this.isDeletingDatabase=!0,g.deleteAppDataService(this.selectedApp.service).then((function(){t.closeDialog(t.dialogNames.deleteDatabase,!0)})).catch((function(){t.closeDialog(t.dialogNames.deleteDatabase)})).finally((function(){t.isDeletingDatabase=!1}))},uninstall:function(t){var e=this;this.isUninstallingApp=!0,g.uninstallApp(this.selectedApp.service).then((function(){e.fetchAppDetails(!0),e.closeDialog(e.dialogNames.uninstall,!0)})).catch((function(){e.closeDialog(e.dialogNames.uninstall)})).finally((function(){e.isUninstallingApp=!1}))},getFileName:function(t){var e=new Date;return t+"_"+(e.getDate()+"-"+(e.getMonth()+1)+"-"+e.getFullYear()+"T"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds())},downloadAppData:function(t){var e=this,a=t.service;g.downloadAppData(a,this.setting).then(function(){var n=c()(l.a.mark((function n(s){var i,o,r,c;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=new h.a,n.next=3,i.loadAsync(s);case 3:return n.next=5,i.generateAsync({type:"blob"});case 5:o=n.sent,new Date,r=e.getFileName(a),(c=document.createElement("a")).href=window.URL.createObjectURL(o),c.setAttribute("download",r+".zip"),c.click(),e.$toasted.show(t.service+" app data is exported.");case 13:case"end":return n.stop()}}),n,e)})));return function(t){return n.apply(this,arguments)}}()).catch((function(t){var n=new FileReader;return n.addEventListener("loadend",(function(t){var n=JSON.parse(t.target.result);n&&n.message?e.$toasted.show(n.message,{type:"error"}):e.$toasted.show("Failed to export "+a+" app data",{type:"error"})})),n.readAsText(t),t}))},deleteAppConfigFile:function(){var t=this;this.isDeletingConfig=!0;var e=this.selectedApp.service,a=this.selectedApp.app_type;g.deleteAppConfig(e,a).then((function(a){t.$toasted.show(e+" app config file is deleted"),t.closeDialog(t.dialogNames.deleteAppConfig)})).catch((function(a){t.$toasted.show("Failed to delete app config for "+e,{type:"error"})})).finally((function(){t.isDeletingConfig=!1}))},downloadConfig:function(t){g.downloadAppConfig(t.service,t.app_type)},restartService:function(){var t=this;this.isRestartingService=!0;var e=this.selectedApp.service;g.changeServiceStatus(k.g.RESTART,e).then((function(){t.$toasted.show("App restarted sucessfully."),t.closeDialog(t.dialogNames.restartService)})).catch((function(){t.$toasted.show("Failed to restart the app.",{type:"error"})})).finally((function(){t.isRestartingService=!1}))},bulkDownloadApps:function(){this.openDialog(this.dialogNames.bulkDownload)},clearDownloadAppStateInterval:function(){clearInterval(this.fetchDownloadStateInterval),this.fetchDownloadStateInterval=null},downloadStateInterval:function(){var t=this,e=this.dialog[this.dialogNames.install]?this.singleDownloadRefreshTIme:this.refreshTime;this.fetchDownloadStateInterval||(this.fetchDownloadStateInterval=setInterval((function(){t.fetchDownloadAppState()}),e))},fetchDownloadAppState:function(){var t=this;return g.fetchDownloadState().then((function(e){var a=e.state,n=e.services;switch(a){case"DOWNLOADING":t.currentDownloadState=St,t.isBulkDownloadAppPersistent=!1,t.fetchDownloadStateInterval||t.downloadStateInterval();break;case"CLEARED":t.currentDownloadState=null,t.clearDownloadAppStateInterval();break;case"DOWNLOADED":t.currentDownloadState=At,t.isBulkDownloadAppPersistent=!0}return Array.isArray(n)&&(t.appDownloadStates=n),n})).catch((function(e){return e&&e.message&&(t.currentDownloadState=null),e}))},clearSelectedApps:function(){this.appDownloadStates=[],this.selectedItems=[]},deleteDownloadState:function(){var t=this;return this.isDeletingDownloadState=!0,g.deleteDownloadState().then((function(t){return t})).catch((function(t){return t})).finally((function(){t.fetchDownloadAppState(),t.clearDownloadAppStateInterval(),t.isDeletingDownloadState=!1}))}}},xt=Object(it.a)(Ct,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("grid-toolbar",{attrs:{"hide-export-data":!0,items:t.selectedItems,toolbarTitle:"Rubix Apps"},scopedSlots:t._u([{key:"customAction",fn:function(){return[a("span",[a("v-btn",{staticClass:"white--text",attrs:{disabled:t.isDeletingDownloadState,"x-small":"",color:"green"},on:{click:function(){return t.bulkDownloadApps(t.selectedItems)}}},[t._v("\n            Download Apps\n            "),a("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[t._v(" mdi-download ")])],1),t._v(" "),t.showDownloadProgressIcon?a("v-progress-circular",{attrs:{width:2,size:15,color:"white",indeterminate:""}}):t._e(),t._v(" "),t.showCheckDownloadIcon?a("v-icon",{attrs:{"x-medium":"",dark:""}},[t._v(" mdi-check")]):t._e()],1)]},proxy:!0}])})],1),t._v(" "),a("v-data-table",{attrs:{"show-select":"","item-key":"service",headers:t.headers,items:t.appDetails,"single-select":!1,loading:t.isFetchingAppDetails,"footer-props":t.tableProps.FOOTER_PROPS,itemsPerPage:t.tableProps.ITEMS_PER_PAGE},scopedSlots:t._u([{key:"item.state",fn:function(t){var e=t.item;return[a("app-status-chip",{attrs:{state:e.state}})]}},{key:"item.restart",fn:function(e){var n=e.item;return[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[n.isUninstallable?a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"success"},on:{click:function(){return t.toggleDialog(t.dialogNames.restartService,n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{dark:""}},[t._v(" mdi-restart ")])],1):t._e()]}}],null,!0)},[t._v(" "),a("span",[t._v("Restart Service")])])]}},{key:"item.actions",fn:function(e){var n=e.item;return[a("span",[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"success"},on:{click:function(){return t.toggleDialog(t.dialogNames.install,n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-download ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Download")])]),t._v(" "),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"yellow"},on:{click:function(){return t.toggleDialog(t.dialogNames.upload,n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-upload ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Upload")])]),t._v(" "),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[n.isUninstallable?a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"error"},on:{click:function(){return t.toggleDialog(t.dialogNames.uninstall,n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-delete ")])],1):t._e()]}}],null,!0)},[t._v(" "),a("span",[t._v("Delete App")])]),t._v(" "),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[n.downloadUrl?a("v-btn",t._g(t._b({attrs:{href:n.downloadUrl,target:"_blank",tar:"",icon:"",small:""}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-zip-box")])],1):t._e()]}}],null,!0)},[t._v(" "),a("span",[t._v("Download ZIP")])])],1)]}},{key:"item.configFile",fn:function(e){var n=e.item;return["PythonApp"==n.app_type||"FrontendApp"==n.app_type?a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"blue"},on:{click:function(){return t.toggleDialog(t.dialogNames.editConfig,n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-pencil ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Edit Config File")])]):t._e(),t._v(" "),"PythonApp"==n.app_type||"FrontendApp"==n.app_type?a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"success"},on:{click:function(){return t.downloadConfig(n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-download ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Download Config File")])]):t._e(),t._v(" "),"PythonApp"==n.app_type||"FrontendApp"==n.app_type?a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"error"},on:{click:function(){return t.toggleDialog(t.dialogNames.deleteAppConfig,n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-delete ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Delete Configuration")])]):t._e()]}},{key:"item.databaseOperations",fn:function(e){var n=e.item;return[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"success"},on:{click:function(){return t.downloadAppData(n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-download ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Download Database")])]),t._v(" "),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"error"},on:{click:function(){return t.toggleDialog(t.dialogNames.deleteDatabase,n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-delete ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Delete Database")])])]}}]),model:{value:t.selectedItems,callback:function(e){t.selectedItems=e},expression:"selectedItems"}}),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.uninstall],"on-close":function(){return t.closeDialog(t.dialogNames.uninstall)},"on-confirm":function(){return t.uninstall(t.dialogNames.uninstall)},loading:t.isUninstallingApp,"dialog-text":"Do you want to uninstall the app?"}}),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.restartService],"on-close":function(){return t.closeDialog(t.dialogNames.restartService)},"on-confirm":function(){return t.restartService()},loading:t.isRestartingService,"dialog-text":"Are you sure want to restart the app?"}}),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.deleteDatabase],"on-close":function(){return t.closeDialog(t.dialogNames.deleteDatabase)},"on-confirm":function(){return t.deleteDatabase(t.dialogNames.deleteDatabase)},loading:t.isDeletingDatabase,"dialog-text":"Do you want to delete the app's database?"}}),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.deleteAppConfig],"on-close":function(){return t.closeDialog(t.dialogNames.deleteAppConfig)},"on-confirm":function(){return t.deleteAppConfigFile()},loading:t.isDeletingConfig,"dialog-text":"Do you want to delete the app's config file?"}}),t._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.dialog[t.dialogNames.upload],callback:function(e){t.$set(t.dialog,t.dialogNames.upload,e)},expression:"dialog[dialogNames.upload]"}},[t.dialog[t.dialogNames.upload]?a("apps-upload-multi-step-view",{attrs:{"app-details":t.selectedApp,"close-dialog":function(e){return t.closeDialog(t.dialogNames.upload,e)}}}):t._e()],1),t._v(" "),a("v-dialog",{attrs:{presistent:"","max-width":"500px"},model:{value:t.dialog[t.dialogNames.editConfig],callback:function(e){t.$set(t.dialog,t.dialogNames.editConfig,e)},expression:"dialog[dialogNames.editConfig]"}},[t.dialog[t.dialogNames.editConfig]?a("apps-edit-config",{attrs:{"close-dialog":function(e){return t.closeDialog(t.dialogNames.editConfig,e)},"app-detail":t.selectedApp}}):t._e()],1),t._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.dialog[t.dialogNames.install],callback:function(e){t.$set(t.dialog,t.dialogNames.install,e)},expression:"dialog[dialogNames.install]"}},[t.dialog[t.dialogNames.install]?a("apps-download-multi-step-view",{attrs:{"delete-download-state":t.deleteDownloadState,"current-download-state":t.currentDownloadState,"fetch-download-app-state":t.fetchDownloadAppState,"clear-download-app-state-interval":t.clearDownloadAppStateInterval,"app-details":t.selectedApp,"close-dialog":function(e){return t.closeDialog(t.dialogNames.install,e)}}}):t._e()],1),t._v(" "),a("v-dialog",{attrs:{persistent:t.isBulkDownloadAppPersistent,"max-width":"500px"},model:{value:t.dialog[t.dialogNames.bulkDownload],callback:function(e){t.$set(t.dialog,t.dialogNames.bulkDownload,e)},expression:"dialog[dialogNames.bulkDownload]"}},[t.remountDialog[t.dialogNames.bulkDownload]?a("apps-bulk-download-multi-step-view",{attrs:{"current-download-state":t.currentDownloadState,"selected-apps":t.selectedItems,"fetch-download-app-state":t.fetchDownloadAppState,"app-download-states":t.appDownloadStates,"clear-selected-apps":t.clearSelectedApps,"delete-download-state":t.deleteDownloadState,"clear-download-app-state-interval":t.clearDownloadAppStateInterval,"close-dialog":function(e,a){return t.closeDialog(t.dialogNames.bulkDownload,e,a)}}}):t._e()],1)],1)}),[],!1,null,null,null).exports,kt=a("snOE"),yt=a.n(kt),It=a("+SqX"),Nt=a("Ui9F"),Vt={name:"slave-app-grid",props:["slaveApps","selectedItems","latestVersion","slaveDevices","onSelectItem","searchText","filters"],components:{AppStatusChip:lt.a,GridToolbar:m.a,TextFieldDisplay:rt.a,TooltipIconButton:Nt.a,ConfirmDialog:Dt.a,AppsEditConfig:ot,AppsUploadMultiStepView:mt},data:function(){var t,e={editConfig:"editConfig",restartService:"restartService",deleteDatabase:"deleteDatabase",deleteAppConfig:"deleteAppConfig",upload:"upload",uninstall:"uninstall"};return{expanded:[],isDeletingConfig:!1,dataTableHeight:void 0,isRestartingService:!1,isUninstallingApp:!1,isDeletingDatabase:!1,dialog:(t={},v()(t,e.deleteDatabase,!1),v()(t,e.restartService,!1),v()(t,e.upload,!1),v()(t,e.editConfig,!1),v()(t,e.deleteAppConfig,!1),v()(t,e.uninstall,!1),t),dialogNames:e,selectedApp:{},headers:[{text:"Site Name",align:"left",value:"slave_site_name"},{text:"Device Name",align:"left",value:"slave_device_name"},{text:"Status",align:"right",value:"state"},{text:"Installed Version",align:"center",sortable:!1,value:"version"},{text:"Active Since",align:"center",sortable:!1,value:"time_since"},{text:"State",align:"center",value:"slave_app_enabled"},{text:"",value:"data-table-expand"}]}},computed:{selectedGridItems:{get:function(){return this.selectedItems},set:function(t){this.onSelectItem(this.serviceName,t)}},setting:function(){return this.$store.state.setting},title:function(){return this.slaveApps.display_name},serviceName:function(){return this.slaveApps.name},dataItems:function(){var t=this;return this.slaveApps.dataItems.filter((function(e){return!(t.filters.isInstalled&&!e.is_installed)})).map((function(e){return t.appendSlaveDevice(e)}))},isFixedHeader:function(){return this.dataItems.length>10}},methods:{appendSlaveDevice:function(t){var e=u()({},t),a=this.slaveDevices[t.slaveId];return a&&(e=u()({},e,{time_since:e.time_since?e.time_since:"-"},i()(a).reduce((function(t,e){return t["slave_"+e]=a[e],t}),{}))),e},closeDialog:function(t,e){this.dialog[t]=!1,this.selectedApp={},e&&"function"==typeof this.fetchAppDetails&&this.fetchAppDetails(!0)},toggleDialog:function(t,e){this.dialog[t]=!this.dialog[t],this.dialog[t]?this.selectedApp=e:this.selectedApp=null},onDeleteDatabase:function(){var t=this;this.isDeletingDatabase=!0;var e=this.selectedApp.service,a=this.selectedApp.slaveId;z(e,a).then((function(){t.$toasted.show("Successfully deleted app data for "+e),t.closeDialog(t.dialogNames.deleteDatabase,!0)})).catch((function(){t.closeDialog(t.dialogNames.deleteDatabase)})).finally((function(){t.isDeletingDatabase=!1}))},downloadConfig:function(t){var e=t.service,a=t.app_type,n=t.slaveId,s=t.slave_device_name;q(e,n,s,a)},deleteAppConfigFile:function(){var t=this;this.isDeletingConfig=!0;var e=this.selectedApp.service,a=this.selectedApp.app_type,n=this.selectedApp.slaveId;Q(n,e,a).then((function(a){t.$toasted.show(e+" app config file is deleted"),t.closeDialog(t.dialogNames.deleteAppConfig)})).catch((function(a){t.$toasted.show("Failed to delete app config for "+e,{type:"error"})})).finally((function(){t.isDeletingConfig=!1}))},onDownloadDatabase:function(t){var e=this,a=t.service,n=t.slaveId;B(a,n,this.setting).then(function(){var t=c()(l.a.mark((function t(n){var s,i,o,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=new h.a,t.next=3,s.loadAsync(n);case 3:return t.next=5,s.generateAsync({type:"blob"});case 5:i=t.sent,new Date,o=e.getFileName(a),(r=document.createElement("a")).href=window.URL.createObjectURL(i),r.setAttribute("download",o+".zip"),r.click(),e.$toasted.show(a+" app data is exported.");case 13:case"end":return t.stop()}}),t,e)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){var n=new FileReader;return n.addEventListener("loadend",(function(t){var n=JSON.parse(t.target.result);n&&n.message?e.$toasted.show(n.message,{type:"error"}):e.$toasted.show("Failed to export "+a+" app data",{type:"error"})})),n.readAsText(t),t}))},uninstall:function(){var t=this;this.isUninstallingApp=!0;var e=this.selectedApp.service,a=this.selectedApp.slaveId;X(a,e).then((function(){t.$toasted.show("Successfully unistalled app"),t.closeDialog(t.dialogNames.uninstall,!0)})).catch((function(){t.closeDialog(t.dialogNames.uninstall)})).finally((function(){t.isUninstallingApp=!1}))},restartService:function(){var t=this;this.isRestartingService=!0;var e=this.selectedApp.service,a=this.selectedApp.slaveId;Z(k.g.RESTART,e,a).then((function(){t.closeDialog(t.dialogNames.restartService,!0),t.$toasted.show("App restarted sucessfully.")})).catch((function(e){t.$toasted.show("Failed to restart the app.",{type:"error"})})).finally((function(){t.isRestartingService=!1}))},getPageLength:function(t){t.itemsLength<10?this.dataTableHeight=void 0:this.dataTableHeight="400px"}}},Ot=Object(it.a)(Vt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{outlined:""}},[a("v-card-text",{staticClass:"pa-0"},[a("v-toolbar",{attrs:{dense:"",flat:""}},[a("v-toolbar-title",[a("span",[t._v(t._s(t.title))])]),t._v(" "),a("v-spacer"),t._v(" "),t.latestVersion?a("span",[a("span",{staticClass:"grey-text font-weight-medium caption pr-2"},[t._v("Latest Version")]),t._v("\n        "+t._s(t.latestVersion)+"\n      ")]):t._e()],1),t._v(" "),a("v-data-table",{attrs:{dense:"","fixed-header":t.isFixedHeader,"hide-default-footer":"",items:t.dataItems,"single-select":!1,"show-select":"",height:t.dataTableHeight,"items-per-page":1e4,expanded:t.expanded,"single-expand":"","item-key":"slaveId",search:t.searchText,headers:t.headers,"show-expand":""},on:{pagination:t.getPageLength,"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"item.state",fn:function(t){var e=t.item;return[a("app-status-chip",{attrs:{"chip-size":"small",state:e.state}})]}},{key:"item.slave_app_enabled",fn:function(e){var n=e.item;return[a("span",{staticClass:"font-weight-medium"},[n.is_enabled?a("v-chip",{attrs:{small:"",dark:"",color:"darken-2 green"}},[t._v("Enabled")]):t._e(),t._v(" "),n.is_enabled?t._e():a("v-chip",{attrs:{small:"",dark:"",color:"darken-1 brown"}},[t._v("Disabled")])],1)]}},{key:"expanded-item",fn:function(e){var n=e.headers,s=e.item;return[a("td",{staticClass:"expanded-table-row py-2",attrs:{colspan:n.length}},[a("div",{staticClass:"flex pl-15"},[a("span",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("Timezone")]),t._v(" "),a("span",{staticClass:"text-ellipses"},[t._v(t._s(s.slave_time_zone))])]),t._v(" "),a("span",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("State")]),t._v(" "),a("span",{staticClass:"font-weight-medium text-ellipses"},[t._v(t._s(s.slave_site_state))])]),t._v(" "),a("span",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("City")]),t._v(" "),a("span",{staticClass:"font-weight-medium text-ellipses"},[t._v(t._s(s.slave_site_city))])]),t._v(" "),a("span",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("Zip")]),t._v(" "),a("span",{staticClass:"font-weight-medium text-ellipses"},[t._v(t._s(s.slave_site_zip))])])]),t._v(" "),a("div",{staticClass:"flex pl-15 pt-3 text-left"},[a("div",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("App Features")]),t._v(" "),a("p",[a("tooltip-icon-button",{attrs:{btnColor:"yellow",btnIcon:"mdi-upload",btnTooltip:"Upload App",onClick:function(){return t.toggleDialog(t.dialogNames.upload,s)}}}),t._v(" "),s.is_installed?a("tooltip-icon-button",{attrs:{btnColor:"error",btnIcon:"mdi-delete",btnTooltip:"Uninstall App",onClick:function(){return t.toggleDialog(t.dialogNames.uninstall,s)}}}):t._e(),t._v(" "),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,i=e.attrs;return[s.browser_download_url?a("v-btn",t._g(t._b({attrs:{href:s.browser_download_url,target:"_blank",tar:"",icon:"",small:""}},"v-btn",i,!1),n),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-zip-box")])],1):t._e()]}}],null,!0)},[t._v(" "),a("span",[t._v("Download ZIP")])])],1)]),t._v(" "),a("div",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("Config File")]),t._v(" "),a("p",[a("tooltip-icon-button",{attrs:{btnColor:"blue",btnIcon:"mdi-pencil",btnTooltip:"Edit Config File",onClick:function(){return t.toggleDialog(t.dialogNames.editConfig,s)}}}),t._v(" "),"PythonApp"==s.app_type||"FrontendApp"==s.app_type?a("tooltip-icon-button",{attrs:{btnColor:"success",btnIcon:"mdi-download",btnTooltip:"Download Config File",onClick:function(){return t.downloadConfig(s)}}}):t._e(),t._v(" "),a("tooltip-icon-button",{attrs:{btnColor:"error",btnIcon:"mdi-delete",btnTooltip:"Delete Configuration",onClick:function(){return t.toggleDialog(t.dialogNames.deleteAppConfig,s)}}})],1)]),t._v(" "),a("div",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("Database")]),t._v(" "),a("p",[a("tooltip-icon-button",{attrs:{btnColor:"success",btnIcon:"mdi-download",btnTooltip:"Download Database",onClick:function(){return t.onDownloadDatabase(s)}}}),t._v(" "),a("tooltip-icon-button",{attrs:{btnIcon:"mdi-delete",btnColor:"error",btnTooltip:"Delete Database",onClick:function(){return t.toggleDialog(t.dialogNames.deleteDatabase,s)}}})],1)]),t._v(" "),a("div",{staticClass:"table-expanded-item"},[s.is_installed?a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("Restart")]):t._e(),t._v(" "),s.is_installed?a("p",[a("tooltip-icon-button",{attrs:{btnColor:"success",btnIcon:"mdi-restart",btnTooltip:"Restart Service",onClick:function(){return t.toggleDialog(t.dialogNames.restartService,s)}}})],1):t._e()])])])]}}]),model:{value:t.selectedGridItems,callback:function(e){t.selectedGridItems=e},expression:"selectedGridItems"}})],1),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.deleteDatabase],"on-close":function(){return t.closeDialog(t.dialogNames.deleteDatabase)},"on-confirm":function(){return t.onDeleteDatabase()},loading:t.isDeletingDatabase,"dialog-text":"Do you want to delete the app's database?"}}),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.restartService],"on-close":function(){return t.closeDialog(t.dialogNames.restartService)},"on-confirm":function(){return t.restartService()},loading:t.isRestartingService,"dialog-text":"Are you sure to restart the app?"}}),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.deleteAppConfig],"on-close":function(){return t.closeDialog(t.dialogNames.deleteAppConfig)},"on-confirm":function(){return t.deleteAppConfigFile()},loading:t.isDeletingConfig,"dialog-text":"Do you want to delete the app's config file?"}}),t._v(" "),a("v-dialog",{attrs:{presistent:"","max-width":"500px"},model:{value:t.dialog[t.dialogNames.editConfig],callback:function(e){t.$set(t.dialog,t.dialogNames.editConfig,e)},expression:"dialog[dialogNames.editConfig]"}},[t.dialog[t.dialogNames.editConfig]?a("apps-edit-config",{attrs:{"is-slave-app":!0,"close-dialog":function(e){return t.closeDialog(t.dialogNames.editConfig,e)},"app-detail":t.selectedApp}}):t._e()],1),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.uninstall],"on-close":function(){return t.closeDialog(t.dialogNames.uninstall)},"on-confirm":function(){return t.uninstall(t.dialogNames.uninstall)},loading:t.isUninstallingApp,"dialog-text":"Do you want to uninstall the app?"}}),t._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.dialog[t.dialogNames.upload],callback:function(e){t.$set(t.dialog,t.dialogNames.upload,e)},expression:"dialog[dialogNames.upload]"}},[t.dialog[t.dialogNames.upload]?a("apps-upload-multi-step-view",{attrs:{"app-details":t.selectedApp,"is-slave-app":!0,"close-dialog":function(e){return t.closeDialog(t.dialogNames.upload,e)}}}):t._e()],1)],1)}),[],!1,null,null,null).exports,Ft=function(t){var e=function(t,e){return i()(t).reduce((function(a,n){var s=i()(t[n]).reduce((function(a,s){return e[n]&&e[n].includes(s)&&a.push(t[n][s]),a}),[]);return a[n]=s,a}),{})}(t.releaseMap,function(t){return i()(t).reduce((function(e,a){return e[a]=(t[a]||[]).map((function(t){return t&&t.slaveId})).filter((function(t){return t})),e}),{})}(t.selectedItems));return i()(e).reduce((function(t,a){var n=e[a].map((function(t){return t&&t.length||1/0})),s=n.indexOf(Math.min.apply(Math,yt()(n)));return t[a]=e[a][s]||[],t}),{})},Lt={name:"tooltip-title",props:["title"]},Et=Object(it.a)(Lt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[a("span",t._g(t._b({staticClass:"white--text"},"span",s,!1),n),[t._v("\n      "+t._s(t.title)+"\n    ")])]}}])},[t._v(" "),a("span",[t._v(t._s(t.title))])])}),[],!1,null,null,null).exports,Rt="DOWNLOAD_IN_PROGRESS",Tt="DOWNLOAD_COMPLETE",Pt={props:["selectedApps","slaveDevices","appVersions","clearSelectedApps","closeDialog","fetchDownloadAppState","currentDownloadState","slaveAppsDownloadStates","clearDownloadAppStateInterval","deleteDownloadState"],components:{AppStatusChip:lt.a,TextFieldDisplay:rt.a,TooltipTitle:Et},data:function(){return{versionForm:!1,renderReleaseCount:0,successInstalledApps:{},failureInstallApps:{},currentView:1,refreshTime:1e4,versionRules:[function(t){return!!t||"Version No. is required."}],multiStepViewConfig:{1:{hasBack:!1,hasForward:!0,title:"Selected Apps",buttonLabel:"Continue",loader:!1,disabled:!1,hasCancel:!0},2:{hasBack:!0,hasForward:!0,title:"Download",buttonLabel:"Download App",loader:!1,disabled:!1,hasCancel:!0},3:{hasBack:!1,hasForward:!0,title:"Download",buttonLabel:"Install",hasCancelInstallation:!0,loader:!1,disabled:!0,hasCancel:!0,cancelTitle:"Close"},4:{hasBack:!1,hasForward:!0,title:"Installation Complete",buttonLabel:"Ok",loader:!1,disabled:!1,hasCancel:!1}}}},updated:function(){this.hasSelectedApps||this.currentDownloadState||this.currentDownloadState===Tt?this.multiStepViewConfig[1].disabled=!1:(this.currentView=1,this.multiStepViewConfig[1].disabled=!0),this.currentDownloadState!==Rt&&this.currentDownloadState?this.multiStepViewConfig[3].disabled=!1:this.multiStepViewConfig[3].disabled=!0},watch:{currentDownloadState:function(t,e){this.showDownloadStateView(t)}},created:function(){this.showDownloadStateView(this.currentDownloadState)},computed:{currentBulkAppDownloadState:function(){return this.$store.state.currentBulkAppDownloadState},hasSelectedApps:function(){var t=this;return i()(this.selectedApps).reduce((function(e,a){var n=t.selectedApps[a],s=n&&Array.isArray(n)&&n.length>0;return e||s}),!1)},apps:function(){var t=this;return i()(this.selectedApps).reduce((function(e,a){return t.selectedApps[a]&&t.selectedApps[a].length>0&&(e.push(t.getHeader(a)),e.push.apply(e,yt()(function(t){return t.map((function(t){return u()({},t,{isListItem:!0,serviceName:t.service,slaveClientName:t.slave_client_name,slaveDeviceName:t.slave_device_name,state:t.state,version:t.version,latestVersion:t.latest_version,minVersion:t.min_support_version,displayName:t.display_name,loadingReleases:!1,releases:[]})}))}(t.selectedApps[a]))),e.push(t.getVersionSelection(a,t.selectedApps[a])),e.push({divider:!0,isNonItem:!0})),e}),[]).filter((function(t){return t}))},downloadStates:function(){var t=this,e=this.slaveDevices;return i()(this.slaveAppsDownloadStates).reduce((function(a,n){return t.slaveAppsDownloadStates[n]&&t.slaveAppsDownloadStates[n].dataItems&&t.slaveAppsDownloadStates[n].dataItems.length>0&&(a.push(u()({},t.getHeader(n),{version:t.slaveAppsDownloadStates[n].dataItems[0].version})),a.push.apply(a,yt()(t.slaveAppsDownloadStates[n].dataItems.map((function(t){return u()({},t,{isListItem:!0,serviceName:t.service,slaveDeviceName:e[t.slaveId].device_name,version:t.version,hasError:!!t.error,errorMessage:t.error,isDownloading:t.download})})))),a.push({divider:!0,isNonItem:!0})),a}),[])},installationSuccessApps:function(){var t=this,e=this.slaveDevices;return i()(this.successInstalledApps).reduce((function(a,n){return t.successInstalledApps[n]&&t.successInstalledApps[n].dataItems&&t.successInstalledApps[n].dataItems.length>0&&(a.push(u()({},t.getHeader(n),{version:t.successInstalledApps[n].dataItems[0].version})),a.push.apply(a,yt()(t.successInstalledApps[n].dataItems.map((function(t){return u()({},t,{slaveDeviceName:e[t.slaveId].device_name,isListItem:!0})})))),a.push({divider:!0,isNonItem:!0})),a}),[])},installationFailedApps:function(){var t=this,e=this.slaveDevices;return i()(this.failureInstallApps).reduce((function(a,n){return t.failureInstallApps[n]&&t.failureInstallApps[n].dataItems&&t.failureInstallApps[n].dataItems.length>0&&(a.push(u()({},t.getHeader(n),{version:t.failureInstallApps[n].dataItems[0].version})),a.push.apply(a,yt()(t.failureInstallApps[n].dataItems.map((function(t){return u()({},t,{slaveDeviceName:e[t.slaveId].site_name,isListItem:!0})})))),a.push({divider:!0,isNonItem:!0})),a}),[])}},methods:{getHeader:function(t){return{text:t,name:t,isHeader:!0,isNonItem:!0,isListItem:!1}},getCommonAppMinVersion:function(t){var e=t.map((function(t){return t.min_support_version}));if(e.filter((function(t,e,a){return a.indexOf(t)===e})).length!==this.appVersions.length)return null;var a=e.reduce((function(t,e){var a=t[e]||0;return t[e]=a+1,t}),{}),n=i()(a).map((function(t){return a[t]})),s=n.indexOf(Math.max.apply(Math,yt()(n)));return s>-1?e[s]:""},getVersionSelection:function(t,e){var a=e.map((function(t){return t.version})).filter((function(t,e,a){return a.indexOf(t)===e})),n=this.getCommonAppMinVersion(e);return{text:t,name:t,model:1===a.length?a[0]:n,isListItem:!1,isVersionSelect:!0,versions:a}},back:function(){this.currentView=this.currentView-1},spinLoader:function(t){this.multiStepViewConfig[this.currentView].loader=t},showDownloadStateView:function(t){switch(t){case Rt:this.currentView=3;break;case Tt:this.currentView=3,this.clearDownloadAppStateInterval()}},disableInstallationButton:function(){this.multiStepViewConfig[3].disabled=!0},bulkDownloadApps:function(){var t=this;this.currentView=3,this.disableInstallationButton();var e=this.apps.reduce((function(t,e){return e.isVersionSelect&&(t[e.name]=e.model),t}),{}),a=this.apps.filter((function(t){return t.isListItem})).map((function(t){return{version:e[t.service],service:t.serviceName,slaveId:t.slaveId}}));return this.spinLoader(!0),E(a).then((function(){t.spinLoader(!1),t.fetchDownloadAppState()})).catch((function(e){t.spinLoader(!1)}))},next:function(t){var e=this;return c()(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.currentView,t.t0=a,t.next=1===t.t0?4:2===t.t0?6:3===t.t0?8:4===t.t0?10:12;break;case 4:return e.stopAndContinue(),t.abrupt("break",14);case 6:return e.download(),t.abrupt("break",14);case 8:return e.install(),t.abrupt("break",14);case 10:return e.continue(),t.abrupt("break",14);case 12:return e.currentView++,t.abrupt("break",14);case 14:case"end":return t.stop()}}),t,e)})))()},stopAndContinue:function(){this.currentView++},download:function(){this.$refs.versionForm.validate()&&this.bulkDownloadApps()},install:function(){var t=this,e=this.downloadStates.filter((function(t){return t.isListItem&&!t.hasError})).map((function(t){return{version:t.version,service:t.serviceName,slaveId:t.slaveId}}));return this.spinLoader(!0),R(e).then((function(e){var a=e.successInstalledApps,n=void 0===a?{}:a,s=e.errorInstalledApps,i=void 0===s?{}:s;t.spinLoader(!1),t.currentView=4,t.successInstalledApps=u()({},n),t.failureInstallApps=u()({},i)})).catch((function(e){t.spinLoader(!1),t.$toasted.show("Unexpected error occured while bulk installing apps. Please try again")}))},continue:function(){this.resetDialog()},cancel:function(){this.fetchDownloadAppState(),this.closeDialog()},cancelInstallation:function(){this.resetDialog()},resetDialog:function(){this.versionForm=!1,this.renderReleaseCount=0,this.currentView=1,this.multiStepViewConfig={1:{hasBack:!1,hasForward:!0,title:"Selected Apps",buttonLabel:"Continue",loader:!1,disabled:!1,hasCancel:!0},2:{hasBack:!0,hasForward:!0,title:"Download",buttonLabel:"Download App",loader:!1,disabled:!1,hasCancel:!0},3:{hasBack:!1,hasForward:!0,title:"Download",buttonLabel:"Install",hasCancelInstallation:!0,loader:!1,disabled:!0,hasCancel:!0,cancelTitle:"Close"},4:{hasBack:!1,hasForward:!0,title:"Installation Complete",buttonLabel:"Ok",loader:!1,disabled:!1,hasCancel:!1}},this.deleteDownloadState(),this.clearSelectedApps(),this.closeDialog(!0,{unmount:!0})}}},Mt=Object(it.a)(Pt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[t.multiStepViewConfig[t.currentView].hasBack?a("v-btn",{staticClass:"white--text mr-1",attrs:{icon:"",medium:""},on:{click:t.back}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-arrow-left ")])],1):t._e(),t._v(" "),a("span",{staticClass:"sub-headline"},[t._v(" Slave Apps | "+t._s(t.multiStepViewConfig[t.currentView].title)+" ")])],1),t._v(" "),a("v-card-text",[a("v-stepper",{model:{value:t.currentView,callback:function(e){t.currentView=e},expression:"currentView"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:t.currentView>1,step:"1"}},[t._v(" 1 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>2,step:"2"}},[t._v(" 2 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>3,step:"3"}},[t._v(" 3 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{step:"4"}},[t._v(" 4 ")])],1),t._v(" "),a("v-stepper-items",[a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"1"}},[t.hasSelectedApps?t._e():a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n            Please select apps from the grid to bulk download.\n          ")]),t._v(" "),a("div",{staticClass:"text-left pb-5"},[a("v-subheader",{staticClass:"mb-n5"},[t._v("Selected Apps")]),t._v(" "),a("v-row",{staticClass:"pa-1",attrs:{dense:""}},[t._l(t.apps,(function(e,n){return[e.isHeader?a("v-col",{key:"selected_apps_header-"+n,staticClass:"pl-3 mt-3",attrs:{cols:"12"}},[a("span",{staticClass:"caption font-weight-bold"},[t._v(t._s(e.name))])]):t._e(),t._v(" "),e.isListItem?a("v-col",{key:"selected_apps-"+n,staticClass:"pl-5",attrs:{cols:"4"}},[a("div",[a("p",{staticClass:"text-ellipses mb-0"},[a("tooltip-title",{attrs:{title:e.slaveDeviceName+" "+(e.version?"("+e.version+")":"")}})],1),t._v(" "),a("p",[a("app-status-chip",{attrs:{"chip-size":"small",state:e.state}})],1)])]):t._e()]}))],2)],1)],1),t._v(" "),a("v-stepper-content",{staticClass:"pa-2 pt-5",attrs:{step:"2"}},[a("v-form",{ref:"versionForm",attrs:{"lazy-validation":""},model:{value:t.versionForm,callback:function(e){t.versionForm=e},expression:"versionForm"}},[a("v-row",{staticClass:"text-left",attrs:{dense:""}},[t._l(t.apps,(function(e,n){return[e.isHeader?a("v-col",{key:"version-form-header-"+t.renderReleaseCount+"-"+n,attrs:{cols:"12"}},[a("span",{staticClass:"caption font-weight-bold"},[t._v(t._s(e.name))])]):t._e(),t._v(" "),e.isListItem?a("v-col",{key:"version-form-field-"+t.renderReleaseCount+"-"+n,staticClass:"pl-5",attrs:{cols:"4"}},[a("div",[a("p",{staticClass:"text-ellipses mb-0"},[a("tooltip-title",{attrs:{title:e.slaveDeviceName+" "+(e.version?"("+e.version+")":"")}})],1),t._v(" "),a("p",[a("app-status-chip",{attrs:{"chip-size":"small",state:e.state}})],1)])]):t._e(),t._v(" "),e.isVersionSelect?a("v-col",{key:"version-form-select-"+t.renderReleaseCount+"-"+n,attrs:{cols:"12"}},[a("v-combobox",{staticClass:"ml-5",attrs:{items:t.appVersions[e.name],label:"Select Release Version",hideSelected:"",clearable:"","item-text":"name","item-value":"tag_name",rules:t.versionRules},model:{value:e.model,callback:function(a){t.$set(e,"model",a)},expression:"app.model"}})],1):t._e()]}))],2)],1)],1),t._v(" "),a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"3"}},[a("div",["DOWNLOAD_IN_PROGRESS"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n              Downloading App(s) "),a("strong",[t._v("Please Wait!")])]):t._e(),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"success"}},[t._v("\n              Downloading Completed\n            ")]):t._e()],1),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("div",{staticClass:"text-left pb-5",attrs:{flat:"",subheader:"",dense:""}},[a("v-subheader",{staticClass:"pa-2 mb-n4"},[t._v("App Download Statuses")]),t._v(" "),a("v-row",{staticClass:"text-left",attrs:{dense:""}},[t._l(t.downloadStates,(function(e,n){return[e.isHeader?a("v-col",{key:"download-statuses-header-"+n,staticClass:"pl-3 mt-3",attrs:{cols:"12"}},[a("span",{staticClass:"caption font-weight-bold"},[t._v(t._s(e.name))]),t._v(" "),a("span",{staticClass:"white--text font-weight-bold"},[t._v("("+t._s(e.version)+")")])]):t._e(),t._v(" "),e.isListItem?a("v-col",{key:"download-statuses-"+n,staticClass:"pl-5",attrs:{cols:"4"}},[a("div",[a("p",{staticClass:"mb-0 text-ellipses"},[a("tooltip-title",{attrs:{title:e.slaveDeviceName}})],1),t._v(" "),a("div",[e.hasError?a("span",{staticClass:"font-weight-medium"},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[a("v-chip",t._g(t._b({attrs:{small:"",outlined:"",color:"red"}},"v-chip",s,!1),n),[t._v("Failed")])]}}],null,!0)},[t._v(" "),a("span",[t._v(t._s(e.error))])])],1):e.isDownloading||e.hasError?e.isDownloading&&!e.hasError?a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{small:"",outlined:"",color:"green"}},[t._v("Downloaded")])],1):t._e():a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{small:"",outlined:"",color:"yellow"}},[t._v("Downloading")])],1)])])]):t._e()]}))],2)],1):t._e()]),t._v(" "),a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"4"}},["DOWNLOAD_COMPLETE"===t.currentDownloadState?a("div",{staticClass:"text-left pb-5"},[t.installationSuccessApps.length>0?a("div",{staticClass:"text-left pb-5"},[a("v-subheader",{staticClass:"pa-2 mb-n4"},[t._v("Installation Completed Apps")]),t._v(" "),a("v-row",{attrs:{dense:""}},[t._l(t.installationSuccessApps,(function(e,n){return[e.isHeader?a("v-col",{key:"install-complete-header-"+n,staticClass:"pl-3 mt-3",attrs:{cols:"12"}},[a("span",{staticClass:"caption font-weight-bold",attrs:{title:e.name}},[t._v(t._s(e.name))]),t._v(" "),a("span",{staticClass:"white--text font-weight-bold"},[t._v("("+t._s(e.version)+")")])]):t._e(),t._v(" "),e.isListItem?a("v-col",{key:"install-complete-"+n,staticClass:"pl-5",attrs:{cols:"4"}},[a("div",[a("p",{staticClass:"mb-0 text-ellipses"},[a("tooltip-title",{attrs:{title:e.slaveDeviceName}})],1),t._v(" "),a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{small:"",outlined:"",color:"blue"}},[t._v("Installed")])],1)])])]):t._e()]}))],2)],1):t._e(),t._v(" "),t.installationFailedApps.length>0?a("div",[a("v-subheader",[t._v(" Installation Failed Apps")]),t._v(" "),a("v-row",{attrs:{dense:""}},[t._l(t.installationFailedApps,(function(e,n){return[e.isHeader?a("v-col",{key:"installation-failed-header-"+n,staticClass:"pl-3",attrs:{cols:"12"}},[a("span",{staticClass:"caption font-weight-bold"},[t._v(t._s(e.name))]),t._v(" "),a("span",{staticClass:"white--text font-weight-bold"},[t._v("("+t._s(e.version)+")")])]):t._e(),t._v(" "),e.isListItem?a("v-col",{key:"install-complete-"+n,staticClass:"pl-5",attrs:{cols:"4"}},[a("div",[a("p",{staticClass:"mb-0 text-ellipses"},[a("tooltip-title",{attrs:{title:e.slaveDeviceName}})],1),t._v(" "),a("p",[a("span",{staticClass:"font-weight-medium"},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[a("v-chip",t._g(t._b({attrs:{small:"",outlined:"",color:"red"}},"v-chip",s,!1),n),[t._v("Failed")])]}}],null,!0)},[t._v(" "),a("span",[t._v(t._s(e.error))])])],1)])])]):t._e()]}))],2)],1):t._e()]):t._e()])],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-card-actions",[t.multiStepViewConfig[t.currentView].hasForward?a("v-btn",{attrs:{color:"primary",loading:t.multiStepViewConfig[t.currentView].loader,disabled:t.multiStepViewConfig[t.currentView].disabled},on:{click:t.next}},[t._v("\n        "+t._s("function"==typeof t.multiStepViewConfig[t.currentView].buttonLabel?t.multiStepViewConfig[t.currentView].buttonLabel(t.serviceStatus):t.multiStepViewConfig[t.currentView].buttonLabel)+"\n      ")]):t._e(),t._v(" "),t.multiStepViewConfig[t.currentView].hasCancelInstallation?a("v-btn",{attrs:{color:"pink",disabled:t.multiStepViewConfig[t.currentView].disabled,text:""},on:{click:t.cancelInstallation}},[t._v("\n        Cancel Install\n      ")]):t._e(),t._v(" "),t.multiStepViewConfig[t.currentView].hasCancel?a("v-btn",{attrs:{text:""},on:{click:t.cancel}},[t._v(" Close ")]):t._e()],1)],1)],1)}),[],!1,null,null,null).exports,$t={name:"slave-apps-control-action-report",props:["controlActionErrorReport","closeDialog","slaveDevices","slaveAppDisplayNameMap"],computed:{successApps:function(){return this.controlActionErrorReport.success},faliureApps:function(){var t=this;return i()(this.controlActionErrorReport).reduce((function(e,a){var n=t.controlActionErrorReport[a].failure;return n=n.map((function(e){return u()({},e,{action:(e.action||"").toUpperCase(),displayName:t.slaveAppDisplayNameMap[e.service]},t.slaveDevices&&t.slaveDevices[e.slaveId]||{})})),e.push.apply(e,yt()(n)),e}),[])}}},Bt=Object(it.a)($t,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[t._v("Control Actions Status Report")]),t._v(" "),a("v-card-text",[a("v-list",{staticClass:"text-left",attrs:{flat:"",subheader:"",dense:""}},[a("v-subheader",[t._v("Failed apps")]),t._v(" "),t._l(t.faliureApps,(function(e,n){return[a("v-list-item",{key:"failed-app-"+n,staticClass:"pl-5"},[a("v-list-item-content",[a("v-list-item-title",{staticClass:"subtitle-2 font-weight-medium",domProps:{textContent:t._s(e.displayName+" | "+e.device_name+" | Action: "+e.action)}}),t._v(" "),a("p",{staticClass:"body-"},[a("span",[t._v("Message: ")]),t._v(" "),a("span",{staticClass:"red--text",attrs:{title:e.error}},[t._v(t._s(e.error))])])],1)],1)]}))],2)],1)],1)}),[],!1,null,null,null).exports,zt=a("0iKi"),Ut=a("5Bfd"),jt="success",Wt="failure",Gt="partial",Ht={success:{type:"success",duration:1e3,message:function(t){return"Sucessfully applied action '"+t+"' all apps."}},failure:{type:"error",duration:1e4,message:function(t){return"Failed to apply action '"+t+"' to all apps."}},partial:{type:"info",duration:1e4,message:function(t){return"Partially applied action '"+t+"' to all apps."}}},Jt={name:"slave-apps",components:{PageTitle:It.a,IconButton:Ut.a,SlaveAppGrid:Ot,SlaveAppsDownloadMultiStep:Mt,ConfirmDialog:Dt.a,SlaveAppsControlActionReport:Bt,TooltipIconButton:Nt.a},data:function(){var t,e,a={bulkUpdate:"bulkUpdate",controlActionErrorReport:"controlActionErrorReport"},n="startBtn",s="restartBtn",i="stopBtn",o="enableBtn",l="disableBtn",r=(t={},v()(t,n,{name:n,title:"Start",color:"light-blue darken-2",iconKey:"mdi-play-circle-outline",action:k.g.START}),v()(t,s,{name:s,title:"Restart",color:"light-green darken-2",iconKey:"mdi-restart",action:k.g.RESTART}),v()(t,i,{name:i,title:"Stop",iconKey:"mdi-stop-circle-outline",action:k.g.STOP}),v()(t,o,{name:o,title:"Enable",color:"teal darken-2",iconKey:"mdi-check-circle-outline",action:k.g.ENABLE}),v()(t,l,{name:l,title:"Disable",color:"orange darken-2",iconKey:"mdi-close-octagon",action:k.g.DISABLE}),t),c=[n,i,s,o,l];return{recompute:0,filters:{isInstalled:!1},slaveAppDisplayNameMap:{},slaveAppsLatestVersion:{},isFetchingSlaveApps:!1,currentControlAction:null,isControlActionPending:!1,statusControlErrors:[],isFetchAppfailure:!1,isClearDialog:!1,isLoadingSlaveApps:!1,slaveAppsOnceLoaded:!1,controlActionState:null,controlActionErrorReport:{},slaveReleaseList:null,fetchErrorMessage:"",searchText:"",isFetchingAppData:!1,refreshTime:5e3,isDeletingDownloadState:!1,currentDownloadState:null,slaveAppsDetailMap:{},slaveAppsDetail:[],selectedItems:{},appVersions:{},selectedAppVersion:{},slaveAppReleases:{},fetchDownloadAppStateInterval:null,slaveDevices:{},slaveAppsDownloadStates:{},dialogNames:a,dialog:(e={},v()(e,a.bulkUpdate,!1),v()(e,a.controlActionErrorReport,!1),e),actionButtons:c.map((function(t){return r[t]})),remountDialog:v()({},a.bulkUpdate,!0)}},mounted:function(){this.initialize()},destroyed:function(){this.fetchDownloadAppStateInterval=null},computed:{showCheckDownloadIcon:function(){return this.currentDownloadState===k.c.DOWNLOAD_COMPLETE},showDownloadProgressIcon:function(){return this.currentDownloadState===k.c.DOWNLOAD_IN_PROGRESS},selectedServicesCount:function(){var t=this;return i()(this.selectedItems).reduce((function(e,a){return e+=t.selectedItems[a].length}),0)},appliedFilterCount:function(){var t=this;return i()(this.filters).reduce((function(e,a){return t.filters[a]&&e++,e}),0)}},methods:{retryFetchApps:function(){this.fetchErrorMessage="",this.isFetchAppfailure=!1,this.initialize()},initialize:function(){var t=this;return c()(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isFetchingAppData=!0,e.next=3,D.a.all([t.fetchSlaveApps(!0),t.fetchSlaveDevices()]).finally((function(){t.isFetchingAppData=!1,t.recompute++}));case 3:return e.next=5,t.fetchSlaveAppsLatestVersion();case 5:case"end":return e.stop()}}),e,t)})))()},openDialog:function(t){this.dialog[t]=!0},toggleDialog:function(t,e){this.dialog[t]=!this.dialog[t],this.dialog[t]?this.selectedApp=e:this.selectedApp=null},fetchSlaveAppsLatestVersion:function(){var t=this;return nt().then((function(e){t.slaveAppsLatestVersion=e}))},fetchSlaveApps:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isFetchingSlaveApps)return this.slaveAppsOnceLoaded||(this.isLoadingSlaveApps=!0),this.isFetchingSlaveApps=!0,N().then((function(a){var n=a.data,s=void 0===n?{}:n;t.slaveAppsDetailMap=s,t.slaveAppDisplayNameMap=i()(s).reduce((function(t,e){return t[e]=s[e]?s[e].display_name:e,t}),{}),t.slaveAppsDetail=i()(s).map((function(t){return s[t]})),t.selectedItems=i()(s).reduce((function(t,e){return t[e]=[],t}),{}),t.slaveAppsOnceLoaded=!0,e&&t.fetchSlaveAppReleases()})).catch((function(e){e&&e.message&&(t.$toasted.show(e.message,{type:"error"}),t.fetchErrorMessage=e.message),t.isFetchAppfailure=!0})).finally((function(){t.isLoadingSlaveApps=!1,t.isFetchingSlaveApps=!1}))},onSelectItem:function(t,e){this.selectedItems[t]=e,this.selectedAppVersion=Ft({releaseMap:this.appVersions,selectedItems:this.selectedItems})},fetchSlaveDevices:function(){var t=this;return zt.e().then((function(e){t.slaveDevices=e,t.fetchDownloadAppState()})).catch((function(t){}))},fetchSlaveAppReleases:function(){var t=this,e=i()(this.slaveAppsDetailMap);return e.length?$(e).then((function(a){t.appVersions=e.reduce((function(t,e,n){return t[e]=a[n],t}),{})})).catch((function(e){t.$toasted.show("Error fetching app releases")})):null},onBulkUpdate:function(){this.dialog[this.dialogNames.bulkUpdate]=!0},closeDialog:function(t){this.dialog[t]=!1},startDownloadStateInterval:function(){var t=this;this.fetchDownloadAppStateInterval||(this.fetchDownloadAppStateInterval=setInterval((function(){t.fetchDownloadAppState()}),this.refreshTime))},clearDownloadAppStateInterval:function(){clearInterval(this.fetchDownloadAppStateInterval),this.fetchDownloadAppStateInterval=null},deleteDownloadState:function(){var t=this;this.isDeletingDownloadState=!0;var e=i()(this.slaveDevices);return e&&e.length>0?P(e).finally((function(){t.fetchDownloadAppState(),t.clearDownloadAppStateInterval(),t.isDeletingDownloadState=!1})):null},fetchDownloadAppState:function(){var t=this,e=i()(this.slaveDevices);return e&&e.length>0?T().then((function(e){var a=e.data;switch(e.globalState){case"DOWNLOADING":t.currentDownloadState=k.c.DOWNLOAD_IN_PROGRESS,t.fetchDownloadAppStateInterval||t.startDownloadStateInterval();break;case"CLEARED":t.currentDownloadState=null,t.clearDownloadAppStateInterval();break;case"DOWNLOADED":t.currentDownloadState=k.c.DOWNLOAD_COMPLETE,t.clearDownloadAppStateInterval()}return t.slaveAppsDownloadStates=a,i()(t.slaveAppsDownloadStates).forEach((function(e){t.slaveAppsDownloadStates[e].dataItems=t.slaveAppsDownloadStates[e].dataItems.map((function(e){return t.appendSlaveDevice(e)}))})),a})).catch((function(t){})):null},clearSelectedApps:function(){this.slaveAppsDownloadStates={},this.selectedItems={},this.recompute++,this.fetchSlaveApps()},appendSlaveDevice:function(t){var e=u()({},t),a=this.slaveDevices[t.slaveId];return a&&(e=u()({},e,i()(a).reduce((function(t,e){return t["slave_"+e]=a[e],t}),{}))),e},onClearDownload:function(){var t=this;this.clearSelectedApps(),this.deleteDownloadState().finally((function(){t.isClearDialog=!1}))},getControlErrorReport:function(t){return i()(t).reduce((function(e,a){e[a]||(e[a]={success:[],failure:[]});var n=t[a].dataItems;return e[a].success=n.filter((function(t){return!t.error})),e[a].failure=n.filter((function(t){return t.error})),e}),{})},getControlActionState:function(t){var e=i()(t).reduce((function(e,a){var n=t[a].success,s=t[a].failure;return 0==s.length?e.push(jt):s.length>0&&0!==n.length?e.push(Gt):e.push(Wt),e}),[]);return e.every((function(t){return t===jt}))?jt:e.every((function(t){return t===Wt}))?Wt:Gt},openErrorReportDialog:function(){this.dialog[this.dialogNames.controlActionErrorReport]=!0},getToastMessageAction:function(t){var e=this,a=[];return t!==Wt&&t!==Gt||a.push({text:"Click here to see Error Report.",onClick:function(a,n){return e.openErrorReportDialog(a,n,t)}}),a},handleControlAction:function(t){var e=this;this.currentControlAction=t,this.isControlActionPending=!0;var a=i()(this.selectedItems).reduce((function(t,a){return e.selectedItems[a]&&e.selectedItems[a].length>0&&t.push.apply(t,yt()(e.selectedItems[a])),t}),[]);return L(a,t).then((function(a){var n=a.data,s=e.getControlErrorReport(n),i=e.getControlActionState(s),o=Ht[i];e.$toasted.show(o.message(t),{type:o.type,duration:o.duration,action:e.getToastMessageAction(i)}),e.controlActionErrorReport=s,e.clearSelectedApps()})).catch((function(t){})).finally((function(){e.currentControlAction=null,e.isControlActionPending=!1}))}}},qt=Object(it.a)(Jt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{loading:t.isLoadingSlaveApps||t.isFetchingAppData}},[a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",[a("span",[t._v("Master Slave Apps")]),t._v(" "),a("tooltip-icon-button",{attrs:{btnColor:"default",btnIcon:"mdi-sync",btnTooltip:"Refresh master view",buttonSize:"medium",onClick:function(){return t.initialize()}}})],1),t._v(" "),a("v-text-field",{staticClass:"pl-10",attrs:{"append-icon":"mdi-magnify",label:"Search using site or device name","single-line":"","hide-details":""},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),t._v(" "),a("v-menu",{attrs:{bottom:"",left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[a("v-btn",t._g(t._b({attrs:{dark:"",icon:""}},"v-btn",s,!1),n),[a("v-icon",{attrs:{color:t.appliedFilterCount>0?"blue":"white"}},[t._v("mdi-filter")])],1)]}}])},[t._v(" "),a("v-list",{attrs:{dense:""}},[a("v-subheader",[t._v("Filters")]),t._v(" "),a("v-list-item",[a("v-list-item-title",[a("v-checkbox",{staticClass:"mt-0",attrs:{"hide-details":"",label:"Installed Apps"},model:{value:t.filters.isInstalled,callback:function(e){t.$set(t.filters,"isInstalled",e)},expression:"filters.isInstalled"}})],1)],1)],1)],1),t._v(" "),a("v-spacer"),t._v(" "),t.currentDownloadState?a("v-btn",{staticClass:"white--text ml-3",attrs:{"x-medium":"",color:"default"},on:{click:function(){return t.isClearDialog=!0}}},[a("span",[t._v("Clear Update")]),t._v(" "),a("v-icon",{attrs:{"x-medium":"",right:"",dark:""}},[t._v(" mdi-cellphone-erase ")])],1):t._e(),t._v(" "),a("v-btn",{staticClass:"white--text",attrs:{"x-medium":"",color:"pink"},on:{click:t.onBulkUpdate}},[t.showDownloadProgressIcon?a("v-progress-circular",{attrs:{width:2,size:15,color:"white",indeterminate:""}}):t._e(),t._v(" "),t.showCheckDownloadIcon?a("v-icon",{attrs:{"x-medium":"",dark:""}},[t._v(" mdi-check")]):t._e(),t._v(" "),a("span",{staticClass:"pl-2"},[t._v("Bulk Update")]),t._v(" "),a("v-icon",{attrs:{"x-medium":"",right:"",dark:""}},[t._v(" mdi-cellphone-arrow-down ")])],1)],1),t._v(" "),a("v-spacer"),t._v(" "),a("v-card-text",[a("v-container",{attrs:{fluid:""}},[a("v-row",{attrs:{"no-gutter":""}},[a("v-col",{attrs:{cols:"3"}},[t.selectedServicesCount>0?a("p",{staticClass:"mb-0 text-left"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("Selected Apps: ")]),t._v(" "),a("span",{staticClass:"font-weight-medium white--text"},[t._v(t._s(t.selectedServicesCount))])]):t._e()]),t._v(" "),a("v-col",{attrs:{cols:"6"}},t._l(t.actionButtons,(function(e){return a("icon-button",{key:e.name,attrs:{"btn-size":"small",disabled:0==t.selectedServicesCount||t.currentControlAction&&t.currentControlAction!==e.action,"on-click":function(){return t.handleControlAction(e.action)},"button-title":e.title,loading:t.currentControlAction&&t.currentControlAction==e.action&&t.isControlActionPending,"icon-key":e.iconKey,color:e.color}})})),1),t._v(" "),a("v-col",{attrs:{cols:"3"}})],1),t._v(" "),a("v-row",{attrs:{"no-gutter":""}},t._l(t.slaveAppsDetail,(function(e){return a("v-col",{key:e.name,attrs:{cols:"12",lg:"12",xl:"12",md:"12",sm:"12",xs:"12"}},[a("slave-app-grid",{key:t.recompute+"-"+e.name,attrs:{"slave-devices":t.slaveDevices,"search-text":t.searchText,filters:t.filters,"app-versions":t.selectedAppVersion,"latest-version":t.slaveAppsLatestVersion[e.name],onSelectItem:t.onSelectItem,"selected-item":t.selectedItems[e.name],"slave-apps":e}})],1)})),1)],1),t._v(" "),t.isLoadingSlaveApps?a("v-row",[t.isLoadingSlaveApps?a("v-col",{attrs:{cols:"12"}},[a("v-skeleton-loader",{attrs:{type:"table-heading, list-item-one-line, image"}})],1):t._e(),t._v(" "),t.isLoadingSlaveApps?a("v-col",{attrs:{cols:"12"}},[a("v-skeleton-loader",{attrs:{type:"table-heading, list-item-one-line, image"}})],1):t._e(),t._v(" "),t.isLoadingSlaveApps?a("v-col",{attrs:{cols:"12"}},[a("v-skeleton-loader",{attrs:{type:"table-heading, list-item-one-line, image"}})],1):t._e(),t._v(" "),t.isLoadingSlaveApps?a("v-col",{attrs:{cols:"12"}},[a("v-skeleton-loader",{attrs:{type:"table-heading, list-item-one-line, image"}})],1):t._e()],1):t._e(),t._v(" "),t.isFetchAppfailure?a("v-col",{staticClass:"text-left",attrs:{cols:"12"}},[t.fetchErrorMessage?a("v-alert",{staticClass:"mb-0 text-left",attrs:{dense:"",outlined:"",type:"error"}},[t._v("\n        "+t._s(t.fetchErrorMessage)+"\n      ")]):t._e(),t._v(" "),a("v-btn",{staticClass:"mt-10",attrs:{color:"primary"},on:{click:t.retryFetchApps}},[t._v("Click here to retry")])],1):t._e()],1),t._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:t.dialog[t.dialogNames.bulkUpdate],callback:function(e){t.$set(t.dialog,t.dialogNames.bulkUpdate,e)},expression:"dialog[dialogNames.bulkUpdate]"}},[a("slave-apps-download-multi-step",{attrs:{"app-versions":t.selectedAppVersion,"slave-devices":t.slaveDevices,"close-dialog":function(){return t.closeDialog(t.dialogNames.bulkUpdate)},"selected-apps":t.selectedItems,"clear-selected-apps":t.clearSelectedApps,"delete-download-state":t.deleteDownloadState,"current-download-state":t.currentDownloadState,"slave-apps-download-states":t.slaveAppsDownloadStates,"fetch-download-app-state":t.fetchDownloadAppState,"clear-download-app-state-interval":t.clearDownloadAppStateInterval}})],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"600px"},model:{value:t.dialog[t.dialogNames.controlActionErrorReport],callback:function(e){t.$set(t.dialog,t.dialogNames.controlActionErrorReport,e)},expression:"dialog[dialogNames.controlActionErrorReport]"}},[a("slave-apps-control-action-report",{attrs:{"slave-devices":t.slaveDevices,"slave-app-display-name-map":t.slaveAppDisplayNameMap,"close-dialog":function(){t.dialog[t.dialogNames.controlActionErrorReport]=!1},"control-action-error-report":t.controlActionErrorReport}})],1),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.isClearDialog,"on-close":function(){return t.isClearDialog=!1},"on-confirm":t.onClearDownload,"dialog-text":"All progress will be lost. Are you sure?"}})],1)}),[],!1,null,null,null).exports,Yt=a("pzyp"),Kt={name:"rubix-apps",data:function(){return{toggleMasterSlave:1,isFetchingMRBConfig:!1}},components:{AppsGrid:xt,PageTitle:It.a,SlaveApps:qt},created:function(){var t=this;this.isFetchingMRBConfig=!0,Yt.a().then((function(e){t.$store.commit("changeMqttRestBridgeConfig",e)})).finally((function(){t.isFetchingMRBConfig=!1}))},computed:{isMqttRestBridgeConfigLoaded:function(){return i()(this.$store.state.mqttRestBridgeConfig||{}).length>0},isMaster:function(){return this.$store.state.isMaster}}},Qt=Object(it.a)(Kt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("page-title",{attrs:{title:"Rubix Apps"},scopedSlots:t._u([{key:"spinner",fn:function(){return[t.isFetchingMRBConfig?a("v-progress-circular",{attrs:{indeterminate:"",size:"20"}}):t._e()]},proxy:!0}])}),t._v(" "),t.isFetchingMRBConfig?t._e():a("div",[t.isMaster?a("div",[a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-btn-toggle",{attrs:{rounded:""},model:{value:t.toggleMasterSlave,callback:function(e){t.toggleMasterSlave=e},expression:"toggleMasterSlave"}},[a("v-btn",{attrs:{small:"",value:1}},[t._v(" Master View ")]),t._v(" "),a("v-btn",{attrs:{small:"",value:2}},[t._v(" Slave View ")])],1)],1),t._v(" "),a("v-row",[!t.isMqttRestBridgeConfigLoaded&&t.isFetchingMRBConfig?a("v-col",{attrs:{cols:"12"}},[a("v-skeleton-loader",{attrs:{type:"table-heading, list-item-two-line, image, table-tfoot"}})],1):t._e(),t._v(" "),!t.isFetchingMRBConfig&&t.isMqttRestBridgeConfigLoaded&&2==t.toggleMasterSlave?a("v-col",{attrs:{cols:"12"}},[a("apps-grid")],1):t._e(),t._v(" "),!t.isFetchingMRBConfig&&t.isMqttRestBridgeConfigLoaded&&1==t.toggleMasterSlave?a("v-col",{attrs:{cols:"12"}},[a("slave-apps")],1):t._e()],1)],1):a("div",[t.isFetchingMRBConfig?a("v-col",{attrs:{cols:"12"}},[a("v-skeleton-loader",{attrs:{type:"table-heading, image, image, image, table-tfoot"}})],1):t._e(),t._v(" "),!t.isFetchingMRBConfig&&t.isMqttRestBridgeConfigLoaded?a("v-col",{attrs:{cols:"12"}},[a("apps-grid")],1):t._e()],1)])],1)}),[],!1,null,null,null);e.default=Qt.exports},0:function(t,e){},"0iKi":function(t,e,a){"use strict";a.d(e,"c",(function(){return l})),a.d(e,"a",(function(){return r})),a.d(e,"e",(function(){return c})),a.d(e,"d",(function(){return p})),a.d(e,"f",(function(){return u})),a.d(e,"b",(function(){return d}));var n=a("OBCi"),s=a.n(n),i=a("uzYq"),o="/slave-devices",l=function(t){var e={global_uuid:t.global_uuid};return i.a.post(o,e)},r=function(t){return s.a.all(t.map((function(t){return l(t)})))},c=function(){return i.a.get(o)},p=function(){return i.a.get(o+"/discover")},u=function(t){var e=t.global_uuid;return i.a.delete(o+"/"+e)},d=function(t){return s.a.all(t.map((function(t){return u(t)})))}},1:function(t,e){},2:function(t,e){},"3saC":function(t,e,a){"use strict";var n={props:["on-copy"],methods:{copyToClipboard:function(t){var e=this;this.$copyText(t,this.$refs.copyClipboard).then((function(){e.$toasted.show("Copied to clipboard!",{type:"success"})}),(function(){e.$toasted.show("Cannot copy to clipboard.",{type:"error"})}))}}},s=a("psIG"),i=Object(s.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{ref:"copyClipboard"},[a("v-btn",{staticClass:"white-text",attrs:{"x-small":"",color:"#009688"},on:{click:function(){return t.onCopy(t.copyToClipboard)}}},[a("span",[t._v("Copy  ")]),t._v(" "),a("v-icon",{attrs:{small:""}},[t._v("mdi-export")])],1)],1)}),[],!1,null,null,null);e.a=i.exports},"5Bfd":function(t,e,a){"use strict";var n={name:"icon-button",props:["icon-key","on-click","button-title","color","btnSize","disabled","loading"]},s=a("psIG"),i=Object(s.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",["small"==t.btnSize?a("v-btn",{staticClass:"pa-2",attrs:{loading:t.loading,disabled:t.disabled,color:t.color,small:"",text:""},on:{click:t.onClick}},[a("v-icon",[t._v(t._s(t.iconKey))]),t._v(" "),t.buttonTitle?a("span",[t._v(" "+t._s(t.buttonTitle))]):t._e()],1):a("v-btn",{staticClass:"pa-2",attrs:{loading:t.loading,disabled:t.disabled,color:t.color,"x-small":"",text:""},on:{click:t.onClick}},[a("v-icon",[t._v(t._s(t.iconKey))]),t._v(" "),t.buttonTitle?a("span",[t._v(" "+t._s(t.buttonTitle))]):t._e()],1)],1)}),[],!1,null,null,null);e.a=i.exports},"7Ipj":function(t,e,a){"use strict";var n=a("Q12t"),s=a("3saC"),i=a("Isj4"),o={name:"import-dialog",props:["receiveDataRows"],data:function(){return{file:null,dialogImportExcel:!1,dialogImportJSON:!1,dataImport:""}},methods:{importFile:function(){var t=new FileReader;t.readAsBinaryString(this.file),t.onload=this.handleFileLoad},handleFileLoad:function(t){var e=t.target.result,a=i.read(e,{type:"binary"}),n=Array.isArray(a.SheetNames)&&a.SheetNames.length>0&&a.SheetNames[0];if(!n)return this.$toasted.show("Invalid Excel File. Please reupload.",{type:"error"});var s=i.utils.sheet_to_row_object_array(a.Sheets[n]);this.receiveDataRows(s),this.dialogImportExcel=!1},importJson:function(){try{var t=JSON.parse(this.dataImport);this.receiveDataRows(t),this.dialogImportJSON=!1}catch(t){return this.$toasted.show("Invalid JSON",{type:"error"})}}}},l=a("psIG"),r=Object(l.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text mr-2",attrs:{"x-small":"",color:"primary"}},"v-btn",s,!1),n),[t._v("Import"),a("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[t._v("mdi-import")])],1)]}}])},[t._v(" "),a("v-list",[a("v-list-item",{attrs:{link:""}},[a("v-list-item-title",{on:{click:function(e){t.dialogImportJSON=!0,t.dataImport=""}}},[t._v("Json")])],1),t._v(" "),a("v-list-item",{attrs:{link:""}},[a("v-list-item-title",{on:{click:function(e){t.dialogImportExcel=!0,t.file=null}}},[t._v("Excel")])],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{width:"500px"},model:{value:t.dialogImportExcel,callback:function(e){t.dialogImportExcel=e},expression:"dialogImportExcel"}},[a("v-card",[a("v-card-title",[t._v("Choose excel file")]),t._v(" "),a("v-card-text",[a("v-file-input",{attrs:{outlined:"",dense:"",label:"File input",accept:".xls,.xlsx"},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}})],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"darken-1",text:""},on:{click:function(e){t.dialogImportExcel=!1}}},[t._v("Close")]),t._v(" "),a("v-btn",{attrs:{color:"primary darken-1",text:"",disabled:!t.file},on:{click:t.importFile}},[t._v("Import")])],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{width:"500px"},model:{value:t.dialogImportJSON,callback:function(e){t.dialogImportJSON=e},expression:"dialogImportJSON"}},[a("v-card",[a("v-card-title",[t._v("Import via JSON")]),t._v(" "),a("v-card-text",[a("v-container",[a("v-textarea",{attrs:{outlined:"",name:"input-7-4",label:"import data"},model:{value:t.dataImport,callback:function(e){t.dataImport=e},expression:"dataImport"}})],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-btn",{attrs:{color:"primary darken-1",text:"",disabled:!t.dataImport},on:{click:t.importJson}},[t._v("Import")])],1)],1)],1)}),[],!1,null,null,null).exports,c={name:"grid-toolbar",props:["toolbarTitle","onCopy","items","fileName","formatDataService","receiveDataRows","onDelete","isDeleteEnabled","onSearch","hideExportData"],components:{ExportData:n.a,CopyClipboard:s.a,ImportDialog:r}},p=Object(l.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",{staticClass:"mr-6"},[t._v(t._s(t.toolbarTitle))]),t._v(" "),t.onCopy?a("copy-clipboard",{staticClass:"mr-2",attrs:{"on-copy":t.onCopy}}):t._e(),t._v(" "),t.items&&t.items.length>0&&!t.hideExportData?a("export-data",{attrs:{data:t.items,"file-name":t.fileName,"format-data-service":t.formatDataService}}):t._e(),t._v(" "),t.receiveDataRows?a("import-dialog",{attrs:{receiveDataRows:t.receiveDataRows}}):t._e(),t._v(" "),t.onDelete?a("v-btn",{staticClass:"white--text",attrs:{disabled:!t.isDeleteEnabled,"x-small":"",color:"error"},on:{click:t.onDelete}},[t._v("\n    Delete\n    "),a("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[t._v(" mdi-delete ")])],1):t._e(),t._v(" "),t._t("customAction"),t._v(" "),t._t("search")],2)}),[],!1,null,null,null);e.a=p.exports},"7Vew":function(t,e,a){"use strict";var n={name:"text-field-display",props:["label","value"]},s=a("psIG"),i=Object(s.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.label?a("div",{staticClass:"grey--text caption mb-2"},[a("span",[t._v(t._s(t.label))])]):t._e(),t._v(" "),t.value?a("div",{staticClass:"font-weight-medium text-ellipses"},[a("span",{staticClass:"field-display-value",attrs:{title:t.value}},[t._v(t._s(t.value))])]):t._e()])}),[],!1,null,null,null);e.a=i.exports},MKDl:function(t,e,a){"use strict";var n={active:{name:"active",displayName:"Running",color:"success"},reloading:{name:"reloading",displayName:"Reloading",color:"yellow"},failed:{name:"failed",displayName:"Failed",color:"red"},activating:{name:"activating",displayName:"Activating",color:"yellow"},deactivating:{name:"deactivating",displayName:"Deactivating",color:"yellow"},maintenance:{name:"maintenance",displayName:"Maintenance",color:"yellow"}},s={name:"app-status-chip",props:["status","state","chipSize"],computed:{currentStatus:function(){var t=n[this.state];return t||{name:"default",displayName:this.capitalize(this.state),color:"yellow"}},defaultStatus:function(){return this.capitalize(this.state)}},methods:{capitalize:function(t){return t||(t=""),(t=String(t)).charAt(0).toUpperCase()+t.slice(1)}}},i=a("psIG"),o=Object(i.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.state?a("div",[a("span",{staticClass:"font-weight-medium"},[t.chipSize&&"small"===t.chipSize?a("v-chip",{attrs:{small:"",outlined:"",color:t.currentStatus.color}},[t._v(t._s(t.currentStatus.displayName))]):a("v-chip",{attrs:{outlined:"",color:t.currentStatus.color}},[t._v(t._s(t.currentStatus.displayName))])],1)]):a("div",[a("span",{staticClass:"font-weight-medium"},[t.chipSize&&"small"===t.chipSize?a("v-chip",{attrs:{small:"",outlined:"",color:"yellow"}},[t._v(t._s(t.defaultStatus))]):a("v-chip",{attrs:{outlined:"",color:"yellow"}},[t._v(t._s(t.defaultStatus))])],1)])])}),[],!1,null,null,null);e.a=o.exports},N4QW:function(t,e,a){"use strict";a.d(e,"c",(function(){return i})),a.d(e,"f",(function(){return o})),a.d(e,"e",(function(){return l})),a.d(e,"b",(function(){return r})),a.d(e,"d",(function(){return c})),a.d(e,"g",(function(){return p})),a.d(e,"a",(function(){return u}));var n=a("uzYq"),s="/rubix-service",i=function(){return n.a.get(s+"/status")},o=function(){return n.a.put(s+"/upgrade",{version:"latest"})},l=function(t){return n.a.put(s+"/upgrade",{version:t})},r=function(){return n.a.get(s+"/releases")},c=function(t){return n.a.post(s+"/token",{token:t})},p=function(t,e){var a=new FormData;return a.append("upgradeFile",e),a.append("version",t),n.a.post(s+"/upload-upgrade",a,{headers:{"Content-Type":"multipart/form-data"}})},u=function(){return n.a.get(s+"/app-url")}},OKta:function(t,e,a){"use strict";var n={name:"rbx-button",props:["title","after-icon","color","click","is-small","class-name","disabled","block","loading"]},s=a("psIG"),i=Object(s.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-btn",{class:t.className,attrs:{loading:t.loading,"x-small":t.isSmall,disabled:t.disabled,color:t.color,block:t.block},on:{click:t.click}},[a("span",[t._v(t._s(t.title)+" ")]),t._v(" "),t.afterIcon?a("v-icon",{attrs:{small:t.isSmall}},[t._v(t._s(t.afterIcon))]):t._e()],1)}),[],!1,null,null,null);e.a=i.exports},Q12t:function(t,e,a){"use strict";var n=a("/9Wh"),s=a.n(n),i=a("+n12"),o={name:"export-data",props:["data","fileName","formatDataService"],methods:{clickDownload:function(t,e){var a=t;switch("function"==typeof this.formatDataService&&(a=this.formatDataService(t)),e){case"csv":return Object(i.e)(this.fileName,a);case"excel":return Object(i.g)(this.fileName,a);case"json":return Object(i.h)(this.fileName,s()(a))}}}},l=a("psIG"),r=Object(l.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text mr-2",attrs:{"x-small":"",color:"#009688",dark:""}},"v-btn",s,!1),n),[a("span",[t._v("Download")]),t._v(" "),a("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[t._v("mdi-download")])],1)]}}])},[t._v(" "),a("v-list",[a("v-list-item",{attrs:{link:""}},[a("v-list-item-title",{on:{click:function(e){return t.clickDownload(t.data,"json")}}},[t._v("Json")])],1),t._v(" "),a("v-list-item",{attrs:{link:""}},[a("v-list-item-title",{on:{click:function(e){return t.clickDownload(t.data,"excel")}}},[t._v("Excel")])],1),t._v(" "),a("v-list-item",{attrs:{link:""}},[a("v-list-item-title",{on:{click:function(e){return t.clickDownload(t.data,"csv")}}},[t._v("CSV")])],1)],1)],1)}),[],!1,null,null,null);e.a=r.exports},Ui9F:function(t,e,a){"use strict";var n={name:"tooltip-icon-button",props:["btnIcon","btnTooltip","onClick","btnColor","buttonSize"]},s=a("psIG"),i=Object(s.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return["medium"==t.buttonSize?a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",medium:"",color:t.btnColor},on:{click:t.onClick}},"v-btn",s,!1),n),[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" "+t._s(t.btnIcon)+" ")])],1):a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:t.btnColor},on:{click:t.onClick}},"v-btn",s,!1),n),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" "+t._s(t.btnIcon)+" ")])],1)]}}])},[t._v(" "),a("span",[t._v(t._s(t.btnTooltip))])])}),[],!1,null,null,null);e.a=i.exports},"Wgf/":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return o}));var n=a("uzYq"),s="/system-service",i=function(){return n.a.get(s)},o=function(t,e){return n.a.post(s+"/control",[{action:t,service:e}])}},lkCm:function(t,e,a){"use strict";var n={name:"confirm-dialog",props:["on-close","on-confirm","dialog-text","is-open","loading"]},s=a("psIG"),i=Object(s.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:t.isOpen,callback:function(e){t.isOpen=e},expression:"isOpen"}},[a("v-card",[a("v-card-title",[a("v-icon",{attrs:{color:"warning"}},[t._v(" mdi-alert-outline ")]),t._v(" Confirm ")],1),t._v(" "),a("v-card-text",[a("v-container",[a("v-row",[t._v(t._s(t.dialogText))])],1)],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{text:""},on:{click:t.onClose}},[t._v(" No ")]),t._v(" "),a("v-btn",{attrs:{color:"red darken-1",loading:t.loading,text:""},on:{click:t.onConfirm}},[t._v(" Yes ")])],1)],1)],1)}),[],!1,null,null,null);e.a=i.exports},nz6T:function(t,e,a){"use strict";a.r(e),a.d(e,"fetchApps",(function(){return b})),a.d(e,"fetchAllApps",(function(){return D})),a.d(e,"fetchAllInstalledApps",(function(){return S})),a.d(e,"fetchSystemDefaultApps",(function(){return A})),a.d(e,"fetchAppReleases",(function(){return C})),a.d(e,"fetchAppsReleases",(function(){return x})),a.d(e,"fetchAppStatus",(function(){return k})),a.d(e,"uninstallApp",(function(){return y})),a.d(e,"installApp",(function(){return I})),a.d(e,"downloadApp",(function(){return N})),a.d(e,"changeServiceStatus",(function(){return V})),a.d(e,"uploadApp",(function(){return O})),a.d(e,"deleteAppData",(function(){return F})),a.d(e,"deleteAppDataService",(function(){return L})),a.d(e,"downloadAppData",(function(){return E})),a.d(e,"fetchJSONConfig",(function(){return R})),a.d(e,"fetchEnvConfig",(function(){return T})),a.d(e,"fetchAppConfig",(function(){return P})),a.d(e,"saveJSONConfig",(function(){return M})),a.d(e,"saveENVConfig",(function(){return $})),a.d(e,"saveAppConfig",(function(){return B})),a.d(e,"deleteJSONConfig",(function(){return z})),a.d(e,"deleteENVConfig",(function(){return U})),a.d(e,"deleteAppConfig",(function(){return j})),a.d(e,"downloadAppConfig",(function(){return W})),a.d(e,"bulkAppControl",(function(){return G})),a.d(e,"bulkInstallApps",(function(){return H})),a.d(e,"bulkDownloadApps",(function(){return J})),a.d(e,"fetchDownloadState",(function(){return q})),a.d(e,"deleteDownloadState",(function(){return Y}));var n,s=a("/9Wh"),i=a.n(s),o=a("06Hw"),l=a.n(o),r=a("YYXh"),c=a.n(r),p=a("OBCi"),u=a.n(p),d=a("uzYq"),v=a("NWgQ"),f=a.n(v),h=a("N4QW"),m=a("A5Vd"),g=a("Wgf/"),_=a("+n12"),w="/rubix-app",b=function(){var t=f.a.stringify({browser_download_url:!0,latest_version:!0});return d.a.get(w+"?"+t)},D=function(){return g.b()},S=function(){return d.a.get(""+w).then((function(t){return t.filter((function(t){return t&&t.is_installed}))}))},A=function(){return g.b().then((function(t){return t.filter((function(t){return t&&t.is_installed}))}))},C=function(t){return d.a.get(w+"/releases/"+t)},x=function(t){return u.a.all(t.map((function(t){return C(t).catch((function(t){return[]}))})))},k=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d.a.get(w+"/stats/"+t,e)},y=function(t){return d.a.post(w+"/uninstall",{service:t})},I=function(t){return d.a.post(w+"/install",[t])},N=function(t){return d.a.post(w+"/download",[t])},V=function(t,e){return d.a.post(w+"/control",[{action:t,service:e}])},O=function(t,e,a){var n=new FormData;return n.append("file",t),n.append("service",e),n.append("version",a),d.a.post(w+"/app-upload",n,{headers:{"Content-Type":"multipart/form-data"}})},F=function(t){return d.a.post(w+"/delete-app-data",[{service:t}])},L=function(t){return F(t)},E=(n=c()(l.a.mark((function t(e){var a,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a();case 2:return a=t.sent,n=a.data+"api/app/download_data?service="+e,t.abrupt("return",d.a.get(n,{headers:{"Content-Type":"application/zip"},responseType:"arraybuffer"}));case 5:case"end":return t.stop()}}),t,void 0)}))),function(t){return n.apply(this,arguments)}),R=function(t,e){return d.a.get(w+"/json-config/"+t,e)},T=function(t,e){return d.a.get(w+"/env/"+t,e)},P=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===m.h.PYTHON_APP)return R(t,a).then((function(t){return t.data}));if(e===m.h.FRONTEND_APP)return T(t,a).then((function(t){return t.data}));throw new Error("App type not supported for editing config")},M=function(t,e){return d.a.put(w+"/json-config",{service:t,data:e})},$=function(t,e){return d.a.put(w+"/env",{service:t,data:e})},B=function(t,e,a){if(e===m.h.PYTHON_APP)return M(t,a||{});if(e===m.h.FRONTEND_APP)return $(t,a||"");throw new Error("App type not supported for editing config")},z=function(t){return d.a.delete(w+"/json-config",{data:{service:t}})},U=function(t){return d.a.delete(w+"/env",{data:{service:t}})},j=function(t,e){if(e===m.h.PYTHON_APP)return z(t);if(e===m.h.FRONTEND_APP)return U(t);throw new Error("App type not supported for deletion")},W=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===m.h.PYTHON_APP)return R(t,a).then((function(e){var a=e.data;Object(_.h)(t+"-config",i()(a))}));if(e===m.h.FRONTEND_APP)return T(t,a).then((function(e){var a=e.data;Object(_.f)(""+t,a)}));throw new Error("App type not supported for download config")},G=function(t){return d.a.post(w+"/control",t)},H=function(t){return d.a.post(w+"/install",t)},J=function(t){return d.a.post(w+"/download",t)},q=function(){return d.a.get(w+"/download-state",{restrictToast:!0})},Y=function(){return d.a.delete(w+"/download-state")}},pzyp:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return o}));var n=a("uzYq"),s="/mqtt-rest-bridge/listener",i=function(){return n.a.get(s)},o=function(t){return n.a.patch(s,t)}}}]);
//# sourceMappingURL=7.3064ee535ee249b35057.js.map