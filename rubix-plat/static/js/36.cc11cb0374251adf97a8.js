(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{VNy9:function(e,t,r){"use strict";var s={name:"breadcrumbs",props:["items"]},a=r("psIG"),o=Object(a.a)(s,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-breadcrumbs",{staticClass:"breadcrumbs",attrs:{items:e.items},scopedSlots:e._u([{key:"item",fn:function(t){var s=t.item;return[r("v-breadcrumbs-item",{staticClass:"breadcrumbs-item-text",attrs:{to:s.link,exact:""}},[e._v(" "+e._s(s.text)+" ")])]}}])})}),[],!1,null,"04244946",null);t.a=o.exports},e1ED:function(e,t,r){"use strict";var s=r("snOE"),a=r.n(s),o={name:"flow-mapping-form",props:["currentItems","items","onSave","onCancel","title"],data:function(){return{selectedItems:[],isSaving:!1,valid:!1}},computed:{lowerCaseTitle:function(){return(this.title||"").toLowerCase()}},mounted:function(){this.currentItems&&this.currentItems.length>0&&(this.selectedItems=[].concat(a()(this.currentItems)))},destroyed:function(){this.cleanUp()},methods:{cleanUp:function(){this.selectedItems=[],"function"==typeof this.onCancel&&this.onCancel()},onSubmit:function(){var e=this;if("function"!=typeof this.onSave)throw new Error(this.lowerCaseTitle+" form onSave function not passed");return this.isSaving=!0,this.onSave(this.selectedItems,this.currentItems).then((function(){e.$toasted.show("Successfully mapped."),e.cleanUp(!0)})).catch((function(){e.$toasted.show("Mapping unsuccessful.",{type:"error"})})).finally((function(){e.isSaving=!1}))}}},n=r("psIG"),i=Object(n.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",[r("v-card-title",[r("span",{staticClass:"headline"},[e._v(e._s(e.title))])]),e._v(" "),r("v-card-text",[r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-row",[r("v-col",{attrs:{cols:"12"}},[r("v-autocomplete",{attrs:{chips:"",multiple:"",clearable:"","small-chips":"","return-object":"","item-value":"uuid","item-text":"name",items:e.items,"deletable-chips":""},model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}})],1)],1)],1)],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-card-actions",{staticClass:"align-end justify-end"},[r("v-btn",{attrs:{color:"darken-1",text:""},on:{click:e.onCancel}},[e._v(" Cancel ")]),e._v(" "),r("v-btn",{attrs:{color:"blue darken-1",loading:e.isSaving,text:""},on:{click:function(t){return e.onSubmit()}}},[e._v(" Save ")])],1)],1)}),[],!1,null,null,null);t.a=i.exports},ilzx:function(e,t,r){"use strict";var s=r("Kz1y"),a=r.n(s),o=r("OBCi"),n=r.n(o),i=r("e1ED"),l=r("rIlz"),c={name:"associate-object-stream-form",props:["streamId","apiListKey","onCancel","service","title","items"],components:{FlowMappingForm:i.a},data:function(){return{currentItems:null}},mounted:function(){this.fetchStreamById()},methods:{onSave:function(e){var t=this;return n.a.all(e.map((function(e){return t.service.patch(e.uuid,a()({},e,{stream_uuid:t.streamId}))})))},fetchStreamById:function(){var e=this;return l.a.fetchById(this.streamId).then((function(t){return e.currentItems=t[e.apiListKey]||[],t}))}}},u=r("psIG"),f=Object(u.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.currentItems?r("flow-mapping-form",{attrs:{items:e.items,currentItems:e.currentItems,onSave:e.onSave,title:e.title,onCancel:e.onCancel}}):e._e()}),[],!1,null,null,null);t.a=f.exports},oujF:function(e,t,r){"use strict";var s={name:"text-button",props:["onClick","text"]},a=r("psIG"),o=Object(a.a)(s,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-btn",{staticClass:"ma-1",attrs:{link:"",color:"nubeGreen",plain:""},on:{click:e.onClick}},[r("span",{staticClass:"btn-text"},[e._v(e._s(e.text))])])}),[],!1,null,null,null);t.a=o.exports},zEfX:function(e,t,r){"use strict";var s={name:"form-error",props:["errors","error"],computed:{isArray:function(){return Array.isArray(this.errors)&&this.errors.length>0||!1},isObject:function(){return this.error&&this.error.hasOwnProperty("message")}}},a=r("psIG"),o=Object(a.a)(s,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"text-left ma-5"},[e.isArray?r("div",e._l(e.errors,(function(t){return r("v-alert",{key:t.index,attrs:{dense:"",outlined:"",type:"error"}},[r("span",[e._v(e._s(t.message))])])})),1):e._e(),e._v(" "),e.isObject&&e.error.message?r("div",[r("v-alert",{attrs:{dense:"",outlined:"",type:"error"}},[r("span",[e._v(e._s(e.error.message))])])],1):e._e()])}),[],!1,null,null,null);t.a=o.exports},za5t:function(e,t,r){"use strict";r.r(t);var s=r("Kz1y"),a=r.n(s),o=r("TcPG"),n=r.n(o),i=r("oGAK"),l=r("zEfX"),c=r("Ui9F"),u={name:"flow-network-form",components:{TooltipIconButton:c.a,FormError:l.a},props:["isEdit","onCancel","onSave","item","isSaving","isMasterEnabled"],data:function(){return{rules:{required:function(e){return!!e||"Required."},numberRule:function(e){return!isNaN(parseFloat(e))||"Required."}},error:{},valid:!1,formValues:a()({},{name:null,fetch_histories:!1,fetch_hist_frequency:0,delete_histories_on_fetch:!1,flow_ip:"0.0.0.0",flow_port:1616,flow_https:!1,flow_username:null,flow_password:null,flow_token:null,is_mqtt:!1,is_master_slave:!1})}},computed:{title:function(){return this.isEdit?"Edit Flow Network":"Create Flow Network"},saveTitle:function(){return this.isEdit?"Save":"Create"}},mounted:function(){this.isEdit&&this.item&&(this.formValues=a()({},this.formValues,this.item))},methods:{cleanUp:function(){this.formValues={},"function"==typeof this.onCancel&&this.onCancel()},preparePayload:function(e){return e.is_master_slave&&this.isMasterEnabled&&(delete e.flow_ip,delete e.flow_port,delete e.flow_https,delete e.flow_token,delete e.flow_username,delete e.flow_password),e.flow_port=Number(e.flow_port),e},onSubmit:function(){var e=this;if(this.error={},this.$refs.form.validate()){if("function"!=typeof this.onSave)throw new Error("Flow network form onSave function not passed");return this.onSave(this.preparePayload(this.formValues)).then((function(){e.$toasted.show("Successfully "+(e.isEdit?"updated":"created")+" flow network."),e.cleanUp(!0)})).catch((function(t){e.error=t,e.$toasted.show("Failed to "+(e.isEdit?"update":"create")+" flow network.",{type:"error"})}))}}}},f=r("psIG"),m=Object(f.a)(u,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",[r("v-card-title",[r("span",{staticClass:"headline"},[e._v(e._s(e.title))])]),e._v(" "),r("v-card-text",[r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-row",{attrs:{dense:""}},[r("v-col",{attrs:{cols:"12"}},[r("v-text-field",{attrs:{required:"",label:"Flow network name",rules:[e.rules.required]},model:{value:e.formValues.name,callback:function(t){e.$set(e.formValues,"name",t)},expression:"formValues.name"}})],1),e._v(" "),e.isMasterEnabled?r("v-col",{attrs:{cols:"12"}},[r("v-switch",{attrs:{label:"Master's Slave"},model:{value:e.formValues.is_master_slave,callback:function(t){e.$set(e.formValues,"is_master_slave",t)},expression:"formValues.is_master_slave"}})],1):e._e(),e._v(" "),e.formValues.is_master_slave?e._e():r("v-col",{attrs:{cols:"12"}},[r("v-text-field",{attrs:{rules:[e.rules.required],label:"Flow IP"},model:{value:e.formValues.flow_ip,callback:function(t){e.$set(e.formValues,"flow_ip",t)},expression:"formValues.flow_ip"}})],1),e._v(" "),e.formValues.is_master_slave?e._e():r("v-col",{attrs:{cols:"12"}},[r("v-text-field",{attrs:{rules:[e.rules.required,e.rules.numberRule],type:"number",label:"Flow Port"},model:{value:e.formValues.flow_port,callback:function(t){e.$set(e.formValues,"flow_port",t)},expression:"formValues.flow_port"}})],1),e._v(" "),e.formValues.is_master_slave?e._e():r("v-col",{attrs:{cols:"12"}},[r("v-switch",{attrs:{label:"Enable HTTPS"},model:{value:e.formValues.flow_https,callback:function(t){e.$set(e.formValues,"flow_https",t)},expression:"formValues.flow_https"}})],1),e._v(" "),e.formValues.is_master_slave?e._e():r("v-col",{attrs:{cols:"12"}},[r("v-text-field",{attrs:{required:"",rules:[e.rules.required],label:"Flow Username"},model:{value:e.formValues.flow_username,callback:function(t){e.$set(e.formValues,"flow_username",t)},expression:"formValues.flow_username"}})],1),e._v(" "),e.formValues.is_master_slave?e._e():r("v-col",{attrs:{cols:"12"}},[r("v-text-field",{attrs:{type:"password",rules:[e.rules.required],label:"Flow Password",autocomplete:"new-password"},model:{value:e.formValues.flow_password,callback:function(t){e.$set(e.formValues,"flow_password",t)},expression:"formValues.flow_password"}})],1),e._v(" "),r("v-col",{attrs:{cols:"12"}},[r("v-switch",{attrs:{label:"Enable Histories"},model:{value:e.formValues.fetch_histories,callback:function(t){e.$set(e.formValues,"fetch_histories",t)},expression:"formValues.fetch_histories"}})],1),e._v(" "),e.formValues.fetch_histories?r("v-col",{attrs:{cols:"12"}},[r("v-text-field",{attrs:{type:"number",label:"Fetch History Frequency"},model:{value:e.formValues.fetch_hist_frequency,callback:function(t){e.$set(e.formValues,"fetch_hist_frequency",t)},expression:"formValues.fetch_hist_frequency"}})],1):e._e(),e._v(" "),e.formValues.fetch_histories?r("v-col",{attrs:{cols:"12"}},[r("v-switch",{attrs:{label:"Delete Histories after fetch"},model:{value:e.formValues.delete_histories_on_fetch,callback:function(t){e.$set(e.formValues,"delete_histories_on_fetch",t)},expression:"formValues.delete_histories_on_fetch"}})],1):e._e()],1)],1)],1),e._v(" "),r("form-error",{attrs:{error:e.error}}),e._v(" "),r("v-spacer"),e._v(" "),r("v-card-actions",{staticClass:"align-end justify-end"},[r("v-btn",{attrs:{color:"darken-1",text:""},on:{click:e.cleanUp}},[e._v(" Cancel ")]),e._v(" "),r("v-btn",{attrs:{color:"blue darken-1",loading:e.isSaving,text:""},on:{click:function(t){return e.onSubmit(e.formValues)}}},[e._v(" "+e._s(e.saveTitle)+" ")])],1)],1)}),[],!1,null,null,null).exports,d=r("2SyR"),v=r("oujF"),h=r("CfmX"),p=r("97BG"),_=r("nyg2"),w=r("e1ED"),b=r("ilzx"),g=r("rIlz"),k=r("fBuC"),S={name:"associate-streams-form",props:["flowNetworkId","onCancel","refreshGridCb"],components:{AssociateObjectStreams:b.a,FlowMappingForm:w.a},data:function(){return{isLoadingData:!1,streams:[],currentItems:null}},mounted:function(){this.fetchFlowNetworkById(),this.fetchAllStreams()},methods:{fetchAllStreams:function(){var e=this;return g.a.fetch().then((function(t){e.streams=t}))},onSave:function(e){var t=this;return k.a.patch(this.flowNetworkId,{streams:e}).then((function(e){return"function"==typeof t.refreshGridCb&&t.refreshGridCb(),e}))},fetchFlowNetworkById:function(){var e=this;return this.isLoadingData=!0,k.a.fetchById(this.flowNetworkId,{with_streams:!0}).then((function(t){return e.currentItems=t.streams||[],t})).finally((function(){e.isLoadingData=!1}))}}},I=Object(f.a)(S,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.currentItems?r("flow-mapping-form",{attrs:{items:e.streams,currentItems:e.currentItems,onSave:e.onSave,title:"Associate Streams",onCancel:e.onCancel}}):e._e(),e._v(" "),r("v-overlay",{attrs:{value:e.isLoadingData}},[r("v-progress-circular",{attrs:{indeterminate:"",size:"32",color:"primary"}})],1)],1)}),[],!1,null,null,null).exports,x=r("BuMD"),y=r("pzyp"),C={associateStreams:"associateStreams",viewStreams:"viewStreams"},E=n()({},C.viewStreams,(function(e){return i.a.rfFlowNetworkStreams.replace(":flowNetworkId",e)})),V={components:{TextButton:v.a,GenericGrid:h.a,FlowNetworkForm:m,IconButton:d.a,AssociateStreams:I,ConfigureEndpointView:x.a},name:"flowNetworkGrid",data:function(){var e;return e={params:{},isMasterEnabled:!1,mqttRestBridgeConfig:{},configureEndpointDialog:!1,tab:2,gridName:p.h,service:k.a,refreshGridCb:function(e){return e},toolbarTitle:"Flow Networks",storeMutationKey:"changeRfFlowNetworks",selectedItem:{},dialogNames:a()({},C),dialog:n()({},C.associateStreams,!1)},n()(e,"selectedItem",{}),n()(e,"isFlowIntegrated",!1),n()(e,"gridHeaders",[{text:"Name",align:"center",value:"name",sortable:!0},{text:"Grid Actions",align:"center",value:"gridItemActions",sortable:!1},{text:"Actions",align:"center",value:"actions",sortable:!0}]),e},mounted:function(){this.fetchRFloginStatus(),this.fetchMqttRestBridgeConfig()},methods:{fetchMqttRestBridgeConfig:function(){var e=this;y.a().then((function(t){e.mqttRestBridgeConfig=t,e.isMasterEnabled=e.mqttRestBridgeConfig.enabled}))},fetchRFloginStatus:function(){var e=this;_.a().then((function(t){e.isFlowIntegrated=!!t.flow_token}))},openConfigureEndpoint:function(){this.configureEndpointDialog=!0},closeConfigureEndpoint:function(){this.configureEndpointDialog=!1},redirectTo:function(e,t){var r=t.uuid;if(r){var s=E[e];"function"==typeof s&&this.$router.push({path:s(r)})}},toggleDialog:function(e,t,r){this.selectedItem=t,this.dialog[e]=!this.dialog[e],this.refreshGridCb=r,this.dialog[e]?this.selectedItem=t:this.selectedItem=null},closeDialog:function(e){this.dialog[e]=!1,this.selectedItem={}}}},F={name:"flow-network",components:{FlowNetworkGrid:Object(f.a)(V,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("generic-grid",{attrs:{gridName:e.gridName,isHeaderConfigurable:!0,service:e.service,params:e.params,headers:e.gridHeaders,toolbarTitle:e.toolbarTitle,storeMutationKey:e.storeMutationKey},scopedSlots:e._u([{key:"routeLinkName",fn:function(t){var s=t.item;return[r("text-button",{attrs:{text:s.name,onClick:function(){return e.redirectTo(e.dialogNames.viewStreams,s)}}})]}},{key:"createForm",fn:function(t){var s=t.onSave,a=t.onClose,o=t.isOpen,n=t.isSaving;return[o?r("flow-network-form",{attrs:{isEdit:!1,isMasterEnabled:e.isMasterEnabled,onSave:s,onCancel:a,isSaving:n}}):e._e()]}},{key:"editForm",fn:function(t){var s=t.onSave,a=t.item,o=t.onClose,n=t.isOpen,i=t.isSaving;return[n?r("flow-network-form",{attrs:{item:a,isMasterEnabled:e.isMasterEnabled,isEdit:!0,onSave:s,onCancel:o,isSaving:i}}):e._e()]}},{key:"gridItemActions",fn:function(t){var s=t.item,a=t.refreshGrid;return[r("icon-button",{attrs:{title:"Add Streams",icon:"mdi-plus",color:"nubeYellow",onClick:function(){return e.toggleDialog(e.dialogNames.associateStreams,s,a)}}})]}}])}),e._v(" "),r("v-dialog",{attrs:{fullscreen:""},model:{value:e.configureEndpointDialog,callback:function(t){e.configureEndpointDialog=t},expression:"configureEndpointDialog"}},[e.configureEndpointDialog?r("configure-endpoint-view",{attrs:{"initial-tab":e.tab,onCancel:e.closeConfigureEndpoint}}):e._e()],1),e._v(" "),e.selectedItem&&e.selectedItem.uuid?r("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:e.dialog[e.dialogNames.associateStreams],callback:function(t){e.$set(e.dialog,e.dialogNames.associateStreams,t)},expression:"dialog[dialogNames.associateStreams]"}},[e.dialog[e.dialogNames.associateStreams]?r("associate-streams",{attrs:{refreshGridCb:e.refreshGridCb,flowNetworkId:e.selectedItem&&e.selectedItem.uuid,onCancel:function(){return e.closeDialog(e.dialogNames.associateStreams)}}}):e._e()],1):e._e()],1)}),[],!1,null,null,null).exports,FlowNetworkForm:m,Breadcrumbs:r("VNy9").a},data:function(){return{breadcrumbItems:[]}},mounted:function(){this.setBreadCrumbs()},methods:{setBreadCrumbs:function(){this.breadcrumbItems.push({text:"Flow Network",align:"center",disabled:!1,link:i.a.rfFlowNetwork})}}},N=Object(f.a)(F,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",[r("v-card-title",[e._v(" Rubix Flow Network ")]),e._v(" "),r("v-card-text",[r("breadcrumbs",{attrs:{items:e.breadcrumbItems}}),e._v(" "),r("v-row",{attrs:{"no-gutter":""}},[r("v-col",{attrs:{cols:"12",lg:"12",xl:"12",md:"12",sm:"12",xs:"12"}},[r("flow-network-grid")],1)],1)],1)],1)}),[],!1,null,null,null);t.default=N.exports}}]);
//# sourceMappingURL=36.cc11cb0374251adf97a8.js.map