(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"+SqX":function(e,t,i){"use strict";var n={name:"page-title",props:["title"]},a=i("psIG"),s=Object(a.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("h1",{staticClass:"text-h5 text-left py-3"},[i("span",[e._v(e._s(e.title))]),e._t("titleActions"),e._v(" "),e._t("spinner")],2)}),[],!1,null,null,null);t.a=s.exports},0:function(e,t){},"0iKi":function(e,t,i){"use strict";i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return l})),i.d(t,"e",(function(){return c})),i.d(t,"d",(function(){return d})),i.d(t,"f",(function(){return u})),i.d(t,"b",(function(){return v}));var n=i("OBCi"),a=i.n(n),s=i("uzYq"),r="/slave-devices",o=function(e){var t={global_uuid:e.global_uuid};return s.a.post(r,t)},l=function(e){return a.a.all(e.map((function(e){return o(e)})))},c=function(){return s.a.get(r)},d=function(){return s.a.get(r+"/discover")},u=function(e){var t=e.global_uuid;return s.a.delete(r+"/"+t)},v=function(e){return a.a.all(e.map((function(e){return u(e)})))}},1:function(e,t){},2:function(e,t){},"3saC":function(e,t,i){"use strict";var n={props:["on-copy"],methods:{copyToClipboard:function(e){var t=this;this.$copyText(e,this.$refs.copyClipboard).then((function(){t.$toasted.show("Copied to clipboard!",{type:"success"})}),(function(){t.$toasted.show("Cannot copy to clipboard.",{type:"error"})}))}}},a=i("psIG"),s=Object(a.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{ref:"copyClipboard"},[i("v-btn",{staticClass:"mr-1 btn-height-22 white-text",attrs:{"x-small":"",color:"#009688"},on:{click:function(){return e.onCopy(e.copyToClipboard)}}},[e._v("\n    Export"),i("v-icon",{attrs:{"x-small":"",right:""}},[e._v("mdi-export")])],1)],1)}),[],!1,null,null,null);t.a=s.exports},"7Ipj":function(e,t,i){"use strict";var n=i("Q12t"),a=i("3saC"),s=i("Isj4"),r={name:"import-dialog",props:["receiveDataRows"],data:function(){return{file:null,dialogImportExcel:!1,dialogImportJSON:!1,dataImport:""}},methods:{importFile:function(){var e=new FileReader;e.readAsBinaryString(this.file),e.onload=this.handleFileLoad},handleFileLoad:function(e){var t=e.target.result,i=s.read(t,{type:"binary"}),n=Array.isArray(i.SheetNames)&&i.SheetNames.length>0&&i.SheetNames[0];if(!n)return this.$toasted.show("Invalid Excel File. Please reupload.",{type:"error"});var a=s.utils.sheet_to_row_object_array(i.Sheets[n]);this.receiveDataRows(a),this.dialogImportExcel=!1},closeDialog:function(){this.dialogImportJSON=!1},importJson:function(){try{var e=JSON.parse(this.dataImport);this.receiveDataRows(e),this.dialogImportJSON=!1}catch(e){return this.$toasted.show("Invalid JSON",{type:"error"})}}}},o=i("psIG"),l=Object(o.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,a=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"mr-2 btn-height-22 white-text",attrs:{"x-small":"",color:"primary"}},"v-btn",a,!1),n),[e._v("Import"),i("v-icon",{attrs:{"x-small":"",right:""}},[e._v("mdi-import")])],1)]}}])},[e._v(" "),i("v-list",[i("v-list-item",{on:{click:function(t){e.dialogImportJSON=!0,e.dataImport=""}}},[i("v-list-item-title",[e._v("JSON")])],1),e._v(" "),i("v-list-item",{on:{click:function(t){e.dialogImportExcel=!0,e.file=null}}},[i("v-list-item-title",[e._v("Excel")])],1)],1)],1),e._v(" "),i("v-dialog",{attrs:{width:"500px"},model:{value:e.dialogImportExcel,callback:function(t){e.dialogImportExcel=t},expression:"dialogImportExcel"}},[i("v-card",[i("v-card-title",[e._v("Choose excel file")]),e._v(" "),i("v-card-text",[i("v-file-input",{attrs:{outlined:"",dense:"",label:"File input",accept:".xls,.xlsx"},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}})],1),e._v(" "),i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"darken-1",text:""},on:{click:function(t){e.dialogImportExcel=!1}}},[e._v("Close")]),e._v(" "),i("v-btn",{attrs:{color:"primary darken-1",text:"",disabled:!e.file},on:{click:e.importFile}},[e._v("Import")])],1)],1)],1),e._v(" "),i("v-dialog",{attrs:{width:"500px"},model:{value:e.dialogImportJSON,callback:function(t){e.dialogImportJSON=t},expression:"dialogImportJSON"}},[i("v-card",[i("v-card-title",[e._v("Import via JSON")]),e._v(" "),i("v-card-text",[i("v-textarea",{attrs:{outlined:"",name:"input-7-4",label:"import data"},model:{value:e.dataImport,callback:function(t){e.dataImport=t},expression:"dataImport"}})],1),e._v(" "),i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"darken-1",text:""},on:{click:e.closeDialog}},[e._v(" Cancel ")]),e._v(" "),i("v-btn",{attrs:{color:"blue darken-1",text:"",disabled:!e.dataImport},on:{click:e.importJson}},[e._v("Import")])],1)],1)],1)],1)}),[],!1,null,null,null).exports,c={name:"grid-toolbar",props:["toolbarTitle","onCopy","items","fileName","formatDataService","receiveDataRows","onDelete","isDeleteEnabled","onSearch","hideExportData"],components:{ExportData:n.a,CopyClipboard:a.a,ImportDialog:l}},d=Object(o.a)(c,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-toolbar",{attrs:{flat:""}},[i("v-toolbar-title",{staticClass:"mr-6"},[e._v(e._s(e.toolbarTitle))]),e._v(" "),e._t("gridCounter"),e._v(" "),e.onCopy?i("copy-clipboard",{attrs:{"on-copy":e.onCopy}}):e._e(),e._v(" "),e.items&&e.items.length>0&&!e.hideExportData?i("export-data",{attrs:{data:e.items,"file-name":e.fileName,"format-data-service":e.formatDataService}}):e._e(),e._v(" "),e.receiveDataRows?i("import-dialog",{attrs:{receiveDataRows:e.receiveDataRows}}):e._e(),e._v(" "),e.onDelete?i("v-btn",{staticClass:"mr-2 btn-height-22 white-text",attrs:{"x-small":"",color:"error",disabled:!e.isDeleteEnabled},on:{click:e.onDelete}},[e._v("Delete"),i("v-icon",{attrs:{"x-small":"",right:""}},[e._v(" mdi-delete")])],1):e._e(),e._v(" "),e._t("customAction"),e._v(" "),e._t("search")],2)}),[],!1,null,null,null);t.a=d.exports},HeMS:function(e,t,i){"use strict";i.d(t,"g",(function(){return m})),i.d(t,"f",(function(){return f})),i.d(t,"c",(function(){return p})),i.d(t,"b",(function(){return h})),i.d(t,"e",(function(){return b})),i.d(t,"a",(function(){return g})),i.d(t,"d",(function(){return y}));var n=i("/9Wh"),a=i.n(n),s=i("snOE"),r=i.n(s),o=i("tZmG"),l=i.n(o),c=i("yEOx"),d=i.n(c),u=i("VleD"),v=i("M1ki"),m=function(e){var t=function(e,t){return l()(e).reduce((function(i,n){var a=l()(e[n]).reduce((function(i,a){return t[n]&&t[n].includes(a)&&i.push(e[n][a]),i}),[]);return i[n]=a,i}),{})}(e.releaseMap,function(e){return l()(e).reduce((function(t,i){return t[i]=(e[i]||[]).map((function(e){return e&&e.slaveId})).filter((function(e){return e})),t}),{})}(e.selectedItems));return l()(t).reduce((function(e,i){var n=t[i].map((function(e){return e&&e.length||1/0})),a=n.indexOf(Math.min.apply(Math,r()(n)));return e[i]=t[i][a]||[],e}),{})},f=function(e,t){u.d(v.a.SLAVE_ID,e),u.d(v.a.SLAVE_DEVICE_INFO,a()(t))},p=function(){return u.b(v.a.SLAVE_ID)},h=function(){var e=u.b(v.a.SLAVE_DEVICE_INFO);try{return JSON.parse(e)}catch(e){return null}},b=function(){u.c(v.a.SLAVE_ID),u.c(v.a.SLAVE_DEVICE_INFO)};function _(e){return e.reduce((function(e,t){var i=t.toLowerCase().split("v")[1].split(".").map((function(e){return isNaN(+e)&&e.indexOf("rc")?+e.split("-")[0]-.5/+e.split("-rc")[1]:+e})),n=i.reduce((function(e,t,n){var a;return e+=(a=i.length-n,Math.pow(10,a-1)*t)}),0);return e[n]=t,e}),{})}function g(e){var t=_(e);return t[Math.max.apply(Math,r()(l()(t)))]}function y(e,t){var i,n=d()(t),a=d()(e),s=(i=_(n),Math.max.apply(Math,r()(l()(i)))),o=_(a);return function(e){var t=_(e);return l()(t).sort((function(e,t){return t-e})).map((function(e){return t[e]}))}(l()(o).reduce((function(e,t){return+t>=s&&e.push(o[t]),e}),[]))}},OvPX:function(e,t,i){"use strict";i.r(t);var n,a,s=i("Kz1y"),r=i.n(s),o=i("tZmG"),l=i.n(o),c=i("06Hw"),d=i.n(c),u=i("YYXh"),v=i.n(u),m=i("+SqX"),f=i("7Ipj"),p=i("A5Vd"),h=i("asQ9"),b=i("Ui9F"),_={name:"grid-items-counter",props:["num"]},g=i("psIG"),y=Object(g.a)(_,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"text-left mr-5 grid-item-counter"},[i("span",{staticClass:"grey--text caption"},[e._v("Selected Apps: ")]),e._v(" "),i("span",{staticClass:"white--text"},[e._v(e._s(e.num))])])}),[],!1,null,"76419ac0",null).exports,S=i("snOE"),x=i.n(S),I=i("TcPG"),C=i.n(I),D="DISCOVER_SLAVE_GRID",k="SLAVE_APPS_GRID",E=(n={},C()(n,D,[{name:"device_name",isEnabled:!0},{name:"site_name",isEnabled:!0},{name:"site_lat",isEnabled:!0},{name:"site_lon",isEnabled:!0}]),C()(n,k,[{name:"client_name",isEnabled:!0},{displayName:"Status",name:"is_online"},{displayName:"Device Name",name:"device_name"},{displayName:"Site Name",name:"site_name"},{displayName:"Latitude",name:"site_lat"},{displayName:"Longitude",name:"site_lon"}]),n),w=(a={},C()(a,D,[]),C()(a,k,[{name:"faliureRate",displayName:"Failure Rate (%)",isEnabled:!0}]),a),F={hasActions:!0,hasSerialNumber:!0,actionValue:"actions",snValue:"sn"},N=function(e){var t=e.text,i=void 0===t?"":t,n=e.align,a=void 0===n?"center":n,s=e.sortable,r=void 0===s||s,o=e.value,l=void 0===o?null:o;return{text:i,align:a,sortable:r,name:l,value:l}},O=function(e){return e.split("_").map((function(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.toLowerCase();return e.charAt(0).toUpperCase()+t.slice(1)}(e)})).join(" ")},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F;return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=[];return t.forEach((function(e){i.push(N({text:O(e.displayName),value:e.name}))})),e.hasActions&&i.push(N({text:"Actions",value:e.actionValue})),i}},M=function(e,t){var i,n=E[e],a=n;t&&0==(a=t.headers.filter((function(e){return e.isEnabled}))).length&&(a=n);var s=w[e]||[];return(i=a.map((function(e){return{name:e.name,displayName:e.displayName||e.name}}))).concat.apply(i,x()(s))},$=i("uzYq"),T="/grid-table-headers";function R(e){return $.a.get(T+"/"+e)}var P=i("ypiT"),K={name:"headerSelectorDialog",props:["tableName","fieldKeys","closeDialog","gridConfigChange"],components:{Draggable:i.n(P).a},data:function(){return{fields:[],isFormFieldCreated:!1,valid:!1,availableFields:[],selectedFields:[]}},mounted:function(){this.fetchHeadersConfig()},methods:{fetchHeadersConfig:function(){var e=this;return R(this.tableName).then((function(t){return e.mapsHeadersToFormFields(t),t}))},mapsHeadersToFormFields:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e&&e.hasOwnProperty("headers")&&e.headers&&e.headers.length>0&&e.headers.reduce((function(e,t){return e[t.name]=t,e}),{})||{};this.fields=(this.fieldKeys||[]).map((function(e){return{name:e,isEnabled:t&&t[e]&&t[e].isEnabled||!1,displayName:t&&t[e]&&t[e].displayName||O(e),isEditMode:!1}})),this.availableFields=this.fields.filter((function(e){return!e.isEnabled})),this.selectedFields=this.fields.filter((function(e){return e.isEnabled})),this.isFormFieldCreated=!0},onItemDeselect:function(e){this.selectedFields=this.selectedFields.filter((function(t){return t.name!=e.name})),this.availableFields=this.availableFields.concat(e)},onItemSelect:function(e){this.selectedFields=this.selectedFields.concat(e),this.availableFields=this.availableFields.filter((function(t){return t.name!=e.name}))},toggleEditMode:function(e,t){e&&(e.isEditMode=t)},saveConfig:function(){var e,t,i=this;this.selectedFields=this.selectedFields.map((function(e){return r()({},e,{isEnabled:!0})})),(e=this.tableName,t=this.selectedFields,$.a.put(T+"/"+e,t)).then((function(){i.$toasted.show("Grid configuration saved"),i.gridConfigChange(),i.fetchHeadersConfig(),i.closeDialog()})).catch((function(e){i.$toasted.show("Grid configuration could not be saved",{type:"error"})}))}}},G=Object(g.a)(K,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{attrs:{dense:""}},[i("v-card-title",[e._v("Header Selector")]),e._v(" "),i("v-card-text",{attrs:{dense:""}},[i("v-row",{attrs:{dense:""}},[i("v-col",{attrs:{cols:"6"}},[i("v-card",{staticClass:"full-height",attrs:{dense:"",outlined:""}},[i("v-card-text",{staticClass:"full-height"},[i("v-list",{staticClass:"full-height",attrs:{dense:"",subheader:"","two-line":""}},[i("v-subheader",[e._v(" Available columns ")]),e._v(" "),i("draggable",{staticStyle:{"min-height":"10px",height:"100%"},attrs:{options:{group:"name"}},model:{value:e.availableFields,callback:function(t){e.availableFields=t},expression:"availableFields"}},[e._l(e.availableFields,(function(t,n){return[i("v-list-item",{key:t.name,staticClass:"text-left header-selector-list-item",attrs:{dense:"",selectable:""},on:{dblclick:function(){return e.onItemSelect(t)}}},[i("v-list-item-content",[i("v-list-item-title",{domProps:{textContent:e._s(n+1+". "+t.displayName)}}),e._v(" "),i("v-list-item-subtitle",{domProps:{textContent:e._s(t.name)}})],1)],1)]}))],2)],1)],1)],1)],1),e._v(" "),i("v-col",{attrs:{cols:"6"}},[i("v-card",{staticClass:"full-height",attrs:{dense:"",outlined:""}},[i("v-card-text",{staticClass:"full-height"},[i("v-list",{staticClass:"full-height",attrs:{dense:"","two-line":"",subheader:""}},[i("v-subheader",[e._v(" Selected columns ")]),e._v(" "),i("draggable",{staticStyle:{"min-height":"10px",height:"100%"},attrs:{options:{group:"name"}},model:{value:e.selectedFields,callback:function(t){e.selectedFields=t},expression:"selectedFields"}},[e._l(e.selectedFields,(function(t,n){return[t.isEditMode?e._e():i("v-list-item",{key:t.name,staticClass:"text-left header-selector-list-item",attrs:{dense:"",selectable:""}},[i("v-list-item-content",[i("v-list-item-title",{domProps:{textContent:e._s(n+1+". "+t.displayName)}}),e._v(" "),i("v-list-item-subtitle",{domProps:{textContent:e._s(t.name)}})],1),e._v(" "),i("v-list-item-action",[i("span",[i("v-btn",{attrs:{icon:"","x-small":"",color:"green"},on:{click:function(){return e.toggleEditMode(t,!0)}}},[i("v-icon",[e._v("mdi-pencil")])],1),e._v(" "),i("v-btn",{attrs:{icon:"","x-small":"",color:"red"},on:{click:function(i){return e.onItemDeselect(t)}}},[i("v-icon",[e._v("mdi-close")])],1)],1)])],1),e._v(" "),t.isEditMode?i("v-list-item",{key:t.name,staticClass:"text-left header-selector-list-item",attrs:{dense:""}},[i("div",{staticClass:"text-right pb-2 pt-2"},[i("v-text-field",{attrs:{dense:"",label:"Display Name","single-line":""},model:{value:t.displayName,callback:function(i){e.$set(t,"displayName",i)},expression:"item.displayName"}}),e._v(" "),i("v-btn",{attrs:{icon:"",small:"",color:"green"},on:{click:function(){return e.toggleEditMode(t,!1)}}},[i("v-icon",[e._v("mdi-check")])],1)],1)]):e._e()]}))],2)],1)],1)],1)],1)],1)],1),e._v(" "),i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"darken-1",text:""},on:{click:e.closeDialog}},[e._v(" Cancel ")]),e._v(" "),i("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.saveConfig}},[e._v("Save Config")])],1)],1)}),[],!1,null,null,null).exports,j={components:{TooltipIconButton:b.a,HeaderSelectorDialog:G},props:["fieldKeys","tableName","gridConfigChange"],data:function(){return{isOpen:!1}},methods:{closeDialog:function(){this.isOpen=!1},openDialog:function(){this.isOpen=!0}}},V=Object(g.a)(j,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[i("tooltip-icon-button",{attrs:{btnColor:"blue",buttonSize:"medium",btnIcon:"mdi-table-column",btnTooltip:"Configure table columns",onClick:function(){return e.openDialog()}}}),e._v(" "),i("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.isOpen,callback:function(t){e.isOpen=t},expression:"isOpen"}},[e.isOpen?i("header-selector-dialog",{attrs:{"grid-config-change":e.gridConfigChange,closeDialog:e.closeDialog,"field-keys":e.fieldKeys,tableName:e.tableName}}):e._e()],1)],1)}),[],!1,null,null,null).exports,H={name:"slave-devices",components:{GridToolbar:f.a,MasterStarIndicator:h.a,TooltipIconButton:b.a,GridItemsCounter:y,HeaderSelector:V},props:["items","removeSlaves","isFetching","switchToSlave","removeAppSlaveId","appSlaveId","itemKeys"],data:function(){return{search:"",selectedItems:[],tableName:k,headers:[],tableProps:r()({},p.d)}},mounted:function(){this.fetchSetGridHeaders()},computed:{dataItems:function(){return this.items.map((function(e,t){return r()({},e,{sn:t+1,faliureRate:(e.failure_count/e.total_count*100).toFixed(2),client_name:e.is_master?"   "+e.client_name:e.client_name})}))},tableHeight:function(){return this.items&&this.items.length>20?"75vh":void 0}},methods:{gridConfigChange:function(){this.fetchSetGridHeaders()},fetchSetGridHeaders:function(){var e=this;R(k).then((function(t){var i=M(k,t);e.headers=A()(i)})).catch((function(t){e.headers=E.SLAVE_APPS_GRID}))}}},J=Object(g.a)(H,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("grid-toolbar",{attrs:{toolbarTitle:"Slave Devices"},scopedSlots:e._u([{key:"gridCounter",fn:function(){return[i("header-selector",{attrs:{"grid-config-change":e.gridConfigChange,fieldKeys:e.itemKeys,tableName:e.tableName}}),e._v(" "),i("grid-items-counter",{attrs:{num:e.selectedItems.length}})]},proxy:!0},{key:"search",fn:function(){return[i("v-text-field",{staticClass:"pl-10",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]},proxy:!0},{key:"actions",fn:function(){return[i("v-btn",{staticClass:"btn-height-22 white--text",attrs:{"x-small":"",color:"pink",disabled:0==e.selectedItems.length},on:{click:function(){return e.removeSlaves(e.selectedItems)}}},[e._v("\n        Remove as slave\n        "),i("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[e._v(" mdi-delete ")])],1)]},proxy:!0}])}),e._v(" "),i("v-data-table",{staticClass:"elevation-1",attrs:{"item-key":"global_uuid","show-select":"",height:e.tableHeight,loading:e.isFetching,search:e.search,"fixed-header":"",headers:e.headers,items:e.dataItems,"sort-by":"calories","footer-props":e.tableProps.FOOTER_PROPS,itemsPerPage:e.tableProps.ITEMS_PER_PAGE},scopedSlots:e._u([{key:"item.client_name",fn:function(t){var n=t.item;return[i("span",[i("master-star-indicator",{attrs:{"is-master":n.is_master}}),e._v(" "),i("span",[e._v(e._s(n.client_name))])],1)]}},{key:"item.is_online",fn:function(t){return[t.item.is_online?i("div",[i("span",{staticClass:"font-weight-medium"},[i("v-chip",{attrs:{outlined:"",color:"#8cd0ab"}},[e._v("Online")])],1)]):i("div",[i("span",{staticClass:"font-weight-medium"},[i("v-chip",{attrs:{outlined:"",color:"#fbb93e"}},[e._v("Offline")])],1)])]}},{key:"item.faliureRate",fn:function(t){var n=t.item;return[n.faliureRate<10?i("span",{staticClass:"green-text-nube font-weight-bold"},[e._v(e._s(n.faliureRate))]):e._e(),e._v(" "),n.faliureRate>=10?i("span",{staticClass:"orange--text font-weight-bold"},[e._v(e._s(n.faliureRate))]):e._e()]}},{key:"item.actions",fn:function(t){var n=t.item;return[i("div",[e.appSlaveId===n.global_uuid&&e.appSlaveId?e._e():i("tooltip-icon-button",{attrs:{btnColor:"blue",buttonSize:"medium",btnIcon:"mdi-toggle-switch-off-outline",btnTooltip:"Switch to slave mode",onClick:function(){return e.switchToSlave(n)}}}),e._v(" "),e.appSlaveId===n.global_uuid&&e.appSlaveId?i("tooltip-icon-button",{attrs:{btnColor:"orange",buttonSize:"medium",btnIcon:"mdi-toggle-switch-outline",btnTooltip:"Revert to master mode",onClick:function(){return e.removeAppSlaveId()}}}):e._e(),e._v(" "),i("tooltip-icon-button",{attrs:{btnColor:"red",btnIcon:"mdi-delete",btnTooltip:"Remove as slave",onClick:function(){return e.removeSlaves(n)},loading:n.isDeleting}})],1)]}}]),model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}})],1)}),[],!1,null,"5881afed",null).exports,L={name:"discover-devices",components:{GridToolbar:f.a,MasterStarIndicator:h.a,GridItemsCounter:y,HeaderSelector:V},props:["items","createSlaves","isFetching","itemKeys"],data:function(){return{search:"",dialog:!1,tableName:D,isFetchingDevices:!1,selectedItems:[],headers:[],tableProps:r()({},p.d)}},mounted:function(){this.fetchSetGridHeaders()},computed:{dataItems:function(){return this.items.map((function(e,t){return r()({},e,{sn:t+1,client_name:e.is_master?"   "+e.client_name:e.client_name})}))},fieldKeys:function(){return this.itemKeys},tableHeight:function(){return this.items&&this.items.length>20?"75vh":void 0}},methods:{gridConfigChange:function(){this.fetchSetGridHeaders()},fetchSetGridHeaders:function(){var e=this;R(D).then((function(t){var i=M(D,t);e.headers=A()(i)})).catch((function(t){e.headers=E.DISCOVER_SLAVE_GRID}))}}},z=Object(g.a)(L,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("grid-toolbar",{attrs:{toolbarTitle:"Discover Devices"},scopedSlots:e._u([{key:"gridCounter",fn:function(){return[i("header-selector",{attrs:{"grid-config-change":e.gridConfigChange,fieldKeys:e.fieldKeys,tableName:e.tableName}}),e._v(" "),i("grid-items-counter",{attrs:{num:e.selectedItems.length}})]},proxy:!0},{key:"search",fn:function(){return[i("v-text-field",{staticClass:"pl-10",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]},proxy:!0},{key:"customAction",fn:function(){return[i("v-btn",{staticClass:"mr-1 btn-height-22 white--text",attrs:{"x-small":"",color:"#8cd0ab",disabled:0==e.selectedItems.length},on:{click:function(){return e.createSlaves(e.selectedItems)}}},[e._v("Add as slave"),i("v-icon",{attrs:{"x-small":"",right:""}},[e._v("mdi-plus")])],1)]},proxy:!0}])}),e._v(" "),i("v-data-table",{staticClass:"elevation-1",attrs:{"item-key":"global_uuid","show-select":"",loading:e.isFetching,search:e.search,"fixed-header":"",height:e.tableHeight,headers:e.headers,items:e.dataItems,"sort-by":"calories","footer-props":e.tableProps.FOOTER_PROPS,itemsPerPage:e.tableProps.ITEMS_PER_PAGE},scopedSlots:e._u([{key:"item.client_name",fn:function(t){var n=t.item;return[i("span",[i("master-star-indicator",{attrs:{"is-master":n.is_master}}),e._v(" "),i("span",[e._v(e._s(n.client_name))])],1)]}},{key:"item.actions",fn:function(t){var n=t.item;return[n.isAddToSlaveVisible?i("v-btn",{staticClass:"btn-height-22 white--text",attrs:{"x-small":"",color:"#8cd0ab",loading:n.isUpdating},on:{click:function(){return e.createSlaves(n)}}},[e._v("\n        Add as slave\n      ")]):i("div",[e._v("No actions available")])]}}]),model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}})],1)}),[],!1,null,null,null).exports,q=i("0iKi"),U=i("HeMS"),B={name:"master-slave-page",components:{PageTitle:m.a,DiscoverDevices:z,SlaveDevices:J},watch:{"$route.query.tab":function(e){this.tab=this.tabs.indexOf(e)},tab:function(e,t){var i=this.$route.query.tab;if(i!==this.tabs[e]){var n=this.tabs[e];this.$router.push({path:"master-slaves",query:{tab:n}})}}},computed:{isItemKeysSet:function(){return this.slaveDevicesItemKeys.length>0&&this.slaveDevicesItemKeys.length>0}},data:function(){return{tab:0,appSlaveId:null,tabs:["discover-devices","slave-devices"],slaveDevices:[],discoveredDevicesItemKeys:[],slaveDevicesItemKeys:[],devicesMap:{},slaveDevicesMap:{},discoveredDevices:[],isFetchingSlaveDevices:!1,isFetchingDevices:!1,timeout:null}},mounted:function(){var e=this.$route.query.tab;this.tab=this.tabs.indexOf(e),this.getAppSlaveId()},created:function(){this.syncDevices(),this.getAppSlaveId()},destroyed:function(){clearTimeout(this.timeout)},methods:{formatAddress:function(e){var t="";return e.site_address&&(t+=e.site_address),e.site_city&&(t+=", "+e.site_city),e.site_country&&(t+=", "+e.site_country),t},syncDevices:function(){var e=this;return v()(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isFetchingSlaveDevices=!0,e.isFetchingDevices=!0,t.next=4,e.fetchSlaveDevices();case 4:return t.next=6,e.fetchDevices();case 6:e.getAppSlaveId();case 7:case"end":return t.stop()}}),t,e)})))()},fetchSlaveDevices:function(){var e=this;return q.e().then((function(t){e.slaveDevicesMap=t;var i=l()(t);e.setSlaveItemKeys(t,i),e.slaveDevices=i.map((function(i){return r()({},e.slaveDevicesMap[i],{isDeleting:!1,site_address:e.formatAddress(t[i])})}))})).catch((function(e){})).finally((function(){e.isFetchingSlaveDevices=!1}))},setDiscoveredItemKeys:function(e,t){this.discoveredDevicesItemKeys=l()(Array.isArray(t)&&t.length>0&&e[t[0]]||{}),this.discoveredDevicesItemKeys.unshift("sn")},setSlaveItemKeys:function(e,t){this.slaveDevicesItemKeys=l()(Array.isArray(t)&&t.length>0&&e[t[0]]||{}),this.slaveDevicesItemKeys.unshift("sn")},fetchDevices:function(){var e=this;return q.d().then((function(t){e.devicesMap=t;var i=l()(e.devicesMap);e.setDiscoveredItemKeys(t,i),e.discoveredDevices=i.map((function(t){return r()({},e.devicesMap[t],{isUpdating:!1,isAddToSlaveVisible:!e.slaveDevicesMap[t],site_address:e.formatAddress(e.devicesMap[t])})}))})).catch((function(t){e.$toasted.show("Error fetching remote devices",{type:"error"})})).finally((function(){e.isFetchingDevices=!1}))},createSlaves:function(e){var t=this;e.isUpdating=!0;return(Array.isArray(e)&&e.length>0?q.a:q.c)(e).then((function(){t.$toasted.show("Successfully updated the device status."),t.syncDevices()})).catch((function(){t.$toasted.show("Error occured while updating the device status",{type:"error"})})).finally((function(){e.isUpdating=!1}))},removeSlaves:function(e){var t=this;e.isDeleting=!0;return(Array.isArray(e)&&e.length>0?q.b:q.f)(e).then((function(){t.$toasted.show("Successfully remove the device as slave."),t.syncDevices()})).catch((function(){t.$toasted.show("Error occured while updating the device status",{type:"error"})})).finally((function(){e.isDeleting=!1}))},switchToSlave:function(e){var t=this;this.$store.commit("changeSwitchedSlaveState",!1),this.timeout=setTimeout((function(){U.f(e.global_uuid,e),t.$store.commit("changeSwitchedSlaveState",!0),t.appSlaveId=e.global_uuid,t.$store.commit("changeAppRerenderCount")}),100)},getAppSlaveId:function(){this.appSlaveId=U.c()},removeAppSlaveId:function(){this.appSlaveId=null,this.$store.commit("changeSwitchedSlaveState",!1),U.e(),this.$store.commit("changeAppRerenderCount")}}},Q=Object(g.a)(B,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("page-title",{attrs:{title:"Master Slave Mapping"},scopedSlots:e._u([{key:"spinner",fn:function(){return[e.isFetchingDevices||e.isFetchingSlaveDevices?i("v-progress-circular",{attrs:{indeterminate:"",size:"20"}}):e._e()]},proxy:!0}])}),e._v(" "),i("v-tabs",{attrs:{right:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[i("v-tab",{key:0},[e._v("Discover Devices ")]),e._v(" "),i("v-tab",{key:1},[e._v("Slave Devices ")])],1),e._v(" "),i("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[i("v-tab-item",{key:0},[i("discover-devices",{attrs:{items:e.discoveredDevices,"item-keys":e.discoveredDevicesItemKeys,"create-slaves":e.createSlaves,"is-fetching":e.isFetchingDevices}})],1),e._v(" "),i("v-tab-item",{key:1},[i("slave-devices",{attrs:{items:e.slaveDevices,"item-keys":e.slaveDevicesItemKeys,removeSlaves:e.removeSlaves,"is-fetching":e.isFetchingSlaveDevices,"switch-to-slave":e.switchToSlave,"app-slave-id":e.appSlaveId,"remove-app-slave-id":e.removeAppSlaveId}})],1)],1)],1)}),[],!1,null,null,null);t.default=Q.exports},Q12t:function(e,t,i){"use strict";var n=i("/9Wh"),a=i.n(n),s=i("+n12"),r={name:"export-data",props:["data","fileName","formatDataService"],methods:{clickDownload:function(e,t){var i=e;switch("function"==typeof this.formatDataService&&(i=this.formatDataService(e)),t){case"csv":return Object(s.e)(this.fileName,i);case"excel":return Object(s.g)(this.fileName,i);case"json":return Object(s.h)(this.fileName,a()(i))}}}},o=i("psIG"),l=Object(o.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,a=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"mr-2 btn-height-22 white--text",attrs:{"x-small":"",color:"#339999"}},"v-btn",a,!1),n),[e._v("\n      Download"),i("v-icon",{attrs:{"x-small":"",right:""}},[e._v("mdi-download")])],1)]}}])},[e._v(" "),i("v-list",[i("v-list-item",{on:{click:function(t){return e.clickDownload(e.data,"json")}}},[e._v("\n      JSON\n    ")]),e._v(" "),i("v-list-item",{on:{click:function(t){return e.clickDownload(e.data,"excel")}}},[e._v("\n      Excel\n    ")]),e._v(" "),i("v-list-item",{on:{click:function(t){return e.clickDownload(e.data,"csv")}}},[e._v("\n      CSV\n    ")])],1)],1)}),[],!1,null,null,null);t.a=l.exports},Ui9F:function(e,t,i){"use strict";var n={name:"tooltip-icon-button",props:["btnIcon","btnTooltip","onClick","btnColor","buttonSize","disabled"]},a=i("psIG"),s=Object(a.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,a=t.attrs;return["medium"==e.buttonSize?i("v-btn",e._g(e._b({staticClass:"white--text",attrs:{disabled:e.disabled,icon:"",medium:"",color:e.btnColor},on:{click:e.onClick}},"v-btn",a,!1),n),[i("v-icon",{attrs:{medium:"",dark:""}},[e._v(" "+e._s(e.btnIcon)+" ")])],1):i("v-btn",e._g(e._b({staticClass:"white--text",attrs:{disabled:e.disabled,icon:"",small:"",color:e.btnColor},on:{click:e.onClick}},"v-btn",a,!1),n),[i("v-icon",{attrs:{small:"",dark:""}},[e._v(" "+e._s(e.btnIcon)+" ")])],1)]}}])},[e._v(" "),i("span",[e._v(e._s(e.btnTooltip))])])}),[],!1,null,null,null);t.a=s.exports},asQ9:function(e,t,i){"use strict";var n={name:"master-star-indicator",props:["isMaster"]},a=i("psIG"),s=Object(a.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,a=t.attrs;return[e.isMaster?i("v-icon",e._g(e._b({staticClass:"mt-n1",attrs:{medium:"",color:"#fbb93e"}},"v-icon",a,!1),n),[e._v("mdi-star")]):e._e()]}}])},[e._v(" "),i("span",[e._v("Master device")])])}),[],!1,null,null,null);t.a=s.exports}}]);
//# sourceMappingURL=9.3960f4af9045cf92d895.js.map