(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{"0TWu":function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a("Kz1y"),i=a.n(n),r=a("t3kO"),o=a.n(r),s=function(e,t,a){return e.name+":"+t.name+":"+a.name},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[],a=!0,n=!1,r=void 0;try{for(var l,c=o()(e);!(a=(l=c.next()).done);a=!0){var u=l.value;if(u.devices){var d=!0,m=!1,v=void 0;try{for(var f,h=o()(u.devices);!(d=(f=h.next()).done);d=!0){var p=f.value;if(p.points){var g=!0,_=!1,b=void 0;try{for(var D,y=o()(p.points);!(g=(D=y.next()).done);g=!0){var w=D.value,k=i()({},w,{networkName:u.name,deviceName:p.name,displayName:s(u,p,w)});t.push(k)}}catch(e){_=!0,b=e}finally{try{!g&&y.return&&y.return()}finally{if(_)throw b}}}}}catch(e){m=!0,v=e}finally{try{!d&&h.return&&h.return()}finally{if(m)throw v}}}}}catch(e){n=!0,r=e}finally{try{!a&&c.return&&c.return()}finally{if(n)throw r}}return t}},"2SyR":function(e,t,a){"use strict";var n={name:"icon-button",props:["icon","on-click","title","color","size","disabled","loading"]},i=a("psIG"),r=Object(i.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",["small"==e.size?a("v-btn",{staticClass:"pa-2",attrs:{small:"",text:"",color:e.color,loading:e.loading,disabled:e.disabled},on:{click:e.onClick}},[e.icon?a("v-icon",[e._v(e._s(e.icon))]):e._e(),e._v(" "),e.title?a("span",{staticClass:"text"},[e._v(" "+e._s(e.title))]):e._e()],1):a("v-btn",{staticClass:"pa-2",attrs:{text:"",loading:e.loading,disabled:e.disabled,color:e.color,"x-small":""},on:{click:e.onClick}},[e.icon?a("v-icon",[e._v(e._s(e.icon))]):e._e(),e._v(" "),e.title?a("span",{staticClass:"text"},[e._v(" "+e._s(e.title))]):e._e()],1)],1)}),[],!1,null,null,null);t.a=r.exports},"5Vrd":function(e,t,a){"use strict";a.r(t);var n=a("Kz1y"),i=a.n(n),r=a("edSL"),o=a.n(r),s=a("TcPG"),l=a.n(s),c=a("snOE"),u=a.n(c),d=a("tZmG"),m=a.n(d),v=a("bRcU"),f=a("08eb"),h=a.n(f),p=a("wGtP"),g=a("xrGn"),_="00:00:00",b="yyyy-MM-dd",D="HH:mm:ss",y={name:"v-datetime-picker",model:{prop:"datetime",event:"input"},props:{datetime:{type:[Date,String],default:null},disabled:{type:Boolean},loading:{type:Boolean},label:{type:String,default:""},dateFormat:{type:String,default:b},timeFormat:{type:String,default:"HH:mm"},clearText:{type:String,default:"CLEAR"},okText:{type:String,default:"OK"},textFieldProps:{type:Object},datePickerProps:{type:Object},timePickerProps:{type:Object},rules:{type:Array}},data:function(){return{activeTab:0,open:!1,date:"",time:_}},mounted:function(){this.init()},computed:{dateTimeFormat:function(){return this.dateFormat+" "+this.timeFormat},defaultDateTimeFormat:function(){return"yyyy-MM-dd HH:mm:ss"},formattedDatetime:function(){return this.selectedDatetime?Object(p.a)(this.selectedDatetime,this.dateTimeFormat):""},selectedDatetime:function(){if(this.date&&this.time){var e=this.date+" "+this.time;return 5===this.time.length&&(e+=":00"),Object(g.a)(e,this.defaultDateTimeFormat,new Date)}return null},dateSelected:function(){return!this.date}},methods:{init:function(){if(this.datetime){var e=void 0;this.datetime instanceof Date?e=this.datetime:("string"==typeof this.datetime||this.datetime instanceof String)&&(e=Object(g.a)(this.datetime,this.dateTimeFormat,new Date)),this.date=Object(p.a)(e,b),this.time=Object(p.a)(e,D)}},okHandler:function(){this.open=!1,this.resetPicker(),this.$emit("input",this.selectedDatetime)},handleDialogOpen:function(){this.open=!0},clearHandler:function(){this.resetPicker(),this.date="",this.time=_,this.$emit("input",null)},cancelHandler:function(){this.open=!1},resetPicker:function(){this.activeTab=0,this.$refs.timer&&(this.$refs.timer.selectingHour=!0)},showTimePicker:function(){this.activeTab=1}},watch:{datetime:function(){this.init()}}},w=a("psIG"),k=Object(w.a)(y,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-text-field",e._b({attrs:{readonly:"",rules:e.rules,label:e.label,loading:e.loading,disabled:e.disabled,value:e.formattedDatetime},on:{click:e.handleDialogOpen},scopedSlots:e._u([{key:"progress",fn:function(){return[e._t("progress",[a("v-progress-linear",{attrs:{color:"primary",indeterminate:"",absolute:"",height:"2"}})])]},proxy:!0}],null,!0)},"v-text-field",e.textFieldProps,!1)),e._v(" "),a("v-dialog",{attrs:{"max-width":"300px"},model:{value:e.open,callback:function(t){e.open=t},expression:"open"}},[a("v-card",[a("v-card-text",{staticClass:"px-0 py-0"},[a("v-tabs",{attrs:{"fixed-tabs":""},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",{key:"calendar"},[e._t("dateIcon",[a("v-icon",[e._v("mdi-calendar-outline")])])],2),e._v(" "),a("v-tab",{key:"timer",attrs:{disabled:e.dateSelected}},[e._t("timeIcon",[a("v-icon",[e._v("mdi-clock-outline")])])],2),e._v(" "),a("v-tab-item",{key:"calendar"},[a("v-date-picker",e._b({attrs:{"full-width":""},on:{input:e.showTimePicker},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}},"v-date-picker",e.datePickerProps,!1))],1),e._v(" "),a("v-tab-item",{key:"timer"},[a("v-time-picker",e._b({ref:"timer",staticClass:"v-time-picker-custom",attrs:{"full-width":""},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}},"v-time-picker",e.timePickerProps,!1))],1)],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),e._t("actions",[a("v-btn",{attrs:{color:"grey lighten-1",text:""},nativeOn:{click:function(t){return e.clearHandler(t)}}},[e._v(e._s(e.clearText))]),e._v(" "),a("v-btn",{attrs:{color:"grey lighten-1",text:""},nativeOn:{click:function(t){return e.cancelHandler(t)}}},[e._v("Cancel")]),e._v(" "),a("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:e.okHandler}},[e._v(e._s(e.okText))])],{parent:this})],2)],1)],1)],1)}),[],!1,null,null,null).exports,x=a("Ui9F"),C=a("Zv/C"),E=a.n(C),S=a("2lBV"),N=a.n(S),T=a("F/wX"),I=a.n(T),$={EVENT:"events",WEEKLY:"weekly",EXCEPTION:"exception"},V=function(){function e(t,a,n,i,r,o,s){E()(this,e),this.DEFAULT_COLOR="gary darken-1",this.id=t||Object(v.generate)(),this.name=a||"",this.start=n||new Date(this.getTodayDate()+"T00:00:00"),this.end=i||new Date(this.getTodayDate()+"T23:59:59"),this.color=r||this.DEFAULT_COLOR,this.timed=o||!1,this.eventType=s}return N()(e,[{key:"getTodayDate",value:function(){return(new Date).toISOString().split("T")[0]}}]),e}(),z={sunday:0,monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6};function F(e){return"string"==typeof e&&(e=new Date(e)),I()(e).format("YYYY-MM-DDTHH:mm")}function A(e,t){var a=function(e){return e.split(":").concat("00")}(t),n=new Date(e);return n.setHours.apply(n,u()(a)),n}function P(e,t,a,n,r){t=function(e){return i()({},e,{days:e.days.map((function(e){return z[e]}))})}(t),a=new Date(a.date+"T00:00:00"),n=new Date(n.date+"T23:59:59");for(var o=[],s=function(){var n,r,s=a.getDay(),l=t.days.reduce((function(n,r){if(s==r){var o=function(e,t){var a=e.id,n=e.name,i=e.value,r=e.color,o=e.startTime,s=e.endTime,l=e.date,c=A(l,o),u=A(l,s);return new V(a,n+" - "+i,c,u,r,!0,$.WEEKLY)}(i()({},t,{id:e,date:new Date(a),startTime:t.start,endTime:t.end}));n.push(o)}return n}),[]);l.length&&o.push(l),n=a,(r=new Date(n)).setDate(n.getDate()+1),a=r};a-n<0;)s();return o.flat()}function W(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$.EVENT;return m()(e).reduce((function(a,n){var i=n,r=e[n],o=r.name+" - "+r.value,s=r.color,l=[];return r.dates.forEach((function(e){l.push(new V(i,o,new Date(e.start),new Date(e.end),s,!0,t))})),a.push.apply(a,l),a}),[])}var O={name:"event-form",components:{DateTimePicker:k,TooltipIconButton:x.a},props:["onCancel","onSave","item","isEdit","config","timezone","onDelete"],data:function(){return{isSubmitting:!1,isDeleting:!1,valid:!1,formData:{name:"",dates:[{start:null,end:null}],value:null,color:""},rules:{required:function(e){return!!e||"Required."},numberRule:function(e){return!isNaN(parseFloat(e))||"Required."}}}},computed:{scheduleNames:function(){return h()(this.config&&this.config.names||{})}},mounted:function(){this.isEdit&&this.item&&(this.formData={name:this.item.name,dates:this.item.dates.map((function(e){return{start:new Date(e.start),end:new Date(e.end)}})),value:this.item.value,color:this.item.color})},methods:{startDateValidator:function(e,t){var a=o()(this.formData,"dates["+t+"].start",void 0),n=o()(this.formData,"dates["+t+"].end",void 0);return!n||!a||(!(new Date(a)-new Date(n)>0)||"Start date should be less than End date")},endDateValidator:function(e,t){var a=o()(this.formData,"dates["+t+"].start",void 0),n=o()(this.formData,"dates["+t+"].end",void 0);return!n||!a||(!(new Date(a)-new Date(n)>0)||"End date should be more than Start date")},addNewEvent:function(){this.formData.dates.push({start:null,end:null})},removeEvent:function(e){this.formData.dates=this.formData.dates.filter((function(t,a){return a!=e}))},formatData:function(e){return e.dates=e.dates.map((function(e){return{start:F(e.start),end:F(e.end)}})),e},onSaveForm:function(){var e=this;this.$refs.form.validate()&&(this.isSubmitting=!0,this.onSave(this.formatData(this.formData),this.item?this.item.id:null).then((function(t){e.onCancel()})).catch((function(e){})).finally((function(){e.isSubmitting=!1})))},onDeleteItem:function(){var e=this;this.isDeleting=!0,this.onDelete(this.item.id).then((function(){e.$toasted.show("Successfully deleted"),e.onCancel()})).catch((function(e){})).finally((function(){e.isDeleting=!1}))}}},q=Object(w.a)(O,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-card-title",[e._v("Event")]),e._v(" "),a("v-card-text",[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-select",{attrs:{items:e.scheduleNames,rules:[e.rules.required],"item-text":"name","item-value":"name",label:"Event name","persistent-hint":"","single-line":""},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),a("v-col",{attrs:{cols:"12"}},[a("v-slider",{attrs:{label:"Value",max:"100",min:"0","thumb-label":""},model:{value:e.formData.value,callback:function(t){e.$set(e.formData,"value",t)},expression:"formData.value"}})],1),e._v(" "),a("v-col",{attrs:{cols:"12"}},e._l(e.formData.dates,(function(t,n){return a("v-row",{key:n,attrs:{dense:""}},[a("v-col",{attrs:{cols:"5"}},[a("date-time-picker",{attrs:{rules:[e.rules.required,function(a){return e.startDateValidator(t,n)}],label:"Start Date"},model:{value:t.start,callback:function(a){e.$set(t,"start",a)},expression:"item.start"}})],1),e._v(" "),a("v-col",{attrs:{cols:"5"}},[a("date-time-picker",{attrs:{rules:[e.rules.required,function(a){return e.endDateValidator(t,n)}],label:"End Date"},model:{value:t.end,callback:function(a){e.$set(t,"end",a)},expression:"item.end"}})],1),e._v(" "),a("v-col",{attrs:{cols:"2"}},[a("tooltip-icon-button",{attrs:{disabled:e.formData.dates.length<=1,btnColor:"error",btnIcon:"mdi-delete",buttonSize:"medium",btnTooltip:"Remove Event Date",onClick:function(){return e.removeEvent(n)}}})],1),e._v(" "),a("v-col",{attrs:{cols:"12"}},[n===e.formData.dates.length-1?a("tooltip-icon-button",{attrs:{btnColor:"nubeGreen",btnIcon:"mdi-plus",buttonSize:"medium",btnTooltip:"Add Event Date",onClick:function(){return e.addNewEvent()}}}):e._e()],1)],1)})),1),e._v(" "),a("v-col",{attrs:{cols:"12"}},[a("p",{staticClass:"v-label text-left"},[e._v("Event Color")]),e._v(" "),a("v-color-picker",{attrs:{mode:"hexa"},model:{value:e.formData.color,callback:function(t){e.$set(e.formData,"color",t)},expression:"formData.color"}})],1)],1)],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{text:""},on:{click:e.onCancel}},[e._v("Close")]),e._v(" "),e.isEdit?a("v-btn",{attrs:{color:"error",loading:e.isDeleting,text:""},on:{click:e.onDeleteItem}},[e._v("Delete")]):e._e(),e._v(" "),a("v-btn",{attrs:{color:"primary",loading:e.isSubmitting,text:""},on:{click:e.onSaveForm}},[e._v("Save")])],1)],1)}),[],!1,null,null,null).exports,L=a("yEOx"),j=a.n(L),R={name:"weekly-form",props:["onSave","onCancel","item","isEdit","config","timezone","onDelete"],data:function(){return{valid:!1,showMenu:!1,showEndTime:!1,isDeleting:!1,isSubmitting:!1,formData:{name:"",days:[],start:null,end:null,color:"",value:null},rules:{required:function(e){return!!e||"Required."},numberRule:function(e){return!isNaN(parseFloat(e))||"Required."}},dayList:[{displayName:"Sunday",value:"sunday"},{displayName:"Monday",value:"monday"},{displayName:"Tuesday",value:"tuesday"},{displayName:"Wednesday",value:"wednesday"},{displayName:"Thursday",value:"thursday"},{displayName:"Friday",value:"friday"},{displayName:"Saturday",value:"saturday"}]}},computed:{scheduleNames:function(){return h()(this.config&&this.config.names||{})}},mounted:function(){this.isEdit&&this.item&&(this.formData={name:this.item.name,days:this.item.days,start:this.item.start,end:this.item.end,color:this.item.color,value:this.item.value},this.formData=this.parseStartEndTime(this.formData))},methods:{parseStartEndTime:function(e){return e},formatStartEndTime:function(e){return e},onSaveForm:function(){var e=this;this.$refs.form.validate()&&(this.isSubmitting=!0,this.onSave(this.formatStartEndTime(this.formData),this.item?this.item.id:null).then((function(t){e.onCancel()})).catch((function(){e.$toasted.show("Cannot create weekly event",{type:"error"})})).finally((function(){e.isSubmitting=!1})))},onDeleteItem:function(){var e=this;this.isDeleting=!0,this.onDelete(this.item.id).then((function(){e.$toasted.show("Successfully deleted"),e.onCancel()})).catch((function(e){})).finally((function(){e.isDeleting=!1}))}}},B=Object(w.a)(R,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-card-title",[e._v("Weekly Form")]),e._v(" "),a("v-card-text",[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{cols:"12"}},[a("v-select",{attrs:{"single-line":"","persistent-hint":"","item-text":"name","item-value":"name",label:"Event name",items:e.scheduleNames,rules:[e.rules.required]},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),a("v-col",{attrs:{cols:"12"}},[a("v-slider",{attrs:{label:"Value",max:"100",min:"0","thumb-label":""},model:{value:e.formData.value,callback:function(t){e.$set(e.formData,"value",t)},expression:"formData.value"}})],1),e._v(" "),a("v-col",{attrs:{cols:"12"}},[a("v-select",{attrs:{label:"Days","item-value":"value",multiple:"",chips:"",clearable:"",rules:[e.rules.required],"deletable-chips":"",items:e.dayList,"item-text":"displayName"},model:{value:e.formData.days,callback:function(t){e.$set(e.formData,"days",t)},expression:"formData.days"}})],1),e._v(" "),a("v-col",{attrs:{cols:"6"}},[a("v-menu",{ref:"startMenu",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.formData.start,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(t){return e.$set(e.formData,"start",t)},"update:return-value":function(t){return e.$set(e.formData,"start",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{rules:[e.rules.required],label:"Start Time",readonly:""},model:{value:e.formData.start,callback:function(t){e.$set(e.formData,"start",t)},expression:"formData.start"}},"v-text-field",i,!1),n))]}}]),model:{value:e.showMenu,callback:function(t){e.showMenu=t},expression:"showMenu"}},[e._v(" "),e.showMenu?a("v-time-picker",{attrs:{"full-width":""},on:{"click:minute":function(t){return e.$refs.startMenu.save(e.formData.start)}},model:{value:e.formData.start,callback:function(t){e.$set(e.formData,"start",t)},expression:"formData.start"}}):e._e()],1)],1),e._v(" "),a("v-col",{attrs:{cols:"6"}},[a("v-menu",{ref:"endMenu",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.formData.end,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(t){return e.$set(e.formData,"end",t)},"update:return-value":function(t){return e.$set(e.formData,"end",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{rules:[e.rules.required],label:"End Time",readonly:""},model:{value:e.formData.end,callback:function(t){e.$set(e.formData,"end",t)},expression:"formData.end"}},"v-text-field",i,!1),n))]}}]),model:{value:e.showEndTime,callback:function(t){e.showEndTime=t},expression:"showEndTime"}},[e._v(" "),e.showEndTime?a("v-time-picker",{attrs:{"full-width":""},on:{"click:minute":function(t){return e.$refs.endMenu.save(e.formData.end)}},model:{value:e.formData.end,callback:function(t){e.$set(e.formData,"end",t)},expression:"formData.end"}}):e._e()],1)],1),e._v(" "),a("v-col",{attrs:{cols:"12"}},[a("p",{staticClass:"v-label text-left"},[e._v("Event Color")]),e._v(" "),a("v-color-picker",{attrs:{mode:"hexa"},model:{value:e.formData.color,callback:function(t){e.$set(e.formData,"color",t)},expression:"formData.color"}})],1)],1)],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{text:""},on:{click:e.onCancel}},[e._v("Close")]),e._v(" "),e.isEdit?a("v-btn",{attrs:{color:"error",loading:e.isDeleting,text:""},on:{click:e.onDeleteItem}},[e._v("Delete")]):e._e(),e._v(" "),a("v-btn",{attrs:{color:"primary",loading:e.isSubmitting,text:""},on:{click:e.onSaveForm}},[e._v("Save")])],1)],1)}),[],!1,null,null,null).exports,M=a("dqfB"),G=a("A3AF"),H={data:function(){return{fav:!0,valid:!1,menu:!1,listRenderCount:0,message:!1,hints:!0,timezoneVal:null,timezones:[],names:[],scheduleNameList:[],rules:{required:function(e){return!!e||"Required."}}}},components:{TooltipIconButton:x.a},props:["timezone","scheduleNames","onSubmit"],mounted:function(){this.initialize()},watch:{menu:function(e,t){e&&this.initialize()}},methods:{initialize:function(){this.timezone?this.timezoneVal=this.timezone:this.timezoneVal=M.a(),this.timezones=M.c(),this.updateScheduleNameList()},updateScheduleNameList:function(){this.scheduleNameList=h()(this.scheduleNames||{}).map((function(e){return i()({},e)}))},createScheduleName:function(e){var t={id:Object(G.a)(),name:e};this.scheduleNameList=this.scheduleNameList.concat(t)},updateScheduleName:function(e,t){this.scheduleNames=i()({},this.scheduleNames,l()({},e,i()({},this.scheduleNames[e],{name:t})))},removeScheduleName:function(e){this.scheduleNameList=this.scheduleNameList.filter((function(t){return t.id!==e}))},onSave:function(){if(this.menu=!1,this.$refs.form.validate()){var e={timezone:this.timezoneVal,names:this.scheduleNameList.reduce((function(e,t){return e[t.id]=i()({},t),e}),{})};this.onSubmit(e)}}}},U=Object(w.a)(H,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-width":200,"offset-x":""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"mr-1 btn-height-22",attrs:{color:"orange darken-2","x-small":""}},"v-btn",i,!1),n),[a("span",[e._v("Calendar Settings")]),e._v(" "),a("v-icon",{attrs:{"x-small":"",right:""}},[e._v(" mdi-calendar")])],1)]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[e._v(" "),a("v-card",{staticClass:"text-left"},[a("v-list",[a("v-list-item",[a("v-list-item-avatar",[a("v-icon",[e._v("mdi-calendar")])],1),e._v(" "),a("v-list-item-content",[a("v-list-item-title",[e._v("Calendar Panel")]),e._v(" "),a("v-list-item-subtitle",[e._v("Configure timezone/schedule names")])],1)],1)],1),e._v(" "),a("v-divider"),e._v(" "),a("v-divider"),e._v(" "),a("v-card-text",[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{cols:"12"}},[a("v-autocomplete",{attrs:{dense:"",required:"",clearable:"",items:e.timezones,rules:[e.rules.required]},model:{value:e.timezoneVal,callback:function(t){e.timezoneVal=t},expression:"timezoneVal"}})],1),e._v(" "),a("v-col",{attrs:{cols:"12"}},[a("v-divider")],1),e._v(" "),a("v-col",{attrs:{cols:"12"}},[a("p",{staticClass:"caption"},[e._v("Schedule Names")]),e._v(" "),a("div",{staticClass:"schedule-name-list-wrapper"},e._l(e.scheduleNameList,(function(t,n){return a("div",{key:n+"-"+e.listRenderCount},[a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{cols:"11"}},[a("v-text-field",{attrs:{dense:"",rules:[e.rules.required],required:""},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"scheduleName.name"}})],1),e._v(" "),a("v-col",{attrs:{cols:"1"}},[a("tooltip-icon-button",{attrs:{btnColor:"red",btnIcon:"mdi-delete",buttonSize:"medium",btnTooltip:"Delete",onClick:function(){return e.removeScheduleName(t.id)}}})],1)],1)],1)})),0),e._v(" "),a("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[a("tooltip-icon-button",{attrs:{btnColor:"blue",btnIcon:"mdi-plus",buttonSize:"medium",btnTooltip:"Add Schedule Name",onClick:function(){return e.createScheduleName("")}}})],1)],1)],1)],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{text:""},on:{click:function(t){e.menu=!1}}},[e._v(" Cancel ")]),e._v(" "),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.onSave}},[e._v(" Save ")])],1)],1)],1)}),[],!1,null,null,null).exports,Y=a("6J4u"),K=a.n(Y),Z={name:"execption-event-form",props:["onSave","onCancel","item","isEdit","config","onDelete"],components:{TooltipIconButton:x.a,DateTimePicker:k},data:function(e){return{isDeleting:!1,valid:!1,dateFormatted:null,isSubmitting:!1,showMenu:!1,formData:{name:"",dates:[{start:null,end:null}],color:"",value:null},rules:{required:function(e){return!!e||"Required."},numberRule:function(e){return!isNaN(parseFloat(e))||"Required."}}}},mounted:function(){this.isEdit&&this.item&&(this.formData={name:this.item.name,color:this.item.color,value:this.item.value,dates:(this.item.dates||[]).map((function(e){return{start:new Date(e.start),end:new Date(e.end)}}))})},computed:{computedDateFormatted:function(){return this.formatDate(this.date)},scheduleNames:function(){return h()(this.config&&this.config.names||{})}},watch:{date:function(e){this.dateFormatted=this.formatDate(this.date)}},methods:{startDateValidator:function(e,t){var a=o()(this.formData,"dates["+t+"].start",void 0),n=o()(this.formData,"dates["+t+"].end",void 0);return!n||!a||(!(new Date(a)-new Date(n)>0)||"Start date should be less than End date")},endDateValidator:function(e,t){var a=o()(this.formData,"dates["+t+"].start",void 0),n=o()(this.formData,"dates["+t+"].end",void 0);return!n||!a||(!(new Date(a)-new Date(n)>0)||"End date should be more than Start date")},getDate:function(e){var t=(new Date).getFullYear(),a=e.concat("-",t);return new Date(a).toISOString().substr(0,10)},getFormattedDate:function(e){return Object(p.a)(new Date(e+"T00:00:00"),"MM-dd")},addNewEvent:function(){this.formData.dates.push({start:null,end:null})},removeEvent:function(e){this.formData.dates=this.formData.dates.filter((function(t,a){return a!=e}))},formatData:function(e){var t=j()(e);return i()({},t,{dates:t.dates.map((function(e){return{start:F(e.start),end:F(e.end)}}))})},formatDate:function(e){if(!e)return null;var t=e.split("-"),a=K()(t,3);a[0];return a[1]+"-"+a[2]},parseDate:function(e){if(!e)return null;var t=e.split("-"),a=K()(t,2),n=a[0],i=a[1];return(new Date).getFullYear()+"-"+n.padStart(2,"0")+"-"+i.padStart(2,"0")},onSaveForm:function(){var e=this;this.$refs.form.validate()&&(this.formData.date=this.dateFormatted,this.isSubmitting=!0,this.onSave(this.formatData(this.formData),this.item?this.item.id:null).then((function(t){e.onCancel()})).catch((function(){})).finally((function(){e.isSubmitting=!1})))},onDeleteItem:function(){var e=this;this.isDeleting=!0,this.onDelete(this.item.id).then((function(){e.$toasted.show("Successfully deleted"),e.onCancel()})).catch((function(e){})).finally((function(){e.isDeleting=!1}))}}},J=Object(w.a)(Z,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-card-title",[e._v("Execption Form")]),e._v(" "),a("v-card-text",[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{cols:"12"}},[a("v-select",{attrs:{items:e.scheduleNames,rules:[e.rules.required],"item-text":"name","item-value":"name",label:"Event name","persistent-hint":"","single-line":""},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),a("v-col",{attrs:{cols:"12"}},[a("v-slider",{attrs:{label:"Value",max:"100",min:"0","thumb-label":""},model:{value:e.formData.value,callback:function(t){e.$set(e.formData,"value",t)},expression:"formData.value"}})],1),e._v(" "),a("v-col",{attrs:{cols:"12"}},e._l(e.formData.dates,(function(t,n){return a("v-row",{key:n,attrs:{dense:""}},[a("v-col",{attrs:{cols:"5"}},[a("date-time-picker",{attrs:{rules:[e.rules.required,function(a){return e.startDateValidator(t,n)}],label:"Start Date"},model:{value:t.start,callback:function(a){e.$set(t,"start",a)},expression:"item.start"}})],1),e._v(" "),a("v-col",{attrs:{cols:"5"}},[a("date-time-picker",{attrs:{rules:[e.rules.required,function(a){return e.endDateValidator(t,n)}],label:"End Date"},model:{value:t.end,callback:function(a){e.$set(t,"end",a)},expression:"item.end"}})],1),e._v(" "),a("v-col",{attrs:{cols:"2"}},[a("tooltip-icon-button",{attrs:{disabled:e.formData.dates.length<=1,btnColor:"error",btnIcon:"mdi-delete",buttonSize:"medium",btnTooltip:"Remove Event Date",onClick:function(){return e.removeEvent(n)}}})],1),e._v(" "),a("v-col",{attrs:{cols:"12"}},[n===e.formData.dates.length-1?a("tooltip-icon-button",{attrs:{btnColor:"nubeGreen",btnIcon:"mdi-plus",buttonSize:"medium",btnTooltip:"Add Event Date",onClick:function(){return e.addNewEvent()}}}):e._e()],1)],1)})),1),e._v(" "),a("v-col",{attrs:{cols:"12"}},[a("p",{staticClass:"v-label text-left"},[e._v("Event Color")]),e._v(" "),a("v-color-picker",{attrs:{mode:"hexa"},model:{value:e.formData.color,callback:function(t){e.$set(e.formData,"color",t)},expression:"formData.color"}})],1)],1)],1)],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{text:""},on:{click:e.onCancel}},[e._v("Close")]),e._v(" "),e.isEdit?a("v-btn",{attrs:{color:"error",loading:e.isDeleting,text:""},on:{click:e.onDeleteItem}},[e._v("Delete")]):e._e(),e._v(" "),a("v-btn",{attrs:{color:"primary",loading:e.isSubmitting,text:""},on:{click:e.onSaveForm}},[e._v("Save")])],1)],1)}),[],!1,null,null,null).exports,X={createEventDialog:"createEventDialog",createWeeklyEventDialog:"createWeeklyEventDialog",createExceptionDialog:"createExceptionDialog",updateEventDialog:"updateEventDialog",updateWeeklyEventDialog:"updateWeeklyEventDialog",updateExceptionDialog:"updateExceptionDialog"},Q=$,ee={name:"calendar-view",data:function(){var e;return{type:"week",rules:{required:function(e){return!!e||"Required."}},types:["month","week","day"],mode:"stack",selectedItem:null,weekday:[0,1,2,3,4,5,6],weekdays:[{text:"Sun - Sat",value:[0,1,2,3,4,5,6]},{text:"Mon - Sun",value:[1,2,3,4,5,6,0]},{text:"Mon - Fri",value:[1,2,3,4,5]}],value:"",events:[],dialogNames:i()({},X),dialog:(e={},l()(e,X.createEventDialog,!1),l()(e,X.createWeeklyEventDialog,!1),l()(e,X.createExceptionDialog,!1),l()(e,X.updateEventDialog,!1),l()(e,X.updateWeeklyEventDialog,!1),l()(e,X.updateExceptionDialog,!1),e),formTypes:{events:"events",exception:"exception",weekly:"weekly"}}},computed:{timezone:function(){return this.config.timezone||M.b(this.$store.state.setting)}},props:["data","updateData","isLoadingCalendar","config"],components:{EventForm:q,WeeklyEventForm:B,CalendarExtraPanel:U,ExceptionEventForm:J},methods:{create:function(e,t){var a=j()(this.data);return a[t]||(a[t]={}),a[t][Object(v.generate)()]=i()({},e),this.updateData(a,this.config)},update:function(e,t,a){var n=j()(this.data);return n[t][a]=i()({},e),this.updateData(n,this.config)},onDelete:function(e,t){var a=j()(this.data);return delete a[e][t],this.updateData(a,this.config)},onSaveConfig:function(e){return this.updateData(this.data,e)},event:function(e){return{name:e.name,start:e.start,end:e.end,color:e.color,timed:e.timed}},getEvents:function(e){var t=e.start,a=e.end;return this.events=this.transformDataToView(this.data,{calendarStartDate:t,calendarEndDate:a}),this.events},getEventColor:function(e){return e.color},toggleDialog:function(e,t){e||debuggger,this.selectedItem=t,this.dialog[e]=!this.dialog[e],this.dialog[e]?this.selectedItem=t:this.selectedItem=null},closeDialog:function(e){this.dialog[e]=!1,this.selectedItem={}},rnd:function(e,t){return Math.floor((t-e+1)*Math.random())+e},transformDataToView:function(e,t){var a=this,n=t.calendarStartDate,i=t.calendarEndDate,r=e.events||{},o=e.weekly||{},s=e.exception||{},l=W(r),c=m()(o).map((function(e){return P(e,o[e],n,i,a.timezone)})).flat(),d=W(s,Q.EXCEPTION);return[].concat(u()(l),u()(c),u()(d))},getEventDataObject:function(e,t){var a=o()(this.data,e+"["+t+"]");return i()({},a,{id:t})},onEventClick:function(e){var t=e.event,a=t.id;switch(t.eventType){case Q.EVENT:this.toggleDialog(X.updateEventDialog,this.getEventDataObject(Q.EVENT,a));break;case Q.WEEKLY:this.toggleDialog(X.updateWeeklyEventDialog,this.getEventDataObject(Q.WEEKLY,a));break;case Q.EXCEPTION:this.toggleDialog(X.updateExceptionDialog,this.getEventDataObject(Q.EXCEPTION,a))}}}},te=Object(w.a)(ee,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"ma-2",attrs:{outlined:"",loading:e.isLoadingCalendar}},[a("v-toolbar",{attrs:{flat:"",dense:""}},[a("v-toolbar-title",[a("span",{staticClass:"subtitle-1"},[e._v("Calendar Schedule")])]),e._v(" "),a("v-spacer"),e._v(" "),a("span",{staticClass:"caption pr-3"},[e._v(e._s(e.timezone))]),e._v(" "),a("span",[a("v-btn",{staticClass:"mr-1 btn-height-22 white-text",attrs:{"x-small":"",color:"nubeAqua"},on:{click:function(){return e.toggleDialog(e.dialogNames.createEventDialog)}}},[a("span",[e._v("Event")]),e._v(" "),a("v-icon",{attrs:{"x-small":"",right:""}},[e._v(" mdi-plus")])],1),e._v(" "),a("v-btn",{staticClass:"mr-1 btn-height-22 white-text",attrs:{"x-small":"",color:"nubeAqua"},on:{click:function(){return e.toggleDialog(e.dialogNames.createWeeklyEventDialog)}}},[a("span",[e._v("Weekly")]),e._v(" "),a("v-icon",{attrs:{"x-small":"",right:""}},[e._v(" mdi-plus")])],1),e._v(" "),a("v-btn",{staticClass:"mr-1 btn-height-22 white-text",attrs:{"x-small":"",color:"nubeAqua"},on:{click:function(){return e.toggleDialog(e.dialogNames.createExceptionDialog)}}},[a("span",[e._v("Exception")]),e._v(" "),a("v-icon",{attrs:{"x-small":"",right:""}},[e._v(" mdi-plus")])],1),e._v(" "),a("calendar-extra-panel",{attrs:{scheduleNames:e.config.names,timezone:e.config.timezone,onSubmit:e.onSaveConfig}})],1)],1),e._v(" "),a("v-sheet",{staticClass:"d-flex",attrs:{tile:"",height:"54"}},[a("v-btn",{staticClass:"ma-2",attrs:{icon:""},on:{click:function(t){return e.$refs.calendar.prev()}}},[a("v-icon",[e._v("mdi-chevron-left")])],1),e._v(" "),a("v-select",{staticClass:"ma-2",attrs:{items:e.types,dense:"",outlined:"","hide-details":"",label:"Type"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}}),e._v(" "),a("v-spacer"),e._v(" "),a("v-select",{staticClass:"ma-2",attrs:{items:e.weekdays,dense:"",outlined:"","hide-details":"",label:"Weekdays"},model:{value:e.weekday,callback:function(t){e.weekday=t},expression:"weekday"}}),e._v(" "),a("v-btn",{staticClass:"ma-2",attrs:{icon:""},on:{click:function(t){return e.$refs.calendar.next()}}},[a("v-icon",[e._v("mdi-chevron-right")])],1)],1),e._v(" "),a("v-sheet",{attrs:{height:"600"}},[a("v-calendar",{ref:"calendar",attrs:{type:e.type,events:e.events,weekdays:e.weekday,"event-overlap-mode":e.mode,"event-overlap-threshold":30,"event-color":e.getEventColor},on:{"click:event":e.onEventClick,change:e.getEvents},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:e.dialog[e.dialogNames.createEventDialog],callback:function(t){e.$set(e.dialog,e.dialogNames.createEventDialog,t)},expression:"dialog[dialogNames.createEventDialog]"}},[e.dialog[e.dialogNames.createEventDialog]?a("event-form",{attrs:{isEdit:!1,config:e.config,timezone:e.timezone,onCancel:function(){return e.closeDialog(e.dialogNames.createEventDialog)},onSave:function(t){return e.create(t,e.formTypes.events)}}}):e._e()],1),e._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:e.dialog[e.dialogNames.createWeeklyEventDialog],callback:function(t){e.$set(e.dialog,e.dialogNames.createWeeklyEventDialog,t)},expression:"dialog[dialogNames.createWeeklyEventDialog]"}},[e.dialog[e.dialogNames.createWeeklyEventDialog]?a("weekly-event-form",{attrs:{isEdit:!1,config:e.config,timezone:e.timezone,onCancel:function(){return e.closeDialog(e.dialogNames.createWeeklyEventDialog)},onSave:function(t){return e.create(t,e.formTypes.weekly)}}}):e._e()],1),e._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:e.dialog[e.dialogNames.createExceptionDialog],callback:function(t){e.$set(e.dialog,e.dialogNames.createExceptionDialog,t)},expression:"dialog[dialogNames.createExceptionDialog]"}},[e.dialog[e.dialogNames.createExceptionDialog]?a("exception-event-form",{attrs:{isEdit:!1,config:e.config,timezone:e.timezone,onCancel:function(){return e.closeDialog(e.dialogNames.createExceptionDialog)},onSave:function(t){return e.create(t,e.formTypes.exception)}}}):e._e()],1),e._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:e.dialog[e.dialogNames.updateEventDialog],callback:function(t){e.$set(e.dialog,e.dialogNames.updateEventDialog,t)},expression:"dialog[dialogNames.updateEventDialog]"}},[e.dialog[e.dialogNames.updateEventDialog]?a("event-form",{attrs:{isEdit:!0,config:e.config,item:e.selectedItem,onDelete:function(t){return e.onDelete(e.formTypes.events,t)},timezone:e.timezone,onCancel:function(){return e.closeDialog(e.dialogNames.updateEventDialog)},onSave:function(t,a){return e.update(t,e.formTypes.events,a)}}}):e._e()],1),e._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:e.dialog[e.dialogNames.updateWeeklyEventDialog],callback:function(t){e.$set(e.dialog,e.dialogNames.updateWeeklyEventDialog,t)},expression:"dialog[dialogNames.updateWeeklyEventDialog]"}},[e.dialog[e.dialogNames.updateWeeklyEventDialog]?a("weekly-event-form",{attrs:{isEdit:!0,config:e.config,timezone:e.timezone,item:e.selectedItem,onDelete:function(t){return e.onDelete(e.formTypes.weekly,t)},onCancel:function(){return e.closeDialog(e.dialogNames.updateWeeklyEventDialog)},onSave:function(t,a){return e.update(t,e.formTypes.weekly,a)}}}):e._e()],1),e._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:e.dialog[e.dialogNames.updateExceptionDialog],callback:function(t){e.$set(e.dialog,e.dialogNames.updateExceptionDialog,t)},expression:"dialog[dialogNames.updateExceptionDialog]"}},[e.dialog[e.dialogNames.updateExceptionDialog]?a("exception-event-form",{attrs:{isEdit:!0,config:e.config,item:e.selectedItem,timezone:e.timezone,onDelete:function(t){return e.onDelete(e.formTypes.exception,t)},onCancel:function(){return e.closeDialog(e.dialogNames.updateExceptionDialog)},onSave:function(t,a){return e.update(t,e.formTypes.exception,a)}}}):e._e()],1)],1)}),[],!1,null,null,null).exports,ae=a("L9C3"),ne={name:"rf-writer-form",props:["isEdit","onCancel","onSave","item","isSaving","consumerId","producerThingClass","allPoints","schedules"],data:function(){return{rules:{required:function(e){return!!e||"Required."},numberRule:function(e){return!isNaN(parseFloat(e))||"Required."}},valid:!1,formValues:i()({},{writer_thing_class:null,writer_thing_type:null,writer_thing_uuid:null,consumer_uuid:null}),thingTypes:ae.c,thingActions:ae.b}},computed:{lowerCaseTitle:function(){return"writer"},titleCase:function(){return"Writer"},title:function(){return this.isEdit?"Edit "+this.titleCase:"Create "+this.titleCase},saveTitle:function(){return this.isEdit?"Save":"Create"}},mounted:function(){this.isEdit&&this.item&&(this.formValues=i()({},this.formValues,this.item)),!this.isEdit&&this.consumerId&&(this.formValues=i()({},this.formValues,{writer_thing_class:this.producerThingClass,consumer_uuid:this.consumerId}))},methods:{cleanUp:function(){this.formValues={},"function"==typeof this.onCancel&&this.onCancel()},onSubmit:function(){var e=this;if(this.$refs.form.validate()){if("function"!=typeof this.onSave)throw new Error(this.lowerCaseTitle+" form onSave function not passed");return this.onSave(this.formValues).then((function(){e.$toasted.show("Successfully "+(e.isEdit?"updated":"created")+" "+e.lowerCaseTitle+"."),e.cleanUp(!0)})).catch((function(){e.$toasted.show("Failed to "+(e.isEdit?"update":"create")+" "+e.lowerCaseTitle+".",{type:"error"})}))}}}},ie=Object(w.a)(ne,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v(e._s(e.title))])]),e._v(" "),a("v-card-text",[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{cols:"12"}},[a("v-select",{attrs:{label:"Thing Class","item-value":"name",disabled:!0,items:e.thingTypes,"item-text":"displayName"},model:{value:e.formValues.writer_thing_class,callback:function(t){e.$set(e.formValues,"writer_thing_class",t)},expression:"formValues.writer_thing_class"}})],1),e._v(" "),"point"===e.formValues.writer_thing_class?a("v-col",{attrs:{cols:"12"}},[a("v-autocomplete",{attrs:{chips:"",clearable:"","small-chips":"",label:"Point","item-value":"uuid","item-text":"displayName",items:e.allPoints,loading:e.isFetchingAllDevices,rules:[e.rules.required],"deletable-chips":""},model:{value:e.formValues.writer_thing_uuid,callback:function(t){e.$set(e.formValues,"writer_thing_uuid",t)},expression:"formValues.writer_thing_uuid"}})],1):e._e(),e._v(" "),"schedule"===e.formValues.writer_thing_class?a("v-col",{attrs:{cols:"12"}},[a("v-autocomplete",{attrs:{chips:"",clearable:"","small-chips":"",label:"Scheulde","item-value":"uuid","item-text":"name",items:e.schedules,loading:e.isFetchingSchedules,rules:[e.rules.required],"deletable-chips":""},model:{value:e.formValues.writer_thing_uuid,callback:function(t){e.$set(e.formValues,"writer_thing_uuid",t)},expression:"formValues.writer_thing_uuid"}})],1):e._e()],1)],1)],1),e._v(" "),a("v-spacer"),e._v(" "),a("v-card-actions",{staticClass:"align-end justify-end"},[a("v-btn",{attrs:{color:"darken-1",text:""},on:{click:e.onCancel}},[e._v(" Cancel ")]),e._v(" "),a("v-btn",{attrs:{color:"blue darken-1",loading:e.isSaving,text:""},on:{click:function(t){return e.onSubmit(e.formValues)}}},[e._v(" "+e._s(e.saveTitle)+" ")])],1)],1)}),[],!1,null,null,null).exports,re=a("CfmX"),oe=a("97BG"),se=a("TZD0"),le={WRITE:"write",READ:"read"},ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.action,a=e.ask_refresh,n=e.priority,i=void 0===n?{}:n;return{action:t||le.WRITE,ask_refresh:void 0===a||a,priority:{_1:i._1||null,_2:i._2||null,_3:i._3||null,_4:i._4||null,_5:i._5||null,_6:i._6||null,_7:i._7||null,_8:i._8||null,_9:i._9||null,_10:i._10||null,_11:i._11||null,_12:i._12||null,_13:i._13||null,_14:i._14||null,_15:i._15||null,_16:i._16||null}}},ue={name:"rf-writer-actions-form",props:["onCancel","onSave","item"],data:function(){return{isSaving:!1,writerActions:h()(le),priorityList:["_1","_2","_3","_4","_5","_6","_7","_8","_9","_10","_11","_12","_13","_14","_15","_16"],rules:{required:function(e){return!!e||"Required."},numberRule:function(e){return!isNaN(parseFloat(e))||"Required."}},valid:!1,formValues:i()({},ce())}},computed:{lowerCaseTitle:function(){return"writer action"},titleCase:function(){return"Writer Actions"},title:function(){return this.isEdit?"Edit "+this.titleCase:"Create "+this.titleCase},saveTitle:function(){return this.isEdit?"Save":"Create"}},mounted:function(){this.item&&m()(this.item).length>0&&(this.formValues=ce({ask_refresh:this.item.ask_refresh,action:this.item.action,priority:this.item.data_store}))},methods:{cleanUp:function(){this.formValues=ce(),"function"==typeof this.onCancel&&this.onCancel()},transformFormValues:function(e){var t=j()(e);return t.priority=m()(t.priority).reduce((function(e,a){return t.priority[a]?e[a]=+t.priority[a]:e[a]=null,e}),{}),t},onSubmit:function(){var e=this;if(this.$refs.form.validate()){if("function"!=typeof this.onSave)throw new Error(this.lowerCaseTitle+" form onSave function not passed");return this.isSaving=!0,this.onSave(this.transformFormValues(this.formValues)).then((function(){e.$toasted.show("Successfully "+(e.isEdit?"updated":"created")+" "+e.lowerCaseTitle+".")})).catch((function(t){e.$toasted.show("Failed to "+(e.isEdit?"update":"create")+" "+e.lowerCaseTitle+".",{type:"error"})})).finally((function(){e.isSaving=!1}))}}}},de=Object(w.a)(ue,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v(e._s(e.title))])]),e._v(" "),a("v-card-text",[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{cols:"6"}},[a("v-select",{attrs:{label:"Action",items:e.writerActions},model:{value:e.formValues.action,callback:function(t){e.$set(e.formValues,"action",t)},expression:"formValues.action"}})],1),e._v(" "),a("v-col",{attrs:{cols:"1"}}),e._v(" "),a("v-col",{attrs:{cols:"5"}},[a("v-switch",{staticClass:"pr-4",attrs:{inset:"",label:"Ask Refresh",color:"primary"},model:{value:e.formValues.ask_refresh,callback:function(t){e.$set(e.formValues,"ask_refresh",t)},expression:"formValues.ask_refresh"}})],1),e._v(" "),a("v-row",{attrs:{dense:""}},[a("v-col",{staticClass:"text-left",attrs:{cols:"12"}},[a("span",{staticClass:"caption"},[e._v("Priority Array")])]),e._v(" "),e._l(e.priorityList,(function(t){return a("v-col",{key:t,attrs:{cols:"3"}},[e.formValues.priority?a("v-text-field",{attrs:{"single-line":"",dense:"",outlined:"",required:"",step:"0.01",type:"number",label:t},model:{value:e.formValues.priority[t],callback:function(a){e.$set(e.formValues.priority,t,a)},expression:"formValues.priority[priorityKey]"}}):e._e()],1)}))],2)],1)],1)],1),e._v(" "),a("v-spacer"),e._v(" "),a("v-card-actions",{staticClass:"align-end justify-end"},[a("v-btn",{attrs:{color:"darken-1",text:""},on:{click:e.onCancel}},[e._v(" Close ")]),e._v(" "),a("v-btn",{attrs:{color:"blue darken-1",loading:e.isSaving,text:""},on:{click:function(t){return e.onSubmit(e.formValues)}}},[e._v("\n      Send "),a("v-icon",[e._v("mdi-send")])],1)],1)],1)}),[],!1,null,null,null).exports,me=a("qhTB"),ve={writerActionDialog:"writerActionDialog",scheduleActionDialog:"scheduleActionDialog"},fe={name:"rf-writers-grid",components:{GenericGrid:re.a,WritersForm:ie,TooltipIconButton:x.a,WriterActionsForm:de,CalendarView:te},props:["params","getDataCb","allPoints","schedules","producerThingClass"],data:function(){var e;return{renderCalendarView:0,selectedItem:{},selectedCalendarConfig:{},selectedCalendarData:null,isLoadingCalendar:!1,calendarData:{},syncGrid:function(e){return e},dialogNames:i()({},ve),dialog:(e={},l()(e,ve.writerActionDialog,!1),l()(e,ve.scheduleActionDialog,!1),e),gridName:oe.p,service:se.a,toolbarTitle:"Writers",gridHeaders:[{text:"Thing class",align:"center",value:"writer_thing_class",sortable:!0},{text:"Thing type",align:"center",value:"writer_thing_type",sortable:!0},{text:"Actions",align:"center",value:"actions",sortable:!0}]}},computed:{consumerId:function(){return this.$route.params.consumerId},consumer:function(){return{uuid:this.params.uuid}}},methods:{toggleDialog:function(e,t,a){this.selectedItem=t,this.syncGrid=a,this.dialog[e]=!this.dialog[e],this.dialog[e]?this.selectedItem=t:this.selectedItem=null},closeDialog:function(e){this.dialog[e]=!1,this.selectedItem={}},onAssignWriteAction:function(e){var t=this,a=this.selectedItem.uuid;return me.b(a,e).then((function(e){return"function"==typeof t.syncGrid&&t.syncGrid(),e}))},onExpandClick:function(e){var t=e.expand,a=e.isExpanded,n=e.item,i=!a;t(i),i?(this.selectedItem=n,this.fetchCalendarData()):this.selectedCalendarData=null},updateCalendarView:function(e,t,a){var n=this;return me.a(e,t,a).then((function(e){return n.fetchCalendarData(),e}))},fetchCalendarData:function(){var e=this,t=this.selectedItem.uuid;return this.isLoadingCalendar=!0,se.a.fetchById(t).then((function(a){var n=a&&a.data_store&&a.data_store.schedules||{},r=a&&a.data_store&&a.data_store.config||{};return e.calendarData[t]=i()({},n),e.selectedCalendarConfig=i()({},r),e.selectedCalendarData=i()({},n),e.renderCalendarView++,a})).finally((function(){e.isLoadingCalendar=!1}))}}},he=Object(w.a)(fe,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("generic-grid",{attrs:{params:e.params,service:e.service,gridName:e.gridName,isHeaderConfigurable:!0,headers:e.gridHeaders,toolbarTitle:e.toolbarTitle,showExpand:!0,getDataCb:e.getDataCb,singleExpand:!0},scopedSlots:e._u([{key:"createForm",fn:function(t){var n=t.onSave,i=t.onClose,r=t.isOpen,o=t.isSaving;return[r?a("writers-form",{attrs:{isEdit:!1,onSave:n,onCancel:i,isSaving:o,allPoints:e.allPoints,schedules:e.schedules,consumerId:e.consumerId,producerThingClass:e.producerThingClass}}):e._e()]}},{key:"editForm",fn:function(t){var n=t.onSave,i=t.item,r=t.onClose,o=t.isOpen,s=t.isSaving;return[o?a("writers-form",{attrs:{item:i,isEdit:!0,onSave:n,onCancel:r,isSaving:s,schedules:e.schedules,allPoints:e.allPoints,consumerId:e.consumerId,producerThingClass:e.producerThingClass}}):e._e()]}},{key:"afterActions",fn:function(t){var n=t.item,i=t.refreshGrid;return["point"===n.item.writer_thing_class?a("tooltip-icon-button",{attrs:{btnTooltip:"Assign Point Action",btnIcon:"mdi-yelp",btnColor:"orange",onClick:function(){return e.toggleDialog(e.dialogNames.writerActionDialog,n.item,i)}}}):e._e()]}},{key:"expansionIcon",fn:function(t){var n=t.expand,i=t.isExpanded,r=t.item;return["schedule"===r.writer_thing_class?a("tooltip-icon-button",{attrs:{btnTooltip:"Assign Schedule Action",btnIcon:"mdi-calendar",btnColor:"orange",buttonSize:"medium",onClick:function(){return e.onExpandClick({expand:n,isExpanded:i,item:r})}}}):e._e()]}},{key:"expansionView",fn:function(t){t.headers;var n=t.item;return[a("div",[!e.selectedCalendarData&&e.isLoadingCalendar?a("v-progress-circular",{attrs:{size:"20",indeterminate:""}}):e._e(),e._v(" "),e.selectedCalendarData?a("calendar-view",{key:e.renderCalendarView,attrs:{data:e.selectedCalendarData,config:e.selectedCalendarConfig,isLoadingCalendar:e.isLoadingCalendar,updateData:function(t,a){return e.updateCalendarView(n.uuid,t,a)}}}):e._e()],1)]}}])}),e._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:e.dialog[e.dialogNames.writerActionDialog],callback:function(t){e.$set(e.dialog,e.dialogNames.writerActionDialog,t)},expression:"dialog[dialogNames.writerActionDialog]"}},[e.dialog[e.dialogNames.writerActionDialog]?a("writer-actions-form",{attrs:{onCancel:function(){return e.closeDialog(e.dialogNames.writerActionDialog)},item:e.selectedItem,onSave:e.onAssignWriteAction}}):e._e()],1)],1)}),[],!1,null,null,null).exports,pe=a("oGAK"),ge=a("2SyR"),_e=a("VNy9"),be=a("wffz"),De=a("vJYM"),ye=a("0TWu"),we={name:"writers",data:function(){return{params:{uuid:null,with_writers:!0},renderCount:0,producerThingClass:null,gridData:{},breadcrumbItems:[],schedules:[],allPoints:[]}},components:{IconButton:ge.a,WritersGrid:he,Breadcrumbs:_e.a,TooltipIconButton:x.a},mounted:function(){this.initialize(),this.fetchSchedules(),this.fetchAllPoint()},watch:{"$route.params.consumerId":function(e,t){e!=t&&(this.renderCount++,this.initialize())}},methods:{initialize:function(){this.params=i()({},this.params,{uuid:this.$route.params.consumerId}),this.updateBreadCrumbs()},fetchSchedules:function(){var e=this;De.a.fetch().then((function(t){return e.schedules=t,t}))},fetchAllPoint:function(){var e=this;be.a.fetch({with_points:!0}).then((function(t){return e.allPoints=ye.a(t),t}))},onBack:function(){this.$router.go(-1)},getDataCb:function(e){this.gridData=e,this.producerThingClass=o()(this.gridData,"extraData.producer_thing_class",null)},updateBreadCrumbs:function(){this.breadcrumbItems=[],this.breadcrumbItems.push({text:"Flow Network Clone",align:"center",disabled:!1,link:pe.a.rfFlowNetworkClone}),this.breadcrumbItems.push({text:this.$route.params.flowNetworkId,align:"center",disabled:!1}),this.breadcrumbItems.push({text:"Streams Clone",align:"center",disabled:!0,link:pe.a.rfFlowNetworkStreamsClone.replace(":flowNetworkId",this.$route.params.flowNetworkId)}),this.breadcrumbItems.push({text:this.$route.params.streamId,align:"center",disabled:!1}),this.breadcrumbItems.push({text:"Consumers",align:"center",disabled:!1,link:pe.a.rfFlowNetworkCloneConsumers.replace(":flowNetworkId",this.$route.params.flowNetworkId).replace(":streamId",this.$route.params.streamId)}),this.breadcrumbItems.push({text:this.$route.params.consumerId,align:"center",disabled:!1}),this.breadcrumbItems.push({text:"Writer",align:"center",disabled:!0})}}},ke=Object(w.a)(we,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{key:e.renderCount,attrs:{outlined:""}},[a("v-card-title",[a("v-btn",{staticClass:"mr-1",attrs:{icon:"",medium:""},on:{click:e.onBack}},[a("v-icon",{attrs:{medium:""}},[e._v(" mdi-arrow-left ")])],1),e._v("\n    Writers\n  ")],1),e._v(" "),a("v-card-text",[a("breadcrumbs",{attrs:{items:e.breadcrumbItems}}),e._v(" "),a("v-row",{attrs:{"no-gutter":""}},[a("v-col",{attrs:{cols:"12",lg:"12",xl:"12",md:"12",sm:"12",xs:"12"}},[e.params.uuid?a("writers-grid",{attrs:{params:e.params,getDataCb:e.getDataCb,allPoints:e.allPoints,schedules:e.schedules,producerThingClass:e.producerThingClass}}):e._e()],1)],1)],1)],1)}),[],!1,null,null,null);t.default=ke.exports},DeKB:function(e,t,a){"use strict";var n=a("Zv/C"),i=a.n(n),r=a("uzYq"),o=a("NWgQ"),s=a.n(o),l=a("PWxN"),c=a.n(l),u=function(){var e=this;this.uri="",this.evaluateUri=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return"function"==typeof e.uri?e.uri(t):uri},this.fetch=function(t){var a=e.evaluateUri(),n=null;return t&&t.hasOwnProperty("id")?(n=t.id,t=c()(t,"id")):t&&t.hasOwnProperty("uuid")&&(n=t.uuid,t=c()(t,"uuid")),t&&(a=a+"?"+s.a.stringify(t)),n?e.fetchById(n,t):r.a.get(a)},this.fetchById=function(t,a){var n=e.evaluateUri(t);return a&&(n=n+"?"+s.a.stringify(a)),r.a.get(n)},this.remove=function(){var t=e.evaluateUri();return r.a.delete(t)},this.removeById=function(t){var a=e.evaluateUri(t);return r.a.delete(a)},this.create=function(t){var a=e.evaluateUri();return r.a.post(a,t)},this.patch=function(t,a){var n=e.evaluateUri(t);return r.a.patch(n,a)},this.update=function(t,a){var n=e.evaluateUri(t);return r.a.put(n,a)}};t.a=function e(t){i()(this,e),u.call(this),this.uri=t}},L9C3:function(e,t,a){"use strict";a.d(t,"a",(function(){return h})),a.d(t,"c",(function(){return g})),a.d(t,"b",(function(){return _}));var n,i=a("TcPG"),r=a.n(i),o="api",s="point",l="point_filter",c="internal_api",u="external_api",d="schedule",m="global_schedule",v="alert",f="mapping",h=(n={},r()(n,o,{displayName:"API",name:o,value:o}),r()(n,s,{displayName:"Point",name:s,value:s}),r()(n,l,{displayName:"Point Filter",name:l,value:s}),r()(n,c,{displayName:"InternalAPI",name:c,value:c}),r()(n,u,{displayName:"ExternalAPI",name:u,value:u}),r()(n,d,{displayName:"Schedule",name:d,value:d}),r()(n,m,{displayName:"GlobalSchedule",name:m,value:m}),r()(n,v,{displayName:"Alert",name:v}),n),p=r()({},f,{displayName:"Mapping",name:f}),g=[h.point,h.schedule],_=[p.mapping]},TZD0:function(e,t,a){"use strict";a.d(t,"a",(function(){return w}));var n=a("tZmG"),i=a.n(n),r=a("YUSd"),o=a.n(r),s=a("Zv/C"),l=a.n(s),c=a("2lBV"),u=a.n(c),d=a("Dkg+"),m=a.n(d),v=a("Gjrs"),f=a.n(v),h=a("DeKB"),p=a("oCli"),g=a("uzYq"),_=a("PWxN"),b=a.n(_),D=a("NWgQ"),y=a.n(D),w=new(function(e){function t(){l()(this,t);var e=m()(this,(t.__proto__||o()(t)).call(this,p.a.rfWriters));return e.fetch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.uuid||e.id;if(!t)throw new Error("Consumer Id is required for fetching writers of consumers");var a=p.a.rfConsumers(t);return(e=b()(e,["uuid","id"]))&&i()(e).length>0&&(a=a+"?"+y.a.stringify(e)),g.a.get(a).then((function(e){return{dataItems:e.writers,extraData:b()(e,["writers"])}}))},e.createWriter=function(t){var a=e.evaluateUri()+"/wizard";return g.a.post(a,t)},e}return f()(t,e),u()(t,[{key:"fetchAll",value:function(){var e=p.a.rfWriters();return g.a.get(e)}}]),t}(h.a))},VNy9:function(e,t,a){"use strict";var n={name:"breadcrumbs",props:["items"]},i=a("psIG"),r=Object(i.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-breadcrumbs",{staticClass:"breadcrumbs",attrs:{items:e.items},scopedSlots:e._u([{key:"item",fn:function(t){var n=t.item;return[a("v-breadcrumbs-item",{staticClass:"breadcrumbs-item-text",attrs:{to:n.link,exact:""}},[e._v(" "+e._s(n.text)+" ")])]}}])})}),[],!1,null,"04244946",null);t.a=r.exports},oCli:function(e,t,a){"use strict";function n(e,t){return e?t+"/"+e:t}t.a={rfPing:function(e){return n(e,"rf-ping")},rfFNCStreams:function(e){return n(e,"rf-fnc")},rfCommands:function(e){return n(e,"/rf-commands")},rfLogin:function(e){return n(e,"/rf-login")},rfSchedules:function(e){return n(e,"/rf-schedules")},rfFlowNetwork:function(e){return n(e,"/rf-flow-network")},rfFlowNetworkClone:function(e){return n(e,"/rf-flow-network-clone")},rfJobs:function(e){return n(e,"/rf-jobs")},rfNetworks:function(e){return n(e,"/rf-networks")},rfPoints:function(e){return n(e,"/rf-points")},rfProducers:function(e){return n(e,"/rf-producers")},rfConsumers:function(e){return n(e,"/rf-consumers")},rfWriters:function(e){return n(e,"/rf-writers")},rfWriterClones:function(e){return n(e,"/rf-writer-clones")},rfStreams:function(e){return n(e,"/rf-streams")},rfStreamsClone:function(e){return n(e,"/rf-streams-clone")},rfDevices:function(e){return n(e,"/rf-devices")},rfWriterActions:function(e){return n(e,"/rf-writer-actions")}}},qhTB:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return o}));var n=a("uzYq"),i=a("oCli").a.rfWriterActions,r=function(e,t){var a=i(e);return n.a.post(a,t)},o=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=i(e),o={ask_refresh:!0,action:"write",schedule:{schedules:t,config:a}};return n.a.post(r,o)}},vJYM:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a("YUSd"),i=a.n(n),r=a("Zv/C"),o=a.n(r),s=a("Dkg+"),l=a.n(s),c=a("Gjrs"),u=a.n(c),d=a("oCli"),m=new(function(e){function t(){return o()(this,t),l()(this,(t.__proto__||i()(t)).call(this,d.a.rfSchedules))}return u()(t,e),t}(a("DeKB").a))},wffz:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("DeKB"),i=a("oCli"),r=new n.a(i.a.rfNetworks)}}]);
//# sourceMappingURL=22.5f581790609e550af904.js.map