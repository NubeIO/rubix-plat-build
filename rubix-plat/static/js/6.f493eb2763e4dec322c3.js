(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"+SqX":function(t,e,a){"use strict";var s={name:"page-title",props:["title"]},n=a("psIG"),i=Object(n.a)(s,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("h1",{staticClass:"text-h5 text-left py-3"},[t._v(t._s(t.title))])}),[],!1,null,null,null);e.a=i.exports},"/NG7":function(t,e,a){"use strict";a.r(e);var s=a("tZmG"),n=a.n(s),i=a("06Hw"),o=a.n(i),l=a("YYXh"),r=a.n(l),c=a("Kz1y"),p=a.n(c),u=a("TcPG"),d=a.n(u),v=a("mQ3e"),f=a.n(v),h=a("7Ipj"),m=a("nz6T"),_=a("A5Vd"),w={name:"app-edit-config",props:["appDetail","closeDialog"],data:function(){return{config:null,isFetchingConfig:!1,isSavingConfig:!1,isConfigJSON:!1}},mounted:function(){this.fetchAppConfig(),this.isConfigJSON=this.isJSON(this.appDetail.app_type)},methods:{isJSON:function(t){return _.b[t]===_.d},fetchAppConfig:function(){var t=this,e=this.appDetail.service,a=this.appDetail.app_type;this.isFetchingConfig=!0,m.l(e,a,{restrictToast:!0}).then((function(e){t.config=e})).catch((function(t){})).finally((function(){t.isFetchingConfig=!1}))},saveConfig:function(){var t=this,e=this.appDetail.service,a=this.appDetail.app_type;this.isSavingConfig=!0,m.t(e,a,this.config).then((function(e){t.$toasted.show("Successfully updated config for "+t.appDetail.display_name),t.closeDialog()})).catch((function(e){t.$toasted.show("Failed to update config for "+t.appDetail.display_name,{type:"error"})})).finally((function(){t.isSavingConfig=!1}))}}},g=a("psIG"),b=Object(g.a)(w,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{loading:t.isFetchingConfig}},[a("v-card-title",[t._v(t._s(t.appDetail.display_name)+" | Edit Config")]),t._v(" "),a("v-card-text",[a("v-container",[t.isConfigJSON?a("v-jsoneditor",{attrs:{options:{mode:"code"},plus:!1,height:"400px"},model:{value:t.config,callback:function(e){t.config=e},expression:"config"}}):t._e(),t._v(" "),t.isConfigJSON?t._e():a("v-textarea",{attrs:{outlined:"",name:"input-7-4",label:"Enter ENV config"},model:{value:t.config,callback:function(e){t.config=e},expression:"config"}})],1)],1),t._v(" "),a("v-card-actions",[a("v-btn",{attrs:{color:"primary",loading:t.isSavingConfig},on:{click:t.saveConfig}},[t._v(" Save ")]),t._v(" "),a("v-btn",{attrs:{text:""},on:{click:t.closeDialog}},[t._v(" Cancel ")])],1)],1)}),[],!1,null,"235af619",null).exports,D=a("MKDl"),S=a("7Vew");function C(t){return t.status&&_.a.RUBIX_PLAT!==t.service}var A={name:"apps-download-multi-step",props:["app-details","close-dialog","deleteDownloadState","currentDownloadState","fetchDownloadAppState","clearDownloadAppStateInterval"],components:{AppStatusChip:D.a,TextFieldDisplay:S.a},data:function(){return{valid:!1,currentView:1,appReleases:[],serviceStatus:{},isFetchingAppStatus:!1,selectedVersion:null,multiStepViewConfig:{1:{back:1,forward:2,title:"App Status",hasBack:!1,disabled:!1,hasForward:!0,buttonLabel:function(t){return C(t)?"Stop":"Continue"},loader:!1},2:{back:1,forward:3,title:"Download App",hasBack:!0,disabled:!1,hasForward:!0,buttonLabel:"Download",loader:!1},3:{back:2,forward:4,title:"Install App",hasBack:!0,hasForward:!0,buttonLabel:"Install",loader:!1,disabled:!1},4:{back:3,forward:4,title:"Installation Complete",hasBack:!0,hasForward:!0,buttonLabel:"Ok",loader:!1,disabled:!1}},loading:!0,rules:{required:function(t){return!!t||"Required."}},versionRules:[function(t){return!!t||"Version No. is required."}]}},mounted:function(){var t=this;return r()(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.appDetails.service,t.loading=!0,e.next=4,t.fetchAppStatus();case 4:return e.next=6,m.m(a).then((function(e){t.appReleases=e,t.loading=!1})).catch((function(t){console.error(t)})).finally((function(){t.loading=!1}));case 6:case"end":return e.stop()}}),e,t)})))()},updated:function(){this.currentDownloadState!==_.c.DOWNLOAD_IN_PROGRESS&&this.currentDownloadState?this.multiStepViewConfig[3].disabled=!1:this.multiStepViewConfig[3].disabled=!0},watch:{currentDownloadState:function(t,e){this.showDownloadStateView(t)}},methods:{showDownloadStateView:function(t){switch(t){case _.c.DOWNLOAD_IN_PROGRESS:this.currentView=3;break;case _.c.DOWNLOAD_COMPLETE:this.currentView=3,this.clearDownloadAppStateInterval()}},back:function(){this.currentView=this.currentView-1},cancel:function(){3!==this.currentView&&2!==this.currentView||this.deleteDownloadState(),this.closeDialog(!0)},next:function(t){var e=this;return r()(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.currentView,t.t0=a,t.next=1===t.t0?4:2===t.t0?6:3===t.t0?8:4===t.t0?10:12;break;case 4:return e.stopAndContinue(),t.abrupt("break",14);case 6:return e.download(),t.abrupt("break",14);case 8:return e.install(),t.abrupt("break",14);case 10:return e.continue(),t.abrupt("break",14);case 12:return e.currentView++,t.abrupt("break",14);case 14:case"end":return t.stop()}}),t,e)})))()},stopAndContinue:function(){var t=this,e=(this.serviceStatus.status,this.serviceStatus.service);C(this.serviceStatus)?(this.spinLoader(!0),m.c(_.f.STOP,e).then((function(e){return t.spinLoader(!1),t.currentView++,t.fetchAppStatus()})).catch((function(e){t.spinLoader(!1)}))):this.currentView++},continue:function(){this.closeDialog(!0)},spinLoader:function(t){this.multiStepViewConfig[this.currentView].loader=t},download:function(){var t=this;return r()(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$refs.downloadForm.validate()){e.next=3;break}return e.abrupt("return");case 3:t.spinLoader(!0),a={service:t.appDetails.service,version:t.selectedVersion},m.h(a).then((function(e){t.currentView=3,t.fetchDownloadAppState(),t.spinLoader(!1)})).catch((function(e){e&&e.message&&(t.versionRules.push((function(){return e.message})),t.$refs.downloadForm.validate(),t.versionRules.pop()),t.spinLoader(!1)}));case 6:case"end":return e.stop()}}),e,t)})))()},install:function(){var t=this;this.spinLoader(!0);var e={service:this.appDetails.service,version:this.selectedVersion};m.s(e).then((function(e){t.spinLoader(!1),t.fetchAppStatus(),t.currentView++})).catch((function(e){t.spinLoader(!1),t.currentView--,e&&e.message&&(t.versionRules.push((function(){return e.message})),t.$refs.downloadForm.validate(),t.versionRules.pop())})).finally((function(){t.deleteDownloadState()}))},fetchAppStatus:function(){var t=this;return this.isFetchingAppStatus=!0,m.n(this.appDetails.service,{restrictToast:!0}).then((function(e){t.selectedVersion=e.version,t.serviceStatus=e})).catch((function(e){t.selectedVersion=null,t.serviceStatus={}})).finally((function(){t.isFetchingAppStatus=!1}))}}},x=Object(g.a)(A,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{loading:t.isFetchingAppStatus}},[a("v-card-title",[t.multiStepViewConfig[t.currentView].hasBack?a("v-btn",{staticClass:"white--text mr-1",attrs:{icon:"",medium:""},on:{click:t.back}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-arrow-left ")])],1):t._e(),t._v(" "),a("span",{staticClass:"headline"},[t._v(t._s(t.multiStepViewConfig[t.currentView].title))])],1),t._v(" "),a("v-card-text",[a("v-stepper",{model:{value:t.currentView,callback:function(e){t.currentView=e},expression:"currentView"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:t.currentView>1,step:"1"}},[t._v(" 1 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>2,step:"2"}},[t._v(" 2 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>3,step:"3"}},[t._v(" 3 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{step:"4"}},[t._v(" 4 ")])],1),t._v(" "),a("v-stepper-items",[a("v-stepper-content",{attrs:{step:"1"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Name",value:t.appDetails.display_name}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[a("text-field-display",{attrs:{label:"Active",value:(!t.isFetchingAppStatus&&t.serviceStatus.time_since?t.serviceStatus.time_since:"-")||"N/A"}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[a("app-status-chip",{attrs:{state:t.serviceStatus.state}})],1),t._v(" "),a("v-col",{staticClass:"text-right",attrs:{cols:"1"}},[a("v-btn",{staticClass:"white--text",attrs:{icon:"",medium:"",color:"success"},on:{click:t.fetchAppStatus}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-refresh ")])],1)],1)],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Version",value:!t.isFetchingAppStatus&&t.serviceStatus.version?t.serviceStatus.version:"-"}})],1)],1)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{ref:"downloadForm",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Name",value:t.appDetails.display_name}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[a("text-field-display",{attrs:{label:"Active",value:(!t.isFetchingAppStatus&&t.serviceStatus.time_since?t.serviceStatus.time_since:"-")||"N/A"}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[a("app-status-chip",{attrs:{state:t.serviceStatus.state}})],1),t._v(" "),a("v-col",{staticClass:"text-right",attrs:{cols:"1"}},[a("v-btn",{staticClass:"white--text",attrs:{icon:"",medium:"",color:"success"},on:{click:t.fetchAppStatus}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-refresh ")])],1)],1)],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Version",value:!t.isFetchingAppStatus&&t.serviceStatus.version?t.serviceStatus.version:"-"}})],1)],1),t._v(" "),a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-combobox",{attrs:{loading:t.loading,items:t.appReleases,label:"Select Release Version",hideSelected:"",clearable:"","item-text":"name","item-value":"tag_name",rules:t.versionRules},model:{value:t.selectedVersion,callback:function(e){t.selectedVersion=e},expression:"selectedVersion"}})],1)],1)],1)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"3"}},[a("div",{staticClass:"text-left"},[t.currentDownloadState?t._e():a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n              Fetching download status "),a("strong",[t._v("Please Wait!")])]),t._v(" "),"DOWNLOAD_IN_PROGRESS"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n              Downloading Selected App "),a("strong",[t._v("Please Wait!")])]):t._e(),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"success"}},[t._v("\n              Downloading Completed\n            ")]):t._e()],1),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("div",{staticClass:"pt-3"},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"6"}},[a("div",{staticClass:"grey--text mb-2 caption"},[t._v("Name")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                  "+t._s(t.appDetails.display_name+" - "+t.appDetails.service)+"\n                ")])]),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text mb-2 caption"},[t._v("Version")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                  "+t._s(t.isFetchingAppStatus?"-":t.selectedVersion)+"\n                ")])])],1)],1):t._e()]),t._v(" "),a("v-stepper-content",{attrs:{step:"4"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"12"}},[a("div",{staticClass:"font-weight-large"},[t._v("Successfully installed "+t._s(t.appDetails.display_name)+" app.")])])],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text caption mb-2"},[t._v("Name")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.appDetails.display_name)+"\n              ")])]),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text caption mb-2"},[a("span",[t._v("Version")])]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.selectedVersion)+"\n              ")])])],1)],1)],1)],1)],1),t._v(" "),a("v-card-actions",[t.multiStepViewConfig[t.currentView].hasForward?a("v-btn",{attrs:{color:"primary",disabled:t.multiStepViewConfig[t.currentView].disabled,loading:t.multiStepViewConfig[t.currentView].loader},on:{click:t.next}},[t._v("\n      "+t._s("function"==typeof t.multiStepViewConfig[t.currentView].buttonLabel?t.multiStepViewConfig[t.currentView].buttonLabel(t.serviceStatus):t.multiStepViewConfig[t.currentView].buttonLabel)+"\n    ")]):t._e(),t._v(" "),a("v-btn",{attrs:{text:""},on:{click:t.cancel}},[t._v(" Cancel ")])],1)],1)}),[],!1,null,null,null).exports,k=a("OKta");function y(t){return t.status&&_.a.RUBIX_PLAT!==t.service}var I,V={name:"apps-upload-multi-step",props:["app-details","close-dialog"],components:{AppStatusChip:D.a,TextFieldDisplay:S.a,RbxButton:k.a},data:function(){return{isDeleteAppData:!1,isDeletingAppData:!1,valid:!1,currentView:1,version:null,serviceStatus:{},isFetchingAppStatus:!1,isStartingApp:!1,errorMessage:"",file:null,rubixAppTypes:_.g,multiStepViewConfig:{1:{back:1,forward:2,title:function(t){return t+" | App Status"},hasBack:!1,hasForward:!0,buttonLabel:function(t){return y(t)?"Stop":"Continue"},loader:!1},2:{back:1,forward:3,title:function(t){return t+" | Upload App"},hasBack:!0,hasForward:!0,buttonLabel:"Upload",loader:!1},3:{back:2,forward:4,title:function(t){return t+" | Install App"},hasBack:!0,hasForward:!0,buttonLabel:"Install",loader:!1},4:{back:3,forward:4,title:function(t){return t+" | Installation Complete"},hasBack:!0,hasForward:!0,buttonLabel:"Ok",loader:!1}},loading:!0,rules:{required:function(t){return!!t||"Required."}},versionRules:[function(t){return!!t||"Version No. is required."}]}},mounted:function(){var t=this;return r()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchAppStatus();case 2:case"end":return e.stop()}}),e,t)})))()},methods:{back:function(){this.currentView=this.currentView-1},cancel:function(){this.closeDialog(!0)},next:function(t){var e=this;return r()(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.currentView,t.t0=a,t.next=1===t.t0?4:2===t.t0?6:3===t.t0?8:4===t.t0?10:12;break;case 4:return e.stopAndContinue(),t.abrupt("break",14);case 6:return e.upload(),t.abrupt("break",14);case 8:return e.install(),t.abrupt("break",14);case 10:return e.continue(),t.abrupt("break",14);case 12:return e.currentView++,t.abrupt("break",14);case 14:case"end":return t.stop()}}),t,e)})))()},stopAndContinue:function(){var t=this,e=(this.serviceStatus.status,this.serviceStatus.service);y(this.serviceStatus)?(this.spinLoader(!0),m.c(_.f.STOP,e).then((function(e){return t.spinLoader(!1),t.currentView++,t.fetchAppStatus()})).catch((function(e){t.spinLoader(!1)}))):this.currentView++},startApp:function(){var t=this,e=this.serviceStatus.service;this.isStartingApp=!0,m.c(_.f.START,e).then((function(a){return t.$toasted.show("Successfully started "+e),t.continue(),t.fetchAppStatus()})).catch((function(a){t.$toasted.show("Could not start "+e,{type:"error"})})).finally((function(){t.isStartingApp=!1}))},continue:function(){this.closeDialog(!0)},spinLoader:function(t){this.multiStepViewConfig[this.currentView].loader=t},upload:function(){var t=this;this.$refs.uploadForm.validate()&&(this.spinLoader(!0),m.v(this.file,this.appDetails.service,this.version).then((function(e){t.currentView++})).catch((function(e){e&&e.message&&(t.errorMessage=e.message)})).finally((function(){t.spinLoader(!1)})))},install:function(){var t=this;this.spinLoader(!0);var e={service:this.appDetails.service,version:this.version};m.s(e).then((function(e){t.spinLoader(!1),t.fetchAppStatus(),t.currentView++,t.errorMessage=""})).catch((function(e){t.spinLoader(!1),y(t.serviceStatus)?t.currentView--:t.currentView++,e&&e.message&&y(t.serviceStatus)&&(t.errorMessage=e.message)}))},fetchAppStatus:function(){var t=this;return this.isFetchingAppStatus=!0,m.n(this.appDetails.service,{restrictToast:!0}).then((function(e){t.serviceStatus=e})).catch((function(e){t.serviceStatus={}})).finally((function(){t.isFetchingAppStatus=!1}))},onFileSelect:function(){if(this.file&&this.file.name){var t=this.file.name,e=new RegExp("[0-9].[0-9].[0-9]"),a=t.match(e,"");a&&Array.isArray(a)&&(a=a[0],this.version="v"+a)}},deleteAppData:function(){var t=this;this.isDeletingAppData=!0,m.e(this.serviceStatus.service).then((function(){t.$toasted.show("Successfully deleted app data"),t.isDeleteAppData=!1})).catch((function(){t.$toasted.show("Cannot deleted app data",{type:"error"})})).finally((function(){t.isDeletingAppData=!1}))},toggleDeleteAppData:function(){this.isDeleteAppData=!this.isDeleteAppData}}},N=Object(g.a)(V,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{loading:t.isFetchingAppStatus}},[a("v-card-title",[t.multiStepViewConfig[t.currentView].hasBack?a("v-btn",{staticClass:"white--text mr-1",attrs:{icon:"",medium:""},on:{click:t.back}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-arrow-left ")])],1):t._e(),t._v(" "),a("span",{staticClass:"sub-headline"},[t._v(t._s(t.multiStepViewConfig[t.currentView].title(t.appDetails.display_name)))])],1),t._v(" "),a("v-card-text",[a("v-stepper",{model:{value:t.currentView,callback:function(e){t.currentView=e},expression:"currentView"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:t.currentView>1,step:"1"}},[t._v(" 1 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>2,step:"2"}},[t._v(" 2 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>3,step:"3"}},[t._v(" 3 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{step:"4"}},[t._v(" 4 ")])],1),t._v(" "),a("v-stepper-items",[a("v-stepper-content",{attrs:{step:"1"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Name",value:t.appDetails.display_name}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"2"}},[a("text-field-display",{attrs:{label:"Active",value:(!t.isFetchingAppStatus&&t.serviceStatus.time_since?t.serviceStatus.time_since:"-")||"N/A"}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[t.isFetchingAppStatus?t._e():a("app-status-chip",{attrs:{state:t.serviceStatus.state}})],1),t._v(" "),a("v-col",{staticClass:"text-right",attrs:{cols:"1"}},[a("v-btn",{staticClass:"white--text",attrs:{icon:"",medium:"",color:"success"},on:{click:t.fetchAppStatus}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-refresh ")])],1)],1)],1)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{ref:"uploadForm",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Name",value:t.appDetails.display_name}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"2"}},[a("text-field-display",{attrs:{label:"Active",value:(!t.isFetchingAppStatus&&t.serviceStatus.time_since?t.serviceStatus.time_since:"-")||"N/A"}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[t.isFetchingAppStatus?t._e():a("app-status-chip",{attrs:{state:t.serviceStatus.state}})],1),t._v(" "),a("v-col",{staticClass:"text-right",attrs:{cols:"1"}},[a("v-btn",{staticClass:"white--text",attrs:{icon:"",medium:"",color:"success"},on:{click:t.fetchAppStatus}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-refresh ")])],1)],1)],1),t._v(" "),a("v-row",{staticClass:"pa-3",attrs:{cols:"8"}},[a("v-file-input",{attrs:{rules:[t.rules.required],counter:"","show-size":"","truncate-length":"15"},on:{change:t.onFileSelect},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}})],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"text-left ml-8",attrs:{cols:"12"}},[a("v-text-field",{attrs:{label:"Version",type:"text","single-line":"",rules:[t.rules.required]},model:{value:t.version,callback:function(e){t.version=e},expression:"version"}})],1)],1),t._v(" "),t.errorMessage?a("v-alert",{staticClass:"text-left",attrs:{dense:"",outlined:"",type:"error"}},[t._v("\n              "+t._s(t.errorMessage)+"\n            ")]):t._e()],1)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"3"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"6"}},[a("div",{staticClass:"grey--text mb-2 caption"},[t._v("Name")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.appDetails.display_name+" - "+t.appDetails.service)+"\n              ")])]),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text mb-2 caption"},[t._v("Version")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.version)+"\n              ")])]),t._v(" "),t.serviceStatus.app_type===t.rubixAppTypes.PYTHON_APP?a("v-col",{staticClass:"text-left",attrs:{cols:"12"}},[t.isDeleteAppData?t._e():a("rbx-button",{attrs:{color:"pink",click:t.toggleDeleteAppData,title:"Delete App Data"}}),t._v(" "),t.isDeleteAppData?a("v-card",[a("v-card-title",{staticClass:"headline"},[t._v(" Confirm? ")]),t._v(" "),a("v-card-text",[t._v("Do you want to delete app data?")]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(e){t.isDeleteAppData=!1}}},[t._v(" Cancel ")]),t._v(" "),a("v-btn",{attrs:{color:"red darken-1",loading:t.isDeletingAppData,text:""},on:{click:t.deleteAppData}},[t._v(" Yes ")])],1)],1):t._e()],1):t._e()],1)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"4"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"12"}},[a("div",{staticClass:"font-weight-large"},[t._v("Successfully installed "+t._s(t.appDetails.display_name)+" app.")])])],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text caption mb-2"},[t._v("Name")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.appDetails.display_name)+"\n              ")])]),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text caption mb-2"},[a("span",[t._v("Version")])]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.serviceStatus.version)+"\n              ")])]),t._v(" "),a("v-col",{attrs:{cols:"4"}},[a("rbx-button",{attrs:{color:"success",click:t.startApp,loading:t.isStartingApp,title:"Start App"}})],1)],1)],1)],1)],1)],1),t._v(" "),a("v-card-actions",[t.multiStepViewConfig[t.currentView].hasForward?a("v-btn",{attrs:{color:"primary",loading:t.multiStepViewConfig[t.currentView].loader},on:{click:t.next}},[t._v("\n      "+t._s("function"==typeof t.multiStepViewConfig[t.currentView].buttonLabel?t.multiStepViewConfig[t.currentView].buttonLabel(t.serviceStatus):t.multiStepViewConfig[t.currentView].buttonLabel)+"\n    ")]):t._e(),t._v(" "),a("v-btn",{attrs:{text:""},on:{click:t.cancel}},[t._v(" Cancel ")])],1)],1)}),[],!1,null,null,null).exports,O=(a("KSAc"),"DOWNLOAD_IN_PROGRESS"),L="DOWNLOAD_COMPLETE",F=(I={props:["selectedApps","clearSelectedApps","closeDialog","fetchDownloadAppState","currentDownloadState","appDownloadStates","clearDownloadAppStateInterval","deleteDownloadState"],components:{AppStatusChip:D.a,TextFieldDisplay:S.a},data:function(){return{versionForm:!1,renderReleaseCount:0,isFetchingAppStatuses:!1,successInstallApps:[],failureInstallApps:[],currentView:1,refreshTime:1e4,versionRules:[function(t){return!!t||"Version No. is required."}],multiStepViewConfig:{1:{hasBack:!1,hasForward:!0,title:"Selected Apps",buttonLabel:"Continue",loader:!1,disabled:!1,hasCancel:!0},2:{hasBack:!0,hasForward:!0,title:"Download",buttonLabel:"Download App",loader:!1,disabled:!1,hasCancel:!0},3:{hasBack:!1,hasForward:!0,title:"Download",buttonLabel:"Install",hasCancelInstallation:!0,loader:!1,disabled:!0,hasCancel:!0,cancelTitle:"Close"},4:{hasBack:!1,hasForward:!0,title:"Installation Complete",buttonLabel:"Ok",loader:!1,disabled:!1,hasCancel:!1}}}},updated:function(){this.hasSelectedApps||this.currentDownloadState||this.currentDownloadState===L?this.multiStepViewConfig[1].disabled=!1:(this.currentView=1,this.multiStepViewConfig[1].disabled=!0),this.currentDownloadState!==O&&this.currentDownloadState?this.multiStepViewConfig[3].disabled=!1:this.multiStepViewConfig[3].disabled=!0},watch:{currentDownloadState:function(t,e){this.showDownloadStateView(t)}},created:function(){this.showDownloadStateView(this.currentDownloadState)},computed:{currentBulkAppDownloadState:function(){return this.$store.state.currentBulkAppDownloadState},hasSelectedApps:function(){return this.selectedApps.length>0},apps:function(){return this.selectedApps.map((function(t){return{serviceName:t.service,state:t.state,version:t.version,latestVersion:t.latest_version,minVersion:t.min_support_version,displayName:t.display_name,loadingReleases:!1,releases:[]}}))},downloadStates:function(){return Array.isArray(this.appDownloadStates)&&this.appDownloadStates.length>0&&(this.currentView=3),(this.appDownloadStates||[]).map((function(t){return{isDownloading:!t.download,version:t.version,serviceName:t.service,hasError:!!t.error,errorMessage:t.error}}))}}},d()(I,"created",(function(){this.fetchAppsReleases()})),d()(I,"methods",{back:function(){this.currentView=this.currentView-1},spinLoader:function(t){this.multiStepViewConfig[this.currentView].loader=t},showDownloadStateView:function(t){switch(t){case O:this.currentView=3;break;case L:this.currentView=3,this.clearDownloadAppStateInterval()}},fetchAppsReleases:function(){var t=this,e=this.selectedApps.map((function(t){return t.service}));return this.apps.forEach((function(t){t.loadingReleases=!0})),m.p(e).then((function(e){t.apps.forEach((function(t,a){t.releases=e[a]}))})).catch((function(){t.$toasted.show("Error fetching available releases")})).finally((function(){t.apps.forEach((function(t){t.loadingReleases=!1})),t.renderReleaseCount++}))},disableInstallationButton:function(){this.multiStepViewConfig[3].disabled=!0},bulkDownloadApps:function(){var t=this;this.currentView=3,this.disableInstallationButton();var e=this.apps.map((function(t){return{version:t.version,service:t.serviceName}}));return this.spinLoader(!0),m.a(e).then((function(){t.spinLoader(!1),t.fetchDownloadAppState()})).catch((function(e){t.spinLoader(!1)}))},next:function(t){var e=this;return r()(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.currentView,t.t0=a,t.next=1===t.t0?4:2===t.t0?6:3===t.t0?8:4===t.t0?10:12;break;case 4:return e.stopAndContinue(),t.abrupt("break",14);case 6:return e.download(),t.abrupt("break",14);case 8:return e.install(),t.abrupt("break",14);case 10:return e.continue(),t.abrupt("break",14);case 12:return e.currentView++,t.abrupt("break",14);case 14:case"end":return t.stop()}}),t,e)})))()},stopAndContinue:function(){this.currentView++},download:function(){this.$refs.versionForm.validate()&&this.bulkDownloadApps()},install:function(){var t=this,e=this.downloadStates.filter((function(t){return!t.hasError})).map((function(t){return{service:t.serviceName,version:t.version}}));return this.spinLoader(!0),m.b(e).then((function(e){t.spinLoader(!1),t.currentView=4,t.successInstallApps=e.filter((function(t){return t.installation})),t.failureInstallApps=e.filter((function(t){return!t.installation}))})).catch((function(e){t.spinLoader(!1),t.deleteDownloadState(),t.$toasted.show("Unexpected error occured while bulk installing apps. Please try again")}))},continue:function(){this.resetDialog()},cancel:function(){this.fetchDownloadAppState(),this.closeDialog()},cancelInstallation:function(){this.resetDialog()},resetDialog:function(){this.versionForm=!1,this.renderReleaseCount=0,this.isFetchingAppStatuses=!1,this.currentView=1,this.multiStepViewConfig={1:{hasBack:!1,hasForward:!0,title:"Selected Apps",buttonLabel:"Continue",loader:!1},2:{hasBack:!0,hasForward:!0,title:"Download",buttonLabel:"Download App",loader:!1},3:{hasBack:!1,hasForward:!0,title:"Download",buttonLabel:"Install",loader:!1},4:{hasBack:!1,hasForward:!0,title:"Installation Complete",buttonLabel:"Ok",loader:!1}},this.deleteDownloadState(),this.fetchAppsReleases(),this.clearSelectedApps(),this.closeDialog(!0,{unmount:!0})}}),I),E=Object(g.a)(F,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{loading:t.isFetchingAppStatuses}},[a("v-card-title",[t.multiStepViewConfig[t.currentView].hasBack?a("v-btn",{staticClass:"white--text mr-1",attrs:{icon:"",medium:""},on:{click:t.back}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-arrow-left ")])],1):t._e(),t._v(" "),a("span",{staticClass:"sub-headline"},[t._v(" Bulk Apps | "+t._s(t.multiStepViewConfig[t.currentView].title)+" ")])],1),t._v(" "),a("v-card-text",[a("v-stepper",{model:{value:t.currentView,callback:function(e){t.currentView=e},expression:"currentView"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:t.currentView>1,step:"1"}},[t._v(" 1 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>2,step:"2"}},[t._v(" 2 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>3,step:"3"}},[t._v(" 3 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{step:"4"}},[t._v(" 4 ")])],1),t._v(" "),a("v-stepper-items",[a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"1"}},[t.hasSelectedApps?t._e():a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n            Please select apps from the grid to bulk download.\n          ")]),t._v(" "),a("v-list",{staticClass:"text-left",attrs:{flat:"",subheader:"",dense:""}},[a("v-subheader",[t._v("Selected Apps")]),t._v(" "),t._l(t.apps,(function(e,s){return a("v-list-item",{key:"selected_apps-"+s},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.displayName)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.version)}})],1),t._v(" "),a("v-list-item-icon",[a("app-status-chip",{attrs:{state:e.state}})],1)],1)}))],2)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{ref:"versionForm",attrs:{"lazy-validation":""},model:{value:t.versionForm,callback:function(e){t.versionForm=e},expression:"versionForm"}},[a("v-row",{staticClass:"text-left",attrs:{dense:""}},t._l(t.apps,(function(e,s){return a("v-col",{key:"version-form-"+t.renderReleaseCount+"-"+s,attrs:{cols:"12"}},[a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Name",value:e.displayName}})],1),t._v(" "),a("v-col",{attrs:{cols:"8"}},[a("v-combobox",{attrs:{loading:e.loadingReleases,items:e.releases,label:"Select Release Version",hideSelected:"",clearable:"","item-text":"name","item-value":"tag_name",rules:t.versionRules},model:{value:e.version,callback:function(a){t.$set(e,"version",a)},expression:"app.version"}})],1)],1)],1)})),1)],1)],1),t._v(" "),a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"3"}},[a("div",["DOWNLOAD_IN_PROGRESS"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n              Downloading Selected App(s) "),a("strong",[t._v("Please Wait!")])]):t._e(),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"success"}},[t._v("\n              Downloading Completed\n            ")]):t._e()],1),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-list",{staticClass:"text-left",attrs:{flat:"",subheader:"",dense:""}},[a("v-subheader",[t._v("App Download Statuses")]),t._v(" "),t._l(t.downloadStates,(function(e,s){return a("v-list-item",{key:"download-statuses-"+s},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.serviceName)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.version)}})],1),t._v(" "),a("v-list-item-icon",[e.isDownloading?a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"yellow"}},[t._v("Downloading")])],1)]):e.hasError?a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"red"}},[t._v("Failed")])],1)]):e.isDownloading||e.hasError?t._e():a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"green"}},[t._v("Downloaded")])],1)])])],1)}))],2):t._e()],1),t._v(" "),a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"4"}},["DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-list",{staticClass:"text-left",attrs:{flat:"",subheader:"",dense:""}},[t.successInstallApps.length>0?a("v-list-item-group",[a("v-subheader",[t._v("Installation Completed Apps")]),t._v(" "),t._l(t.successInstallApps,(function(e,s){return a("v-list-item",{key:"install-complete-"+s},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.service)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.version)}})],1),t._v(" "),a("v-list-item-icon",[a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"blue"}},[t._v("Installed")])],1)])])],1)}))],2):t._e(),t._v(" "),t.failureInstallApps.length>0?a("v-list-item-group",[a("v-subheader",[t._v(" Installation Failed Apps")]),t._v(" "),t._l(t.failureInstallApps,(function(e,s){return a("v-list-item",{key:"installation-failed-"+s},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.service)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.version)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.error)}})],1),t._v(" "),a("v-list-item-icon",[a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"red"}},[t._v("Failed")])],1)])])],1)}))],2):t._e()],1):t._e()],1)],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-card-actions",[t.multiStepViewConfig[t.currentView].hasForward?a("v-btn",{attrs:{color:"primary",loading:t.multiStepViewConfig[t.currentView].loader,disabled:t.multiStepViewConfig[t.currentView].disabled},on:{click:t.next}},[t._v("\n        "+t._s("function"==typeof t.multiStepViewConfig[t.currentView].buttonLabel?t.multiStepViewConfig[t.currentView].buttonLabel(t.serviceStatus):t.multiStepViewConfig[t.currentView].buttonLabel)+"\n      ")]):t._e(),t._v(" "),t.multiStepViewConfig[t.currentView].hasCancelInstallation?a("v-btn",{attrs:{color:"pink",disabled:t.multiStepViewConfig[t.currentView].disabled,text:""},on:{click:t.cancelInstallation}},[t._v("\n        Cancel Install\n      ")]):t._e(),t._v(" "),t.multiStepViewConfig[t.currentView].hasCancel?a("v-btn",{attrs:{text:""},on:{click:t.cancel}},[t._v(" Close ")]):t._e()],1)],1)],1)}),[],!1,null,null,null).exports,P=a("lkCm"),R="DOWNLOAD_IN_PROGRESS",T="DOWNLOAD_COMPLETE",$={name:"systemServices",components:{AppsEditConfig:b,GridToolbar:h.a,AppsDownloadMultiStepView:x,ConfirmDialog:P.a,AppStatusChip:D.a,AppsUploadMultiStepView:N,AppsBulkDownloadMultiStepView:E},data:function(){var t,e={install:"install",uninstall:"uninstall",upload:"upload",deleteDatabase:"deleteDatabase",editConfig:"editConfig",deleteAppConfig:"deleteAppConfig",bulkDownload:"bulkDownload"};return{selectedItems:[],refreshTime:5e3,singleDownloadRefreshTIme:1e3,appDownloadStates:[],selectedApp:null,dialogNames:e,isFetchingAppDetails:!1,isBulkDownloadAppPersistent:!0,isDeletingConfig:!1,isDeletingDatabase:!1,isUninstallingApp:!1,currentDownloadState:null,fetchDownloadStateInterval:null,isDeletingDownloadState:!1,dialog:(t={},d()(t,e.install,!1),d()(t,e.upload,!1),d()(t,e.uninstall,!1),d()(t,e.deleteDatabase,!1),d()(t,e.editConfig,!1),d()(t,e.deleteAppConfig,!1),d()(t,e.bulkDownload,!1),t),remountDialog:d()({},e.bulkDownload,!0),headers:[{text:"Label",align:"start",value:"display_name"},{text:"Name",align:"start",value:"service"},{text:"Status",align:"center",value:"state"},{text:"Restart",align:"center",value:"restart"},{text:"Installed Version",align:"center",value:"installedVersion"},{text:"Latest Available Version",align:"center",value:"latest_version"},{text:"Actions",align:"center",value:"actions"},{text:"Config File",align:"center",value:"configFile"},{text:"Database",align:"end",value:"databaseOperations"}]}},computed:{appDetails:function(){return this.formatAppDetails(this.$store.state.appDetails)},setting:function(){return this.$store.state.setting},showCheckDownloadIcon:function(){return this.currentDownloadState===T},showDownloadProgressIcon:function(){return this.currentDownloadState===R}},mounted:function(){this.fetchDownloadAppState()},created:function(){this.fetchAppDetails()},methods:{closeDialog:function(t,e){var a=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.dialog[t]=!1,s.unmount&&this.remountDialog[t]&&(this.remountDialog[t]=!1,setTimeout((function(){a.remountDialog[t]=!0}),500)),e&&this.fetchAppDetails(!0)},openDialog:function(t){this.dialog[t]=!0},toggleDialog:function(t,e){if(!this.dialog[t])switch(t){case this.dialogNames.install:if(this.currentDownloadState)return this.$toasted.show("Please resolve bulk download apps in the top left first.",{type:"info"})}this.dialog[t]=!this.dialog[t],this.dialog[t]?this.selectedApp=e:this.selectedApp=null},formatAppDetails:function(t){return t.map((function(t){return p()({},t,{activeLabel:t.status?"Running":"Stopped",isUninstallable:t.is_installed,installedVersion:t.version?t.version:"-",downloadUrl:t.browser_download_url?t.browser_download_url:null,updatedAt:t.date_since?new Date(t.date_since).toLocaleDateString():"-"})}))},fetchAppDetails:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.isFetchingAppDetails=!0,m.o().then((function(a){t.$store.commit("changeAppDetails",a),e&&t.fetchAllInstalledApps()})).finally((function(){t.isFetchingAppDetails=!1}))},fetchAllInstalledApps:function(){var t=this;m.k().then((function(e){t.$store.commit("changeInstalledServices",e)})).catch((function(t){}))},deleteDatabase:function(){var t=this;this.isDeletingDatabase=!0,m.f(this.selectedApp.service).then((function(){t.closeDialog(t.dialogNames.deleteDatabase,!0)})).catch((function(){t.closeDialog(t.dialogNames.deleteDatabase)})).finally((function(){t.isDeletingDatabase=!1}))},uninstall:function(t){var e=this;this.isUninstallingApp=!0,m.u(this.selectedApp.service).then((function(){e.fetchAppDetails(!0),e.closeDialog(e.dialogNames.uninstall,!0)})).catch((function(){e.closeDialog(e.dialogNames.uninstall)})).finally((function(){e.isUninstallingApp=!1}))},getFileName:function(t){var e=new Date;return t+"_"+(e.getDate()+"-"+(e.getMonth()+1)+"-"+e.getFullYear()+"T"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds())},downloadAppData:function(t){var e,a=this,s=t.service;m.j(s,this.setting).then((e=r()(o.a.mark((function e(n){var i,l,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new f.a,e.next=3,i.loadAsync(n);case 3:return e.next=5,i.generateAsync({type:"blob"});case 5:l=e.sent,new Date,r=a.getFileName(s),(c=document.createElement("a")).href=window.URL.createObjectURL(l),c.setAttribute("download",r+".zip"),c.click(),a.$toasted.show(t.service+" app data is exported.");case 13:case"end":return e.stop()}}),e,a)}))),function(t){return e.apply(this,arguments)})).catch((function(e){a.$toasted.show("Failed to export "+t.service+" app data",{type:"error"})}))},deleteAppConfigFile:function(){var t=this;this.isDeletingConfig=!0;var e=this.selectedApp.service,a=this.selectedApp.app_type;m.d(e,a).then((function(a){t.$toasted.show(e+" app config file is deleted"),t.closeDialog(t.dialogNames.deleteAppConfig)})).catch((function(a){t.$toasted.show("Failed to delete app config for "+e,{type:"error"})})).finally((function(){t.isDeletingConfig=!1}))},downloadConfig:function(t){m.i(t.service,t.app_type)},restartService:function(t){var e=this;m.c(_.f.RESTART,t.service).then((function(){e.$toasted.show("App restarted sucessfully.")})).catch((function(){e.$toasted.show("Failed to restart the app.",{type:"error"})}))},bulkDownloadApps:function(){this.openDialog(this.dialogNames.bulkDownload)},clearDownloadAppStateInterval:function(){clearInterval(this.fetchDownloadStateInterval),this.fetchDownloadStateInterval=null},downloadStateInterval:function(){var t=this,e=this.dialog[this.dialogNames.install]?this.singleDownloadRefreshTIme:this.refreshTime;this.fetchDownloadStateInterval||(this.fetchDownloadStateInterval=setInterval((function(){t.fetchDownloadAppState()}),e))},fetchDownloadAppState:function(){var t=this;return m.q().then((function(e){var a=e.state,s=e.services;switch(a){case"DOWNLOADING":t.currentDownloadState=R,t.isBulkDownloadAppPersistent=!1,t.fetchDownloadStateInterval||t.downloadStateInterval();break;case"CLEARED":t.currentDownloadState=null,t.clearDownloadAppStateInterval();break;case"DOWNLOADED":t.currentDownloadState=T,t.isBulkDownloadAppPersistent=!0}return Array.isArray(s)&&(t.appDownloadStates=s),s})).catch((function(e){return e&&e.message&&(t.currentDownloadState=null),e}))},clearSelectedApps:function(){this.appDownloadStates=[],this.selectedItems=[]},deleteDownloadState:function(){var t=this;return this.isDeletingDownloadState=!0,m.g().then((function(t){return t})).catch((function(t){return t})).finally((function(){t.fetchDownloadAppState(),t.clearDownloadAppStateInterval(),t.isDeletingDownloadState=!1}))}}},B=Object(g.a)($,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("grid-toolbar",{attrs:{"hide-export-data":!0,items:t.selectedItems,toolbarTitle:"Rubix Apps"},scopedSlots:t._u([{key:"customAction",fn:function(){return[a("span",[a("v-btn",{staticClass:"white--text",attrs:{disabled:t.isDeletingDownloadState,"x-small":"",color:"green"},on:{click:function(){return t.bulkDownloadApps(t.selectedItems)}}},[t._v("\n            Download Apps\n            "),a("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[t._v(" mdi-download ")])],1),t._v(" "),t.showDownloadProgressIcon?a("v-progress-circular",{attrs:{width:2,size:15,color:"white",indeterminate:""}}):t._e(),t._v(" "),t.showCheckDownloadIcon?a("v-icon",{attrs:{"x-medium":"",dark:""}},[t._v(" mdi-check")]):t._e()],1)]},proxy:!0}])})],1),t._v(" "),a("v-data-table",{attrs:{"show-select":"","item-key":"service",headers:t.headers,items:t.appDetails,"single-select":!1,loading:t.isFetchingAppDetails,"footer-props":{showFirstLastPage:!0,firstIcon:"mdi-chevron-double-left",lastIcon:"mdi-chevron-double-right",prevIcon:"mdi-chevron-left",nextIcon:"mdi-chevron-right"}},scopedSlots:t._u([{key:"item.state",fn:function(t){var e=t.item;return[a("app-status-chip",{attrs:{state:e.state}})]}},{key:"item.restart",fn:function(e){var s=e.item;return[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"success"},on:{click:function(){return t.restartService(s)}}},"v-btn",i,!1),n),[a("v-icon",{attrs:{dark:""}},[t._v(" mdi-restart ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Restart Service")])])]}},{key:"item.actions",fn:function(e){var s=e.item;return[a("span",[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"success"},on:{click:function(){return t.toggleDialog(t.dialogNames.install,s)}}},"v-btn",i,!1),n),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-download ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Download")])]),t._v(" "),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"yellow"},on:{click:function(){return t.toggleDialog(t.dialogNames.upload,s)}}},"v-btn",i,!1),n),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-upload ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Upload")])]),t._v(" "),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,i=e.attrs;return[s.isUninstallable?a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"error"},on:{click:function(){return t.toggleDialog(t.dialogNames.uninstall,s)}}},"v-btn",i,!1),n),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-delete ")])],1):t._e()]}}],null,!0)},[t._v(" "),a("span",[t._v("Delete App")])]),t._v(" "),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,i=e.attrs;return[s.downloadUrl?a("v-btn",t._g(t._b({attrs:{href:s.downloadUrl,target:"_blank",tar:"",icon:"",small:""}},"v-btn",i,!1),n),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-zip-box")])],1):t._e()]}}],null,!0)},[t._v(" "),a("span",[t._v("Download ZIP")])])],1)]}},{key:"item.configFile",fn:function(e){var s=e.item;return["PythonApp"==s.app_type||"FrontendApp"==s.app_type?a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"blue"},on:{click:function(){return t.toggleDialog(t.dialogNames.editConfig,s)}}},"v-btn",i,!1),n),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-pencil ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Edit Config File")])]):t._e(),t._v(" "),"PythonApp"==s.app_type||"FrontendApp"==s.app_type?a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"success"},on:{click:function(){return t.downloadConfig(s)}}},"v-btn",i,!1),n),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-download ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Download Config File")])]):t._e(),t._v(" "),"PythonApp"==s.app_type||"FrontendApp"==s.app_type?a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,i=e.attrs;return[s.isUninstallable?a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"error"},on:{click:function(){return t.toggleDialog(t.dialogNames.deleteAppConfig,s)}}},"v-btn",i,!1),n),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-delete ")])],1):t._e()]}}],null,!0)},[t._v(" "),a("span",[t._v("Delete Configuration")])]):t._e()]}},{key:"item.databaseOperations",fn:function(e){var s=e.item;return[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"success"},on:{click:function(){return t.downloadAppData(s)}}},"v-btn",i,!1),n),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-download ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Download Database")])]),t._v(" "),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,i=e.attrs;return[s.isUninstallable?a("v-btn",t._g(t._b({staticClass:"white--text",attrs:{icon:"",small:"",color:"error"},on:{click:function(){return t.toggleDialog(t.dialogNames.deleteDatabase,s)}}},"v-btn",i,!1),n),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-delete ")])],1):t._e()]}}],null,!0)},[t._v(" "),a("span",[t._v("Delete Database")])])]}}]),model:{value:t.selectedItems,callback:function(e){t.selectedItems=e},expression:"selectedItems"}}),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.uninstall],"on-close":function(){return t.closeDialog(t.dialogNames.uninstall)},"on-confirm":function(){return t.uninstall(t.dialogNames.uninstall)},loading:t.isUninstallingApp,"dialog-text":"Do you want to uninstall the app?"}}),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.deleteDatabase],"on-close":function(){return t.closeDialog(t.dialogNames.deleteDatabase)},"on-confirm":function(){return t.deleteDatabase(t.dialogNames.deleteDatabase)},loading:t.isDeletingDatabase,"dialog-text":"Do you want to delete the app's database?"}}),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.deleteAppConfig],"on-close":function(){return t.closeDialog(t.dialogNames.deleteAppConfig)},"on-confirm":function(){return t.deleteAppConfigFile()},loading:t.isDeletingConfig,"dialog-text":"Do you want to delete the app's config file?"}}),t._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.dialog[t.dialogNames.upload],callback:function(e){t.$set(t.dialog,t.dialogNames.upload,e)},expression:"dialog[dialogNames.upload]"}},[t.dialog[t.dialogNames.upload]?a("apps-upload-multi-step-view",{attrs:{"app-details":t.selectedApp,"close-dialog":function(e){return t.closeDialog(t.dialogNames.upload,e)}}}):t._e()],1),t._v(" "),a("v-dialog",{attrs:{presistent:"","max-width":"500px"},model:{value:t.dialog[t.dialogNames.editConfig],callback:function(e){t.$set(t.dialog,t.dialogNames.editConfig,e)},expression:"dialog[dialogNames.editConfig]"}},[t.dialog[t.dialogNames.editConfig]?a("apps-edit-config",{attrs:{"close-dialog":function(e){return t.closeDialog(t.dialogNames.editConfig,e)},"app-detail":t.selectedApp}}):t._e()],1),t._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.dialog[t.dialogNames.install],callback:function(e){t.$set(t.dialog,t.dialogNames.install,e)},expression:"dialog[dialogNames.install]"}},[t.dialog[t.dialogNames.install]?a("apps-download-multi-step-view",{attrs:{"delete-download-state":t.deleteDownloadState,"current-download-state":t.currentDownloadState,"fetch-download-app-state":t.fetchDownloadAppState,"clear-download-app-state-interval":t.clearDownloadAppStateInterval,"app-details":t.selectedApp,"close-dialog":function(e){return t.closeDialog(t.dialogNames.install,e)}}}):t._e()],1),t._v(" "),a("v-dialog",{attrs:{persistent:t.isBulkDownloadAppPersistent,"max-width":"500px"},model:{value:t.dialog[t.dialogNames.bulkDownload],callback:function(e){t.$set(t.dialog,t.dialogNames.bulkDownload,e)},expression:"dialog[dialogNames.bulkDownload]"}},[t.remountDialog[t.dialogNames.bulkDownload]?a("apps-bulk-download-multi-step-view",{attrs:{"current-download-state":t.currentDownloadState,"selected-apps":t.selectedItems,"fetch-download-app-state":t.fetchDownloadAppState,"app-download-states":t.appDownloadStates,"clear-selected-apps":t.clearSelectedApps,"delete-download-state":t.deleteDownloadState,"clear-download-app-state-interval":t.clearDownloadAppStateInterval,"close-dialog":function(e,a){return t.closeDialog(t.dialogNames.bulkDownload,e,a)}}}):t._e()],1)],1)}),[],!1,null,null,null).exports,M=a("OBCi"),U=a.n(M),W=a("+SqX"),j={name:"slave-app-grid",props:["slaveApps","selectedItems","slaveDevices","onSelectItem","searchText"],components:{AppStatusChip:D.a,GridToolbar:h.a,TextFieldDisplay:S.a},data:function(){return{expanded:[],headers:[{text:"Slave device name",align:"left",value:"slave_device_name"},{text:"Site name",align:"center",value:"slave_site_name"},{text:"Installed Version",align:"center",value:"version"},{text:"Status",align:"right",value:"state"},{text:"",value:"data-table-expand"}]}},computed:{selectedGridItems:{get:function(){return this.selectedItems},set:function(t){this.onSelectItem(this.serviceName,t)}},title:function(){return this.slaveApps.display_name},serviceName:function(){return this.slaveApps.name},dataItems:function(){var t=this;return this.slaveApps.dataItems.map((function(e){return t.appendSlaveDevice(e)}))},appVersion:function(){var t=Array.isArray(this.slaveApps.dataItems)&&this.slaveApps.dataItems.find((function(t){return t.latest_version}));return t?t.latest_version:null}},methods:{appendSlaveDevice:function(t){var e=p()({},t),a=this.slaveDevices[t.slaveId];return a&&(e=p()({},e,n()(a).reduce((function(t,e){return t["slave_"+e]=a[e],t}),{}))),e}}},G=Object(g.a)(j,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{outlined:""}},[a("v-card-text",{staticClass:"pa-0"},[a("v-toolbar",{attrs:{dense:"",flat:""}},[a("v-toolbar-title",[a("span",[t._v(t._s(t.title))])]),t._v(" "),a("v-spacer"),t._v(" "),t.appVersion?a("span",[a("span",{staticClass:"grey-text font-weight-medium caption pr-2"},[t._v("Latest Version")]),t._v("\n        "+t._s(t.appVersion)+"\n      ")]):t._e()],1),t._v(" "),a("v-data-table",{attrs:{dense:"","hide-default-footer":"",items:t.dataItems,"single-select":!1,"show-select":"",expanded:t.expanded,"single-expand":"","item-key":"slaveId",search:t.searchText,headers:t.headers,"show-expand":""},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"item.state",fn:function(t){var e=t.item;return[a("app-status-chip",{attrs:{state:e.state}})]}},{key:"expanded-item",fn:function(e){var s=e.headers,n=e.item;return[a("td",{staticClass:"expanded-table-row",attrs:{colspan:s.length}},[a("div",{staticClass:"flex pl-15"},[a("span",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("Timezone")]),t._v(" "),a("span",{staticClass:"text-ellipses"},[t._v(t._s(n.slave_time_zone))])]),t._v(" "),a("span",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("State")]),t._v(" "),a("span",{staticClass:"font-weight-medium text-ellipses"},[t._v(t._s(n.slave_site_state))])]),t._v(" "),a("span",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("City")]),t._v(" "),a("span",{staticClass:"font-weight-medium text-ellipses"},[t._v(t._s(n.slave_site_city))])]),t._v(" "),a("span",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("Zip")]),t._v(" "),a("span",{staticClass:"font-weight-medium text-ellipses"},[t._v(t._s(n.slave_site_zip))])])])])]}}]),model:{value:t.selectedGridItems,callback:function(e){t.selectedGridItems=e},expression:"selectedGridItems"}})],1)],1)}),[],!1,null,"a3485882",null).exports,z=a("snOE"),q=a.n(z),J=function(t){var e=function(t,e){return n()(t).reduce((function(a,s){var i=n()(t[s]).reduce((function(a,n){return e[s].includes(n)&&a.push(t[s][n]),a}),[]);return a[s]=i,a}),{})}(t.releaseMap,function(t){return n()(t).reduce((function(e,a){return e[a]=(t[a]||[]).map((function(t){return t&&t.slaveId})).filter((function(t){return t})),e}),{})}(t.selectedItems));return n()(e).reduce((function(t,a){var s=e[a].map((function(t){return t&&t.length||1/0})),n=s.indexOf(Math.min.apply(Math,q()(s)));return t[a]=e[a][n]||[],t}),{})},H=a("uzYq"),Y=a("NWgQ"),K=a.n(Y),Q="/slave-apps",X=function(){return H.a.get(""+Q)};function Z(t){return t.reduce((function(t,e){return t[e.slaveId]||(t[e.slaveId]=[]),t[e.slaveId].push({service:e.service,version:e.version}),t}),{})}var tt=function(t){return U.a.all(t.map((function(t){return(e=t,H.a.get(Q+"/releases/"+e)).catch((function(t){return{}}));var e})))},et="DOWNLOAD_IN_PROGRESS",at="DOWNLOAD_COMPLETE",st={props:["selectedApps","slaveDevices","appVersions","clearSelectedApps","closeDialog","fetchDownloadAppState","currentDownloadState","slaveAppsDownloadStates","clearDownloadAppStateInterval","deleteDownloadState"],components:{AppStatusChip:D.a,TextFieldDisplay:S.a},data:function(){return{versionForm:!1,renderReleaseCount:0,successInstalledApps:{},failureInstallApps:{},currentView:1,refreshTime:1e4,versionRules:[function(t){return!!t||"Version No. is required."}],multiStepViewConfig:{1:{hasBack:!1,hasForward:!0,title:"Selected Apps",buttonLabel:"Continue",loader:!1,disabled:!1,hasCancel:!0},2:{hasBack:!0,hasForward:!0,title:"Download",buttonLabel:"Download App",loader:!1,disabled:!1,hasCancel:!0},3:{hasBack:!1,hasForward:!0,title:"Download",buttonLabel:"Install",hasCancelInstallation:!0,loader:!1,disabled:!0,hasCancel:!0,cancelTitle:"Close"},4:{hasBack:!1,hasForward:!0,title:"Installation Complete",buttonLabel:"Ok",loader:!1,disabled:!1,hasCancel:!1}}}},updated:function(){this.hasSelectedApps||this.currentDownloadState||this.currentDownloadState===at?this.multiStepViewConfig[1].disabled=!1:(this.currentView=1,this.multiStepViewConfig[1].disabled=!0),this.currentDownloadState!==et&&this.currentDownloadState?this.multiStepViewConfig[3].disabled=!1:this.multiStepViewConfig[3].disabled=!0},watch:{currentDownloadState:function(t,e){this.showDownloadStateView(t)}},created:function(){this.showDownloadStateView(this.currentDownloadState)},computed:{currentBulkAppDownloadState:function(){return this.$store.state.currentBulkAppDownloadState},hasSelectedApps:function(){var t=this;return n()(this.selectedApps).reduce((function(e,a){var s=t.selectedApps[a],n=s&&Array.isArray(s)&&s.length>0;return e||n}),!1)},apps:function(){var t=this;return n()(this.selectedApps).reduce((function(e,a){return t.selectedApps[a]&&t.selectedApps[a].length>0&&(e.push(t.getHeader(a)),e.push.apply(e,q()(function(t){return t.map((function(t){return p()({},t,{isListItem:!0,serviceName:t.service,slaveClientName:t.slave_client_name,slaveDeviceName:t.slave_device_name,state:t.state,version:t.version,latestVersion:t.latest_version,minVersion:t.min_support_version,displayName:t.display_name,loadingReleases:!1,releases:[]})}))}(t.selectedApps[a]))),e.push(t.getVersionSelection(a,t.selectedApps[a])),e.push({divider:!0,isNonItem:!0})),e}),[]).filter((function(t){return t}))},downloadStates:function(){var t=this,e=this.slaveDevices;return n()(this.slaveAppsDownloadStates).reduce((function(a,s){return t.slaveAppsDownloadStates[s]&&t.slaveAppsDownloadStates[s].dataItems&&t.slaveAppsDownloadStates[s].dataItems.length>0&&(a.push(t.getHeader(s)),a.push.apply(a,q()(t.slaveAppsDownloadStates[s].dataItems.map((function(t){return p()({},t,{isListItem:!0,serviceName:t.service,slaveDeviceName:e[t.slaveId].device_name,version:t.version,hasError:!!t.error,errorMessage:t.error,isDownloading:t.download})})))),a.push({divider:!0,isNonItem:!0})),a}),[])},installationSuccessApps:function(){var t=this,e=this.slaveDevices;return n()(this.successInstalledApps).reduce((function(a,s){return t.successInstalledApps[s]&&t.successInstalledApps[s].dataItems&&t.successInstalledApps[s].dataItems.length>0&&(a.push(t.getHeader(s)),a.push.apply(a,q()(t.successInstalledApps[s].dataItems.map((function(t){return p()({},t,{slaveDeviceName:e[t.slaveId].device_name,isListItem:!0})})))),a.push({divider:!0,isNonItem:!0})),a}),[])},installationFailedApps:function(){var t=this,e=this.slaveDevices;return n()(this.failureInstallApps).reduce((function(a,s){return t.failureInstallApps[s]&&t.failureInstallApps[s].dataItems&&t.failureInstallApps[s].dataItems.length>0&&(a.push(t.getHeader(s)),a.push.apply(a,q()(t.failureInstallApps[s].dataItems.map((function(t){return p()({},t,{slaveDeviceName:e[t.slaveId].site_name,isListItem:!0})})))),a.push({divider:!0,isNonItem:!0})),a}),[])}},methods:{getHeader:function(t){return{text:t,name:t,isHeader:!0,isNonItem:!0,isListItem:!1}},getCommonAppMinVersion:function(t){var e=t.map((function(t){return t.min_support_version})),a=e.reduce((function(t,e){var a=t[e]||0;return t[e]=a+1,t}),{}),s=n()(a).map((function(t){return a[t]})),i=s.indexOf(Math.max.apply(Math,q()(s)));return i>-1?e[i]:""},getVersionSelection:function(t,e){var a=e.map((function(t){return t.version})).filter((function(t,e,a){return a.indexOf(t)===e})),s=this.getCommonAppMinVersion(e);return{text:t,name:t,model:1===a.length?a[0]:s,isListItem:!1,isVersionSelect:!0,versions:a}},back:function(){this.currentView=this.currentView-1},spinLoader:function(t){this.multiStepViewConfig[this.currentView].loader=t},showDownloadStateView:function(t){switch(t){case et:this.currentView=3;break;case at:this.currentView=3,this.clearDownloadAppStateInterval()}},disableInstallationButton:function(){this.multiStepViewConfig[3].disabled=!0},bulkDownloadApps:function(){var t=this;this.currentView=3,this.disableInstallationButton();var e,a=this.apps.reduce((function(t,e){return e.isVersionSelect&&(t[e.name]=e.model),t}),{}),s=this.apps.filter((function(t){return t.isListItem})).map((function(t){return{version:a[t.service],service:t.serviceName,slaveId:t.slaveId}}));return this.spinLoader(!0),(e=s,H.a.post(Q+"/download",Z(e))).then((function(){t.spinLoader(!1),t.fetchDownloadAppState()})).catch((function(e){t.spinLoader(!1)}))},next:function(t){var e=this;return r()(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.currentView,t.t0=a,t.next=1===t.t0?4:2===t.t0?6:3===t.t0?8:4===t.t0?10:12;break;case 4:return e.stopAndContinue(),t.abrupt("break",14);case 6:return e.download(),t.abrupt("break",14);case 8:return e.install(),t.abrupt("break",14);case 10:return e.continue(),t.abrupt("break",14);case 12:return e.currentView++,t.abrupt("break",14);case 14:case"end":return t.stop()}}),t,e)})))()},stopAndContinue:function(){this.currentView++},download:function(){this.$refs.versionForm.validate()&&this.bulkDownloadApps()},install:function(){var t,e=this,a=this.downloadStates.filter((function(t){return t.isListItem&&!t.hasError})).map((function(t){return{version:t.version,service:t.serviceName,slaveId:t.slaveId}}));return this.spinLoader(!0),(t=a,H.a.post(Q+"/install",Z(t))).then((function(t){var a=t.successInstalledApps,s=void 0===a?{}:a,n=t.errorInstalledApps,i=void 0===n?{}:n;e.spinLoader(!1),e.currentView=4,e.successInstalledApps=p()({},s),e.failureInstallApps=p()({},i)})).catch((function(t){e.spinLoader(!1),e.$toasted.show("Unexpected error occured while bulk installing apps. Please try again")}))},continue:function(){this.resetDialog()},cancel:function(){this.fetchDownloadAppState(),this.closeDialog()},cancelInstallation:function(){this.resetDialog()},resetDialog:function(){this.versionForm=!1,this.renderReleaseCount=0,this.currentView=1,this.multiStepViewConfig={1:{hasBack:!1,hasForward:!0,title:"Selected Apps",buttonLabel:"Continue",loader:!1,disabled:!1,hasCancel:!0},2:{hasBack:!0,hasForward:!0,title:"Download",buttonLabel:"Download App",loader:!1,disabled:!1,hasCancel:!0},3:{hasBack:!1,hasForward:!0,title:"Download",buttonLabel:"Install",hasCancelInstallation:!0,loader:!1,disabled:!0,hasCancel:!0,cancelTitle:"Close"},4:{hasBack:!1,hasForward:!0,title:"Installation Complete",buttonLabel:"Ok",loader:!1,disabled:!1,hasCancel:!1}},this.deleteDownloadState(),this.clearSelectedApps(),this.closeDialog(!0,{unmount:!0})}}},nt=Object(g.a)(st,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[t.multiStepViewConfig[t.currentView].hasBack?a("v-btn",{staticClass:"white--text mr-1",attrs:{icon:"",medium:""},on:{click:t.back}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-arrow-left ")])],1):t._e(),t._v(" "),a("span",{staticClass:"sub-headline"},[t._v(" Slave Apps | "+t._s(t.multiStepViewConfig[t.currentView].title)+" ")])],1),t._v(" "),a("v-card-text",[a("v-stepper",{model:{value:t.currentView,callback:function(e){t.currentView=e},expression:"currentView"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:t.currentView>1,step:"1"}},[t._v(" 1 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>2,step:"2"}},[t._v(" 2 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>3,step:"3"}},[t._v(" 3 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{step:"4"}},[t._v(" 4 ")])],1),t._v(" "),a("v-stepper-items",[a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"1"}},[t.hasSelectedApps?t._e():a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n            Please select apps from the grid to bulk download.\n          ")]),t._v(" "),a("v-list",{staticClass:"text-left",attrs:{flat:"",subheader:"",dense:""}},[a("v-subheader",[t._v("Selected Apps")]),t._v(" "),t._l(t.apps,(function(e,s){return[e.isHeader?a("v-list-item",{key:"selected_apps_header-"+s},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.name)}})],1)],1):t._e(),t._v(" "),e.isListItem?a("v-list-item",{key:"selected_apps-"+s,staticClass:"pl-10"},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.slaveDeviceName)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.version)}})],1),t._v(" "),a("v-list-item-icon",[a("app-status-chip",{attrs:{state:e.state}})],1)],1):t._e()]}))],2)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{ref:"versionForm",attrs:{"lazy-validation":""},model:{value:t.versionForm,callback:function(e){t.versionForm=e},expression:"versionForm"}},[a("v-row",{staticClass:"text-left",attrs:{dense:""}},[t._l(t.apps,(function(e,s){return[e.isHeader?a("v-col",{key:"version-form-header-"+t.renderReleaseCount+"-"+s,attrs:{cols:"12"}},[a("span",{staticClass:"caption font-weight-bold"},[t._v(t._s(e.name))])]):t._e(),t._v(" "),e.isListItem?a("v-col",{key:"version-form-field-"+t.renderReleaseCount+"-"+s,attrs:{cols:"4"}},[a("text-field-display",{staticClass:"pl-5",attrs:{label:"Slave Name",value:e.slaveDeviceName}})],1):t._e(),t._v(" "),e.isVersionSelect?a("v-col",{key:"version-form-select-"+t.renderReleaseCount+"-"+s,attrs:{cols:"12"}},[a("v-combobox",{staticClass:"pl-5",attrs:{items:t.appVersions[e.name],label:"Select Release Version",hideSelected:"",clearable:"","item-text":"name","item-value":"tag_name",rules:t.versionRules},model:{value:e.model,callback:function(a){t.$set(e,"model",a)},expression:"app.model"}})],1):t._e()]}))],2)],1)],1),t._v(" "),a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"3"}},[a("div",["DOWNLOAD_IN_PROGRESS"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n              Downloading App(s) "),a("strong",[t._v("Please Wait!")])]):t._e(),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"success"}},[t._v("\n              Downloading Completed\n            ")]):t._e()],1),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-list",{staticClass:"text-left",attrs:{flat:"",subheader:"",dense:""}},[a("v-subheader",[t._v("App Download Statuses")]),t._v(" "),t._l(t.downloadStates,(function(e,s){return[e.isHeader?a("v-row",{key:"download-statuses-header-"+s,attrs:{dense:""}},[a("v-col",{staticClass:"pl-3",attrs:{cols:"12"}},[a("span",{staticClass:"caption font-weight-bold"},[t._v(t._s(e.name))])])],1):t._e(),t._v(" "),e.isListItem?a("v-list-item",{key:"download-statuses-"+s,staticClass:"pl-5"},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.slaveDeviceName)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.version)}})],1),t._v(" "),a("v-list-item-icon",[e.isDownloading?e.hasError?a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"red"}},[t._v("Failed")])],1)]):e.isDownloading&&!e.hasError?a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"green"}},[t._v("Downloaded")])],1)]):t._e():a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"yellow"}},[t._v("Downloading")])],1)])])],1):t._e()]}))],2):t._e()],1),t._v(" "),a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"4"}},["DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-list",{staticClass:"text-left",attrs:{flat:"",subheader:"",dense:""}},[t.installationSuccessApps.length>0?a("v-list-item-group",[a("v-subheader",[t._v("Installation Completed Apps")]),t._v(" "),t._l(t.installationSuccessApps,(function(e,s){return[e.isHeader?a("v-row",{key:"install-complete-header-"+s},[a("v-col",{attrs:{cols:"12"}},[a("span",{staticClass:"caption font-weight-bold"},[t._v(t._s(e.name))])])],1):t._e(),t._v(" "),e.isListItem?a("v-list-item",{key:"install-complete-"+s},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.slaveDeviceName)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.version)}})],1),t._v(" "),a("v-list-item-icon",[a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"blue"}},[t._v("Installed")])],1)])])],1):t._e()]}))],2):t._e(),t._v(" "),t.installationFailedApps.length>0?a("v-list-item-group",[a("v-subheader",[t._v(" Installation Failed Apps")]),t._v(" "),t._l(t.installationFailedApps,(function(e,s){return[e.isHeader?a("v-row",{key:"installation-failed-header-"+s,attrs:{dense:""}},[a("v-col",{staticClass:"pl-3",attrs:{cols:"12"}},[a("span",{staticClass:"caption font-weight-bold"},[t._v(t._s(e.name))])])],1):t._e(),t._v(" "),e.isListItem?a("v-list-item",{key:"installation-failed-"+s},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.service)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.version)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.error)}})],1),t._v(" "),a("v-list-item-icon",[a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"red"}},[t._v("Failed")])],1)])])],1):t._e()]}))],2):t._e()],1):t._e()],1)],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-card-actions",[t.multiStepViewConfig[t.currentView].hasForward?a("v-btn",{attrs:{color:"primary",loading:t.multiStepViewConfig[t.currentView].loader,disabled:t.multiStepViewConfig[t.currentView].disabled},on:{click:t.next}},[t._v("\n        "+t._s("function"==typeof t.multiStepViewConfig[t.currentView].buttonLabel?t.multiStepViewConfig[t.currentView].buttonLabel(t.serviceStatus):t.multiStepViewConfig[t.currentView].buttonLabel)+"\n      ")]):t._e(),t._v(" "),t.multiStepViewConfig[t.currentView].hasCancelInstallation?a("v-btn",{attrs:{color:"pink",disabled:t.multiStepViewConfig[t.currentView].disabled,text:""},on:{click:t.cancelInstallation}},[t._v("\n        Cancel Install\n      ")]):t._e(),t._v(" "),t.multiStepViewConfig[t.currentView].hasCancel?a("v-btn",{attrs:{text:""},on:{click:t.cancel}},[t._v(" Close ")]):t._e()],1)],1)],1)}),[],!1,null,null,null).exports,it=a("0iKi"),ot={name:"slave-apps",components:{PageTitle:W.a,SlaveAppGrid:G,SlaveAppsDownloadMultiStep:nt,ConfirmDialog:P.a},data:function(){var t={bulkUpdate:"bulkUpdate"};return{recompute:0,isClearDialog:!1,isLoadingSlaveApps:!1,slaveReleaseList:null,searchText:"",isFetchingAppData:!1,refreshTime:5e3,isDeletingDownloadState:!1,currentDownloadState:null,slaveAppsDetailMap:{},slaveAppsDetail:[],selectedItems:{},appVersions:{},selectedAppVersion:{},slaveAppReleases:{},fetchDownloadAppStateInterval:null,slaveDevices:{},slaveAppsDownloadStates:{},dialogNames:t,dialog:d()({},t.bulkUpdate,!1),remountDialog:d()({},t.bulkUpdate,!0)}},mounted:function(){this.initialize()},computed:{showCheckDownloadIcon:function(){return this.currentDownloadState===_.c.DOWNLOAD_COMPLETE},showDownloadProgressIcon:function(){return this.currentDownloadState===_.c.DOWNLOAD_IN_PROGRESS}},methods:{initialize:function(){var t=this;return r()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isFetchingAppData=!0,e.next=3,U.a.all([t.fetchSlaveApps(!0),t.fetchSlaveDevices()]).finally((function(){t.isFetchingAppData=!1,t.recompute++}));case 3:case"end":return e.stop()}}),e,t)})))()},openDialog:function(t){this.dialog[t]=!0},toggleDialog:function(t,e){this.dialog[t]=!this.dialog[t],this.dialog[t]?this.selectedApp=e:this.selectedApp=null},fetchSlaveApps:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.isLoadingSlaveApps=!0,X().then((function(a){var s=a.data,i=void 0===s?{}:s;t.slaveAppsDetailMap=i,t.slaveAppsDetail=n()(i).map((function(t){return i[t]})),t.selectedItems=n()(i).reduce((function(t,e){return t[e]=[],t}),{}),e&&t.fetchSlaveAppReleases()})).finally((function(){t.isLoadingSlaveApps=!1}))},onSelectItem:function(t,e){this.selectedItems[t]=e,this.selectedAppVersion=J({releaseMap:this.appVersions,selectedItems:this.selectedItems})},fetchSlaveDevices:function(){var t=this;return it.e().then((function(e){t.slaveDevices=e,t.fetchDownloadAppState()})).catch((function(e){t.$toasted.show("Error fetching slave devies")}))},fetchSlaveAppReleases:function(){var t=this,e=n()(this.slaveAppsDetailMap);return e.length?tt(e).then((function(a){t.appVersions=e.reduce((function(t,e,s){return t[e]=a[s],t}),{})})).catch((function(e){t.$toasted.show("Error fetching app releases")})):null},onBulkUpdate:function(){this.dialog[this.dialogNames.bulkUpdate]=!0},closeDialog:function(t){this.dialog[t]=!1},startDownloadStateInterval:function(){var t=this;this.fetchDownloadAppStateInterval||(this.fetchDownloadAppStateInterval=setInterval((function(){t.fetchDownloadAppState()}),this.refreshTime))},clearDownloadAppStateInterval:function(){clearInterval(this.fetchDownloadAppStateInterval),this.fetchDownloadAppStateInterval=null},deleteDownloadState:function(){var t=this;this.isDeletingDownloadState=!0;var e=n()(this.slaveDevices);return e&&e.length>0?function(t){var e=K.a.stringify({slaveUUIDs:t});return H.a.delete(Q+"/download-state?"+e)}(e).finally((function(){t.fetchDownloadAppState(),t.clearDownloadAppStateInterval(),t.isDeletingDownloadState=!1})):null},fetchDownloadAppState:function(){var t=this,e=n()(this.slaveDevices);return e&&e.length>0?function(t){var e=K.a.stringify({slaveUUIDs:t});return H.a.get(Q+"/download-state?"+e)}(e).then((function(e){var a=e.data;switch(e.globalState){case"DOWNLOADING":t.currentDownloadState=_.c.DOWNLOAD_IN_PROGRESS,t.fetchDownloadAppStateInterval||t.startDownloadStateInterval();break;case"CLEARED":t.currentDownloadState=null,t.clearDownloadAppStateInterval();break;case"DOWNLOADED":t.currentDownloadState=_.c.DOWNLOAD_COMPLETE,t.clearDownloadAppStateInterval()}return t.slaveAppsDownloadStates=a,n()(t.slaveAppsDownloadStates).forEach((function(e){t.slaveAppsDownloadStates[e].dataItems=t.slaveAppsDownloadStates[e].dataItems.map((function(e){return t.appendSlaveDevice(e)}))})),a})).catch((function(t){})):null},clearSelectedApps:function(){this.slaveAppsDownloadStates={},this.selectedItems={},this.recompute++,this.fetchSlaveApps()},appendSlaveDevice:function(t){var e=p()({},t),a=this.slaveDevices[t.slaveId];return a&&(e=p()({},e,n()(a).reduce((function(t,e){return t["slave_"+e]=a[e],t}),{}))),e},onClearDownload:function(){var t=this;this.clearSelectedApps(),this.deleteDownloadState().finally((function(){t.isClearDialog=!1}))}}},lt=Object(g.a)(ot,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{loading:t.isLoadingSlaveApps||t.isFetchingAppData}},[a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",[t._v("Slave Apps")]),t._v(" "),a("v-text-field",{staticClass:"pl-10",attrs:{"append-icon":"mdi-magnify",label:"Search using slave device or site name","single-line":"","hide-details":""},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),t._v(" "),a("v-spacer"),t._v(" "),t.currentDownloadState?a("v-btn",{staticClass:"white--text ml-3",attrs:{"x-medium":"",color:"default"},on:{click:function(){return t.isClearDialog=!0}}},[a("span",[t._v("Clear Update")]),t._v(" "),a("v-icon",{attrs:{"x-medium":"",right:"",dark:""}},[t._v(" mdi-cellphone-erase ")])],1):t._e(),t._v(" "),a("v-btn",{staticClass:"white--text",attrs:{"x-medium":"",color:"pink"},on:{click:t.onBulkUpdate}},[t.showDownloadProgressIcon?a("v-progress-circular",{attrs:{width:2,size:15,color:"white",indeterminate:""}}):t._e(),t._v(" "),t.showCheckDownloadIcon?a("v-icon",{attrs:{"x-medium":"",dark:""}},[t._v(" mdi-check")]):t._e(),t._v(" "),a("span",{staticClass:"pl-2"},[t._v("Bulk Update")]),t._v(" "),a("v-icon",{attrs:{"x-medium":"",right:"",dark:""}},[t._v(" mdi-cellphone-arrow-down ")])],1)],1),t._v(" "),a("v-spacer"),t._v(" "),a("v-card-text",[a("v-container",{attrs:{fluid:""}},[a("v-row",{attrs:{"no-gutter":""}},t._l(t.slaveAppsDetail,(function(e){return a("v-col",{key:e.name,attrs:{cols:"12",lg:"6",md:"6",sm:"12",xs:"12"}},[a("slave-app-grid",{key:t.recompute+"-"+e.name,attrs:{"slave-devices":t.slaveDevices,"search-text":t.searchText,"app-versions":t.selectedAppVersion,onSelectItem:t.onSelectItem,"selected-item":t.selectedItems[e.name],"slave-apps":e}})],1)})),1)],1)],1),t._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:t.dialog[t.dialogNames.bulkUpdate],callback:function(e){t.$set(t.dialog,t.dialogNames.bulkUpdate,e)},expression:"dialog[dialogNames.bulkUpdate]"}},[a("slave-apps-download-multi-step",{attrs:{"app-versions":t.selectedAppVersion,"slave-devices":t.slaveDevices,"close-dialog":function(){return t.closeDialog(t.dialogNames.bulkUpdate)},"selected-apps":t.selectedItems,"clear-selected-apps":t.clearSelectedApps,"delete-download-state":t.deleteDownloadState,"current-download-state":t.currentDownloadState,"slave-apps-download-states":t.slaveAppsDownloadStates,"fetch-download-app-state":t.fetchDownloadAppState,"clear-download-app-state-interval":t.clearDownloadAppStateInterval}})],1),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.isClearDialog,"on-close":function(){return t.isClearDialog=!1},"on-confirm":t.onClearDownload,"dialog-text":"All progress will be lost. Are you sure?"}})],1)}),[],!1,null,null,null).exports,rt={name:"rubix-apps",components:{AppsGrid:B,PageTitle:W.a,SlaveApps:lt},computed:{isMqttRestBridgeConfigLoaded:function(){return n()(this.$store.state.mqttRestBridgeConfig||{}).length>0},isMaster:function(){return this.$store.state.isMaster}}},ct=Object(g.a)(rt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("page-title",{attrs:{title:"Rubix Apps"}}),t._v(" "),a("v-row",[t.isMqttRestBridgeConfigLoaded?t._e():a("v-col",{attrs:{cols:"12"}},[a("v-skeleton-loader",{attrs:{type:"table-heading, list-item-two-line, image, table-tfoot"}})],1),t._v(" "),t.isMqttRestBridgeConfigLoaded&&!t.isMaster?a("v-col",{attrs:{cols:"12"}},[a("apps-grid")],1):t._e(),t._v(" "),t.isMqttRestBridgeConfigLoaded&&t.isMaster?a("v-col",{attrs:{cols:"12"}},[a("slave-apps")],1):t._e()],1)],1)}),[],!1,null,null,null);e.default=ct.exports},0:function(t,e){},"0iKi":function(t,e,a){"use strict";a.d(e,"c",(function(){return l})),a.d(e,"a",(function(){return r})),a.d(e,"e",(function(){return c})),a.d(e,"d",(function(){return p})),a.d(e,"f",(function(){return u})),a.d(e,"b",(function(){return d}));var s=a("OBCi"),n=a.n(s),i=a("uzYq"),o="/slave-devices",l=function(t){var e={global_uuid:t.global_uuid};return i.a.post(o,e)},r=function(t){return n.a.all(t.map((function(t){return l(t)})))},c=function(){return i.a.get(o)},p=function(){return i.a.get(o+"/discover")},u=function(t){var e=t.global_uuid;return i.a.delete(o+"/"+e)},d=function(t){return n.a.all(t.map((function(t){return u(t)})))}},1:function(t,e){},2:function(t,e){},"3saC":function(t,e,a){"use strict";var s={props:["on-copy"],methods:{copyToClipboard:function(t){var e=this;this.$copyText(t,this.$refs.copyClipboard).then((function(){e.$toasted.show("Copied to clipboard!",{type:"success"})}),(function(){e.$toasted.show("Cannot copy to clipboard.",{type:"error"})}))}}},n=a("psIG"),i=Object(n.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{ref:"copyClipboard"},[a("v-btn",{staticClass:"white-text",attrs:{"x-small":"",color:"#009688"},on:{click:function(){return t.onCopy(t.copyToClipboard)}}},[a("span",[t._v("Copy  ")]),t._v(" "),a("v-icon",{attrs:{small:""}},[t._v("mdi-export")])],1)],1)}),[],!1,null,null,null);e.a=i.exports},"7Ipj":function(t,e,a){"use strict";var s=a("Q12t"),n=a("3saC"),i=a("Isj4"),o={name:"import-dialog",props:["receiveDataRows"],data:function(){return{file:null,dialogImportExcel:!1,dialogImportJSON:!1,dataImport:""}},methods:{importFile:function(){var t=new FileReader;t.readAsBinaryString(this.file),t.onload=this.handleFileLoad},handleFileLoad:function(t){var e=t.target.result,a=i.read(e,{type:"binary"}),s=Array.isArray(a.SheetNames)&&a.SheetNames.length>0&&a.SheetNames[0];if(!s)return this.$toasted.show("Invalid Excel File. Please reupload.",{type:"error"});var n=i.utils.sheet_to_row_object_array(a.Sheets[s]);this.receiveDataRows(n),this.dialogImportExcel=!1},importJson:function(){try{var t=JSON.parse(this.dataImport);this.receiveDataRows(t),this.dialogImportJSON=!1}catch(t){return this.$toasted.show("Invalid JSON",{type:"error"})}}}},l=a("psIG"),r=Object(l.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,n=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text mr-2",attrs:{"x-small":"",color:"primary"}},"v-btn",n,!1),s),[t._v("Import"),a("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[t._v("mdi-import")])],1)]}}])},[t._v(" "),a("v-list",[a("v-list-item",{attrs:{link:""}},[a("v-list-item-title",{on:{click:function(e){t.dialogImportJSON=!0,t.dataImport=""}}},[t._v("Json")])],1),t._v(" "),a("v-list-item",{attrs:{link:""}},[a("v-list-item-title",{on:{click:function(e){t.dialogImportExcel=!0,t.file=null}}},[t._v("Excel")])],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{width:"500px"},model:{value:t.dialogImportExcel,callback:function(e){t.dialogImportExcel=e},expression:"dialogImportExcel"}},[a("v-card",[a("v-card-title",[t._v("Choose excel file")]),t._v(" "),a("v-card-text",[a("v-file-input",{attrs:{outlined:"",dense:"",label:"File input",accept:".xls,.xlsx"},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}})],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"darken-1",text:""},on:{click:function(e){t.dialogImportExcel=!1}}},[t._v("Close")]),t._v(" "),a("v-btn",{attrs:{color:"primary darken-1",text:"",disabled:!t.file},on:{click:t.importFile}},[t._v("Import")])],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{width:"500px"},model:{value:t.dialogImportJSON,callback:function(e){t.dialogImportJSON=e},expression:"dialogImportJSON"}},[a("v-card",[a("v-card-title",[t._v("Import via JSON")]),t._v(" "),a("v-card-text",[a("v-container",[a("v-textarea",{attrs:{outlined:"",name:"input-7-4",label:"import data"},model:{value:t.dataImport,callback:function(e){t.dataImport=e},expression:"dataImport"}})],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-btn",{attrs:{color:"primary darken-1",text:"",disabled:!t.dataImport},on:{click:t.importJson}},[t._v("Import")])],1)],1)],1)}),[],!1,null,null,null).exports,c={name:"grid-toolbar",props:["toolbarTitle","onCopy","items","fileName","formatDataService","receiveDataRows","onDelete","isDeleteEnabled","onSearch","hideExportData"],components:{ExportData:s.a,CopyClipboard:n.a,ImportDialog:r}},p=Object(l.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",{staticClass:"mr-6"},[t._v(t._s(t.toolbarTitle))]),t._v(" "),t.onCopy?a("copy-clipboard",{staticClass:"mr-2",attrs:{"on-copy":t.onCopy}}):t._e(),t._v(" "),t.items&&t.items.length>0&&!t.hideExportData?a("export-data",{attrs:{data:t.items,"file-name":t.fileName,"format-data-service":t.formatDataService}}):t._e(),t._v(" "),t.receiveDataRows?a("import-dialog",{attrs:{receiveDataRows:t.receiveDataRows}}):t._e(),t._v(" "),t.onDelete?a("v-btn",{staticClass:"white--text",attrs:{disabled:!t.isDeleteEnabled,"x-small":"",color:"error"},on:{click:t.onDelete}},[t._v("\n    Delete\n    "),a("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[t._v(" mdi-delete ")])],1):t._e(),t._v(" "),t._t("customAction"),t._v(" "),t._t("search")],2)}),[],!1,null,null,null);e.a=p.exports},"7Vew":function(t,e,a){"use strict";var s={name:"text-field-display",props:["label","value"]},n=a("psIG"),i=Object(n.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.label?a("div",{staticClass:"grey--text caption mb-2"},[a("span",[t._v(t._s(t.label))])]):t._e(),t._v(" "),t.value?a("div",{staticClass:"font-weight-medium text-ellipses"},[a("span",{staticClass:"field-display-value",attrs:{title:t.value}},[t._v(t._s(t.value))])]):t._e()])}),[],!1,null,null,null);e.a=i.exports},MKDl:function(t,e,a){"use strict";var s={active:{name:"active",displayName:"Running",color:"success"},reloading:{name:"reloading",displayName:"Reloading",color:"yellow"},failed:{name:"failed",displayName:"Failed",color:"red"},activating:{name:"activating",displayName:"Activating",color:"yellow"},deactivating:{name:"deactivating",displayName:"Deactivating",color:"yellow"},maintenance:{name:"maintenance",displayName:"Maintenance",color:"yellow"}},n={name:"app-status-chip",props:["status","state"],computed:{currentStatus:function(){var t=s[this.state];return t||{name:"default",displayName:this.capitalize(this.state),color:"yellow"}},defaultStatus:function(){return this.capitalize(this.state)}},methods:{capitalize:function(t){return t||(t=""),(t=String(t)).charAt(0).toUpperCase()+t.slice(1)}}},i=a("psIG"),o=Object(i.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.state?a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:t.currentStatus.color}},[t._v(t._s(t.currentStatus.displayName))])],1)]):a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"yellow"}},[t._v(t._s(t.defaultStatus))])],1)])])}),[],!1,null,null,null);e.a=o.exports},OKta:function(t,e,a){"use strict";var s={name:"rbx-button",props:["title","after-icon","color","click","is-small","class-name","disabled","block","loading"]},n=a("psIG"),i=Object(n.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-btn",{class:t.className,attrs:{loading:t.loading,"x-small":t.isSmall,disabled:t.disabled,color:t.color,block:t.block},on:{click:t.click}},[a("span",[t._v(t._s(t.title)+" ")]),t._v(" "),t.afterIcon?a("v-icon",{attrs:{small:t.isSmall}},[t._v(t._s(t.afterIcon))]):t._e()],1)}),[],!1,null,null,null);e.a=i.exports},Q12t:function(t,e,a){"use strict";var s=a("/9Wh"),n=a.n(s),i=a("+n12"),o={name:"export-data",props:["data","fileName","formatDataService"],methods:{clickDownload:function(t,e){var a=t;switch("function"==typeof this.formatDataService&&(a=this.formatDataService(t)),e){case"csv":return Object(i.c)(this.fileName,a);case"excel":return Object(i.e)(this.fileName,a);case"json":return Object(i.f)(this.fileName,n()(a))}}}},l=a("psIG"),r=Object(l.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,n=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"white--text mr-2",attrs:{"x-small":"",color:"#009688",dark:""}},"v-btn",n,!1),s),[a("span",[t._v("Download")]),t._v(" "),a("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[t._v("mdi-download")])],1)]}}])},[t._v(" "),a("v-list",[a("v-list-item",{attrs:{link:""}},[a("v-list-item-title",{on:{click:function(e){return t.clickDownload(t.data,"json")}}},[t._v("Json")])],1),t._v(" "),a("v-list-item",{attrs:{link:""}},[a("v-list-item-title",{on:{click:function(e){return t.clickDownload(t.data,"excel")}}},[t._v("Excel")])],1),t._v(" "),a("v-list-item",{attrs:{link:""}},[a("v-list-item-title",{on:{click:function(e){return t.clickDownload(t.data,"csv")}}},[t._v("CSV")])],1)],1)],1)}),[],!1,null,null,null);e.a=r.exports},"Wgf/":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return o}));var s=a("uzYq"),n="/system-service",i=function(){return s.a.get(n)},o=function(t,e){return s.a.post(n+"/control",[{action:t,service:e}])}},lkCm:function(t,e,a){"use strict";var s={name:"confirm-dialog",props:["on-close","on-confirm","dialog-text","is-open","loading"]},n=a("psIG"),i=Object(n.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:t.isOpen,callback:function(e){t.isOpen=e},expression:"isOpen"}},[a("v-card",[a("v-card-title",[a("v-icon",{attrs:{color:"warning"}},[t._v(" mdi-alert-outline ")]),t._v(" Confirm ")],1),t._v(" "),a("v-card-text",[a("v-container",[a("v-row",[t._v(t._s(t.dialogText))])],1)],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{text:""},on:{click:t.onClose}},[t._v(" No ")]),t._v(" "),a("v-btn",{attrs:{color:"red darken-1",loading:t.loading,text:""},on:{click:t.onConfirm}},[t._v(" Yes ")])],1)],1)],1)}),[],!1,null,null,null);e.a=i.exports},nz6T:function(t,e,a){"use strict";a.d(e,"o",(function(){return f})),a.d(e,"k",(function(){return h})),a.d(e,"r",(function(){return m})),a.d(e,"m",(function(){return _})),a.d(e,"p",(function(){return w})),a.d(e,"n",(function(){return g})),a.d(e,"u",(function(){return b})),a.d(e,"s",(function(){return D})),a.d(e,"h",(function(){return S})),a.d(e,"c",(function(){return C})),a.d(e,"v",(function(){return A})),a.d(e,"e",(function(){return x})),a.d(e,"f",(function(){return k})),a.d(e,"j",(function(){return y})),a.d(e,"l",(function(){return N})),a.d(e,"t",(function(){return O})),a.d(e,"d",(function(){return L})),a.d(e,"i",(function(){return F})),a.d(e,"b",(function(){return E})),a.d(e,"a",(function(){return P})),a.d(e,"q",(function(){return R})),a.d(e,"g",(function(){return T}));var s=a("/9Wh"),n=a.n(s),i=a("OBCi"),o=a.n(i),l=a("uzYq"),r=a("NWgQ"),c=a.n(r),p=a("A5Vd"),u=a("Wgf/"),d=a("+n12"),v="/rubix-app",f=function(){var t=c.a.stringify({browser_download_url:!0,latest_version:!0});return l.a.get(v+"?"+t)},h=function(){return l.a.get(""+v).then((function(t){return t.filter((function(t){return t&&t.is_installed}))}))},m=function(){return u.b().then((function(t){return t.filter((function(t){return t&&t.is_installed}))}))},_=function(t){return l.a.get(v+"/releases/"+t)},w=function(t){return o.a.all(t.map((function(t){return _(t).catch((function(t){return[]}))})))},g=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.a.get(v+"/stats/"+t,e)},b=function(t){return l.a.post(v+"/uninstall",{service:t})},D=function(t){return l.a.post(v+"/install",[t])},S=function(t){return l.a.post(v+"/download",[t])},C=function(t,e){return l.a.post(v+"/control",[{action:t,service:e}])},A=function(t,e,a){var s=new FormData;return s.append("file",t),s.append("service",e),s.append("version",a),l.a.post(v+"/app-upload",s,{headers:{"Content-Type":"multipart/form-data"}})},x=function(t){return l.a.post(v+"/delete-app-data",[{service:t}])},k=function(t){return x(t)},y=function(t,e){var a="http://"+e.globalIp+":"+e.rubixServicePort+"/api/app/download_data?service="+t;return l.a.get(a,{headers:{"Content-Type":"application/zip"},responseType:"arraybuffer"})},I=function(t,e){return l.a.get(v+"/json-config/"+t,e)},V=function(t,e){return l.a.get(v+"/env/"+t,e)},N=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===p.g.PYTHON_APP)return I(t,a);if(e===p.g.FRONTEND_APP)return V(t,a);throw new Error("App type not supported for editing config")},O=function(t,e,a){if(e===p.g.PYTHON_APP)return function(t,e){return l.a.put(v+"/json-config",{service:t,data:e})}(t,a||{});if(e===p.g.FRONTEND_APP)return function(t,e){return l.a.put(v+"/env",{service:t,data:e})}(t,a||"");throw new Error("App type not supported for editing config")},L=function(t,e){if(e===p.g.PYTHON_APP)return function(t){return l.a.delete(v+"/json-config",{data:{service:t}})}(t);if(e===p.g.FRONTEND_APP)return function(t){return l.a.delete(v+"/env",{data:{service:t}})}(t);throw new Error("App type not supported for deletion")},F=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===p.g.PYTHON_APP)return I(t,a).then((function(e){Object(d.f)(t+"-config",n()(e))}));if(e===p.g.FRONTEND_APP)return V(t,a).then((function(e){Object(d.d)(""+t,e)}));throw new Error("App type not supported for download config")},E=function(t){return l.a.post(v+"/install",t)},P=function(t){return l.a.post(v+"/download",t)},R=function(){return l.a.get(v+"/download-state",{restrictToast:!0})},T=function(){return l.a.delete(v+"/download-state")}}}]);
//# sourceMappingURL=6.f493eb2763e4dec322c3.js.map