(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"+SqX":function(e,t,i){"use strict";var a={name:"page-title",props:["title"]},n=i("psIG"),s=Object(n.a)(a,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("h1",{staticClass:"text-h5 text-left py-3"},[e._v(e._s(e.title))])}),[],!1,null,null,null);t.a=s.exports},0:function(e,t){},1:function(e,t){},2:function(e,t){},"3saC":function(e,t,i){"use strict";var a={props:["on-copy"],methods:{copyToClipboard:function(e){var t=this;this.$copyText(e,this.$refs.copyClipboard).then((function(){t.$toasted.show("Copied to clipboard!",{type:"success"})}),(function(){t.$toasted.show("Cannot copy to clipboard.",{type:"error"})}))}}},n=i("psIG"),s=Object(n.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{ref:"copyClipboard"},[i("v-btn",{staticClass:"white-text",attrs:{"x-small":"",color:"#009688"},on:{click:function(){return e.onCopy(e.copyToClipboard)}}},[i("span",[e._v("Copy Â ")]),e._v(" "),i("v-icon",{attrs:{small:""}},[e._v("mdi-export")])],1)],1)}),[],!1,null,null,null);t.a=s.exports},"7Ipj":function(e,t,i){"use strict";var a=i("Q12t"),n=i("3saC"),s=i("Isj4"),r={name:"import-dialog",props:["receiveDataRows"],data:function(){return{file:null,dialogImportExcel:!1,dialogImportJSON:!1,dataImport:""}},methods:{importFile:function(){var e=new FileReader;e.readAsBinaryString(this.file),e.onload=this.handleFileLoad},handleFileLoad:function(e){var t=e.target.result,i=s.read(t,{type:"binary"}),a=Array.isArray(i.SheetNames)&&i.SheetNames.length>0&&i.SheetNames[0];if(!a)return this.$toasted.show("Invalid Excel File. Please reupload.",{type:"error"});var n=s.utils.sheet_to_row_object_array(i.Sheets[a]);this.receiveDataRows(n),this.dialogImportExcel=!1},importJson:function(){try{var e=JSON.parse(this.dataImport);this.receiveDataRows(e),this.dialogImportJSON=!1}catch(e){return this.$toasted.show("Invalid JSON",{type:"error"})}}}},o=i("psIG"),l=Object(o.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"white--text mr-2",attrs:{"x-small":"",color:"primary"}},"v-btn",n,!1),a),[e._v("Import"),i("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[e._v("mdi-import")])],1)]}}])},[e._v(" "),i("v-list",[i("v-list-item",{attrs:{link:""}},[i("v-list-item-title",{on:{click:function(t){e.dialogImportJSON=!0,e.dataImport=""}}},[e._v("Json")])],1),e._v(" "),i("v-list-item",{attrs:{link:""}},[i("v-list-item-title",{on:{click:function(t){e.dialogImportExcel=!0,e.file=null}}},[e._v("Excel")])],1)],1)],1),e._v(" "),i("v-dialog",{attrs:{width:"500px"},model:{value:e.dialogImportExcel,callback:function(t){e.dialogImportExcel=t},expression:"dialogImportExcel"}},[i("v-card",[i("v-card-title",[e._v("Choose excel file")]),e._v(" "),i("v-card-text",[i("v-file-input",{attrs:{outlined:"",dense:"",label:"File input",accept:".xls,.xlsx"},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}})],1),e._v(" "),i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"darken-1",text:""},on:{click:function(t){e.dialogImportExcel=!1}}},[e._v("Close")]),e._v(" "),i("v-btn",{attrs:{color:"primary darken-1",text:"",disabled:!e.file},on:{click:e.importFile}},[e._v("Import")])],1)],1)],1),e._v(" "),i("v-dialog",{attrs:{width:"500px"},model:{value:e.dialogImportJSON,callback:function(t){e.dialogImportJSON=t},expression:"dialogImportJSON"}},[i("v-card",[i("v-card-title",[e._v("Import via JSON")]),e._v(" "),i("v-card-text",[i("v-container",[i("v-textarea",{attrs:{outlined:"",name:"input-7-4",label:"import data"},model:{value:e.dataImport,callback:function(t){e.dataImport=t},expression:"dataImport"}})],1)],1)],1),e._v(" "),i("v-card-actions",[i("v-btn",{attrs:{color:"primary darken-1",text:"",disabled:!e.dataImport},on:{click:e.importJson}},[e._v("Import")])],1)],1)],1)}),[],!1,null,null,null).exports,c={name:"grid-toolbar",props:["toolbarTitle","onCopy","items","fileName","formatDataService","receiveDataRows","onDelete","isDeleteEnabled","onSearch"],components:{ExportData:a.a,CopyClipboard:n.a,ImportDialog:l}},v=Object(o.a)(c,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-toolbar",{attrs:{flat:""}},[i("v-toolbar-title",{staticClass:"mr-6"},[e._v(e._s(e.toolbarTitle))]),e._v(" "),e.onCopy?i("copy-clipboard",{staticClass:"mr-2",attrs:{"on-copy":e.onCopy}}):e._e(),e._v(" "),e.items&&e.items.length>0?i("export-data",{attrs:{data:e.items,"file-name":e.fileName,"format-data-service":e.formatDataService}}):e._e(),e._v(" "),e.receiveDataRows?i("import-dialog",{attrs:{receiveDataRows:e.receiveDataRows}}):e._e(),e._v(" "),e.onDelete?i("v-btn",{staticClass:"white--text",attrs:{disabled:!e.isDeleteEnabled,"x-small":"",color:"error"},on:{click:e.onDelete}},[e._v("\n    Delete\n    "),i("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[e._v(" mdi-delete ")])],1):e._e(),e._v(" "),e._t("customAction"),e._v(" "),e._t("search")],2)}),[],!1,null,null,null);t.a=v.exports},Q12t:function(e,t,i){"use strict";var a=i("/9Wh"),n=i.n(a),s=i("+n12"),r={name:"export-data",props:["data","fileName","formatDataService"],methods:{clickDownload:function(e,t){var i=e;switch("function"==typeof this.formatDataService&&(i=this.formatDataService(e)),t){case"csv":return Object(s.c)(this.fileName,i);case"excel":return Object(s.e)(this.fileName,i);case"json":return Object(s.f)(this.fileName,n()(i))}}}},o=i("psIG"),l=Object(o.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"white--text mr-2",attrs:{"x-small":"",color:"#009688",dark:""}},"v-btn",n,!1),a),[i("span",[e._v("Download")]),e._v(" "),i("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[e._v("mdi-download")])],1)]}}])},[e._v(" "),i("v-list",[i("v-list-item",{attrs:{link:""}},[i("v-list-item-title",{on:{click:function(t){return e.clickDownload(e.data,"json")}}},[e._v("Json")])],1),e._v(" "),i("v-list-item",{attrs:{link:""}},[i("v-list-item-title",{on:{click:function(t){return e.clickDownload(e.data,"excel")}}},[e._v("Excel")])],1),e._v(" "),i("v-list-item",{attrs:{link:""}},[i("v-list-item-title",{on:{click:function(t){return e.clickDownload(e.data,"csv")}}},[e._v("CSV")])],1)],1)],1)}),[],!1,null,null,null);t.a=l.exports},na7t:function(e,t,i){"use strict";i.r(t);var a=i("Kz1y"),n=i.n(a),s=i("tZmG"),r=i.n(s),o=i("06Hw"),l=i.n(o),c=i("YYXh"),v=i.n(c),d=i("+SqX"),u=i("7Ipj"),m={name:"slave-devices",components:{GridToolbar:u.a},props:["items","removeMinions","isFetching"],data:function(){return{search:"",selectedItems:[],headers:[{text:"Client Name",align:"start",sortable:!0,value:"client_name"},{text:"Status",align:"center",value:"onlineStatus",sortable:!1},{text:"Device Name",align:"center",value:"device_name",sortable:!0},{text:"Site Name",align:"center",value:"site_name",sortable:!1},{text:"Latitude",align:"center",value:"site_lat",sortable:!1},{text:"Longitude",align:"center",value:"site_lon",sortable:!1},{text:"Site Address",align:"center",value:"site_address",sortable:!1},{text:"Actions",align:"center",value:"actions",sortable:!1}]}}},p=i("psIG"),f=Object(p.a)(m,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("grid-toolbar",{attrs:{toolbarTitle:"Slave Devices"},scopedSlots:e._u([{key:"search",fn:function(){return[i("v-text-field",{staticClass:"pl-10",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]},proxy:!0},{key:"customAction",fn:function(){return[i("v-btn",{staticClass:"white--text",attrs:{disabled:0==e.selectedItems.length,"x-small":"",color:"pink"},on:{click:function(){return e.removeMinions(e.selectedItems)}}},[e._v("\n        Remove as slave\n        "),i("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[e._v(" mdi-delete ")])],1)]},proxy:!0}])}),e._v(" "),i("v-data-table",{staticClass:"elevation-1",attrs:{"item-key":"global_uuid","show-select":"",loading:e.isFetching,search:e.search,headers:e.headers,items:e.items,"sort-by":"calories","footer-props":{showFirstLastPage:!0,firstIcon:"mdi-chevron-double-left",lastIcon:"mdi-chevron-double-right",prevIcon:"mdi-chevron-left",nextIcon:"mdi-chevron-right"}},scopedSlots:e._u([{key:"item.onlineStatus",fn:function(t){return[t.item.is_online?i("div",[i("span",{staticClass:"font-weight-medium"},[i("v-chip",{attrs:{outlined:"",color:"green"}},[e._v("Online")])],1)]):i("div",[i("span",{staticClass:"font-weight-medium"},[i("v-chip",{attrs:{outlined:"",color:"yellow"}},[e._v("Offline")])],1)])]}},{key:"item.actions",fn:function(t){var a=t.item;return[i("v-btn",{attrs:{color:"pink",loading:a.isDeleting},on:{click:function(){return e.removeMinions(a)}}},[e._v(" Remove as slave ")])]}}]),model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}})],1)}),[],!1,null,null,null).exports,h={name:"discover-devices",components:{GridToolbar:u.a},props:["items","createMinions","isFetching"],data:function(){return{search:"",dialog:!1,isFetchingDevices:!1,selectedItems:[],headers:[{text:"Client Name",align:"start",sortable:!0,value:"client_name"},{text:"Device Name",align:"center",value:"device_name",sortable:!0},{text:"Site Name",align:"center",value:"site_name",sortable:!1},{text:"Latitude",align:"center",value:"site_lat",sortable:!1},{text:"Longitude",align:"center",value:"site_lon",sortable:!1},{text:"Site Address",align:"center",value:"site_address",sortable:!1},{text:"Actions",align:"center",value:"actions",sortable:!1}]}}},b=Object(p.a)(h,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("grid-toolbar",{attrs:{toolbarTitle:"Discover Devices"},scopedSlots:e._u([{key:"search",fn:function(){return[i("v-text-field",{staticClass:"pl-10",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]},proxy:!0},{key:"customAction",fn:function(){return[i("v-btn",{staticClass:"white--text",attrs:{disabled:0==e.selectedItems.length,"x-small":"",color:"green"},on:{click:function(){return e.createMinions(e.selectedItems)}}},[e._v("\n        Add as slave\n        "),i("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[e._v(" mdi-plus ")])],1)]},proxy:!0}])}),e._v(" "),i("v-data-table",{staticClass:"elevation-1",attrs:{"item-key":"global_uuid","show-select":"",loading:e.isFetching,search:e.search,headers:e.headers,items:e.items,"sort-by":"calories","footer-props":{showFirstLastPage:!0,firstIcon:"mdi-chevron-double-left",lastIcon:"mdi-chevron-double-right",prevIcon:"mdi-chevron-left",nextIcon:"mdi-chevron-right"}},scopedSlots:e._u([{key:"item.actions",fn:function(t){var a=t.item;return[a.isAddToSlaveVisible?i("v-btn",{attrs:{color:"green",loading:a.isUpdating},on:{click:function(){return e.createMinions(a)}}},[e._v("\n        Add as slave\n      ")]):i("div",[e._v("No actions available")])]}}]),model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}})],1)}),[],!1,null,null,null).exports,_=i("OBCi"),g=i.n(_),x=i("uzYq"),y="/minion-devices",D=function(e){var t={global_uuid:e.global_uuid};return x.a.post(y,t)},k=function(e){return g.a.all(e.map((function(e){return D(e)})))},I=function(e){var t=e.global_uuid;return x.a.delete(y+"/"+t)},w=function(e){return g.a.all(e.map((function(e){return I(e)})))},S={name:"master-minion-page",components:{PageTitle:d.a,DiscoverDevices:b,MinionDevices:f},watch:{"$route.query.tab":function(e){this.tab=this.tabs.indexOf(e)},tab:function(e,t){var i=this.$route.query.tab;if(i!==this.tabs[e]){var a=this.tabs[e];this.$router.push({path:"master-minions",query:{tab:a}})}}},data:function(){return{tab:0,tabs:["discover-devices","slave-devices"],minionDevices:[],devicesMap:{},minionDevicesMap:{},discoveredDevices:[],isFetchingMinionDevices:!1,isFetchingDevices:!1}},mounted:function(){var e=this.$route.query.tab;this.tab=this.tabs.indexOf(e)},created:function(){this.syncDevices()},methods:{formatAddress:function(e){var t="";return e.site_address&&(t+=e.site_address),e.site_city&&(t+=", "+e.site_city),e.site_country&&(t+=", "+e.site_country),t},syncDevices:function(){var e=this;return v()(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isFetchingMinionDevices=!0,e.isFetchingDevices=!0,t.next=4,e.fetchMinionDevices();case 4:return t.next=6,e.fetchDevices();case 6:case"end":return t.stop()}}),t,e)})))()},fetchMinionDevices:function(){var e=this;return x.a.get(y).then((function(t){e.minionDevicesMap=t,e.minionDevices=r()(t).map((function(i){return n()({},e.minionDevicesMap[i],{isDeleting:!1,site_address:e.formatAddress(t[i])})}))})).catch((function(t){e.$toasted.show("Error fetching minion devices",{type:"error"})})).finally((function(){e.isFetchingMinionDevices=!1}))},fetchDevices:function(){var e=this;return x.a.get(y+"/discover").then((function(t){e.devicesMap=t,e.discoveredDevices=r()(e.devicesMap).map((function(t){return n()({},e.devicesMap[t],{isUpdating:!1,isAddToSlaveVisible:!e.minionDevicesMap[t],site_address:e.formatAddress(e.devicesMap[t])})}))})).catch((function(t){e.$toasted.show("Error fetching remote devices",{type:"error"})})).finally((function(){e.isFetchingDevices=!1}))},createMinions:function(e){var t=this;e.isUpdating=!0;return(Array.isArray(e)&&e.length>0?k:D)(e).then((function(){t.$toasted.show("Successfully updated the device status."),t.syncDevices()})).catch((function(){t.$toasted.show("Error occured while updating the device status",{type:"error"})})).finally((function(){e.isUpdating=!1}))},removeMinions:function(e){var t=this;e.isDeleting=!0;return(Array.isArray(e)&&e.length>0?w:I)(e).then((function(){t.$toasted.show("Successfully remove the device as slave."),t.syncDevices()})).catch((function(){t.$toasted.show("Error occured while updating the device status",{type:"error"})})).finally((function(){e.isDeleting=!1}))}}},C=Object(p.a)(S,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("page-title",{attrs:{title:"Master Slave Mapping"}}),e._v(" "),i("v-tabs",{attrs:{dark:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[i("v-tab",{key:0},[e._v("Discover Devices ")]),e._v(" "),i("v-tab",{key:1},[e._v("Slave Devices ")])],1),e._v(" "),i("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[i("v-tab-item",{key:0},[i("discover-devices",{attrs:{items:e.discoveredDevices,"create-minions":e.createMinions,"is-fetching":e.isFetchingDevices}})],1),e._v(" "),i("v-tab-item",{key:1},[i("minion-devices",{attrs:{items:e.minionDevices,removeMinions:e.removeMinions,"is-fetching":e.isFetchingMinionDevices}})],1)],1)],1)}),[],!1,null,null,null);t.default=C.exports}}]);
//# sourceMappingURL=13.b052556c6e52529d1673.js.map