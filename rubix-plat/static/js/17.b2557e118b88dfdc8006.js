(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"/NG7":function(t,e,a){"use strict";a.r(e);var n={};a.r(n),a.d(n,"fetchOpenVPNConfig",(function(){return D}));var s=a("tZmG"),i=a.n(s),o=a("06Hw"),l=a.n(o),r=a("YYXh"),c=a.n(r),p=a("Kz1y"),d=a.n(p),u=a("TcPG"),v=a.n(u),f=a("mQ3e"),h=a.n(f),m=a("OBCi"),g=a.n(m),_=a("nz6T"),w=a("8XWa"),b=a("uzYq"),D=function(t,e,a){return b.a.get("/rubix-master/openvpn-config/"+t).then((function(n){var s=n.data;return e.saveOpenVPNConfig(a,s,t).then((function(t){return t.data}))}))},S=a("A5Vd"),A={name:"app-edit-config",props:["appDetail","closeDialog","isSlaveApp"],data:function(){return{config:null,slaveId:null,apiOpenVPNService:null,apiService:null,isFetchingConfig:!1,isSavingConfig:!1,isRestartConfig:!1,appDetails:[],isArray:!1,appType:null,configType:null,jsonConfigType:S.f,envConfigType:S.e,openVpnConfigType:S.i,file:null,rules:{ovpnExtensionValidator:function(t){return t&&t.name.toLowerCase().includes(".ovpn")||"Extension not supported."}}}},mounted:function(){this.isSlaveApp?(this.slaveId=this.appDetail.slaveId,this.apiService=w):this.apiService=_,this.apiOpenVPNService=n,this.appDetails=Array.isArray(this.appDetail)?this.appDetail:[this.appDetail],this.appType=this.appDetails[0].app_type,this.fetchAppConfig(),this.configType=this.getConfigType(this.appType)},methods:{getConfigType:function(t){return S.b[t]},getAppDetailType:function(t){var e=Array.isArray(t)&&t.length>0;return{isArray:e,firstItem:e&&t[0]}},onFileSelect:function(){var t=this;this.file&&this.file.text().then((function(e){t.config=e})).catch((function(){t.$toasted.show("Cannot parse file",{type:"error"})}))},fetchAppConfig:function(){var t=this,e=this.appDetails[0].service,a=this.appType,n=this.appDetails[0].slaveId;this.isFetchingConfig=!0,this.apiService.fetchAppConfig(e,a,{restrictToast:!0,slaveId:n}).then((function(e){t.config=e})).catch((function(t){})).finally((function(){t.isFetchingConfig=!1}))},resetConfig:function(){var t=this;this.isRestartConfig=!0;var e=this.appDetails[0].display_name;g.a.all(this.appDetails.map((function(e){return t.apiOpenVPNService.fetchOpenVPNConfig(e.slaveId||t.$store.state.setting.global_uuid,t.apiService,e.service)}))).then((function(a){t.$toasted.show("Successfully updated config for "+e),t.closeDialog()})).catch((function(a){t.$toasted.show("Failed to update config for "+e,{type:"error"})})).finally((function(){t.isRestartConfig=!1}))},saveConfig:function(){var t=this;this.isSavingConfig=!0;var e=this.appDetails[0].display_name;g.a.all(this.appDetails.map((function(e){return t.apiService.saveAppConfig(e.service,t.appType,t.config,e.slaveId)}))).then((function(a){t.$toasted.show("Successfully updated config for "+e),t.closeDialog()})).catch((function(a){t.$toasted.show("Failed to update config for "+e,{type:"error"})})).finally((function(){t.isSavingConfig=!1}))}}},C=a("psIG"),x=Object(C.a)(A,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{loading:t.isFetchingConfig}},[a("v-card-title",[t._v("Edit Config")]),t._v(" "),a("v-card-text",[a("v-container",[t.configType===t.jsonConfigType?a("v-jsoneditor",{attrs:{options:{mode:"code"},plus:!1,height:"400px"},model:{value:t.config,callback:function(e){t.config=e},expression:"config"}}):t._e(),t._v(" "),t.configType===t.envConfigType?a("v-textarea",{attrs:{outlined:"",name:"input-7-4",label:"Enter ENV config"},model:{value:t.config,callback:function(e){t.config=e},expression:"config"}}):t._e(),t._v(" "),t.configType===t.openVpnConfigType?a("div",[a("v-row",{attrs:{dense:""}},[a("v-col",{staticClass:"mb-5",attrs:{cols:"12"}},[a("v-file-input",{attrs:{rules:[t.rules.ovpnExtensionValidator],counter:"","show-size":"","truncate-length":"15"},on:{change:t.onFileSelect},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}})],1),t._v(" "),a("v-col",{attrs:{cols:"12"}},[a("v-textarea",{attrs:{outlined:"",name:"input-7-4",label:"OpenVPN Config"},model:{value:t.config,callback:function(e){t.config=e},expression:"config"}})],1)],1)],1):t._e()],1)],1),t._v(" "),a("v-card-actions",[a("v-btn",{attrs:{small:"",text:""},on:{click:t.closeDialog}},[t._v("Cancel")]),t._v(" "),t.configType===t.openVpnConfigType&&this.$store.state.mqttRestBridgeConfig.enabled?a("v-btn",{staticClass:"mr-1 btn-height-22 white--text",attrs:{"x-small":"",color:"warning",loading:t.isRestartConfig},on:{click:t.resetConfig}},[t._v("Restart Config\n    ")]):t._e(),t._v(" "),a("v-btn",{staticClass:"mr-1 btn-height-22 white--text",attrs:{"x-small":"",color:"primary",loading:t.isSavingConfig},on:{click:t.saveConfig}},[t._v("Save\n    ")])],1)],1)}),[],!1,null,"a806325a",null).exports,y=a("7Ipj"),k=a("KRMY"),I=a("MKDl"),V=a("7Vew");var N={name:"apps-download-multi-step",props:["app-details","close-dialog","deleteDownloadState","currentDownloadState","fetchDownloadAppState","clearDownloadAppStateInterval"],components:{AppStatusChip:I.a,TextFieldDisplay:V.a},data:function(){return{valid:!1,currentView:1,appReleases:[],serviceStatus:{},isFetchingAppStatus:!1,selectedVersion:null,multiStepViewConfig:{1:{back:1,forward:2,title:"App Status",hasBack:!1,disabled:!1,hasForward:!0,buttonLabel:function(t){return"Continue"},loader:!1},2:{back:1,forward:3,title:"Download App",hasBack:!0,disabled:!1,hasForward:!0,buttonLabel:"Download",loader:!1},3:{back:2,forward:4,title:"Install App",hasBack:!0,hasForward:!0,buttonLabel:"Install",loader:!1,disabled:!1},4:{back:3,forward:4,title:"Installation Complete",hasBack:!0,hasForward:!0,buttonLabel:"Ok",loader:!1,disabled:!1}},loading:!0,rules:{required:function(t){return!!t||"Required."}},versionRules:[function(t){return!!t||"Version No. is required."}]}},mounted:function(){var t=this;return c()(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.appDetails.service,t.loading=!0,e.next=4,t.fetchAppStatus();case 4:return e.next=6,_.fetchAppReleases(a).then((function(e){t.appReleases=e,t.loading=!1})).catch((function(t){console.error(t)})).finally((function(){t.loading=!1}));case 6:case"end":return e.stop()}}),e,t)})))()},updated:function(){this.currentDownloadState!==S.c.DOWNLOAD_IN_PROGRESS&&this.currentDownloadState?this.multiStepViewConfig[3].disabled=!1:this.multiStepViewConfig[3].disabled=!0},watch:{currentDownloadState:function(t,e){this.showDownloadStateView(t)}},methods:{showDownloadStateView:function(t){switch(t){case S.c.DOWNLOAD_IN_PROGRESS:this.currentView=3;break;case S.c.DOWNLOAD_COMPLETE:this.currentView=3,this.clearDownloadAppStateInterval()}},back:function(){this.currentView=this.currentView-1},cancel:function(){3!==this.currentView&&2!==this.currentView||this.deleteDownloadState(),this.closeDialog(!0)},next:function(t){var e=this;return c()(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.currentView,t.t0=a,t.next=1===t.t0?4:2===t.t0?6:3===t.t0?8:4===t.t0?10:12;break;case 4:return e.stopAndContinue(),t.abrupt("break",14);case 6:return e.download(),t.abrupt("break",14);case 8:return e.install(),t.abrupt("break",14);case 10:return e.continue(),t.abrupt("break",14);case 12:return e.currentView++,t.abrupt("break",14);case 14:case"end":return t.stop()}}),t,e)})))()},stopAndContinue:function(){this.serviceStatus.status,this.serviceStatus.service;this.serviceStatus,this.currentView++},continue:function(){this.closeDialog(!0)},spinLoader:function(t){this.multiStepViewConfig[this.currentView].loader=t},download:function(){var t=this;return c()(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$refs.downloadForm.validate()){e.next=3;break}return e.abrupt("return");case 3:t.spinLoader(!0),a={service:t.appDetails.service,version:t.selectedVersion},_.downloadApp(a).then((function(e){t.currentView=3,t.fetchDownloadAppState(),t.spinLoader(!1)})).catch((function(e){e&&e.message&&(t.versionRules.push((function(){return e.message})),t.$refs.downloadForm.validate(),t.versionRules.pop()),t.spinLoader(!1)}));case 6:case"end":return e.stop()}}),e,t)})))()},install:function(){var t=this;this.spinLoader(!0);var e={service:this.appDetails.service,version:this.selectedVersion},a=0;_.installApp(e).then((function(e){t.spinLoader(!1),t.fetchAppStatus(),t.currentView++})).catch((function(e){"RUBIX_PLAT"===t.appDetails.service?(t.$toasted.show("The application is being self upgraded/restarted. It may be unresponsive for a few seconds in all locations.",{type:"info"}),t.spinLoader(!1),t.currentView++,a=5e3):(t.spinLoader(!1),t.currentView--,e&&e.message&&(t.versionRules.push((function(){return e.message})),t.$refs.downloadForm.validate(),t.versionRules.pop()))})).finally((function(){setTimeout((function(){t.deleteDownloadState()}),a)}))},fetchAppStatus:function(){var t=this;return this.isFetchingAppStatus=!0,_.fetchAppStatus(this.appDetails.service,{restrictToast:!0}).then((function(e){t.selectedVersion=e.version,t.serviceStatus=e})).catch((function(e){t.selectedVersion=null,t.serviceStatus={}})).finally((function(){t.isFetchingAppStatus=!1}))}}},L=Object(C.a)(N,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{loading:t.isFetchingAppStatus}},[a("v-card-title",[t.multiStepViewConfig[t.currentView].hasBack?a("v-btn",{staticClass:"mr-1",attrs:{icon:"",medium:""},on:{click:t.back}},[a("v-icon",{attrs:{medium:""}},[t._v(" mdi-arrow-left ")])],1):t._e(),t._v(" "),a("span",{staticClass:"headline"},[t._v(t._s(t.multiStepViewConfig[t.currentView].title))])],1),t._v(" "),a("v-card-text",[a("v-stepper",{model:{value:t.currentView,callback:function(e){t.currentView=e},expression:"currentView"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:t.currentView>1,step:"1"}},[t._v(" 1 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>2,step:"2"}},[t._v(" 2 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>3,step:"3"}},[t._v(" 3 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{step:"4"}},[t._v(" 4 ")])],1),t._v(" "),a("v-stepper-items",[a("v-stepper-content",{attrs:{step:"1"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Name",value:t.appDetails.display_name}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[a("text-field-display",{attrs:{label:"Active",value:(!t.isFetchingAppStatus&&t.serviceStatus.time_since?t.serviceStatus.time_since:"-")||"N/A"}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[a("app-status-chip",{attrs:{state:t.serviceStatus.state}})],1),t._v(" "),a("v-col",{staticClass:"text-right",attrs:{cols:"1"}},[a("v-btn",{attrs:{icon:"",medium:"",color:"nubeGreen"},on:{click:t.fetchAppStatus}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-refresh ")])],1)],1)],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Version",value:!t.isFetchingAppStatus&&t.serviceStatus.version?t.serviceStatus.version:"-"}})],1)],1)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{ref:"downloadForm",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Name",value:t.appDetails.display_name}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[a("text-field-display",{attrs:{label:"Active",value:(!t.isFetchingAppStatus&&t.serviceStatus.time_since?t.serviceStatus.time_since:"-")||"N/A"}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[a("app-status-chip",{attrs:{state:t.serviceStatus.state}})],1),t._v(" "),a("v-col",{staticClass:"text-right",attrs:{cols:"1"}},[a("v-btn",{attrs:{icon:"",medium:"",color:"nubeGreen"},on:{click:t.fetchAppStatus}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-refresh ")])],1)],1)],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Version",value:!t.isFetchingAppStatus&&t.serviceStatus.version?t.serviceStatus.version:"-"}})],1)],1),t._v(" "),a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-combobox",{attrs:{loading:t.loading,items:t.appReleases,label:"Select Release Version",clearable:"","item-text":"name","item-value":"tag_name",rules:t.versionRules},model:{value:t.selectedVersion,callback:function(e){t.selectedVersion=e},expression:"selectedVersion"}})],1)],1)],1)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"3"}},[a("div",{staticClass:"text-left"},[t.currentDownloadState?t._e():a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n              Fetching download status "),a("strong",[t._v("Please Wait!")])]),t._v(" "),"DOWNLOAD_IN_PROGRESS"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n              Downloading Selected App "),a("strong",[t._v("Please Wait!")])]):t._e(),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"success"}},[t._v("\n              Downloading Completed\n            ")]):t._e()],1),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("div",{staticClass:"pt-3"},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"6"}},[a("div",{staticClass:"grey--text mb-2 caption"},[t._v("Name")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                  "+t._s(t.appDetails.display_name+" - "+t.appDetails.service)+"\n                ")])]),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text mb-2 caption"},[t._v("Version")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                  "+t._s(t.isFetchingAppStatus?"-":t.selectedVersion)+"\n                ")])])],1)],1):t._e()]),t._v(" "),a("v-stepper-content",{attrs:{step:"4"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"12"}},[a("div",{staticClass:"font-weight-large"},[t._v("Successfully installed "+t._s(t.appDetails.display_name)+" app.")])])],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text caption mb-2"},[t._v("Name")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.appDetails.display_name)+"\n              ")])]),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text caption mb-2"},[a("span",[t._v("Version")])]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.selectedVersion)+"\n              ")])])],1)],1)],1)],1)],1),t._v(" "),a("v-card-actions",[t.multiStepViewConfig[t.currentView].hasForward?a("v-btn",{staticClass:"btn-height-22 white--text",attrs:{"x-small":"",color:"primary",disabled:t.multiStepViewConfig[t.currentView].disabled,loading:t.multiStepViewConfig[t.currentView].loader},on:{click:t.next}},[t._v("\n      "+t._s("function"==typeof t.multiStepViewConfig[t.currentView].buttonLabel?t.multiStepViewConfig[t.currentView].buttonLabel(t.serviceStatus):t.multiStepViewConfig[t.currentView].buttonLabel)+"\n    ")]):t._e(),t._v(" "),a("v-btn",{attrs:{small:"",text:""},on:{click:t.cancel}},[t._v(" Cancel ")])],1)],1)}),[],!1,null,null,null).exports,E=a("OKta");function F(t){return t.status&&S.a.RUBIX_PLAT!==t.service}var R,O={name:"apps-upload-multi-step",props:["app-details","close-dialog","isSlaveApp"],components:{AppStatusChip:I.a,TextFieldDisplay:V.a,RbxButton:E.a},data:function(){return{isDeleteAppData:!1,isDeletingAppData:!1,valid:!1,currentView:1,version:null,serviceStatus:{},isFetchingAppStatus:!1,isStartingApp:!1,errorMessage:"",file:null,rubixAppTypes:S.k,apiService:null,slaveId:null,multiStepViewConfig:{1:{back:1,forward:2,title:function(t){return t+" | App Status"},hasBack:!1,hasForward:!0,buttonLabel:function(t){return F(t)?"Stop":"Continue"},loader:!1},2:{back:1,forward:3,title:function(t){return t+" | Upload App"},hasBack:!0,hasForward:!0,buttonLabel:"Upload",loader:!1},3:{back:2,forward:4,title:function(t){return t+" | Install App"},hasBack:!0,hasForward:!0,buttonLabel:"Install",loader:!1},4:{back:3,forward:4,title:function(t){return t+" | Installation Complete"},hasBack:!0,hasForward:!0,buttonLabel:"Ok",loader:!1}},loading:!0,rules:{required:function(t){return!!t||"Required."}},versionRules:[function(t){return!!t||"Version No. is required."}]}},mounted:function(){var t=this;return c()(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isSlaveApp?(t.apiService=w,t.slaveId=t.appDetails.slaveId):t.apiService=_,e.next=3,t.fetchAppStatus();case 3:case"end":return e.stop()}}),e,t)})))()},methods:{back:function(){this.currentView=this.currentView-1},cancel:function(){this.closeDialog(!0)},next:function(t){var e=this;return c()(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.currentView,t.t0=a,t.next=1===t.t0?4:2===t.t0?6:3===t.t0?8:4===t.t0?10:12;break;case 4:return e.stopAndContinue(),t.abrupt("break",14);case 6:return e.upload(),t.abrupt("break",14);case 8:return e.install(),t.abrupt("break",14);case 10:return e.continue(),t.abrupt("break",14);case 12:return e.currentView++,t.abrupt("break",14);case 14:case"end":return t.stop()}}),t,e)})))()},stopAndContinue:function(){var t=this,e=(this.serviceStatus.status,this.serviceStatus.service);F(this.serviceStatus)?(this.spinLoader(!0),this.apiService.changeServiceStatus(S.j.STOP,e,this.slaveId).then((function(e){return t.spinLoader(!1),t.currentView++,t.fetchAppStatus()})).catch((function(e){t.spinLoader(!1)}))):this.currentView++},startApp:function(){var t=this,e=this.serviceStatus.service;this.isStartingApp=!0,this.apiService.changeServiceStatus(S.j.START,e,this.slaveId).then((function(a){return t.$toasted.show("Successfully started "+e),t.continue(),t.fetchAppStatus()})).catch((function(a){t.$toasted.show("Could not start "+e,{type:"error"})})).finally((function(){t.isStartingApp=!1}))},continue:function(){this.closeDialog(!0)},spinLoader:function(t){this.multiStepViewConfig[this.currentView].loader=t},upload:function(){var t=this;this.$refs.uploadForm.validate()&&(this.spinLoader(!0),this.apiService.uploadApp(this.file,this.appDetails.service,this.version,this.slaveId).then((function(e){t.currentView++})).catch((function(e){e&&e.message&&(t.errorMessage=e.message)})).finally((function(){t.spinLoader(!1)})))},install:function(){var t=this;this.spinLoader(!0);var e={service:this.appDetails.service,version:this.version};this.apiService.installApp(e,this.slaveId).then((function(e){t.spinLoader(!1),t.fetchAppStatus(),t.currentView++,t.errorMessage=""})).catch((function(e){t.spinLoader(!1),F(t.serviceStatus)?t.currentView--:t.currentView++,e&&e.message&&F(t.serviceStatus)&&(t.errorMessage=e.message)}))},fetchAppStatus:function(){var t=this;return this.isFetchingAppStatus=!0,this.apiService.fetchAppStatus(this.appDetails.service,{restrictToast:!0},this.slaveId).then((function(e){t.serviceStatus=e})).catch((function(e){t.serviceStatus={}})).finally((function(){t.isFetchingAppStatus=!1}))},onFileSelect:function(){if(this.file&&this.file.name){var t=this.file.name,e=new RegExp("[0-9].[0-9].[0-9]"),a=t.match(e,"");a&&Array.isArray(a)&&(a=a[0],this.version="v"+a)}},deleteAppData:function(){var t=this;this.isDeletingAppData=!0,this.apiService.deleteAppData(this.serviceStatus.service,this.slaveId).then((function(){t.$toasted.show("Successfully deleted app data"),t.isDeleteAppData=!1})).catch((function(){t.$toasted.show("Cannot deleted app data",{type:"error"})})).finally((function(){t.isDeletingAppData=!1}))},toggleDeleteAppData:function(){this.isDeleteAppData=!this.isDeleteAppData}}},T=Object(C.a)(O,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{loading:t.isFetchingAppStatus}},[a("v-card-title",[t.multiStepViewConfig[t.currentView].hasBack?a("v-btn",{staticClass:"mr-1",attrs:{icon:"",medium:""},on:{click:t.back}},[a("v-icon",{attrs:{medium:""}},[t._v(" mdi-arrow-left ")])],1):t._e(),t._v(" "),a("span",{staticClass:"sub-headline"},[t._v(t._s(t.multiStepViewConfig[t.currentView].title(t.appDetails.display_name)))])],1),t._v(" "),a("v-card-text",[a("v-stepper",{model:{value:t.currentView,callback:function(e){t.currentView=e},expression:"currentView"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:t.currentView>1,step:"1"}},[t._v(" 1 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>2,step:"2"}},[t._v(" 2 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>3,step:"3"}},[t._v(" 3 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{step:"4"}},[t._v(" 4 ")])],1),t._v(" "),a("v-stepper-items",[a("v-stepper-content",{attrs:{step:"1"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Name",value:t.appDetails.display_name}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"2"}},[a("text-field-display",{attrs:{label:"Active",value:(!t.isFetchingAppStatus&&t.serviceStatus.time_since?t.serviceStatus.time_since:"-")||"N/A"}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[t.isFetchingAppStatus?t._e():a("app-status-chip",{attrs:{state:t.serviceStatus.state}})],1),t._v(" "),a("v-col",{staticClass:"text-right",attrs:{cols:"1"}},[a("v-btn",{attrs:{icon:"",medium:"",color:"nubeGreen"},on:{click:t.fetchAppStatus}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-refresh ")])],1)],1)],1)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{ref:"uploadForm",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Name",value:t.appDetails.display_name}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"2"}},[a("text-field-display",{attrs:{label:"Active",value:(!t.isFetchingAppStatus&&t.serviceStatus.time_since?t.serviceStatus.time_since:"-")||"N/A"}})],1),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"3"}},[t.isFetchingAppStatus?t._e():a("app-status-chip",{attrs:{state:t.serviceStatus.state}})],1),t._v(" "),a("v-col",{staticClass:"text-right",attrs:{cols:"1"}},[a("v-btn",{attrs:{icon:"",medium:"",color:"nubeGreen"},on:{click:t.fetchAppStatus}},[a("v-icon",{attrs:{medium:"",dark:""}},[t._v(" mdi-refresh ")])],1)],1)],1),t._v(" "),a("v-row",{attrs:{dense:""}},[a("v-col",{staticClass:"white--text",attrs:{cols:"12"}},[a("v-file-input",{attrs:{rules:[t.rules.required],counter:"","show-size":"","truncate-length":"15"},on:{change:t.onFileSelect},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}})],1),t._v(" "),a("v-col",{staticClass:"text-left ml-8",attrs:{cols:"12"}},[a("v-text-field",{attrs:{label:"Version",type:"text","single-line":"",rules:[t.rules.required]},model:{value:t.version,callback:function(e){t.version=e},expression:"version"}})],1)],1),t._v(" "),t.errorMessage?a("v-alert",{staticClass:"text-left",attrs:{dense:"",outlined:"",type:"error"}},[t._v("\n              "+t._s(t.errorMessage)+"\n            ")]):t._e()],1)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"3"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"6"}},[a("div",{staticClass:"grey--text mb-2 caption"},[t._v("Name")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.appDetails.display_name+" - "+t.appDetails.service)+"\n              ")])]),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text mb-2 caption"},[t._v("Version")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.version)+"\n              ")])]),t._v(" "),t.serviceStatus.app_type===t.rubixAppTypes.PYTHON_APP?a("v-col",{staticClass:"text-left",attrs:{cols:"12"}},[t.isDeleteAppData?t._e():a("rbx-button",{attrs:{color:"pink",click:t.toggleDeleteAppData,title:"Delete App Data"}}),t._v(" "),t.isDeleteAppData?a("v-card",[a("v-card-title",{staticClass:"headline"},[t._v(" Confirm? ")]),t._v(" "),a("v-card-text",[t._v("Do you want to delete app data?")]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"nubeGreen",text:""},on:{click:function(e){t.isDeleteAppData=!1}}},[t._v(" Cancel ")]),t._v(" "),a("v-btn",{attrs:{color:"red darken-1",loading:t.isDeletingAppData,text:""},on:{click:t.deleteAppData}},[t._v(" Yes ")])],1)],1):t._e()],1):t._e()],1)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"4"}},[a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"12"}},[a("div",{staticClass:"font-weight-large"},[t._v("Successfully installed "+t._s(t.appDetails.display_name)+" app.")])])],1),t._v(" "),a("v-row",[a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text caption mb-2"},[t._v("Name")]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.appDetails.display_name)+"\n              ")])]),t._v(" "),a("v-col",{staticClass:"text-left",attrs:{cols:"4"}},[a("div",{staticClass:"grey--text caption mb-2"},[a("span",[t._v("Version")])]),t._v(" "),a("div",{staticClass:"font-weight-medium"},[t._v("\n                "+t._s(t.serviceStatus.version)+"\n              ")])]),t._v(" "),a("v-col",{attrs:{cols:"4"}},[a("rbx-button",{attrs:{color:"nubeGreen",click:t.startApp,loading:t.isStartingApp,title:"Start App"}})],1)],1)],1)],1)],1)],1),t._v(" "),a("v-card-actions",[t.multiStepViewConfig[t.currentView].hasForward?a("v-btn",{staticClass:"btn-height-22 white--text",attrs:{"x-small":"",color:"primary",loading:t.multiStepViewConfig[t.currentView].loader},on:{click:t.next}},[t._v("\n      "+t._s("function"==typeof t.multiStepViewConfig[t.currentView].buttonLabel?t.multiStepViewConfig[t.currentView].buttonLabel(t.serviceStatus):t.multiStepViewConfig[t.currentView].buttonLabel)+"\n    ")]):t._e(),t._v(" "),a("v-btn",{attrs:{small:"",text:""},on:{click:t.cancel}},[t._v(" Cancel ")])],1)],1)}),[],!1,null,null,null).exports,M=a("Ui9F"),P=(a("KSAc"),"DOWNLOAD_IN_PROGRESS"),$="DOWNLOAD_COMPLETE",B=(R={props:["selectedApps","clearSelectedApps","closeDialog","fetchDownloadAppState","currentDownloadState","appDownloadStates","clearDownloadAppStateInterval","deleteDownloadState"],components:{AppStatusChip:I.a,TextFieldDisplay:V.a},data:function(){return{versionForm:!1,renderReleaseCount:0,isFetchingAppStatuses:!1,successInstallApps:[],failureInstallApps:[],currentView:1,refreshTime:1e4,versionRules:[function(t){return!!t||"Version No. is required."}],multiStepViewConfig:{1:{hasBack:!1,hasForward:!0,title:"Selected Apps",buttonLabel:"Continue",loader:!1,disabled:!1,hasCancel:!0},2:{hasBack:!0,hasForward:!0,title:"Download",buttonLabel:"Download App",loader:!1,disabled:!1,hasCancel:!0},3:{hasBack:!1,hasForward:!0,title:"Download",buttonLabel:"Install",hasCancelInstallation:!0,loader:!1,disabled:!0,hasCancel:!0,cancelTitle:"Close"},4:{hasBack:!1,hasForward:!0,title:"Installation Complete",buttonLabel:"Ok",loader:!1,disabled:!1,hasCancel:!1}}}},updated:function(){this.hasSelectedApps||this.currentDownloadState||this.currentDownloadState===$?this.multiStepViewConfig[1].disabled=!1:(this.currentView=1,this.multiStepViewConfig[1].disabled=!0),this.currentDownloadState!==P&&this.currentDownloadState?this.multiStepViewConfig[3].disabled=!1:this.multiStepViewConfig[3].disabled=!0},watch:{currentDownloadState:function(t,e){this.showDownloadStateView(t)}},created:function(){this.showDownloadStateView(this.currentDownloadState)},computed:{currentBulkAppDownloadState:function(){return this.$store.state.currentBulkAppDownloadState},hasSelectedApps:function(){return this.selectedApps.length>0},apps:function(){return this.selectedApps.map((function(t){return{serviceName:t.service,state:t.state,version:t.version,latestVersion:t.latest_version,minVersion:t.min_support_version,displayName:t.display_name,loadingReleases:!1,releases:[]}}))},downloadStates:function(){return Array.isArray(this.appDownloadStates)&&this.appDownloadStates.length>0&&(this.currentView=3),(this.appDownloadStates||[]).map((function(t){return{isDownloading:!t.download,version:t.version,serviceName:t.service,hasError:!!t.error,errorMessage:t.error}}))}}},v()(R,"created",(function(){this.fetchAppsReleases()})),v()(R,"methods",{back:function(){this.currentView=this.currentView-1},spinLoader:function(t){this.multiStepViewConfig[this.currentView].loader=t},showDownloadStateView:function(t){switch(t){case P:this.currentView=3;break;case $:this.currentView=3,this.clearDownloadAppStateInterval()}},fetchAppsReleases:function(){var t=this,e=this.selectedApps.map((function(t){return t.service}));return this.apps.forEach((function(t){t.loadingReleases=!0})),_.fetchAppsReleases(e).then((function(e){t.apps.forEach((function(t,a){t.releases=e[a]}))})).catch((function(){t.$toasted.show("Error fetching available releases")})).finally((function(){t.apps.forEach((function(t){t.loadingReleases=!1})),t.renderReleaseCount++}))},disableInstallationButton:function(){this.multiStepViewConfig[3].disabled=!0},bulkDownloadApps:function(){var t=this;this.currentView=3,this.disableInstallationButton();var e=this.apps.map((function(t){return{version:t.version,service:t.serviceName}}));return this.spinLoader(!0),_.bulkDownloadApps(e).then((function(){t.spinLoader(!1),t.fetchDownloadAppState()})).catch((function(e){t.spinLoader(!1)}))},next:function(t){var e=this;return c()(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.currentView,t.t0=a,t.next=1===t.t0?4:2===t.t0?6:3===t.t0?8:4===t.t0?10:12;break;case 4:return e.stopAndContinue(),t.abrupt("break",14);case 6:return e.download(),t.abrupt("break",14);case 8:return e.install(),t.abrupt("break",14);case 10:return e.continue(),t.abrupt("break",14);case 12:return e.currentView++,t.abrupt("break",14);case 14:case"end":return t.stop()}}),t,e)})))()},stopAndContinue:function(){this.currentView++},download:function(){this.$refs.versionForm.validate()&&this.bulkDownloadApps()},install:function(){var t=this,e=this.downloadStates.filter((function(t){return!t.hasError})).map((function(t){return{service:t.serviceName,version:t.version}}));return this.spinLoader(!0),_.bulkInstallApps(e).then((function(e){t.spinLoader(!1),t.currentView=4,t.successInstallApps=e.filter((function(t){return t.installation})),t.failureInstallApps=e.filter((function(t){return!t.installation}))})).catch((function(e){t.spinLoader(!1),t.deleteDownloadState(),t.$toasted.show("Unexpected error occured while bulk installing apps. Please try again")}))},continue:function(){this.resetDialog()},cancel:function(){this.fetchDownloadAppState(),this.closeDialog()},cancelInstallation:function(){this.resetDialog()},resetDialog:function(){this.versionForm=!1,this.renderReleaseCount=0,this.isFetchingAppStatuses=!1,this.currentView=1,this.multiStepViewConfig={1:{hasBack:!1,hasForward:!0,title:"Selected Apps",buttonLabel:"Continue",loader:!1},2:{hasBack:!0,hasForward:!0,title:"Download",buttonLabel:"Download App",loader:!1},3:{hasBack:!1,hasForward:!0,title:"Download",buttonLabel:"Install",loader:!1},4:{hasBack:!1,hasForward:!0,title:"Installation Complete",buttonLabel:"Ok",loader:!1}},this.deleteDownloadState(),this.fetchAppsReleases(),this.clearSelectedApps(),this.closeDialog(!0,{unmount:!0})}}),R),G=Object(C.a)(B,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{loading:t.isFetchingAppStatuses}},[a("v-card-title",[t.multiStepViewConfig[t.currentView].hasBack?a("v-btn",{staticClass:"mr-1",attrs:{icon:"",medium:""},on:{click:t.back}},[a("v-icon",{attrs:{medium:""}},[t._v(" mdi-arrow-left ")])],1):t._e(),t._v(" "),a("span",{staticClass:"sub-headline"},[t._v(" Bulk Apps | "+t._s(t.multiStepViewConfig[t.currentView].title)+" ")])],1),t._v(" "),a("v-card-text",[a("v-stepper",{model:{value:t.currentView,callback:function(e){t.currentView=e},expression:"currentView"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:t.currentView>1,step:"1"}},[t._v(" 1 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>2,step:"2"}},[t._v(" 2 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>3,step:"3"}},[t._v(" 3 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{step:"4"}},[t._v(" 4 ")])],1),t._v(" "),a("v-stepper-items",[a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"1"}},[t.hasSelectedApps?t._e():a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n            Please select apps from the grid to bulk download.\n          ")]),t._v(" "),a("v-list",{staticClass:"text-left",attrs:{flat:"",subheader:"",dense:""}},[a("v-subheader",[t._v("Selected Apps")]),t._v(" "),t._l(t.apps,(function(e,n){return a("v-list-item",{key:"selected_apps-"+n},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.displayName)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.version)}})],1),t._v(" "),a("v-list-item-icon",[a("app-status-chip",{attrs:{state:e.state}})],1)],1)}))],2)],1),t._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("v-form",{ref:"versionForm",attrs:{"lazy-validation":""},model:{value:t.versionForm,callback:function(e){t.versionForm=e},expression:"versionForm"}},[a("v-row",{staticClass:"text-left",attrs:{dense:""}},t._l(t.apps,(function(e,n){return a("v-col",{key:"version-form-"+t.renderReleaseCount+"-"+n,attrs:{cols:"12"}},[a("v-row",{attrs:{dense:""}},[a("v-col",{attrs:{cols:"4"}},[a("text-field-display",{attrs:{label:"Name",value:e.displayName}})],1),t._v(" "),a("v-col",{attrs:{cols:"8"}},[a("v-combobox",{attrs:{loading:e.loadingReleases,items:e.releases,label:"Select Release Version",hideSelected:"",clearable:"","item-text":"name","item-value":"tag_name",rules:t.versionRules},model:{value:e.version,callback:function(a){t.$set(e,"version",a)},expression:"app.version"}})],1)],1)],1)})),1)],1)],1),t._v(" "),a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"3"}},[a("div",["DOWNLOAD_IN_PROGRESS"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n              Downloading Selected App(s) "),a("strong",[t._v("Please Wait!")])]):t._e(),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"success"}},[t._v("\n              Downloading Completed\n            ")]):t._e()],1),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-list",{staticClass:"text-left",attrs:{flat:"",subheader:"",dense:""}},[a("v-subheader",[t._v("App Download Statuses")]),t._v(" "),t._l(t.downloadStates,(function(e,n){return a("v-list-item",{key:"download-statuses-"+n},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.serviceName)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.version)}})],1),t._v(" "),a("v-list-item-icon",[e.isDownloading?a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"downloadColor"}},[t._v("Downloading")])],1)]):e.hasError?a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"red"}},[t._v("Failed")])],1)]):e.isDownloading||e.hasError?t._e():a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"nubeGreen"}},[t._v("Downloaded")])],1)])])],1)}))],2):t._e()],1),t._v(" "),a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"4"}},["DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-list",{staticClass:"text-left",attrs:{flat:"",subheader:"",dense:""}},[t.successInstallApps.length>0?a("v-list-item-group",[a("v-subheader",[t._v("Installation Completed Apps")]),t._v(" "),t._l(t.successInstallApps,(function(e,n){return a("v-list-item",{key:"install-complete-"+n},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.service)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.version)}})],1),t._v(" "),a("v-list-item-icon",[a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"blue"}},[t._v("Installed")])],1)])])],1)}))],2):t._e(),t._v(" "),t.failureInstallApps.length>0?a("v-list-item-group",[a("v-subheader",[t._v(" Installation Failed Apps")]),t._v(" "),t._l(t.failureInstallApps,(function(e,n){return a("v-list-item",{key:"installation-failed-"+n},[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:t._s(e.service)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.version)}}),t._v(" "),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.error)}})],1),t._v(" "),a("v-list-item-icon",[a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"red"}},[t._v("Failed")])],1)])])],1)}))],2):t._e()],1):t._e()],1)],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-card-actions",[t.multiStepViewConfig[t.currentView].hasForward?a("v-btn",{staticClass:"btn-height-22 white--text",attrs:{"x-small":"",color:"primary",loading:t.multiStepViewConfig[t.currentView].loader,disabled:t.multiStepViewConfig[t.currentView].disabled},on:{click:t.next}},[t._v("\n        "+t._s("function"==typeof t.multiStepViewConfig[t.currentView].buttonLabel?t.multiStepViewConfig[t.currentView].buttonLabel(t.serviceStatus):t.multiStepViewConfig[t.currentView].buttonLabel)+"\n      ")]):t._e(),t._v(" "),t.multiStepViewConfig[t.currentView].hasCancelInstallation?a("v-btn",{attrs:{small:"",color:"pink",disabled:t.multiStepViewConfig[t.currentView].disabled,text:""},on:{click:t.cancelInstallation}},[t._v("\n        Cancel Install\n      ")]):t._e(),t._v(" "),t.multiStepViewConfig[t.currentView].hasCancel?a("v-btn",{attrs:{small:"",text:""},on:{click:t.cancel}},[t._v(" Close ")]):t._e()],1)],1)],1)}),[],!1,null,null,null).exports,U=a("Jkoc"),j=a("lkCm"),z="DOWNLOAD_IN_PROGRESS",W="DOWNLOAD_COMPLETE",H={name:"systemServices",components:{GridToolbar:y.a,ConfirmDialog:j.a,AppStatusChip:I.a,AppsEditConfig:x,ConfigureCronBtn:k.a,ConfigureCronView:U.a,TooltipIconButton:M.a,AppsUploadMultiStepView:T,AppsDownloadMultiStepView:L,AppsBulkDownloadMultiStepView:G},data:function(){var t,e={install:"install",uninstall:"uninstall",upload:"upload",deleteDatabase:"deleteDatabase",editConfig:"editConfig",deleteAppConfig:"deleteAppConfig",bulkDownload:"bulkDownload",restartService:"restartService",cronConfigure:"cronConfigure"};return{selectedItems:[],refreshToolTipTitle:"Refresh apps",isRestartingService:!1,refreshTime:5e3,singleDownloadRefreshTIme:1e3,appDownloadStates:[],selectedApp:null,dialogNames:e,isFetchingAppDetails:!1,isBulkDownloadAppPersistent:!0,isDeletingConfig:!1,isDeletingDatabase:!1,isUninstallingApp:!1,currentDownloadState:null,fetchDownloadStateInterval:null,isDeletingDownloadState:!1,dialog:(t={},v()(t,e.install,!1),v()(t,e.restartService,!1),v()(t,e.upload,!1),v()(t,e.uninstall,!1),v()(t,e.deleteDatabase,!1),v()(t,e.editConfig,!1),v()(t,e.deleteAppConfig,!1),v()(t,e.bulkDownload,!1),v()(t,e.cronConfigure,!1),t),remountDialog:v()({},e.bulkDownload,!0),headers:[{text:"Label",align:"start",value:"display_name"},{text:"Name",align:"start",value:"service"},{text:"Status",align:"center",value:"state"},{text:"Restart",align:"center",sortable:!1,value:"restart"},{text:"Installed Version",align:"center",value:"installedVersion",sortable:!0},{text:"Latest Available Version",align:"center",value:"latest_version"},{text:"Actions",align:"center",value:"actions"},{text:"Config File",align:"center",value:"configFile"},{text:"Database",align:"end",value:"databaseOperations"}],tableProps:d()({},S.d)}},computed:{appDetails:function(){return this.formatAppDetails(this.$store.state.appDetails)},setting:function(){return this.$store.state.setting},showCheckDownloadIcon:function(){return this.currentDownloadState===W},showDownloadProgressIcon:function(){return this.currentDownloadState===z}},mounted:function(){this.fetchDownloadAppState()},created:function(){this.fetchAppDetails()},destroyed:function(){this.fetchDownloadStateInterval=null},methods:{refreshGrid:function(){this.fetchAppDetails()},closeDialog:function(t,e){var a=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.dialog[t]=!1,n.unmount&&this.remountDialog[t]&&(this.remountDialog[t]=!1,setTimeout((function(){a.remountDialog[t]=!0}),500)),e&&this.fetchAppDetails(!0)},openDialog:function(t){this.dialog[t]=!0},toggleDialog:function(t,e){if(!this.dialog[t])switch(t){case this.dialogNames.install:if(this.currentDownloadState)return this.$toasted.show("Please resolve bulk download apps in the top left first.",{type:"info"})}this.dialog[t]=!this.dialog[t],this.dialog[t]?this.selectedApp=e:this.selectedApp=null},formatAppDetails:function(t){return t.map((function(t){return d()({},t,{activeLabel:t.status?"Running":"Stopped",isUninstallable:t.is_installed,installedVersion:t.version?t.version:"-",downloadUrl:t.browser_download_url?t.browser_download_url:null,updatedAt:t.date_since?new Date(t.date_since).toLocaleDateString():"-"})}))},fetchAppDetails:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.isFetchingAppDetails=!0,_.fetchApps().then((function(a){t.$store.commit("changeAppDetails",a),e&&t.fetchAllInstalledApps()})).finally((function(){t.isFetchingAppDetails=!1}))},fetchAllInstalledApps:function(){var t=this;_.fetchAllInstalledApps().then((function(e){t.$store.commit("changeInstalledServices",e)})).catch((function(t){}))},deleteDatabase:function(){var t=this;this.isDeletingDatabase=!0,_.deleteAppDataService(this.selectedApp.service).then((function(){t.closeDialog(t.dialogNames.deleteDatabase,!0)})).catch((function(){t.closeDialog(t.dialogNames.deleteDatabase)})).finally((function(){t.isDeletingDatabase=!1}))},uninstall:function(t){var e=this;this.isUninstallingApp=!0,_.uninstallApp(this.selectedApp.service).then((function(){e.fetchAppDetails(!0),e.closeDialog(e.dialogNames.uninstall,!0)})).catch((function(){e.closeDialog(e.dialogNames.uninstall)})).finally((function(){e.isUninstallingApp=!1}))},getFileName:function(t){var e=new Date;return t+"_"+(e.getDate()+"-"+(e.getMonth()+1)+"-"+e.getFullYear()+"T"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds())},downloadAppData:function(t){var e,a=this,n=t.service;_.downloadAppData(n,this.setting).then((e=c()(l.a.mark((function e(s){var i,o,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new h.a,e.next=3,i.loadAsync(s);case 3:return e.next=5,i.generateAsync({type:"blob"});case 5:o=e.sent,new Date,r=a.getFileName(n),(c=document.createElement("a")).href=window.URL.createObjectURL(o),c.setAttribute("download",r+".zip"),c.click(),a.$toasted.show(t.service+" app data is exported.");case 13:case"end":return e.stop()}}),e,a)}))),function(t){return e.apply(this,arguments)})).catch((function(t){var e=new FileReader;return e.addEventListener("loadend",(function(t){var e=JSON.parse(t.target.result);e&&e.message?a.$toasted.show(e.message,{type:"error"}):a.$toasted.show("Failed to export "+n+" app data",{type:"error"})})),e.readAsText(t),t}))},deleteAppConfigFile:function(){var t=this;this.isDeletingConfig=!0;var e=this.selectedApp.service,a=this.selectedApp.app_type;_.deleteAppConfig(e,a).then((function(a){t.$toasted.show(e+" app config file is deleted"),t.closeDialog(t.dialogNames.deleteAppConfig)})).catch((function(a){t.$toasted.show("Failed to delete app config for "+e,{type:"error"})})).finally((function(){t.isDeletingConfig=!1}))},downloadConfig:function(t){_.downloadAppConfig(t.service,t.app_type)},restartService:function(){var t=this;this.isRestartingService=!0;var e=this.selectedApp.service,a="RUBIX_PLAT"===e;_.changeServiceStatus(S.j.RESTART,e).then((function(){t.$toasted.show("App restarted successfully."),t.closeDialog(t.dialogNames.restartService)})).catch((function(){a?(t.$toasted.show("The application is being self upgraded/restarted. It may be unresponsive for a few seconds in all locations.",{type:"info"}),t.closeDialog(t.dialogNames.restartService)):t.$toasted.show("Failed to restart the app.",{type:"error"})})).finally((function(){t.isRestartingService=!1}))},bulkDownloadApps:function(){this.openDialog(this.dialogNames.bulkDownload)},clearDownloadAppStateInterval:function(){clearInterval(this.fetchDownloadStateInterval),this.fetchDownloadStateInterval=null},downloadStateInterval:function(){var t=this,e=this.dialog[this.dialogNames.install]?this.singleDownloadRefreshTIme:this.refreshTime;this.fetchDownloadStateInterval||(this.fetchDownloadStateInterval=setInterval((function(){t.fetchDownloadAppState()}),e))},fetchDownloadAppState:function(){var t=this;return _.fetchDownloadState().then((function(e){var a=e.state,n=e.services;switch(a){case"DOWNLOADING":t.currentDownloadState=z,t.isBulkDownloadAppPersistent=!1,t.fetchDownloadStateInterval||t.downloadStateInterval();break;case"CLEARED":t.currentDownloadState=null,t.clearDownloadAppStateInterval();break;case"DOWNLOADED":t.currentDownloadState=W,t.isBulkDownloadAppPersistent=!0}return Array.isArray(n)&&(t.appDownloadStates=n),n})).catch((function(e){return e&&e.message&&(t.currentDownloadState=null),e}))},clearSelectedApps:function(){this.appDownloadStates=[],this.selectedItems=[]},deleteDownloadState:function(){var t=this;return this.isDeletingDownloadState=!0,_.deleteDownloadState().then((function(t){return t})).catch((function(t){return t})).finally((function(){t.fetchDownloadAppState(),t.clearDownloadAppStateInterval(),t.isDeletingDownloadState=!1}))}}},q=Object(C.a)(H,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("grid-toolbar",{attrs:{"hide-export-data":!0,items:t.selectedItems,toolbarTitle:"Rubix Apps"},scopedSlots:t._u([{key:"customAction",fn:function(){return[a("span",[a("tooltip-icon-button",{attrs:{btnColor:"default",btnIcon:"mdi-sync",btnTooltip:t.refreshToolTipTitle,buttonSize:"medium",onClick:function(){return t.refreshGrid()}}}),t._v(" "),a("v-btn",{staticClass:"btn-height-22 white--text",attrs:{disabled:t.isDeletingDownloadState,"x-small":"",color:"downloadColor"},on:{click:function(){return t.bulkDownloadApps(t.selectedItems)}}},[t._v("\n            Download Apps\n            "),a("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[t._v(" mdi-download ")])],1),t._v(" "),t.showDownloadProgressIcon?a("v-progress-circular",{attrs:{width:2,size:15,color:"white",indeterminate:""}}):t._e(),t._v(" "),t.showCheckDownloadIcon?a("v-icon",{attrs:{"x-medium":"",dark:""}},[t._v(" mdi-check")]):t._e()],1)]},proxy:!0}])})],1),t._v(" "),a("v-data-table",{attrs:{"show-select":"","item-key":"service",headers:t.headers,items:t.appDetails,"single-select":!1,loading:t.isFetchingAppDetails,"footer-props":t.tableProps.FOOTER_PROPS,itemsPerPage:t.tableProps.ITEMS_PER_PAGE},scopedSlots:t._u([{key:"item.state",fn:function(t){var e=t.item;return[a("app-status-chip",{attrs:{state:e.state}})]}},{key:"item.restart",fn:function(e){var n=e.item;return[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[n.isUninstallable?a("v-btn",t._g(t._b({attrs:{icon:"",small:"",color:"nubeGreen"},on:{click:function(){return t.toggleDialog(t.dialogNames.restartService,n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{dark:""}},[t._v(" mdi-restart ")])],1):t._e()]}}],null,!0)},[t._v(" "),a("span",[t._v("Restart Service")])]),t._v(" "),a("configure-cron-btn",{attrs:{service:n,btnSize:"medium",handleClick:function(){return t.toggleDialog(t.dialogNames.cronConfigure,n)}}})]}},{key:"item.actions",fn:function(e){var n=e.item;return[a("span",[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:"",small:"",color:"downloadColor"},on:{click:function(){return t.toggleDialog(t.dialogNames.install,n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-download ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Download")])]),t._v(" "),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:"",small:"",color:"nubeYellow"},on:{click:function(){return t.toggleDialog(t.dialogNames.upload,n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-upload ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Upload")])]),t._v(" "),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[n.isUninstallable?a("v-btn",t._g(t._b({attrs:{icon:"",small:"",color:"error"},on:{click:function(){return t.toggleDialog(t.dialogNames.uninstall,n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-delete ")])],1):t._e()]}}],null,!0)},[t._v(" "),a("span",[t._v("Delete App")])]),t._v(" "),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[n.downloadUrl?a("v-btn",t._g(t._b({attrs:{href:n.downloadUrl,target:"_blank",tar:"",icon:"",small:""}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-zip-box")])],1):t._e()]}}],null,!0)},[t._v(" "),a("span",[t._v("Download ZIP")])])],1)]}},{key:"item.configFile",fn:function(e){var n=e.item;return["PythonApp"==n.app_type||"FrontendApp"==n.app_type||"AptApp"==n.app_type?a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:"",small:"",color:"blue"},on:{click:function(){return t.toggleDialog(t.dialogNames.editConfig,n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-pencil ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Edit Config File")])]):t._e(),t._v(" "),"PythonApp"==n.app_type||"FrontendApp"==n.app_type||"AptApp"==n.app_type?a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:"",small:"",color:"downloadColor"},on:{click:function(){return t.downloadConfig(n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-download ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Download Config File")])]):t._e(),t._v(" "),"PythonApp"==n.app_type||"FrontendApp"==n.app_type||"AptApp"==n.app_type?a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:"",small:"",color:"error"},on:{click:function(){return t.toggleDialog(t.dialogNames.deleteAppConfig,n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-delete ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Delete Configuration")])]):t._e()]}},{key:"item.databaseOperations",fn:function(e){var n=e.item;return[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:"",small:"",color:"downloadColor"},on:{click:function(){return t.downloadAppData(n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-download ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Download Database")])]),t._v(" "),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var s=e.on,i=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:"",small:"",color:"error"},on:{click:function(){return t.toggleDialog(t.dialogNames.deleteDatabase,n)}}},"v-btn",i,!1),s),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-delete ")])],1)]}}],null,!0)},[t._v(" "),a("span",[t._v("Delete Database")])])]}}],null,!0),model:{value:t.selectedItems,callback:function(e){t.selectedItems=e},expression:"selectedItems"}}),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.uninstall],"on-close":function(){return t.closeDialog(t.dialogNames.uninstall)},"on-confirm":function(){return t.uninstall(t.dialogNames.uninstall)},loading:t.isUninstallingApp,"dialog-text":"Do you want to uninstall the app?"}}),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.restartService],"on-close":function(){return t.closeDialog(t.dialogNames.restartService)},"on-confirm":function(){return t.restartService()},loading:t.isRestartingService,"dialog-text":"Are you sure want to restart the app?"}}),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.deleteDatabase],"on-close":function(){return t.closeDialog(t.dialogNames.deleteDatabase)},"on-confirm":function(){return t.deleteDatabase(t.dialogNames.deleteDatabase)},loading:t.isDeletingDatabase,"dialog-text":"Do you want to delete the app's database?"}}),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.deleteAppConfig],"on-close":function(){return t.closeDialog(t.dialogNames.deleteAppConfig)},"on-confirm":function(){return t.deleteAppConfigFile()},loading:t.isDeletingConfig,"dialog-text":"Do you want to delete the app's config file?"}}),t._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.dialog[t.dialogNames.upload],callback:function(e){t.$set(t.dialog,t.dialogNames.upload,e)},expression:"dialog[dialogNames.upload]"}},[t.dialog[t.dialogNames.upload]?a("apps-upload-multi-step-view",{attrs:{"app-details":t.selectedApp,"close-dialog":function(e){return t.closeDialog(t.dialogNames.upload,e)}}}):t._e()],1),t._v(" "),a("v-dialog",{attrs:{presistent:"","max-width":"500px"},model:{value:t.dialog[t.dialogNames.editConfig],callback:function(e){t.$set(t.dialog,t.dialogNames.editConfig,e)},expression:"dialog[dialogNames.editConfig]"}},[t.dialog[t.dialogNames.editConfig]?a("apps-edit-config",{attrs:{"close-dialog":function(e){return t.closeDialog(t.dialogNames.editConfig,e)},"app-detail":t.selectedApp}}):t._e()],1),t._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.dialog[t.dialogNames.install],callback:function(e){t.$set(t.dialog,t.dialogNames.install,e)},expression:"dialog[dialogNames.install]"}},[t.dialog[t.dialogNames.install]?a("apps-download-multi-step-view",{attrs:{"delete-download-state":t.deleteDownloadState,"current-download-state":t.currentDownloadState,"fetch-download-app-state":t.fetchDownloadAppState,"clear-download-app-state-interval":t.clearDownloadAppStateInterval,"app-details":t.selectedApp,"close-dialog":function(e){return t.closeDialog(t.dialogNames.install,e)}}}):t._e()],1),t._v(" "),a("v-dialog",{attrs:{persistent:t.isBulkDownloadAppPersistent,"max-width":"500px"},model:{value:t.dialog[t.dialogNames.bulkDownload],callback:function(e){t.$set(t.dialog,t.dialogNames.bulkDownload,e)},expression:"dialog[dialogNames.bulkDownload]"}},[t.remountDialog[t.dialogNames.bulkDownload]?a("apps-bulk-download-multi-step-view",{attrs:{"current-download-state":t.currentDownloadState,"selected-apps":t.selectedItems,"fetch-download-app-state":t.fetchDownloadAppState,"app-download-states":t.appDownloadStates,"clear-selected-apps":t.clearSelectedApps,"delete-download-state":t.deleteDownloadState,"clear-download-app-state-interval":t.clearDownloadAppStateInterval,"close-dialog":function(e,a){return t.closeDialog(t.dialogNames.bulkDownload,e,a)}}}):t._e()],1),t._v(" "),a("v-dialog",{attrs:{presistent:"","max-width":"500px"},model:{value:t.dialog[t.dialogNames.cronConfigure],callback:function(e){t.$set(t.dialog,t.dialogNames.cronConfigure,e)},expression:"dialog[dialogNames.cronConfigure]"}},[t.dialog[t.dialogNames.cronConfigure]?a("configure-cron-view",{attrs:{service:t.selectedApp,open:t.dialog[t.dialogNames.cronConfigure],"on-cancel":function(){return t.closeDialog(t.dialogNames.cronConfigure)}}}):t._e()],1)],1)}),[],!1,null,null,null).exports,J=a("snOE"),K=a.n(J),Y=a("+SqX"),Q=a("t3kO"),X=a.n(Q),Z=a("asQ9"),tt={name:"slave-app-grid",props:["slaveApps","search","updateSearch","selectedItems","latestVersion","slaveDevices","onSelectItem","filters","name","slaveAppsDataItems"],components:{AppStatusChip:I.a,ConfigureCronBtn:k.a,ConfigureCronView:U.a,GridToolbar:y.a,TextFieldDisplay:V.a,TooltipIconButton:M.a,ConfirmDialog:j.a,AppsEditConfig:x,MasterStarIndicator:Z.a,AppsUploadMultiStepView:T},data:function(){var t,e={upload:"upload",uninstall:"uninstall",editConfig:"editConfig",cronConfigure:"cronConfigure",deleteDatabase:"deleteDatabase",restartService:"restartService",deleteAppConfig:"deleteAppConfig"};return{expanded:[],searchText:"",searchItems:[],isDeletingConfig:!1,isRestartingService:!1,isUninstallingApp:!1,isDeletingDatabase:!1,controlActions:d()({},S.j),dialog:(t={},v()(t,e.deleteDatabase,!1),v()(t,e.restartService,!1),v()(t,e.upload,!1),v()(t,e.editConfig,!1),v()(t,e.deleteAppConfig,!1),v()(t,e.uninstall,!1),v()(t,e.cronConfigure,!1),t),dialogNames:e,selectedGridItems:[],selectedApp:{},start:0,timeout:null,rowHeight:33,perPage:25,headers:[{text:"",align:"left",value:"checkbox",sortable:!1},{text:"SN",alignt:"center",value:"sn",sortable:!0},{text:"Site Name",align:"left",value:"slave_site_name"},{text:"Device Name",align:"left",value:"slave_device_name"},{text:"Status",align:"right",value:"state"},{text:"Installed Version",align:"center",sortable:!0,value:"version"},{text:"Active Since",align:"center",sortable:!0,value:"time_since"},{text:"State",align:"center",value:"is_enabled"},{text:"",value:"data-table-expand"}],dataItems:[]}},mounted:function(){var t=this;this.dataItems=this.slaveAppsDataItems.filter((function(e){return!(t.filters.isInstalled&&!e.is_installed)})).map((function(e,a){return t.appendSlaveDevice(e,a)})),this.searchText=this.search,this.searchCriteria=this.initSearchCriteria()},computed:{setting:function(){return this.$store.state.setting},title:function(){return this.slaveApps.display_name},serviceName:function(){return this.slaveApps.name},virtualDataItems:function(){return this.dataItems.slice(this.start,this.perPage+this.start)},tableHeight:function(){return this.dataItems&&this.dataItems.length>this.perPage?"62vh":void 0},startHeight:function(){return this.start*this.rowHeight-33},endHeight:function(){return this.rowHeight*(this.dataItems.length-this.start)},isFixedHeader:function(){return this.dataItems.length>10},isSelectAll:function(){return this.selectedGridItems.length==this.dataItems.length}},methods:{onSearchChange:function(){this.updateSearch(this.searchText),this.searchItems=this.searchText.split(",").map((function(t){return t.trim()}))},initSearchCriteria:function(){var t=this,e=["slave_site_name","slave_device_name","version","state"];return function(a,n){var s=!1;if(!t.search)return!0;var i=function(t){var e=a[t];s=s||n&&Array.isArray(n)&&n.length>0&&"string"==typeof e&&n.every((function(t){return"string"==typeof t}))&&n.some((function(t){return-1!==e.toString().toLowerCase().indexOf(t.toLowerCase())}))},o=!0,l=!1,r=void 0;try{for(var c,p=X()(e);!(o=(c=p.next()).done);o=!0){i(c.value)}}catch(t){l=!0,r=t}finally{try{!o&&p.return&&p.return()}finally{if(l)throw r}}return s}},handleSelectAll:function(t,e){this.dataItems=this.dataItems.map((function(e){return d()({},e,{isSelected:t})})),this.selectedGridItems=t?this.dataItems:[],this.handleOnGridItemSelect()},toolbarDialogActions:function(t,e){0!==e.length&&this.toggleDialog(t,e)},handleOnGridItemSelect:function(){this.onSelectItem(this.serviceName,this.selectedGridItems)},onScroll:function(t,e){var a=this;e==this.name&&(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout((function(){var e=t.target.scrollTop,n=Math.ceil(e/a.rowHeight);a.start=n+a.perPage>a.dataItems.length?a.dataItems.length-a.perPage:n,a.$nextTick((function(){t.target.scrollTop=e}))}),20))},appendSlaveDevice:function(t,e){var a=d()({},t),n=this.slaveDevices[t.slaveId];return n&&(a=d()({sn:e+1,isExpanded:!1,isSelected:!1},a,{time_since:a.time_since?a.time_since:"-"},i()(n).reduce((function(t,e){var a="slave_"+e;return"slave_site_name"===a&&n.is_master?(t[a]="   "+n[e],t):(t[a]=n[e],t)}),{}))),a},handleCheckboxChange:function(t,e){if(e){var a=this.selectedGridItems.find((function(t){return t.slaveId===e.slaveId}));!a&&t&&this.selectedGridItems.push(e),a&&!t&&(this.selectedGridItems=this.selectedGridItems.filter((function(t){return t.slaveId!==e.slaveId}))),this.handleOnGridItemSelect()}},toggleItemExpansion:function(t){t.isExpanded=!t.isExpanded},toggleItemSelection:function(t){t.isSelected=!t.isSelected},closeDialog:function(t,e){this.dialog[t]=!1,this.selectedApp={},e&&"function"==typeof this.fetchAppDetails&&this.fetchAppDetails(!0)},toggleDialog:function(t,e){this.dialog[t]=!this.dialog[t],this.dialog[t]?this.selectedApp=e:this.selectedApp=null},onDeleteDatabase:function(){var t=this,e=[];if(!Array.isArray(this.selectedApp)||0!=this.selectedApp.length)return!Array.isArray(this.selectedApp)&&this.selectedApp?e.push(this.selectedApp):e=this.selectedApp,this.isDeletingDatabase=!0,g.a.all(e.map((function(t){return w.deleteAppData(t.service,t.slaveId)}))).then((function(){t.$toasted.show("Successfully deleted app data"),t.closeDialog(t.dialogNames.deleteDatabase,!0),t.clearSelectedItems()})).catch((function(){t.closeDialog(t.dialogNames.deleteDatabase)})).finally((function(){t.isDeletingDatabase=!1}))},downloadConfig:function(t){var e=t.service,a=t.app_type,n=t.slaveId,s=t.slave_device_name;w.downloadAppConfig(e,n,s,a)},deleteAppConfigFile:function(){var t=this,e=[];Array.isArray(this.selectedApp)&&0==this.selectedApp.length||(!Array.isArray(this.selectedApp)&&this.selectedApp?e.push(this.selectedApp):e=this.selectedApp,this.isDeletingConfig=!0,g.a.all(e.map((function(t){return w.deleteAppConfig(t.slaveId,t.service,t.app_type)}))).then((function(e){t.$toasted.show("App config file is deleted"),t.closeDialog(t.dialogNames.deleteAppConfig),t.clearSelectedItems()})).catch((function(e){t.$toasted.show("Failed to delete app config",{type:"error"})})).finally((function(){t.isDeletingConfig=!1})))},onDownloadDatabase:function(t){var e,a=this,n=t.service,s=t.slaveId;w.downloadAppData(n,s,this.setting).then((e=c()(l.a.mark((function t(e){var s,i,o,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=new h.a,t.next=3,s.loadAsync(e);case 3:return t.next=5,s.generateAsync({type:"blob"});case 5:i=t.sent,new Date,o=a.getFileName(n),(r=document.createElement("a")).href=window.URL.createObjectURL(i),r.setAttribute("download",o+".zip"),r.click(),a.$toasted.show(n+" app data is exported.");case 13:case"end":return t.stop()}}),t,a)}))),function(t){return e.apply(this,arguments)})).catch((function(t){var e=new FileReader;return e.addEventListener("loadend",(function(t){var e=JSON.parse(t.target.result);e&&e.message?a.$toasted.show(e.message,{type:"error"}):a.$toasted.show("Failed to export "+n+" app data",{type:"error"})})),e.readAsText(t),t}))},uninstall:function(){var t=this,e=[];if(!Array.isArray(this.selectedApp)||0!=this.selectedApp.length)return!Array.isArray(this.selectedApp)&&this.selectedApp?e.push(this.selectedApp):e=this.selectedApp,this.isUninstallingApp=!0,g.a.all(e.map((function(t){return w.uninstallApp(t.slaveId,t.service)}))).then((function(){t.$toasted.show("Successfully unistalled app"),t.closeDialog(t.dialogNames.uninstall,!0),t.clearSelectedItems()})).catch((function(){t.closeDialog(t.dialogNames.uninstall)})).finally((function(){t.isUninstallingApp=!1}))},restartService:function(){var t=this,e=[];Array.isArray(this.selectedApp)&&0==this.selectedApp.length||(!Array.isArray(this.selectedApp)&&this.selectedApp?e.push(this.selectedApp):e=this.selectedApp,this.isRestartingService=!0,g.a.all(e.map((function(t){return w.changeServiceStatus(S.j.RESTART,t.service,t.slaveId)}))).then((function(){t.$toasted.show("App restarted successfully."),t.clearSelectedItems()})).catch((function(){t.$toasted.show("Failed to restart the app.",{type:"error"})})).finally((function(){t.isRestartingService=!1})))},controlSlaveApp:function(t,e){var a=this,n=[];if(!Array.isArray(t)||0!=t.length)return!Array.isArray(t)&&t?n.push(t):n=t,g.a.all(n.map((function(t){return w.changeServiceStatus(e,t.service,t.slaveId).catch((function(t){}))}))).then((function(){Array.isArray(t)&&a.clearSelectedItems(),a.$toasted.show("Successfully performed "+e+" to selected app.")}))},handleCustomSort:function(t,e,a){var n=this,s=this.dataItems.filter((function(t){return!(n.filters.isInstalled&&!t.is_installed)}));"function"==typeof this.searchCriteria&&(s=s.filter((function(t){return n.searchCriteria(t,n.searchItems)})));var i=Array.isArray(e)&&e.length>0&&e[0]||null;Array.isArray(a)&&a.length>0&&a[0];return i&&(s=s.sort((function(t,e){return function(t,e,a,n){if(t[a]<e[a])return n?1:-1;if(t[a]>e[a])return n?-1:1;return 0}(t,e,i)}))),s=s.slice(this.start,this.perPage+this.start)},clearSelectedItems:function(){this.selectedGridItems=[],this.dataItems=this.dataItems.map((function(t){return d()({},t,{isSelected:!1})})),this.handleOnGridItemSelect()}}},et=Object(C.a)(tt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{staticClass:"slave-apps-grid",attrs:{outlined:""}},[a("v-card-text",{staticClass:"pa-0"},[a("v-toolbar",{attrs:{dense:"",flat:""}},[a("v-toolbar-title",[a("span",[t._v(t._s(t.title))])]),t._v(" "),a("v-text-field",{staticClass:"pl-10",attrs:{"append-icon":"mdi-magnify",label:"Search using site or device name","single-line":"","hide-details":""},on:{input:t.onSearchChange},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),t._v(" "),a("v-spacer"),t._v(" "),t.latestVersion?a("span",[a("span",{staticClass:"grey-text font-weight-medium caption pr-2"},[t._v("Latest Version")]),t._v("\n        "+t._s(t.latestVersion)+"\n      ")]):t._e(),t._v(" "),a("tooltip-icon-button",{attrs:{btnColor:"blue darken-2",btnIcon:"mdi-play-circle-outline",buttonSize:"medium",btnTooltip:"Start Service",disabled:0==t.selectedGridItems.length,onClick:function(){return t.controlSlaveApp(t.selectedGridItems,t.controlActions.START)}}}),t._v(" "),a("tooltip-icon-button",{attrs:{btnColor:"nubeGreen",btnIcon:"mdi-restart",buttonSize:"medium",btnTooltip:"Restart Service",disabled:0==t.selectedGridItems.length,onClick:function(){return t.toggleDialog(t.dialogNames.restartService,t.selectedGridItems)}}}),t._v(" "),a("tooltip-icon-button",{attrs:{btnIcon:"mdi-stop-circle-outline",btnTooltip:"Stop Service",buttonSize:"medium",disabled:0==t.selectedGridItems.length,onClick:function(){return t.controlSlaveApp(t.selectedGridItems,t.controlActions.STOP)}}}),t._v(" "),a("tooltip-icon-button",{attrs:{btnColor:"teal darken-2",btnIcon:"mdi-check-circle-outline",btnTooltip:"Enable Service",buttonSize:"medium",disabled:0==t.selectedGridItems.length,onClick:function(){return t.controlSlaveApp(t.selectedGridItems,t.controlActions.ENABLE)}}}),t._v(" "),a("tooltip-icon-button",{attrs:{btnColor:"orange darken-2",btnIcon:"mdi-close-octagon",btnTooltip:"Disable Service",buttonSize:"medium",disabled:0==t.selectedGridItems.length,onClick:function(){return t.controlSlaveApp(t.selectedGridItems,t.controlActions.DISABLE)}}}),t._v(" "),a("v-menu",{attrs:{bottom:"",left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:"",disabled:0==t.selectedGridItems.length}},"v-btn",s,!1),n),[a("v-icon",[t._v("mdi-dots-vertical")])],1)]}}])},[t._v(" "),a("v-list",{staticClass:"text-left"},[a("v-list-item",{attrs:{link:""},on:{click:function(){return t.toolbarDialogActions(t.dialogNames.uninstall,t.selectedGridItems)}}},[a("v-list-item-title",[t._v("Uninstall App")])],1),t._v(" "),a("v-list-item",{attrs:{link:""},on:{click:function(){return t.toolbarDialogActions(t.dialogNames.editConfig,t.selectedGridItems)}}},[a("v-list-item-title",[t._v("Edit Config File")])],1),t._v(" "),a("v-list-item",{attrs:{link:""},on:{click:function(){return t.toolbarDialogActions(t.dialogNames.deleteAppConfig,t.selectedGridItems)}}},[a("v-list-item-title",[t._v("Delete Configuration")])],1),t._v(" "),a("v-list-item",{attrs:{link:""},on:{click:function(){return t.toolbarDialogActions(t.dialogNames.deleteDatabase,t.selectedGridItems)}}},[a("v-list-item-title",[t._v("Delete Database")])],1)],1)],1)],1),t._v(" "),a("div",{directives:[{name:"scroll",rawName:"v-scroll.self",value:function(e){return t.onScroll(e,t.name)},expression:"e => onScroll(e, name)",modifiers:{self:!0}}],staticClass:"virtual-scroll-table",style:{height:t.tableHeight}},[a("v-data-table",{attrs:{dense:"","fixed-header":!0,"hide-default-footer":"",items:t.virtualDataItems,expanded:t.expanded,"custom-sort":t.handleCustomSort,"single-expand":"","disable-pagination":"","item-key":"slaveId",headers:t.headers,"show-expand":""},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"header.checkbox",fn:function(e){return[a("v-simple-checkbox",{attrs:{value:t.isSelectAll,small:""},on:{input:function(a){return t.handleSelectAll(a,e)}}})]}},{key:"item.checkbox",fn:function(e){var n=e.item;return[a("v-simple-checkbox",{attrs:{small:""},on:{input:function(e){return t.handleCheckboxChange(e,n)}},model:{value:n.isSelected,callback:function(e){t.$set(n,"isSelected",e)},expression:"item.isSelected"}})]}},{key:"item.slave_site_name",fn:function(e){var n=e.item;return[a("span",[a("master-star-indicator",{attrs:{"is-master":n.slave_is_master}}),t._v(" "),a("span",[t._v(t._s(n.slave_site_name))])],1)]}},t.start>0?{key:"body.prepend",fn:function(){return[a("tr",[a("td",{style:"padding-top:"+t.startHeight+"px",attrs:{colspan:t.headers.length}})])]},proxy:!0}:null,t.start+t.perPage<this.dataItems.length?{key:"body.append",fn:function(){return[a("tr",[a("td",{style:"padding-top:"+t.endHeight+"px",attrs:{colspan:t.headers.length}})])]},proxy:!0}:null,{key:"item.state",fn:function(t){var e=t.item;return[a("app-status-chip",{attrs:{"chip-size":"small",state:e.state}})]}},{key:"item.is_enabled",fn:function(e){var n=e.item;return[a("span",{staticClass:"font-weight-medium"},[n.is_enabled?a("v-chip",{attrs:{small:"",dark:"",color:"nubeGreen"}},[t._v("Enabled")]):t._e(),t._v(" "),n.is_enabled?t._e():a("v-chip",{attrs:{small:"",dark:"",color:"darken-1 brown"}},[t._v("Disabled")])],1)]}},{key:"expanded-item",fn:function(e){var n=e.headers,s=e.item;return[a("td",{class:"expanded-table-row py-2 "+(t.$vuetify.theme.dark?"nubeDarkGrey":"nubeLightBackground"),attrs:{colspan:n.length}},[a("div",{staticClass:"flex pl-15"},[a("span",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("Timezone")]),t._v(" "),a("span",{staticClass:"text-ellipses"},[t._v(t._s(s.slave_time_zone))])]),t._v(" "),a("span",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("State")]),t._v(" "),a("span",{staticClass:"font-weight-medium text-ellipses"},[t._v(t._s(s.slave_site_state))])]),t._v(" "),a("span",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("City")]),t._v(" "),a("span",{staticClass:"font-weight-medium text-ellipses"},[t._v(t._s(s.slave_site_city))])]),t._v(" "),a("span",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("Zip")]),t._v(" "),a("span",{staticClass:"font-weight-medium text-ellipses"},[t._v(t._s(s.slave_site_zip))])])]),t._v(" "),a("div",{staticClass:"flex pl-15 pt-3 text-left"},[a("div",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("App Features")]),t._v(" "),a("p",[a("tooltip-icon-button",{attrs:{btnColor:"nubeYellow",btnIcon:"mdi-upload",btnTooltip:"Upload App",onClick:function(){return t.toggleDialog(t.dialogNames.upload,s)}}}),t._v(" "),s.is_installed?a("tooltip-icon-button",{attrs:{btnColor:"error",btnIcon:"mdi-delete",btnTooltip:"Uninstall App",onClick:function(){return t.toggleDialog(t.dialogNames.uninstall,s)}}}):t._e(),t._v(" "),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,i=e.attrs;return[s.browser_download_url?a("v-btn",t._g(t._b({attrs:{href:s.browser_download_url,target:"_blank",tar:"",icon:"",small:""}},"v-btn",i,!1),n),[a("v-icon",{attrs:{small:"",dark:""}},[t._v(" mdi-zip-box")])],1):t._e()]}}],null,!0)},[t._v(" "),a("span",[t._v("Download ZIP")])])],1)]),t._v(" "),a("div",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("Config File")]),t._v(" "),a("p",[a("tooltip-icon-button",{attrs:{btnColor:"blue",btnIcon:"mdi-pencil",btnTooltip:"Edit Config File",onClick:function(){return t.toggleDialog(t.dialogNames.editConfig,s)}}}),t._v(" "),"PythonApp"==s.app_type||"FrontendApp"==s.app_type||"AptApp"==s.app_type?a("tooltip-icon-button",{attrs:{btnColor:"downloadColor",btnIcon:"mdi-download",btnTooltip:"Download Config File",onClick:function(){return t.downloadConfig(s)}}}):t._e(),t._v(" "),a("tooltip-icon-button",{attrs:{btnColor:"error",btnIcon:"mdi-delete",btnTooltip:"Delete Configuration",onClick:function(){return t.toggleDialog(t.dialogNames.deleteAppConfig,s)}}})],1)]),t._v(" "),a("div",{staticClass:"table-expanded-item"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("Database")]),t._v(" "),a("p",[a("tooltip-icon-button",{attrs:{btnColor:"downloadColor",btnIcon:"mdi-download",btnTooltip:"Download Database",onClick:function(){return t.onDownloadDatabase(s)}}}),t._v(" "),a("tooltip-icon-button",{attrs:{btnIcon:"mdi-delete",btnColor:"error",btnTooltip:"Delete Database",onClick:function(){return t.toggleDialog(t.dialogNames.deleteDatabase,s)}}})],1)]),t._v(" "),a("div",{staticClass:"table-expanded-item"},[s.is_installed?a("span",{staticClass:"grey-text text-left font-weight-medium caption"},[t._v("Actions")]):t._e(),t._v(" "),s.is_installed?a("p",[a("tooltip-icon-button",{attrs:{btnColor:"blue darken-2",btnIcon:"mdi-play-circle-outline",btnTooltip:"Start Service",onClick:function(){return t.controlSlaveApp(s,t.controlActions.START)}}}),t._v(" "),a("tooltip-icon-button",{attrs:{btnColor:"nubeGreen",btnIcon:"mdi-restart",btnTooltip:"Restart Service",onClick:function(){return t.toggleDialog(t.dialogNames.restartService,s)}}}),t._v(" "),a("tooltip-icon-button",{attrs:{btnIcon:"mdi-stop-circle-outline",btnTooltip:"Stop Service",onClick:function(){return t.controlSlaveApp(s,t.controlActions.STOP)}}}),t._v(" "),a("tooltip-icon-button",{attrs:{btnColor:"teal darken-2",btnIcon:"mdi-check-circle-outline",btnTooltip:"Enable Service",onClick:function(){return t.controlSlaveApp(s,t.controlActions.ENABLE)}}}),t._v(" "),a("tooltip-icon-button",{attrs:{btnColor:"orange darken-2",btnIcon:"mdi-close-octagon",btnTooltip:"Disable Service",onClick:function(){return t.controlSlaveApp(s,t.controlActions.DISABLE)}}}),t._v(" "),a("configure-cron-btn",{attrs:{service:s,handleClick:function(){return t.toggleDialog(t.dialogNames.cronConfigure,s)}}})],1):t._e()])])])]}}],null,!0)})],1)],1),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.deleteDatabase],"on-close":function(){return t.closeDialog(t.dialogNames.deleteDatabase)},"on-confirm":function(){return t.onDeleteDatabase()},loading:t.isDeletingDatabase,"dialog-text":"Do you want to delete the app's database?"}}),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.restartService],"on-close":function(){return t.closeDialog(t.dialogNames.restartService)},"on-confirm":function(){return t.restartService()},loading:t.isRestartingService,"dialog-text":"Are you sure to restart the app?"}}),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.deleteAppConfig],"on-close":function(){return t.closeDialog(t.dialogNames.deleteAppConfig)},"on-confirm":function(){return t.deleteAppConfigFile()},loading:t.isDeletingConfig,"dialog-text":"Do you want to delete the app's config file?"}}),t._v(" "),a("v-dialog",{attrs:{presistent:"","max-width":"500px"},model:{value:t.dialog[t.dialogNames.editConfig],callback:function(e){t.$set(t.dialog,t.dialogNames.editConfig,e)},expression:"dialog[dialogNames.editConfig]"}},[t.dialog[t.dialogNames.editConfig]?a("apps-edit-config",{attrs:{"is-slave-app":!0,"close-dialog":function(e){return t.closeDialog(t.dialogNames.editConfig,e)},"app-detail":t.selectedApp}}):t._e()],1),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.dialog[t.dialogNames.uninstall],"on-close":function(){return t.closeDialog(t.dialogNames.uninstall)},"on-confirm":function(){return t.uninstall(t.dialogNames.uninstall)},loading:t.isUninstallingApp,"dialog-text":"Do you want to uninstall the app?"}}),t._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:t.dialog[t.dialogNames.upload],callback:function(e){t.$set(t.dialog,t.dialogNames.upload,e)},expression:"dialog[dialogNames.upload]"}},[t.dialog[t.dialogNames.upload]?a("apps-upload-multi-step-view",{attrs:{"app-details":t.selectedApp,"is-slave-app":!0,"close-dialog":function(e){return t.closeDialog(t.dialogNames.upload,e)}}}):t._e()],1),t._v(" "),a("v-dialog",{attrs:{presistent:"","max-width":"500px"},model:{value:t.dialog[t.dialogNames.cronConfigure],callback:function(e){t.$set(t.dialog,t.dialogNames.cronConfigure,e)},expression:"dialog[dialogNames.cronConfigure]"}},[t.dialog[t.dialogNames.cronConfigure]?a("configure-cron-view",{attrs:{service:t.selectedApp,open:t.dialog[t.dialogNames.cronConfigure],"on-cancel":function(){return t.closeDialog(t.dialogNames.cronConfigure)}}}):t._e()],1)],1)}),[],!1,null,null,null).exports,at=a("HeMS"),nt={name:"tooltip-title",props:["title"]},st=Object(C.a)(nt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[a("span",t._g(t._b({staticClass:"white--text"},"span",s,!1),n),[t._v("\n      "+t._s(t.title)+"\n    ")])]}}])},[t._v(" "),a("span",[t._v(t._s(t.title))])])}),[],!1,null,null,null).exports,it="DOWNLOAD_IN_PROGRESS",ot="DOWNLOAD_COMPLETE",lt={props:["selectedApps","slaveDevices","appVersions","clearSelectedApps","closeDialog","fetchDownloadAppState","currentDownloadState","slaveAppsDownloadStates","clearDownloadAppStateInterval","deleteDownloadState"],components:{AppStatusChip:I.a,TextFieldDisplay:V.a,TooltipTitle:st},data:function(){return{versionForm:!1,renderReleaseCount:0,successInstalledApps:{},failureInstallApps:{},currentView:1,refreshTime:1e4,versionRules:[function(t){return!!t||"Version No. is required."}],multiStepViewConfig:{1:{hasBack:!1,hasForward:!0,title:"Selected Apps",buttonLabel:"Continue",loader:!1,disabled:!1,hasCancel:!0},2:{hasBack:!0,hasForward:!0,title:"Download",buttonLabel:"Download App",loader:!1,disabled:!1,hasCancel:!0},3:{hasBack:!1,hasForward:!0,title:"Download",buttonLabel:"Install",hasCancelInstallation:!0,loader:!1,disabled:!0,hasCancel:!0,cancelTitle:"Close"},4:{hasBack:!1,hasForward:!0,title:"Installation Complete",buttonLabel:"Ok",loader:!1,disabled:!1,hasCancel:!1}}}},updated:function(){this.hasSelectedApps||this.currentDownloadState||this.currentDownloadState===ot?this.multiStepViewConfig[1].disabled=!1:(this.currentView=1,this.multiStepViewConfig[1].disabled=!0),this.currentDownloadState!==it&&this.currentDownloadState?this.multiStepViewConfig[3].disabled=!1:this.multiStepViewConfig[3].disabled=!0},watch:{currentDownloadState:function(t,e){this.showDownloadStateView(t)}},created:function(){this.showDownloadStateView(this.currentDownloadState)},computed:{currentBulkAppDownloadState:function(){return this.$store.state.currentBulkAppDownloadState},hasSelectedApps:function(){var t=this;return i()(this.selectedApps).reduce((function(e,a){var n=t.selectedApps[a],s=n&&Array.isArray(n)&&n.length>0;return e||s}),!1)},apps:function(){var t=this;return i()(this.selectedApps).reduce((function(e,a){return t.selectedApps[a]&&t.selectedApps[a].length>0&&(e.push(t.getHeader(a)),e.push.apply(e,K()(function(t){return t.map((function(t){return d()({},t,{isListItem:!0,serviceName:t.service,slaveClientName:t.slave_client_name,slaveDeviceName:t.slave_device_name,state:t.state,version:t.version,latestVersion:t.latest_version,minVersion:t.min_support_version,displayName:t.display_name,loadingReleases:!1,releases:[]})}))}(t.selectedApps[a]))),e.push(t.getVersionSelection(a,t.selectedApps[a])),e.push({divider:!0,isNonItem:!0})),e}),[]).filter((function(t){return t}))},downloadStates:function(){var t=this,e=this.slaveDevices;return i()(this.slaveAppsDownloadStates).reduce((function(a,n){return t.slaveAppsDownloadStates[n]&&t.slaveAppsDownloadStates[n].dataItems&&t.slaveAppsDownloadStates[n].dataItems.length>0&&(a.push(d()({},t.getHeader(n),{version:t.slaveAppsDownloadStates[n].dataItems[0].version})),a.push.apply(a,K()(t.slaveAppsDownloadStates[n].dataItems.map((function(t){return d()({},t,{isListItem:!0,serviceName:t.service,slaveDeviceName:e[t.slaveId].device_name,version:t.version,hasError:!!t.error,errorMessage:t.error,isDownloading:t.download})})))),a.push({divider:!0,isNonItem:!0})),a}),[])},installationSuccessApps:function(){var t=this,e=this.slaveDevices;return i()(this.successInstalledApps).reduce((function(a,n){return t.successInstalledApps[n]&&t.successInstalledApps[n].dataItems&&t.successInstalledApps[n].dataItems.length>0&&(a.push(d()({},t.getHeader(n),{version:t.successInstalledApps[n].dataItems[0].version})),a.push.apply(a,K()(t.successInstalledApps[n].dataItems.map((function(t){return d()({},t,{slaveDeviceName:e[t.slaveId].device_name,isListItem:!0})})))),a.push({divider:!0,isNonItem:!0})),a}),[])},installationFailedApps:function(){var t=this,e=this.slaveDevices;return i()(this.failureInstallApps).reduce((function(a,n){return t.failureInstallApps[n]&&t.failureInstallApps[n].dataItems&&t.failureInstallApps[n].dataItems.length>0&&(a.push(d()({},t.getHeader(n),{version:t.failureInstallApps[n].dataItems[0].version})),a.push.apply(a,K()(t.failureInstallApps[n].dataItems.map((function(t){return d()({},t,{slaveDeviceName:e[t.slaveId].site_name,isListItem:!0})})))),a.push({divider:!0,isNonItem:!0})),a}),[])}},methods:{getHeader:function(t){return{text:t,name:t,isHeader:!0,isNonItem:!0,isListItem:!1}},getCommonAppMinVersion:function(t){var e=t.map((function(t){return t.min_support_version}));return at.a(e)},getVersionSelection:function(t,e){var a=e.map((function(t){return t.version})).filter((function(t,e,a){return a.indexOf(t)===e})).filter((function(t){return t}));a=at.d(this.appVersions[t],a);var n=this.getCommonAppMinVersion(e);return{text:t,name:t,model:1===a.length?a[0]:n,isListItem:!1,isVersionSelect:!0,versions:a}},back:function(){this.currentView=this.currentView-1},spinLoader:function(t){this.multiStepViewConfig[this.currentView].loader=t},showDownloadStateView:function(t){switch(t){case it:this.currentView=3;break;case ot:this.currentView=3,this.clearDownloadAppStateInterval()}},disableInstallationButton:function(){this.multiStepViewConfig[3].disabled=!0},bulkDownloadApps:function(){var t=this;this.currentView=3,this.disableInstallationButton();var e=this.apps.reduce((function(t,e){return e.isVersionSelect&&(t[e.name]=e.model),t}),{}),a=this.apps.filter((function(t){return t.isListItem})).map((function(t){return{version:e[t.service],service:t.serviceName,slaveId:t.slaveId}}));return this.spinLoader(!0),w.bulkDownloadSlaveApps(a).then((function(){t.spinLoader(!1),t.fetchDownloadAppState()})).catch((function(e){t.spinLoader(!1)}))},next:function(t){var e=this;return c()(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.currentView,t.t0=a,t.next=1===t.t0?4:2===t.t0?6:3===t.t0?8:4===t.t0?10:12;break;case 4:return e.stopAndContinue(),t.abrupt("break",14);case 6:return e.download(),t.abrupt("break",14);case 8:return e.install(),t.abrupt("break",14);case 10:return e.continue(),t.abrupt("break",14);case 12:return e.currentView++,t.abrupt("break",14);case 14:case"end":return t.stop()}}),t,e)})))()},stopAndContinue:function(){this.currentView++},download:function(){this.$refs.versionForm.validate()&&this.bulkDownloadApps()},install:function(){var t=this,e=this.downloadStates.filter((function(t){return t.isListItem&&!t.hasError})).map((function(t){return{version:t.version,service:t.serviceName,slaveId:t.slaveId}}));return this.spinLoader(!0),w.bulkInstallSlaveApps(e).then((function(e){var a=e.successInstalledApps,n=void 0===a?{}:a,s=e.errorInstalledApps,i=void 0===s?{}:s;t.spinLoader(!1),t.currentView=4,t.successInstalledApps=d()({},n),t.failureInstallApps=d()({},i)})).catch((function(){t.$toasted.show("Unexpected error occurred while bulk installing apps. Please try again")})).finally((function(){t.spinLoader(!1)}))},continue:function(){this.resetDialog()},cancel:function(){this.fetchDownloadAppState(),this.closeDialog()},cancelInstallation:function(){this.resetDialog()},resetDialog:function(){this.versionForm=!1,this.renderReleaseCount=0,this.currentView=1,this.multiStepViewConfig={1:{hasBack:!1,hasForward:!0,title:"Selected Apps",buttonLabel:"Continue",loader:!1,disabled:!1,hasCancel:!0},2:{hasBack:!0,hasForward:!0,title:"Download",buttonLabel:"Download App",loader:!1,disabled:!1,hasCancel:!0},3:{hasBack:!1,hasForward:!0,title:"Download",buttonLabel:"Install",hasCancelInstallation:!0,loader:!1,disabled:!0,hasCancel:!0,cancelTitle:"Close"},4:{hasBack:!1,hasForward:!0,title:"Installation Complete",buttonLabel:"Ok",loader:!1,disabled:!1,hasCancel:!1}},this.deleteDownloadState(),this.clearSelectedApps(),this.closeDialog(!0,{unmount:!0})}}},rt=Object(C.a)(lt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[t.multiStepViewConfig[t.currentView].hasBack?a("v-btn",{staticClass:"mr-1",attrs:{icon:"",medium:""},on:{click:t.back}},[a("v-icon",{attrs:{medium:""}},[t._v(" mdi-arrow-left ")])],1):t._e(),t._v(" "),a("span",{staticClass:"sub-headline"},[t._v(" Slave Apps | "+t._s(t.multiStepViewConfig[t.currentView].title)+" ")])],1),t._v(" "),a("v-card-text",[a("v-stepper",{model:{value:t.currentView,callback:function(e){t.currentView=e},expression:"currentView"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{complete:t.currentView>1,step:"1"}},[t._v(" 1 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>2,step:"2"}},[t._v(" 2 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{complete:t.currentView>3,step:"3"}},[t._v(" 3 ")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{step:"4"}},[t._v(" 4 ")])],1),t._v(" "),a("v-stepper-items",[a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"1"}},[t.hasSelectedApps?t._e():a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n            Please select apps from the grid to bulk download.\n          ")]),t._v(" "),a("div",{staticClass:"text-left pb-5"},[a("v-subheader",{staticClass:"mb-n5"},[t._v("Selected Apps")]),t._v(" "),a("v-row",{staticClass:"pa-1",attrs:{dense:""}},[t._l(t.apps,(function(e,n){return[e.isHeader?a("v-col",{key:"selected_apps_header-"+n,staticClass:"pl-3 mt-3",attrs:{cols:"12"}},[a("span",{staticClass:"caption font-weight-bold"},[t._v(t._s(e.name))])]):t._e(),t._v(" "),e.isListItem?a("v-col",{key:"selected_apps-"+n,staticClass:"pl-5",attrs:{cols:"4"}},[a("div",[a("p",{staticClass:"text-ellipses mb-0"},[a("tooltip-title",{attrs:{title:e.slaveDeviceName+" "+(e.version?"("+e.version+")":"")}})],1),t._v(" "),a("p",[a("app-status-chip",{attrs:{"chip-size":"small",state:e.state}})],1)])]):t._e()]}))],2)],1)],1),t._v(" "),a("v-stepper-content",{staticClass:"pa-2 pt-5",attrs:{step:"2"}},[a("v-form",{ref:"versionForm",attrs:{"lazy-validation":""},model:{value:t.versionForm,callback:function(e){t.versionForm=e},expression:"versionForm"}},[a("v-row",{staticClass:"text-left",attrs:{dense:""}},[t._l(t.apps,(function(e,n){return[e.isHeader?a("v-col",{key:"version-form-header-"+t.renderReleaseCount+"-"+n,attrs:{cols:"12"}},[a("span",{staticClass:"caption font-weight-bold"},[t._v(t._s(e.name))])]):t._e(),t._v(" "),e.isListItem?a("v-col",{key:"version-form-field-"+t.renderReleaseCount+"-"+n,staticClass:"pl-5",attrs:{cols:"4"}},[a("div",[a("p",{staticClass:"text-ellipses mb-0"},[a("tooltip-title",{attrs:{title:e.slaveDeviceName+" "+(e.version?"("+e.version+")":"")}})],1),t._v(" "),a("p",[a("app-status-chip",{attrs:{"chip-size":"small",state:e.state}})],1)])]):t._e(),t._v(" "),e.isVersionSelect?a("v-col",{key:"version-form-select-"+t.renderReleaseCount+"-"+n,attrs:{cols:"12"}},[a("v-combobox",{staticClass:"ml-5",attrs:{items:e.versions,label:"Select Release Version",clearable:"","item-text":"name","item-value":"tag_name",rules:t.versionRules},model:{value:e.model,callback:function(a){t.$set(e,"model",a)},expression:"app.model"}})],1):t._e()]}))],2)],1)],1),t._v(" "),a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"3"}},[a("div",["DOWNLOAD_IN_PROGRESS"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"info"}},[t._v("\n              Downloading App(s) "),a("strong",[t._v("Please Wait!")])]):t._e(),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("v-alert",{staticClass:"mb-0",attrs:{dense:"",type:"success"}},[t._v("\n              Downloading Completed\n            ")]):t._e()],1),t._v(" "),"DOWNLOAD_COMPLETE"===t.currentDownloadState?a("div",{staticClass:"text-left pb-5",attrs:{flat:"",subheader:"",dense:""}},[a("v-subheader",{staticClass:"pa-2 mb-n4"},[t._v("App Download Statuses")]),t._v(" "),a("v-row",{staticClass:"text-left",attrs:{dense:""}},[t._l(t.downloadStates,(function(e,n){return[e.isHeader?a("v-col",{key:"download-statuses-header-"+n,staticClass:"pl-3 mt-3",attrs:{cols:"12"}},[a("span",{staticClass:"caption font-weight-bold"},[t._v(t._s(e.name))]),t._v(" "),a("span",{staticClass:"white--text font-weight-bold"},[t._v("("+t._s(e.version)+")")])]):t._e(),t._v(" "),e.isListItem?a("v-col",{key:"download-statuses-"+n,staticClass:"pl-5",attrs:{cols:"4"}},[a("div",[a("p",{staticClass:"mb-0 text-ellipses"},[a("tooltip-title",{attrs:{title:e.slaveDeviceName}})],1),t._v(" "),a("div",[e.hasError?a("span",{staticClass:"font-weight-medium"},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[a("v-chip",t._g(t._b({attrs:{small:"",outlined:"",color:"red"}},"v-chip",s,!1),n),[t._v("Failed")])]}}],null,!0)},[t._v(" "),a("span",[t._v(t._s(e.error))])])],1):e.isDownloading||e.hasError?e.isDownloading&&!e.hasError?a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{small:"",outlined:"",color:"nubeGreen"}},[t._v("Downloaded")])],1):t._e():a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{small:"",outlined:"",color:"downloadColor"}},[t._v("Downloading")])],1)])])]):t._e()]}))],2)],1):t._e()]),t._v(" "),a("v-stepper-content",{staticClass:"pa-0",attrs:{step:"4"}},["DOWNLOAD_COMPLETE"===t.currentDownloadState?a("div",{staticClass:"text-left pb-5"},[t.installationSuccessApps.length>0?a("div",{staticClass:"text-left pb-5"},[a("v-subheader",{staticClass:"pa-2 mb-n4"},[t._v("Installation Completed Apps")]),t._v(" "),a("v-row",{attrs:{dense:""}},[t._l(t.installationSuccessApps,(function(e,n){return[e.isHeader?a("v-col",{key:"install-complete-header-"+n,staticClass:"pl-3 mt-3",attrs:{cols:"12"}},[a("span",{staticClass:"caption font-weight-bold",attrs:{title:e.name}},[t._v(t._s(e.name))]),t._v(" "),a("span",{staticClass:"white--text font-weight-bold"},[t._v("("+t._s(e.version)+")")])]):t._e(),t._v(" "),e.isListItem?a("v-col",{key:"install-complete-"+n,staticClass:"pl-5",attrs:{cols:"4"}},[a("div",[a("p",{staticClass:"mb-0 text-ellipses"},[a("tooltip-title",{attrs:{title:e.slaveDeviceName}})],1),t._v(" "),a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{small:"",outlined:"",color:"blue"}},[t._v("Installed")])],1)])])]):t._e()]}))],2)],1):t._e(),t._v(" "),t.installationFailedApps.length>0?a("div",[a("v-subheader",[t._v(" Installation Failed Apps")]),t._v(" "),a("v-row",{attrs:{dense:""}},[t._l(t.installationFailedApps,(function(e,n){return[e.isHeader?a("v-col",{key:"installation-failed-header-"+n,staticClass:"pl-3",attrs:{cols:"12"}},[a("span",{staticClass:"caption font-weight-bold"},[t._v(t._s(e.name))]),t._v(" "),a("span",{staticClass:"white--text font-weight-bold"},[t._v("("+t._s(e.version)+")")])]):t._e(),t._v(" "),e.isListItem?a("v-col",{key:"install-complete-"+n,staticClass:"pl-5",attrs:{cols:"4"}},[a("div",[a("p",{staticClass:"mb-0 text-ellipses"},[a("tooltip-title",{attrs:{title:e.slaveDeviceName}})],1),t._v(" "),a("p",[a("span",{staticClass:"font-weight-medium"},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[a("v-chip",t._g(t._b({attrs:{small:"",outlined:"",color:"red"}},"v-chip",s,!1),n),[t._v("Failed")])]}}],null,!0)},[t._v(" "),a("span",[t._v(t._s(e.error))])])],1)])])]):t._e()]}))],2)],1):t._e()]):t._e()])],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-card-actions",[t.multiStepViewConfig[t.currentView].hasForward?a("v-btn",{staticClass:"btn-height-22 white--text",attrs:{"x-small":"",color:"primary",loading:t.multiStepViewConfig[t.currentView].loader,disabled:t.multiStepViewConfig[t.currentView].disabled},on:{click:t.next}},[t._v("\n        "+t._s("function"==typeof t.multiStepViewConfig[t.currentView].buttonLabel?t.multiStepViewConfig[t.currentView].buttonLabel(t.serviceStatus):t.multiStepViewConfig[t.currentView].buttonLabel)+"\n      ")]):t._e(),t._v(" "),t.multiStepViewConfig[t.currentView].hasCancelInstallation?a("v-btn",{attrs:{small:"",color:"pink",text:"",disabled:t.multiStepViewConfig[t.currentView].disabled},on:{click:t.cancelInstallation}},[t._v("\n        Cancel Install\n      ")]):t._e(),t._v(" "),t.multiStepViewConfig[t.currentView].hasCancel?a("v-btn",{attrs:{small:"",text:""},on:{click:t.cancel}},[t._v(" Close ")]):t._e()],1)],1)],1)}),[],!1,null,null,null).exports,ct={name:"slave-apps-control-action-report",props:["controlActionErrorReport","closeDialog","slaveDevices","slaveAppDisplayNameMap"],computed:{successApps:function(){return this.controlActionErrorReport.success},faliureApps:function(){var t=this;return i()(this.controlActionErrorReport).reduce((function(e,a){var n=t.controlActionErrorReport[a].failure;return n=n.map((function(e){return d()({},e,{action:(e.action||"").toUpperCase(),displayName:t.slaveAppDisplayNameMap[e.service]},t.slaveDevices&&t.slaveDevices[e.slaveId]||{})})),e.push.apply(e,K()(n)),e}),[])}}},pt=Object(C.a)(ct,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[t._v("Control Actions Status Report")]),t._v(" "),a("v-card-text",[a("v-list",{staticClass:"text-left",attrs:{flat:"",subheader:"",dense:""}},[a("v-subheader",[t._v("Failed apps")]),t._v(" "),t._l(t.faliureApps,(function(e,n){return[a("v-list-item",{key:"failed-app-"+n,staticClass:"pl-5"},[a("v-list-item-content",[a("v-list-item-title",{staticClass:"subtitle-2 font-weight-medium",domProps:{textContent:t._s(e.displayName+" | "+e.device_name+" | Action: "+e.action)}}),t._v(" "),a("p",{staticClass:"body-"},[a("span",[t._v("Message: ")]),t._v(" "),a("span",{staticClass:"red--text",attrs:{title:e.error}},[t._v(t._s(e.error))])])],1)],1)]}))],2)],1)],1)}),[],!1,null,null,null).exports,dt=a("0iKi"),ut=a("5Bfd"),vt="success",ft="failure",ht="partial",mt={success:{type:"success",duration:1e3,message:function(t){return"Successfully applied action '"+t+"' all apps."}},failure:{type:"error",duration:1e4,message:function(t){return"Failed to apply action '"+t+"' to all apps."}},partial:{type:"info",duration:1e4,message:function(t){return"Partially applied action '"+t+"' to all apps."}}},gt={name:"slave-apps",components:{PageTitle:Y.a,IconButton:ut.a,SlaveAppGrid:et,SlaveAppsDownloadMultiStep:rt,ConfirmDialog:j.a,SlaveAppsControlActionReport:pt,TooltipIconButton:M.a},data:function(){var t,e,a={bulkUpdate:"bulkUpdate",controlActionErrorReport:"controlActionErrorReport"},n="startBtn",s="restartBtn",i="stopBtn",o="enableBtn",l="disableBtn",r=(t={},v()(t,n,{name:n,title:"Start",color:"light-blue darken-2",iconKey:"mdi-play-circle-outline",action:S.j.START}),v()(t,s,{name:s,title:"Restart",color:"nubeGreen",iconKey:"mdi-restart",action:S.j.RESTART}),v()(t,i,{name:i,title:"Stop",iconKey:"mdi-stop-circle-outline",action:S.j.STOP}),v()(t,o,{name:o,title:"Enable",color:"teal darken-2",iconKey:"mdi-check-circle-outline",action:S.j.ENABLE}),v()(t,l,{name:l,title:"Disable",color:"orange darken-2",iconKey:"mdi-close-octagon",action:S.j.DISABLE}),t),c=[n,i,s,o,l];return{recompute:0,slaveTabs:null,filters:{isInstalled:!1},gridSearchMap:{},slaveAppDisplayNameMap:{},slaveAppsLatestVersion:{},isFetchingSlaveApps:!1,currentControlAction:null,isControlActionPending:!1,statusControlErrors:[],isFetchAppfailure:!1,isDownloadingApps:!1,isClearDialog:!1,isClearingUpdate:!1,isLoadingSlaveApps:!1,slaveAppsOnceLoaded:!1,controlActionState:null,controlActionErrorReport:{},slaveReleaseList:null,fetchErrorMessage:"",searchText:"",isFetchingAppData:!1,refreshTime:5e3,isDeletingDownloadState:!1,currentDownloadState:null,slaveAppsDetailMap:{},slaveAppsDetail:[],selectedItems:{},appVersions:{},selectedAppVersion:{},slaveAppReleases:{},fetchDownloadAppStateInterval:null,slaveDevices:{},slaveAppsDownloadStates:{},dialogNames:a,dialog:(e={},v()(e,a.bulkUpdate,!1),v()(e,a.controlActionErrorReport,!1),e),actionButtons:c.map((function(t){return r[t]})),remountDialog:v()({},a.bulkUpdate,!0)}},mounted:function(){this.initialize()},destroyed:function(){this.fetchDownloadAppStateInterval=null},computed:{showCheckDownloadIcon:function(){return this.currentDownloadState===S.c.DOWNLOAD_COMPLETE},isMaster:function(){return this.$store.state.isMaster},showDownloadProgressIcon:function(){return this.currentDownloadState===S.c.DOWNLOAD_IN_PROGRESS},selectedServicesCount:function(){var t=this;return i()(this.selectedItems).reduce((function(e,a){return e+=t.selectedItems[a].length}),0)},appliedFilterCount:function(){var t=this;return i()(this.filters).reduce((function(e,a){return t.filters[a]&&e++,e}),0)}},methods:{retryFetchApps:function(){this.fetchErrorMessage="",this.isFetchAppfailure=!1,this.initialize()},initialize:function(){var t=this;return c()(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isFetchingAppData=!0,e.next=3,g.a.all([t.fetchSlaveApps(!0),t.fetchSlaveDevices()]).finally((function(){t.isFetchingAppData=!1,t.recompute++}));case 3:return e.next=5,t.fetchSlaveAppsLatestVersion();case 5:case"end":return e.stop()}}),e,t)})))()},openDialog:function(t){this.dialog[t]=!0},toggleDialog:function(t,e){this.dialog[t]=!this.dialog[t],this.dialog[t]?this.selectedApp=e:this.selectedApp=null},fetchSlaveAppsLatestVersion:function(){var t=this;return w.fetchLatestAppVersion().then((function(e){t.slaveAppsLatestVersion=e}))},updateSearch:function(t,e){this.gridSearchMap[t]=e},fetchSlaveApps:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isFetchingSlaveApps)return this.slaveAppsOnceLoaded||(this.isLoadingSlaveApps=!0),this.isFetchingSlaveApps=!0,w.fetch().then((function(a){var n=a.data,s=void 0===n?{}:n;t.slaveAppsDetailMap=s,0===i()(t.gridSearchMap).length&&(t.gridSearchMap=i()(s).reduce((function(t,e){return t[e]="",t}),{})),t.slaveAppDisplayNameMap=i()(s).reduce((function(t,e){return t[e]=s[e]?s[e].display_name:e,t}),{}),t.slaveAppsDetail=i()(s).map((function(t){return s[t]})),t.selectedItems=i()(s).reduce((function(t,e){return t[e]=[],t}),{}),t.slaveAppsOnceLoaded=!0,e&&t.fetchSlaveAppReleases()})).catch((function(e){e&&e.message&&(t.$toasted.show(e.message,{type:"error"}),t.fetchErrorMessage=e.message),t.isFetchAppfailure=!0})).finally((function(){t.isLoadingSlaveApps=!1,t.isFetchingSlaveApps=!1}))},onSelectItem:function(t,e){this.selectedItems[t]=e,this.selectedAppVersion=at.g({releaseMap:this.appVersions,selectedItems:this.selectedItems})},fetchSlaveDevices:function(){var t=this;return dt.e().then((function(e){t.slaveDevices=e,t.fetchDownloadAppState()})).catch((function(t){}))},fetchSlaveAppReleases:function(){var t=this,e=i()(this.slaveAppsDetailMap);return e.length?w.fetchAppsReleases(e).then((function(a){t.appVersions=e.reduce((function(t,e,n){return t[e]=a[n],t}),{})})).catch((function(e){t.$toasted.show("Error fetching app releases")})):null},onBulkUpdate:function(){this.dialog[this.dialogNames.bulkUpdate]=!0},closeDialog:function(t){this.dialog[t]=!1},startDownloadStateInterval:function(){var t=this;this.fetchDownloadAppStateInterval||(this.fetchDownloadAppStateInterval=setInterval((function(){t.fetchDownloadAppState()}),this.refreshTime))},clearDownloadAppStateInterval:function(){clearInterval(this.fetchDownloadAppStateInterval),this.fetchDownloadAppStateInterval=null},deleteDownloadState:function(){var t=this;this.isDeletingDownloadState=!0;var e=i()(this.slaveDevices);return e&&e.length>0?w.clearDownloadState(e).finally((function(){t.fetchDownloadAppState(),t.clearDownloadAppStateInterval(),t.isDeletingDownloadState=!1})):null},fetchDownloadAppState:function(){var t=this,e=i()(this.slaveDevices);return e&&e.length>0?w.fetchDownloadState().then((function(e){var a=e.data;switch(e.globalState){case"DOWNLOADING":t.currentDownloadState=S.c.DOWNLOAD_IN_PROGRESS,t.fetchDownloadAppStateInterval||t.startDownloadStateInterval(),t.isDownloadingApps=!0;break;case"CLEARED":t.currentDownloadState=null,t.clearDownloadAppStateInterval(),t.isDownloadingApps=!1;break;case"DOWNLOADED":t.currentDownloadState=S.c.DOWNLOAD_COMPLETE,t.clearDownloadAppStateInterval(),t.isDownloadingApps=!1}return t.slaveAppsDownloadStates=a,i()(t.slaveAppsDownloadStates).forEach((function(e){t.slaveAppsDownloadStates[e].dataItems=t.slaveAppsDownloadStates[e].dataItems.map((function(e){return t.appendSlaveDevice(e)}))})),a})).catch((function(e){t.isDownloadingApps=!1})):null},clearSelectedApps:function(){this.slaveAppsDownloadStates={},this.selectedItems={},this.recompute++,this.fetchSlaveApps()},appendSlaveDevice:function(t){var e=d()({},t),a=this.slaveDevices[t.slaveId];return a&&(e=d()({},e,i()(a).reduce((function(t,e){return t["slave_"+e]=a[e],t}),{}))),e},onClearDownload:function(){var t=this;this.isClearingUpdate=!0,this.clearSelectedApps(),this.deleteDownloadState().finally((function(){t.isClearDialog=!1,t.isClearingUpdate=!1}))},getControlErrorReport:function(t){return i()(t).reduce((function(e,a){e[a]||(e[a]={success:[],failure:[]});var n=t[a].dataItems;return e[a].success=n.filter((function(t){return!t.error})),e[a].failure=n.filter((function(t){return t.error})),e}),{})},getControlActionState:function(t){var e=i()(t).reduce((function(e,a){var n=t[a].success,s=t[a].failure;return 0==s.length?e.push(vt):s.length>0&&0!==n.length?e.push(ht):e.push(ft),e}),[]);return e.every((function(t){return t===vt}))?vt:e.every((function(t){return t===ft}))?ft:ht},openErrorReportDialog:function(){this.dialog[this.dialogNames.controlActionErrorReport]=!0},getToastMessageAction:function(t){var e=this,a=[];return t!==ft&&t!==ht||a.push({text:"Click here to see Error Report.",onClick:function(a,n){return e.openErrorReportDialog(a,n,t)}}),a},handleControlAction:function(t){var e=this;this.currentControlAction=t,this.isControlActionPending=!0;var a=i()(this.selectedItems).reduce((function(t,a){return e.selectedItems[a]&&e.selectedItems[a].length>0&&t.push.apply(t,K()(e.selectedItems[a])),t}),[]);if(a.length)return w.bulkControlApps(a,t).then((function(a){var n=a.data,s=e.getControlErrorReport(n),i=e.getControlActionState(s),o=mt[i];e.$toasted.show(o.message(t),{type:o.type,duration:o.duration,action:e.getToastMessageAction(i)}),e.controlActionErrorReport=s,e.clearSelectedApps()})).finally((function(){e.currentControlAction=null,e.isControlActionPending=!1}))}}},_t=Object(C.a)(gt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{loading:t.isLoadingSlaveApps||t.isFetchingAppData||t.isDownloadingApps}},[a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",[a("span",[t._v("Master Slave Apps")]),t._v(" "),a("tooltip-icon-button",{attrs:{btnColor:"default",btnIcon:"mdi-sync",btnTooltip:"Refresh master view",buttonSize:"medium",onClick:function(){return t.initialize()}}})],1),t._v(" "),a("v-menu",{attrs:{bottom:"",left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[a("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",s,!1),n),[a("v-icon",{attrs:{color:t.appliedFilterCount>0?"blue":""}},[t._v("mdi-filter")])],1)]}}])},[t._v(" "),a("v-list",{attrs:{dense:""}},[a("v-subheader",[t._v("Filters")]),t._v(" "),a("v-list-item",[a("v-list-item-title",[a("v-checkbox",{staticClass:"mt-0",attrs:{"hide-details":"",label:"Installed Apps"},model:{value:t.filters.isInstalled,callback:function(e){t.$set(t.filters,"isInstalled",e)},expression:"filters.isInstalled"}})],1)],1)],1)],1),t._v(" "),a("v-spacer"),t._v(" "),t.currentDownloadState?a("v-btn",{staticClass:"mr-2 btn-height-22 white--text",attrs:{"x-small":"",color:"default"},on:{click:function(){return t.isClearDialog=!0}}},[t._v("\n      Clear Update\n      "),a("v-icon",{attrs:{"x-small":"",right:""}},[t._v(" mdi-cellphone-erase ")])],1):t._e(),t._v(" "),a("v-btn",{staticClass:"btn-height-22 white--text",attrs:{"x-small":"",color:"pink"},on:{click:t.onBulkUpdate}},[t.showDownloadProgressIcon?a("v-progress-circular",{attrs:{width:2,size:15,color:"white",indeterminate:""}}):t._e(),t._v(" "),t.showCheckDownloadIcon?a("v-icon",{attrs:{small:""}},[t._v("mdi-check")]):t._e(),t._v(" "),a("span",{staticClass:"pl-2"},[t._v("Bulk Update")]),t._v(" "),a("v-icon",{attrs:{small:"",right:""}},[t._v("mdi-cellphone-arrow-down")])],1)],1),t._v(" "),a("v-spacer"),t._v(" "),a("v-card-text",[a("v-container",{attrs:{fluid:""}},[a("v-row",{staticClass:"mb-2",attrs:{"no-gutter":""}},[a("v-col",{attrs:{cols:"3"}},[t.selectedServicesCount>0?a("p",{staticClass:"mb-0 text-left"},[a("span",{staticClass:"grey-text font-weight-medium caption"},[t._v("Selected Apps: ")]),t._v(" "),a("span",{staticClass:"font-weight-medium"},[t._v(t._s(t.selectedServicesCount))])]):t._e()]),t._v(" "),a("v-col",{attrs:{cols:"6"}},t._l(t.actionButtons,(function(e){return a("icon-button",{key:e.name,attrs:{"btn-size":"small",disabled:0==t.selectedServicesCount||t.currentControlAction&&t.currentControlAction!==e.action,"on-click":function(){return t.handleControlAction(e.action)},"button-title":e.title,loading:t.currentControlAction&&t.currentControlAction==e.action&&t.isControlActionPending,"icon-key":e.iconKey,color:e.color}})})),1),t._v(" "),a("v-col",{attrs:{cols:"3"}})],1),t._v(" "),a("v-tabs",{attrs:{color:t.$vuetify.theme.dark?"":"nubeGreen"},model:{value:t.slaveTabs,callback:function(e){t.slaveTabs=e},expression:"slaveTabs"}},t._l(t.slaveAppsDetail,(function(e,n){return a("v-tab",{key:n},[t._v(" "+t._s(e.display_name)+" ")])})),1),t._v(" "),a("v-tabs-items",{model:{value:t.slaveTabs,callback:function(e){t.slaveTabs=e},expression:"slaveTabs"}},t._l(t.slaveAppsDetail,(function(e,n){return a("v-tab-item",{key:n},[a("v-row",{attrs:{"no-gutter":""}},[a("v-col",{attrs:{cols:"12",lg:"12",xl:"12",md:"12",sm:"12",xs:"12"}},[a("slave-app-grid",{key:t.recompute+"-"+e.name,attrs:{filters:t.filters,"slave-apps":e,"search-text":t.searchText,onSelectItem:t.onSelectItem,"slave-devices":t.slaveDevices,search:t.gridSearchMap[e.name],name:t.recompute+"-"+e.name,"slave-apps-data-items":e.dataItems,"selected-item":t.selectedItems[e.name],"latest-version":t.slaveAppsLatestVersion[e.name],updateSearch:function(a){return t.updateSearch(e.name,a)}}})],1)],1)],1)})),1)],1),t._v(" "),t.isLoadingSlaveApps?a("v-row",[t.isLoadingSlaveApps?a("v-col",{attrs:{cols:"12"}},[a("v-skeleton-loader",{attrs:{type:"table-heading, list-item-one-line, image"}})],1):t._e()],1):t._e(),t._v(" "),t.isFetchAppfailure?a("v-col",{staticClass:"text-left",attrs:{cols:"12"}},[t.fetchErrorMessage?a("v-alert",{staticClass:"mb-0 text-left",attrs:{dense:"",outlined:"",type:"error"}},[t._v("\n        "+t._s(t.fetchErrorMessage)+"\n      ")]):t._e(),t._v(" "),a("v-btn",{staticClass:"btn-height-22 white--text mt-8",attrs:{"x-small":"",color:"primary"},on:{click:t.retryFetchApps}},[t._v("Click here to retry")])],1):t._e()],1),t._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:t.dialog[t.dialogNames.bulkUpdate],callback:function(e){t.$set(t.dialog,t.dialogNames.bulkUpdate,e)},expression:"dialog[dialogNames.bulkUpdate]"}},[a("slave-apps-download-multi-step",{attrs:{"app-versions":t.appVersions,"slave-devices":t.slaveDevices,"close-dialog":function(){return t.closeDialog(t.dialogNames.bulkUpdate)},"selected-apps":t.selectedItems,"clear-selected-apps":t.clearSelectedApps,"delete-download-state":t.deleteDownloadState,"current-download-state":t.currentDownloadState,"slave-apps-download-states":t.slaveAppsDownloadStates,"fetch-download-app-state":t.fetchDownloadAppState,"clear-download-app-state-interval":t.clearDownloadAppStateInterval}})],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"600px"},model:{value:t.dialog[t.dialogNames.controlActionErrorReport],callback:function(e){t.$set(t.dialog,t.dialogNames.controlActionErrorReport,e)},expression:"dialog[dialogNames.controlActionErrorReport]"}},[a("slave-apps-control-action-report",{attrs:{"slave-devices":t.slaveDevices,"slave-app-display-name-map":t.slaveAppDisplayNameMap,"close-dialog":function(){t.dialog[t.dialogNames.controlActionErrorReport]=!1},"control-action-error-report":t.controlActionErrorReport}})],1),t._v(" "),a("confirm-dialog",{attrs:{"is-open":t.isClearDialog,loading:t.isClearingUpdate,"on-close":function(){return t.isClearDialog=!1},"on-confirm":t.onClearDownload,"dialog-text":"All progress will be lost. Are you sure?"}})],1)}),[],!1,null,null,null).exports,wt=a("N4QW"),bt=a("pzyp"),Dt={name:"rubix-apps",data:function(){return{toggleMasterSlave:2,isFetchingMRBConfig:!1,deviceInfo:{}}},components:{AppsGrid:q,PageTitle:Y.a,SlaveApps:_t},created:function(){var t=this;this.isFetchingMRBConfig=!0,this.getDeviceInfo(),bt.a().then((function(e){t.$store.commit("changeMqttRestBridgeConfig",e)})).finally((function(){t.isFetchingMRBConfig=!1}))},methods:{getDeviceInfo:function(){var t=this;wt.fetchPlatInfo().then((function(e){t.deviceInfo=e}))}},computed:{isMqttRestBridgeConfigLoaded:function(){return i()(this.$store.state.mqttRestBridgeConfig||{}).length>0},isSlaveModeActive:function(){return this.$store.state.isSwitchedSlave},isMaster:function(){return this.$store.state.isMaster}}},St=Object(C.a)(Dt,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("page-title",{attrs:{title:"Rubix Apps"},scopedSlots:t._u([{key:"spinner",fn:function(){return[t.isFetchingMRBConfig?a("v-progress-circular",{attrs:{indeterminate:"",size:"20"}}):t._e()]},proxy:!0}])}),t._v(" "),t.isFetchingMRBConfig?t._e():a("div",[t.isMaster&&!t.isSlaveModeActive?a("div",[a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-btn-toggle",{attrs:{rounded:""},model:{value:t.toggleMasterSlave,callback:function(e){t.toggleMasterSlave=e},expression:"toggleMasterSlave"}},[a("v-btn",{attrs:{small:"",value:2}},[t._v("Device: "+t._s(t.deviceInfo&&t.deviceInfo.device_name?t.deviceInfo.device_name:"Slave View"))]),t._v(" "),a("v-btn",{attrs:{small:"",value:1}},[t._v(" Master View ")])],1)],1),t._v(" "),a("v-row",[!t.isMqttRestBridgeConfigLoaded&&t.isFetchingMRBConfig?a("v-col",{attrs:{cols:"12"}},[a("v-skeleton-loader",{attrs:{type:"table-heading, list-item-two-line, image, table-tfoot"}})],1):t._e(),t._v(" "),!t.isFetchingMRBConfig&&t.isMqttRestBridgeConfigLoaded&&2==t.toggleMasterSlave?a("v-col",{attrs:{cols:"12"}},[a("apps-grid")],1):t._e(),t._v(" "),!t.isFetchingMRBConfig&&t.isMqttRestBridgeConfigLoaded&&1==t.toggleMasterSlave?a("v-col",{attrs:{cols:"12"}},[a("slave-apps")],1):t._e()],1)],1):a("div",[t.isFetchingMRBConfig?a("v-col",{attrs:{cols:"12"}},[a("v-skeleton-loader",{attrs:{type:"table-heading, image, image, image, table-tfoot"}})],1):t._e(),t._v(" "),!t.isFetchingMRBConfig&&t.isMqttRestBridgeConfigLoaded?a("v-col",{attrs:{cols:"12"}},[a("apps-grid")],1):t._e()],1)])],1)}),[],!1,null,null,null);e.default=St.exports},0:function(t,e){},"0iKi":function(t,e,a){"use strict";a.d(e,"c",(function(){return l})),a.d(e,"a",(function(){return r})),a.d(e,"e",(function(){return c})),a.d(e,"d",(function(){return p})),a.d(e,"f",(function(){return d})),a.d(e,"b",(function(){return u}));var n=a("OBCi"),s=a.n(n),i=a("uzYq"),o="/slave-devices",l=function(t){var e={global_uuid:t.global_uuid};return i.a.post(o,e)},r=function(t){return s.a.all(t.map((function(t){return l(t)})))},c=function(){return i.a.get(o)},p=function(){return i.a.get(o+"/discover")},d=function(t){var e=t.global_uuid;return i.a.delete(o+"/"+e)},u=function(t){return s.a.all(t.map((function(t){return d(t)})))}},1:function(t,e){},2:function(t,e){},"3saC":function(t,e,a){"use strict";var n={props:["on-copy"],methods:{copyToClipboard:function(t){var e=this;this.$copyText(t,this.$refs.copyClipboard).then((function(){e.$toasted.show("Copied to clipboard!",{type:"success"})}),(function(){e.$toasted.show("Cannot copy to clipboard.",{type:"error"})}))}}},s=a("psIG"),i=Object(s.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{ref:"copyClipboard"},[a("v-btn",{staticClass:"mr-1 btn-height-22 white--text",attrs:{"x-small":"",color:"exportColor"},on:{click:function(){return t.onCopy(t.copyToClipboard)}}},[t._v("\n    Export"),a("v-icon",{attrs:{"x-small":"",right:""}},[t._v("mdi-export")])],1)],1)}),[],!1,null,null,null);e.a=i.exports},"7Ipj":function(t,e,a){"use strict";var n=a("Q12t"),s=a("3saC"),i=a("Isj4"),o={name:"import-dialog",props:["receiveDataRows"],data:function(){return{file:null,dialogImportExcel:!1,dialogImportJSON:!1,dataImport:""}},methods:{importFile:function(){var t=new FileReader;t.readAsBinaryString(this.file),t.onload=this.handleFileLoad},handleFileLoad:function(t){var e=t.target.result,a=i.read(e,{type:"binary"}),n=Array.isArray(a.SheetNames)&&a.SheetNames.length>0&&a.SheetNames[0];if(!n)return this.$toasted.show("Invalid Excel File. Please reupload.",{type:"error"});var s=i.utils.sheet_to_row_object_array(a.Sheets[n]);this.receiveDataRows(s),this.dialogImportExcel=!1},closeDialog:function(){this.dialogImportJSON=!1},importJson:function(){try{var t=JSON.parse(this.dataImport);this.receiveDataRows(t),this.dialogImportJSON=!1}catch(t){return this.$toasted.show("Invalid JSON",{type:"error"})}}}},l=a("psIG"),r=Object(l.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"mr-2 btn-height-22 white--text",attrs:{"x-small":"",color:"primary"}},"v-btn",s,!1),n),[t._v("Import"),a("v-icon",{attrs:{"x-small":"",right:""}},[t._v("mdi-import")])],1)]}}])},[t._v(" "),a("v-list",[a("v-list-item",{on:{click:function(e){t.dialogImportJSON=!0,t.dataImport=""}}},[a("v-list-item-title",[t._v("JSON")])],1),t._v(" "),a("v-list-item",{on:{click:function(e){t.dialogImportExcel=!0,t.file=null}}},[a("v-list-item-title",[t._v("Excel")])],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{width:"500px"},model:{value:t.dialogImportExcel,callback:function(e){t.dialogImportExcel=e},expression:"dialogImportExcel"}},[a("v-card",[a("v-card-title",[t._v("Choose excel file")]),t._v(" "),a("v-card-text",[a("v-file-input",{attrs:{outlined:"",dense:"",label:"File input",accept:".xls,.xlsx"},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}})],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"darken-1",text:""},on:{click:function(e){t.dialogImportExcel=!1}}},[t._v("Close")]),t._v(" "),a("v-btn",{attrs:{color:"primary darken-1",text:"",disabled:!t.file},on:{click:t.importFile}},[t._v("Import")])],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{width:"500px"},model:{value:t.dialogImportJSON,callback:function(e){t.dialogImportJSON=e},expression:"dialogImportJSON"}},[a("v-card",[a("v-card-title",[t._v("Import via JSON")]),t._v(" "),a("v-card-text",[a("v-textarea",{attrs:{outlined:"",name:"input-7-4",label:"import data"},model:{value:t.dataImport,callback:function(e){t.dataImport=e},expression:"dataImport"}})],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"darken-1",text:""},on:{click:t.closeDialog}},[t._v(" Cancel ")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",text:"",disabled:!t.dataImport},on:{click:t.importJson}},[t._v("Import")])],1)],1)],1)],1)}),[],!1,null,null,null).exports,c={name:"grid-toolbar",props:["toolbarTitle","onCopy","items","fileName","formatDataService","receiveDataRows","onDelete","isDeleteEnabled","onSearch","hideExportData"],components:{ExportData:n.a,CopyClipboard:s.a,ImportDialog:r}},p=Object(l.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",{staticClass:"mr-6"},[t._v(t._s(t.toolbarTitle))]),t._v(" "),t._t("gridCounter"),t._v(" "),t.onCopy?a("copy-clipboard",{attrs:{"on-copy":t.onCopy}}):t._e(),t._v(" "),t.items&&t.items.length>0&&!t.hideExportData?a("export-data",{attrs:{data:t.items,"file-name":t.fileName,"format-data-service":t.formatDataService}}):t._e(),t._v(" "),t.receiveDataRows?a("import-dialog",{attrs:{receiveDataRows:t.receiveDataRows}}):t._e(),t._v(" "),t.onDelete?a("v-btn",{staticClass:"mr-2 btn-height-22 white--text",attrs:{"x-small":"",color:"error",disabled:!t.isDeleteEnabled},on:{click:t.onDelete}},[t._v("Delete"),a("v-icon",{attrs:{"x-small":"",right:""}},[t._v(" mdi-delete")])],1):t._e(),t._v(" "),t._t("customAction"),t._v(" "),t._t("search")],2)}),[],!1,null,null,null);e.a=p.exports},HeMS:function(t,e,a){"use strict";a.d(e,"g",(function(){return v})),a.d(e,"f",(function(){return f})),a.d(e,"c",(function(){return h})),a.d(e,"b",(function(){return m})),a.d(e,"e",(function(){return g})),a.d(e,"a",(function(){return w})),a.d(e,"d",(function(){return b}));var n=a("/9Wh"),s=a.n(n),i=a("snOE"),o=a.n(i),l=a("tZmG"),r=a.n(l),c=a("yEOx"),p=a.n(c),d=a("VleD"),u=a("M1ki"),v=function(t){var e=function(t,e){return r()(t).reduce((function(a,n){var s=r()(t[n]).reduce((function(a,s){return e[n]&&e[n].includes(s)&&a.push(t[n][s]),a}),[]);return a[n]=s,a}),{})}(t.releaseMap,function(t){return r()(t).reduce((function(e,a){return e[a]=(t[a]||[]).map((function(t){return t&&t.slaveId})).filter((function(t){return t})),e}),{})}(t.selectedItems));return r()(e).reduce((function(t,a){var n=e[a].map((function(t){return t&&t.length||1/0})),s=n.indexOf(Math.min.apply(Math,o()(n)));return t[a]=e[a][s]||[],t}),{})},f=function(t,e){d.d(u.a.SLAVE_ID,t),d.d(u.a.SLAVE_DEVICE_INFO,s()(e))},h=function(){return d.b(u.a.SLAVE_ID)},m=function(){var t=d.b(u.a.SLAVE_DEVICE_INFO);try{return JSON.parse(t)}catch(t){return null}},g=function(){d.c(u.a.SLAVE_ID),d.c(u.a.SLAVE_DEVICE_INFO)};function _(t){return t.reduce((function(t,e){var a=e.toLowerCase().split("v")[1].split(".").map((function(t){return isNaN(+t)&&t.indexOf("rc")?+t.split("-")[0]-.5/+t.split("-rc")[1]:+t})),n=a.reduce((function(t,e,n){var s;return t+=(s=a.length-n,Math.pow(10,s-1)*e)}),0);return t[n]=e,t}),{})}function w(t){var e=_(t);return e[Math.max.apply(Math,o()(r()(e)))]}function b(t,e){var a,n=p()(e),s=p()(t),i=(a=_(n),Math.max.apply(Math,o()(r()(a)))),l=_(s);return function(t){var e=_(t);return r()(e).sort((function(t,e){return e-t})).map((function(t){return e[t]}))}(r()(l).reduce((function(t,e){return+e>=i&&t.push(l[e]),t}),[]))}},OKta:function(t,e,a){"use strict";var n={name:"rbx-button",props:["title","after-icon","color","click","is-small","class-name","disabled","block","loading"]},s=a("psIG"),i=Object(s.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-btn",{staticClass:"mr-1 btn-height-22 white--text",class:t.className,attrs:{loading:t.loading,"x-small":t.isSmall,disabled:t.disabled,color:t.color,block:t.block},on:{click:t.click}},[t._v("\n  "+t._s(t.title)+"\n  "),t.afterIcon?a("v-icon",{attrs:{"x-small":t.isSmall,right:""}},[t._v(t._s(t.afterIcon))]):t._e()],1)}),[],!1,null,null,null);e.a=i.exports},Q12t:function(t,e,a){"use strict";var n=a("/9Wh"),s=a.n(n),i=a("+n12"),o={name:"export-data",props:["data","fileName","formatDataService"],methods:{clickDownload:function(t,e){var a=t;switch("function"==typeof this.formatDataService&&(a=this.formatDataService(t)),e){case"csv":return Object(i.e)(this.fileName,a);case"excel":return Object(i.g)(this.fileName,a);case"json":return Object(i.h)(this.fileName,s()(a))}}}},l=a("psIG"),r=Object(l.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"mr-2 btn-height-22 white--text",attrs:{"x-small":"",color:"downloadColor"}},"v-btn",s,!1),n),[t._v("\n      Download"),a("v-icon",{attrs:{"x-small":"",right:""}},[t._v("mdi-download")])],1)]}}])},[t._v(" "),a("v-list",[a("v-list-item",{on:{click:function(e){return t.clickDownload(t.data,"json")}}},[t._v(" JSON ")]),t._v(" "),a("v-list-item",{on:{click:function(e){return t.clickDownload(t.data,"excel")}}},[t._v(" Excel ")]),t._v(" "),a("v-list-item",{on:{click:function(e){return t.clickDownload(t.data,"csv")}}},[t._v(" CSV ")])],1)],1)}),[],!1,null,null,null);e.a=r.exports},asQ9:function(t,e,a){"use strict";var n={name:"master-star-indicator",props:["isMaster"]},s=a("psIG"),i=Object(s.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[t.isMaster?a("v-icon",t._g(t._b({staticClass:"mt-n1",attrs:{medium:"",color:"nubeYellow"}},"v-icon",s,!1),n),[t._v("mdi-star")]):t._e()]}}])},[t._v(" "),a("span",[t._v("Master device")])])}),[],!1,null,null,null);e.a=i.exports},pzyp:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return o}));var n=a("uzYq"),s="/mqtt-rest-bridge/listener",i=function(){return n.a.get(s)},o=function(t){return n.a.patch(s,t,{restrictToast:!0})}}}]);
//# sourceMappingURL=17.b2557e118b88dfdc8006.js.map