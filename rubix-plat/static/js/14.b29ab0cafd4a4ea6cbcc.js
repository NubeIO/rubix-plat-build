(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"+SqX":function(e,t,i){"use strict";var n={name:"page-title",props:["title"]},a=i("psIG"),s=Object(a.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("h1",{staticClass:"text-h5 text-left py-3"},[i("span",[e._v(e._s(e.title))]),e._v(" "),e._t("refreshIcon"),e._v(" "),e._t("titleActions"),e._v(" "),e._t("spinner")],2)}),[],!1,null,null,null);t.a=s.exports},0:function(e,t){},1:function(e,t){},2:function(e,t){},"3saC":function(e,t,i){"use strict";var n={props:["on-copy"],methods:{copyToClipboard:function(e){var t=this;this.$copyText(e,this.$refs.copyClipboard).then((function(){t.$toasted.show("Copied to clipboard!",{type:"success"})}),(function(){t.$toasted.show("Cannot copy to clipboard.",{type:"error"})}))}}},a=i("psIG"),s=Object(a.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{ref:"copyClipboard"},[i("v-btn",{staticClass:"mr-1 btn-height-22 white--text",attrs:{"x-small":"",color:"exportColor"},on:{click:function(){return e.onCopy(e.copyToClipboard)}}},[e._v("\n    Export"),i("v-icon",{attrs:{"x-small":"",right:""}},[e._v("fa-upload")])],1)],1)}),[],!1,null,null,null);t.a=s.exports},"7Ipj":function(e,t,i){"use strict";var n=i("Q12t"),a=i("3saC"),s=i("Isj4"),r={name:"import-dialog",props:["receiveDataRows"],data:function(){return{file:null,dialogImportExcel:!1,dialogImportJSON:!1,dataImport:""}},methods:{importFile:function(){var e=new FileReader;e.readAsBinaryString(this.file),e.onload=this.handleFileLoad},handleFileLoad:function(e){var t=e.target.result,i=s.read(t,{type:"binary"}),n=Array.isArray(i.SheetNames)&&i.SheetNames.length>0&&i.SheetNames[0];if(!n)return this.$toasted.show("Invalid Excel File. Please reupload.",{type:"error"});var a=s.utils.sheet_to_row_object_array(i.Sheets[n]);this.receiveDataRows(a),this.dialogImportExcel=!1},closeDialog:function(){this.dialogImportJSON=!1},importJson:function(){try{var e=JSON.parse(this.dataImport);this.receiveDataRows(e),this.dialogImportJSON=!1}catch(e){return this.$toasted.show("Invalid JSON",{type:"error"})}}}},o=i("psIG"),c=Object(o.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,a=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"mr-2 btn-height-22 white--text",attrs:{"x-small":"",color:"primary"}},"v-btn",a,!1),n),[e._v("Import"),i("v-icon",{attrs:{"x-small":"",right:""}},[e._v("fa-vcard-o")])],1)]}}])},[e._v(" "),i("v-list",[i("v-list-item",{on:{click:function(t){e.dialogImportJSON=!0,e.dataImport=""}}},[i("v-list-item-title",[e._v("JSON")])],1),e._v(" "),i("v-list-item",{on:{click:function(t){e.dialogImportExcel=!0,e.file=null}}},[i("v-list-item-title",[e._v("Excel")])],1)],1)],1),e._v(" "),i("v-dialog",{attrs:{width:"500px"},model:{value:e.dialogImportExcel,callback:function(t){e.dialogImportExcel=t},expression:"dialogImportExcel"}},[i("v-card",[i("v-card-title",[e._v("Choose excel file")]),e._v(" "),i("v-card-text",[i("v-file-input",{attrs:{outlined:"",dense:"",label:"File input",accept:".xls,.xlsx"},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}})],1),e._v(" "),i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"darken-1",text:""},on:{click:function(t){e.dialogImportExcel=!1}}},[e._v("Close")]),e._v(" "),i("v-btn",{attrs:{color:"primary darken-1",text:"",disabled:!e.file},on:{click:e.importFile}},[e._v("Import")])],1)],1)],1),e._v(" "),i("v-dialog",{attrs:{width:"500px"},model:{value:e.dialogImportJSON,callback:function(t){e.dialogImportJSON=t},expression:"dialogImportJSON"}},[i("v-card",[i("v-card-title",[e._v("Import via JSON")]),e._v(" "),i("v-card-text",[i("v-textarea",{attrs:{outlined:"",name:"input-7-4",label:"import data"},model:{value:e.dataImport,callback:function(t){e.dataImport=t},expression:"dataImport"}})],1),e._v(" "),i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"darken-1",text:""},on:{click:e.closeDialog}},[e._v(" Cancel ")]),e._v(" "),i("v-btn",{attrs:{color:"blue darken-1",text:"",disabled:!e.dataImport},on:{click:e.importJson}},[e._v("Import")])],1)],1)],1)],1)}),[],!1,null,null,null).exports,l={name:"grid-toolbar",props:["toolbarTitle","onCopy","items","fileName","formatDataService","receiveDataRows","onDelete","isDeleteEnabled","onSearch","hideExportData"],components:{ExportData:n.a,CopyClipboard:a.a,ImportDialog:c}},d=Object(o.a)(l,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-toolbar",{attrs:{flat:""}},[i("v-toolbar-title",{staticClass:"mr-6"},[e._v(e._s(e.toolbarTitle))]),e._v(" "),e._t("gridCounter"),e._v(" "),e.onCopy?i("copy-clipboard",{attrs:{"on-copy":e.onCopy}}):e._e(),e._v(" "),e.items&&e.items.length>0&&!e.hideExportData?i("export-data",{attrs:{data:e.items,"file-name":e.fileName,"format-data-service":e.formatDataService}}):e._e(),e._v(" "),e.receiveDataRows?i("import-dialog",{attrs:{receiveDataRows:e.receiveDataRows}}):e._e(),e._v(" "),e.onDelete?i("v-btn",{staticClass:"mr-2 btn-height-22 white--text",attrs:{"x-small":"",color:"error",disabled:!e.isDeleteEnabled},on:{click:e.onDelete}},[e._v("Delete"),i("v-icon",{attrs:{"x-small":"",right:""}},[e._v(" fa-trash-o")])],1):e._e(),e._v(" "),e._t("customAction"),e._v(" "),e._t("search")],2)}),[],!1,null,null,null);t.a=d.exports},MKDl:function(e,t,i){"use strict";var n={active:{name:"active",displayName:"Running",outlined:!0,color:"exportColor"},reloading:{name:"reloading",outlined:!0,displayName:"Reloading",color:"nubeYellow"},failed:{name:"failed",outlined:!0,displayName:"Failed",color:"red"},activating:{name:"activating",outlined:!0,displayName:"Activating",color:"nubeYellow"},deactivating:{outlined:!0,name:"deactivating",displayName:"Deactivating",color:"nubeYellow"},maintenance:{name:"maintenance",outlined:!0,displayName:"Maintenance",color:"nubeYellow"},STARTED:{name:"STARTED",outlined:!0,displayName:"Started",color:"blue"},RUNNING:{name:"RUNNING",outlined:!0,displayName:"Running",color:"nubeYellow"},FINISHED:{name:"FINISHED",outlined:!0,displayName:"Finished",color:"nubeGreen"},BROKEN:{name:"BROKEN",outlined:!0,displayName:"Broken",color:"red"},MAPPED:{name:"MAPPED",outlined:!0,displayName:"Mapped",color:"nubeGreen"},INTEGRATED:{name:"INTEGRATED",outlined:!1,displayName:"Integrated",color:"nubeGreen"},UNINTEGRATED:{name:"UNINTEGRATED",outlined:!1,displayName:"Not Integrated",color:"red"}},a={name:"app-status-chip",props:["status","state","chipSize"],computed:{currentStatus:function(){var e=n[this.state];return e||{name:"default",displayName:this.capitalize(this.state),color:"nubeYellow"}},defaultStatus:function(){return this.capitalize(this.state)}},methods:{capitalize:function(e){return e||(e=""),(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}}},s=i("psIG"),r=Object(s.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.state?i("div",[i("span",{staticClass:"font-weight-medium"},[e.chipSize&&"small"===e.chipSize?i("v-chip",{attrs:{small:"",outlined:"",color:e.currentStatus.color}},[e._v(e._s(e.currentStatus.displayName))]):i("v-chip",{attrs:{outlined:"",color:e.currentStatus.color}},[e._v(e._s(e.currentStatus.displayName))])],1)]):i("div",[i("span",{staticClass:"font-weight-medium"},[e.chipSize&&"small"===e.chipSize?i("v-chip",{attrs:{small:"",outlined:"",color:e.currentStatus.color}},[e._v(e._s(e.defaultStatus))]):i("v-chip",{attrs:{outlined:"",color:e.currentStatus.color}},[e._v(e._s(e.defaultStatus))])],1)])])}),[],!1,null,null,null);t.a=r.exports},OKta:function(e,t,i){"use strict";var n={name:"rbx-button",props:["title","after-icon","color","click","is-small","class-name","disabled","block","loading"]},a=i("psIG"),s=Object(a.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-btn",{staticClass:"mr-1 btn-height-22 white--text",class:e.className,attrs:{loading:e.loading,"x-small":e.isSmall,disabled:e.disabled,color:e.color,block:e.block},on:{click:e.click}},[e._v("\n  "+e._s(e.title)+"\n  "),e.afterIcon?i("v-icon",{attrs:{"x-small":e.isSmall,right:""}},[e._v(e._s(e.afterIcon))]):e._e()],1)}),[],!1,null,null,null);t.a=s.exports},Q12t:function(e,t,i){"use strict";var n=i("/9Wh"),a=i.n(n),s=i("+n12"),r={name:"export-data",props:["data","fileName","formatDataService"],methods:{clickDownload:function(e,t){var i=e;switch("function"==typeof this.formatDataService&&(i=this.formatDataService(e)),t){case"csv":return Object(s.e)(this.fileName,i);case"excel":return Object(s.g)(this.fileName,i);case"json":return Object(s.h)(this.fileName,a()(i))}}}},o=i("psIG"),c=Object(o.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,a=t.attrs;return[i("v-btn",e._g(e._b({staticClass:"mr-2 btn-height-22 white--text",attrs:{"x-small":"",color:"downloadColor"}},"v-btn",a,!1),n),[e._v("\n      Download"),i("v-icon",{attrs:{"x-small":"",right:""}},[e._v("fa-download")])],1)]}}])},[e._v(" "),i("v-list",[i("v-list-item",{on:{click:function(t){return e.clickDownload(e.data,"json")}}},[e._v(" JSON ")]),e._v(" "),i("v-list-item",{on:{click:function(t){return e.clickDownload(e.data,"excel")}}},[e._v(" Excel ")]),e._v(" "),i("v-list-item",{on:{click:function(t){return e.clickDownload(e.data,"csv")}}},[e._v(" CSV ")])],1)],1)}),[],!1,null,null,null);t.a=c.exports},Ui9F:function(e,t,i){"use strict";var n={name:"tooltip-icon-button",props:["btnIcon","btnTooltip","onClick","btnColor","buttonSize","disabled"]},a=i("psIG"),s=Object(a.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,a=t.attrs;return["medium"==e.buttonSize?i("v-btn",e._g(e._b({attrs:{disabled:e.disabled,icon:"",medium:"",color:e.btnColor},on:{click:e.onClick}},"v-btn",a,!1),n),[i("v-icon",{attrs:{medium:"",dark:""}},[e._v(" "+e._s(e.btnIcon)+" ")])],1):i("v-btn",e._g(e._b({attrs:{disabled:e.disabled,icon:"",small:"",color:e.btnColor},on:{click:e.onClick}},"v-btn",a,!1),n),[i("v-icon",{attrs:{small:"",dark:""}},[e._v(" "+e._s(e.btnIcon)+" ")])],1)]}}])},[e._v(" "),i("span",{staticStyle:{"white-space":"pre-line"},domProps:{innerHTML:e._s(e.btnTooltip)}})])}),[],!1,null,null,null);t.a=s.exports},YfxP:function(e,t,i){"use strict";var n={name:"full-screen-container",props:["title","on-back"]},a=i("psIG"),s=Object(a.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",[i("v-card-title",[i("v-btn",{staticClass:"mr-1",attrs:{icon:"",medium:""},on:{click:e.onBack}},[i("v-icon",{attrs:{medium:""}},[e._v(" fa-angle-left ")])],1),e._v(" "),i("v-container",{staticClass:"text-left"},[e._v(e._s(e.title))])],1),e._v(" "),i("v-container",{attrs:{fluid:""}},[e._t("default")],2)],1)}),[],!1,null,null,null);t.a=s.exports},Zepl:function(e,t,i){"use strict";t.a={maxLengthValidator:function(e){return function(t){return"string"==typeof t&&t.length<=e||"Value should be of "+e+" length."}},minLengthValidator:function(e){return function(t){return"string"==typeof t&&t.length>=e||"Value should be of at least "+e+" length."}},required:function(e){return!!e||"Required"},number:function(e){return!function(e){return isNaN(+e)}(e)||"Value should be a number"},isIpAddress:function(e){return!(!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(t=e)&&!/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/g.test(t)&&"localhost"!==(""+t).toLowerCase())||"Invalid IP Address";var t},isJsonString:function(e){return function(e){try{JSON.parse(e)}catch(e){return!1}return!0}(e)||"Data should be in a valid JSON format"}}},lkCm:function(e,t,i){"use strict";var n={name:"confirm-dialog",props:["on-close","on-confirm","dialog-text","is-open","loading"]},a=i("psIG"),s=Object(a.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:e.isOpen,callback:function(t){e.isOpen=t},expression:"isOpen"}},[i("v-card",[i("v-card-title",[i("v-icon",{attrs:{color:"warning"}},[e._v(" fa-exclamation-circle ")]),e._v(" Confirm ")],1),e._v(" "),i("v-card-text",[i("v-container",[i("v-row",[e._v(e._s(e.dialogText))])],1)],1),e._v(" "),i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{text:""},on:{click:e.onClose}},[e._v(" No ")]),e._v(" "),i("v-btn",{attrs:{color:"red darken-1",loading:e.loading,text:""},on:{click:e.onConfirm}},[e._v(" Yes ")])],1)],1)],1)}),[],!1,null,null,null);t.a=s.exports},"n/Zs":function(e,t,i){"use strict";i.d(t,"e",(function(){return r})),i.d(t,"i",(function(){return o})),i.d(t,"h",(function(){return c})),i.d(t,"d",(function(){return l})),i.d(t,"g",(function(){return d})),i.d(t,"f",(function(){return u})),i.d(t,"m",(function(){return p})),i.d(t,"b",(function(){return m})),i.d(t,"a",(function(){return v})),i.d(t,"l",(function(){return h})),i.d(t,"j",(function(){return g})),i.d(t,"n",(function(){return f})),i.d(t,"k",(function(){return b})),i.d(t,"c",(function(){return P}));var n=i("uzYq"),a=i("NWgQ"),s=i.n(a),r="modbus-server",o=function(e){return n.a.post(r+"/poll-point",e)},c=function(e){var t=r+"/network";return e&&(t=t+"?"+s.a.stringify(e)),n.a.get(r+"/network?"+s.a.stringify(e))},l=function(e){return n.a.delete(r+"/network/"+e)},d=function(e,t){var i=r+"/network/"+e;return t&&(i=i+"?"+s.a.stringify(t)),n.a.get(i)},u=function(e,t){var i=r+"/device/"+e;return t&&(i=i+"?"+s.a.stringify(t)),n.a.get(i)},p=function(e,t){return n.a.put(r+"/network/"+e,t)},m=function(e){return n.a.post(r+"/network",e)},v=function(e){return n.a.post(r+"/device",e)},h=function(e,t){return n.a.put(r+"/device/"+e,t)},g=function(e){return n.a.delete(r+"/device/"+e)},f=function(e,t){return n.a.put(r+"/point/"+e,t)},b=function(e){return n.a.delete(r+"/point/"+e)},P=function(e){return n.a.post(r+"/point",e)}},rRpL:function(e,t,i){"use strict";i.r(t);var n=i("Kz1y"),a=i.n(n),s=i("+SqX"),r=i("TcPG"),o=i.n(r),c=i("OKta"),l=i("Zepl"),d={components:{RbxButton:c.a},props:["toList","fromList","isEditForm","onCancel","serviceMapping","mappingListLeft","mappingListRight","mappingRightKey","mappingLeftKey","serviceMappings","createServiceMapping","mappingSelectionLeftTitle","mappingSelectionRightTitle"],data:function(){return{uuid:null,valid:!1,selectedToList:[],selectedLeft:null,selectedRight:null,isCreatingMapping:!1,fieldValidations:[l.a.required]}},mounted:function(){this.isEditForm&&this.serviceMapping&&(this.uuid=this.serviceMapping.uuid,this.selectedLeft=this.serviceMapping[this.mappingLeftKey],this.selectedRight=this.serviceMapping[this.mappingRightKey],this.fieldValidations=[])},computed:{mappings:function(){return this.serviceMappings},selectedMappingListLeft:function(){var e=this;return this.serviceMappings.map((function(t){return t[e.mappingLeftKey]}))},selectedMappingListRight:function(){var e=this;return this.serviceMappings.map((function(t){return t[e.mappingRightKey]}))},updatedMappingListLeft:function(){return this.updateLisItemProperty(this.mappingListLeft,this.selectedMappingListLeft)},updatedMappingListRight:function(){return this.updateLisItemProperty(this.mappingListRight,this.selectedMappingListRight)}},methods:{addMapping:function(){var e,t=this;this.$refs.serviceMappingForm.validate()&&(this.selectedMappingListLeft.push(this.selectedLeft),this.selectedMappingListRight.push(this.selectedRight),this.isCreatingMapping=!0,this.createServiceMapping((e={},o()(e,this.mappingLeftKey,this.selectedLeft),o()(e,this.mappingRightKey,this.selectedRight),e),this.uuid).then((function(){if(t.isEditForm)return t.onCancel();t.selectedLeft=null,t.selectedRight=null,t.$refs.serviceMappingForm.reset()})).finally((function(){t.isCreatingMapping=!1})))},updateLisItemProperty:function(e,t){if(!t)return e;var i=t.filter((function(e){return e})).map((function(e){return e.id}));return e.reduce((function(e,t){return i.includes(t.id)?t.disabled=!0:t.disabled=!1,e.push(t),e}),[])}}},u=i("psIG"),p=Object(u.a)(d,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-form",{ref:"serviceMappingForm",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[i("v-row",[i("v-col",{attrs:{cols:e.isEditForm?12:5.5}},[i("v-autocomplete",{attrs:{items:e.updatedMappingListLeft,"auto-select-first":"",clearable:"","item-text":"name","item-value":"id",rules:e.fieldValidations,label:e.mappingSelectionLeftTitle,"return-object":""},model:{value:e.selectedLeft,callback:function(t){e.selectedLeft=t},expression:"selectedLeft"}})],1),e._v(" "),i("v-col",{attrs:{cols:e.isEditForm?12:5.5}},[i("v-autocomplete",{attrs:{items:e.updatedMappingListRight,"auto-select-first":"",clearable:"","item-text":"name",rules:e.fieldValidations,"item-value":"id",label:e.mappingSelectionRightTitle,"return-object":""},model:{value:e.selectedRight,callback:function(t){e.selectedRight=t},expression:"selectedRight"}})],1),e._v(" "),e.isEditForm?e._e():i("v-col",{staticClass:"flex justify-center align-center",attrs:{cols:"1"}},[i("v-btn",{staticClass:"btn-height-22 white--text",attrs:{"x-small":"",color:"pink",block:"",loading:e.isCreatingMapping},on:{click:e.addMapping}},[e._v("Add")])],1)],1),e._v(" "),e.isEditForm?i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"darken-1",text:""},on:{click:e.onCancel}},[e._v(" Cancel ")]),e._v(" "),i("v-btn",{attrs:{color:"blue darken-1",loading:e.isCreatingMapping,text:""},on:{click:e.addMapping}},[e._v(" Save ")])],1):e._e()],1)}),[],!1,null,"7e044bb8",null).exports,m=i("/9Wh"),v=i.n(m),h=i("MKDl"),g=i("lkCm"),f=i("7Ipj"),b=i("Ui9F"),P=i("A5Vd"),_={name:"service-mapping-grid",props:["loading","mappingRightKey","mappingListRight","mappingListLeft","mappingLeftKey","serviceMappings","deleteItem","editItem","fileName","formatDataService","mappingRightTitle","mappingLeftTitle","updateServiceMapping","receiveDataRows","deleteItems","fixMapping","syncGridItems"],components:{ConfirmDialog:g.a,ServiceMappingForm:p,GridToolbar:f.a,AppStatusChip:h.a,TooltipIconButton:b.a},data:function(){var e={deleteServiceMapping:"deleteServiceMapping"};return{search:"",isFixingServiceMaps:!1,deletionType:null,selectedItems:[],isDeletingItem:!1,selectedItem:null,editServiceMappingDialog:!1,dialog:o()({},e.deleteServiceMapping,!1),dialogNames:e,headers:[{text:this.mappingLeftTitle,align:"start",value:"serviceLeft"},{text:this.mappingRightTitle,align:"start",value:"serviceRight"},{text:"Mapping status",align:"center",value:"mapping_state"},{text:"Actions",align:"start",value:"actions",sortable:!1}],tableProps:a()({},P.d)}},computed:{items:function(){var e=this;return this.serviceMappings.map((function(t){return a()({},t,{isMapped:t.mapping_state===P.i.MAPPED,mapping_state:t.mapping_state||"-",serviceLeft:t[e.mappingLeftKey]&&t[e.mappingLeftKey].name||"-",serviceRight:t[e.mappingRightKey]&&t[e.mappingRightKey].name||"-"})}))},isDeleteEnabled:function(){return this.selectedItems.length>0}},methods:{openDialog:function(e,t,i){this.dialog[e]=!0,this.deletionType=t,"single"==t&&(this.selectedItem=i)},toggleServiceMappingDialog:function(e){this.editServiceMappingDialog=!this.editServiceMappingDialog,this.editServiceMappingDialog?this.selectedItem=e:this.selectedItem=null},closeDialog:function(e){this.dialog[e]=!1,this.selectedItem=null,this.deletionType=null},handleDeleteItem:function(){switch(this.deletionType){case"single":this.onDeleteRow();break;case"multiple":this.onDeleteRows()}},onCopy:function(e){var t=this.formatDataService(this.selectedItems.filter((function(e){return e.isMapped})),"copy");e(v()(t))},onDeleteRow:function(){var e=this;this.isDeletingItem=!0,this.deleteItem(this.selectedItem).then((function(){e.closeDialog(e.dialogNames.deleteServiceMapping)})).finally((function(){e.isDeletingItem=!1}))},onDeleteRows:function(){var e=this;this.selectedItems.length>0&&(this.isDeletingItem=!0,this.deleteItems(this.selectedItems).then((function(){e.closeDialog(e.dialogNames.deleteServiceMapping)})).finally((function(){e.isDeletingItem=!1})))},fixServiceMappings:function(){var e=this;"function"==typeof this.fixMapping&&(this.isFixingServiceMaps=!0,this.fixMapping().finally((function(){e.isFixingServiceMaps=!1})))}}},M=Object(u.a)(_,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("grid-toolbar",{attrs:{toolbarTitle:"Mappings",items:e.items,"hide-export-data":!0,"is-delete-enabled":e.isDeleteEnabled,"on-delete":function(){return e.openDialog(e.dialogNames.deleteServiceMapping,"multiple")},"on-copy":e.onCopy,"file-name":e.fileName,"format-data-service":e.formatDataService,"receive-data-rows":e.receiveDataRows},scopedSlots:e._u([{key:"search",fn:function(){return[i("v-spacer"),i("v-spacer"),i("v-spacer"),i("v-spacer"),e._v(" "),i("v-text-field",{attrs:{"append-icon":"fa-search",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]},proxy:!0},{key:"customAction",fn:function(){return[i("v-btn",{staticClass:"mr-2 btn-height-22 white--text",attrs:{"x-small":"",color:"blue"},on:{click:e.fixServiceMappings}},[e._v("\n        Sync\n        "),e.isFixingServiceMaps?i("v-progress-circular",{staticClass:"ml-3",attrs:{width:"2",indeterminate:"",size:"12"}}):i("v-icon",{attrs:{"x-small":"",right:""}},[e._v(" fa-refresh ")])],1),e._v(" "),i("tooltip-icon-button",{attrs:{btnColor:"default",btnIcon:"fa-refresh",btnTooltip:"Refresh mapping table",buttonSize:"small",onClick:function(){return e.syncGridItems()}}})]},proxy:!0}])}),e._v(" "),i("v-data-table",{attrs:{"show-select":"","item-key":"uuid",loading:e.loading,headers:e.headers,search:e.search,items:e.items,"footer-props":e.tableProps.FOOTER_PROPS,itemsPerPage:e.tableProps.ITEMS_PER_PAGE},scopedSlots:e._u([{key:"item.mapping_state",fn:function(e){var t=e.item;return[i("app-status-chip",{attrs:{state:t.mapping_state}})]}},{key:"item.actions",fn:function(t){var n=t.item;return[i("v-btn",{attrs:{icon:"",small:"",color:"primary"},on:{click:function(){return e.toggleServiceMappingDialog(n)}}},[i("v-icon",{attrs:{small:"",dark:""}},[e._v(" fa-pencil ")])],1),e._v(" "),i("v-btn",{attrs:{icon:"",small:"",color:"error"},on:{click:function(){return e.openDialog(e.dialogNames.deleteServiceMapping,"single",n)}}},[i("v-icon",{attrs:{small:"",dark:""}},[e._v(" fa-trash-o ")])],1)]}}],null,!0),model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}}),e._v(" "),i("confirm-dialog",{attrs:{"is-open":e.dialog[e.dialogNames.deleteServiceMapping],loading:e.isDeletingItem,"on-close":function(){return e.closeDialog(e.dialogNames.deleteServiceMapping)},"on-confirm":function(){return e.handleDeleteItem()},"dialog-text":"Do you want to delete the mapping(s)?"}}),e._v(" "),i("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.editServiceMappingDialog,callback:function(t){e.editServiceMappingDialog=t},expression:"editServiceMappingDialog"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v("Edit Mapping")])]),e._v(" "),i("v-card-text",[i("service-mapping-form",{attrs:{"service-mappings":e.serviceMappings,"mapping-list-right":e.mappingListRight,"mapping-list-left":e.mappingListLeft,"mapping-selection-right-title":e.mappingRightTitle,"mapping-selection-left-title":e.mappingLeftTitle,"create-service-mapping":e.updateServiceMapping,"mapping-left-key":e.mappingLeftKey,"mapping-right-key":e.mappingRightKey,"is-edit-form":!0,"on-cancel":function(){return e.toggleServiceMappingDialog()},"service-mapping":e.selectedItem}})],1)],1)],1)],1)}),[],!1,null,null,null).exports,x=i("edSL"),y=i.n(x),k=i("OBCi"),C=i.n(k),D=i("uzYq"),w=i("mWu/"),S=i.n(w),N="/service-mapping/generic-bacnet-mapping";function I(e){return e.map((function(e){return a()({},e,{genericPoint:{id:e.mapped_point_uuid,name:e.mapped_point_name},bacnetPoint:{id:e.point_uuid,name:e.point_name}})}))}function E(e,t,i){var n=t[e.generic_point_name.toLowerCase()];return a()({},e,{network_details:n,bacnet_point:i[e.bacnet_point_name.toLowerCase()]})}function G(e){return e.map((function(e){return S.a.unflatten(e,{transformKey:function(e){return e.trim()}})}))}function L(e){var t={};return e.uuid&&(t.uuid=e.uuid),a()({},t,{generic_point_uuid:e.genericPoint.id,generic_point_name:e.genericPoint.name,bacnet_point_uuid:e.bacnetPoint.id,bacnet_point_name:e.bacnetPoint.name})}function R(e){return{point_uuid:e.bacnetPoint.id,mapped_point_uuid:e.genericPoint.id,type:"BACNET"}}var T=function(e){return D.a.delete(N+"/"+e.uuid)},F={name:"bacnet-generic-point-mapping-dialog",props:["dataRows","isOpen","close","bacnetPoints","genericPoints","syncMappingBacnetGenericPoints"],data:function(){return{dataItems:[],valid:!1,isRequestOnce:!1,isCreatingMapping:!1,errors:[],rules:{required:function(e){return!!e||"Required."}},errorTableHeaders:[{text:"Row",value:"rowIndex",sortable:!1},{text:"Error Message",value:"message",sortable:!1}],headers:[{text:"Actions",value:"actions",sortable:!1},{text:"Row",value:"rowNumber",sortable:!1},{text:"Network Name",value:"networkName",sortable:!1},{text:"Device Name",value:"deviceName",sortable:!1},{text:"Point Name",value:"pointName",sortable:!1},{text:"BACnet Point Name",value:"bacnetPointName",sortable:!1},{text:"BACnet Point Address",value:"bacnetPointAddress",sortable:!1}],tableProps:a()({},P.d)}},computed:{genericPointNames:function(){return this.genericPoints.map((function(e){return y()(e,"point.name")})).filter((function(e){return e}))}},mounted:function(){this.dataItems=this.dataRows},methods:{exists:function(e,t,i){return!!t&&!!t.find((function(t){return i?t[i]==e:t==e}))},clickDeleteImport:function(e){this.dataItems=this.dataItems.filter((function(t,i){return i!==e})),this.errors=this.errors.filter((function(e,t){return itemIndex!==t}))},createMapping:function(){var e,t=this;this.$refs.form.validate()&&(this.isCreatingMapping=!0,this.isRequestOnce=!0,(e=this.dataItems,D.a.post(N+"/file-upload",G(e))).then((function(e){t.errors=e.reduce((function(e,i){return i.success||e.push(t.getErrorFromResult(i)),e}),[]),e.map((function(e){return e.success})).every((function(e){return e}))&&(t.syncMappingBacnetGenericPoints(),t.closeDialog())})).catch((function(e){})).finally((function(){t.isCreatingMapping=!1})))},getErrorFromResult:function(e){return{rowIndex:e.rowIndex+1,message:e.message}},closeDialog:function(){this.isRequestOnce&&this.syncMappingBacnetGenericPoints(),this.dataItems=[],this.close()}}},A=Object(u.a)(F,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-dialog",{attrs:{persistent:""},model:{value:e.isOpen,callback:function(t){e.isOpen=t},expression:"isOpen"}},[e.isOpen?i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v("Import Mappings")])]),e._v(" "),i("v-card-text",[i("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[i("v-data-table",{staticClass:"elevation-1 mb-4",attrs:{headers:e.headers,items:e.dataItems,"footer-props":e.tableProps.FOOTER_PROPS,itemsPerPage:e.tableProps.ITEMS_PER_PAGE},scopedSlots:e._u([{key:"item.actions",fn:function(t){var n=t.index;return[i("v-icon",{attrs:{small:"",color:"error"},on:{click:function(t){return e.clickDeleteImport(n)}}},[e._v(" fa-trash-o ")])]}},{key:"item.rowNumber",fn:function(t){var n=t.index;return[i("span",[e._v(e._s(+n+1))])]}},{key:"item.networkName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{"single-line":"",required:""},model:{value:n.network_details.network.name,callback:function(t){e.$set(n.network_details.network,"name",t)},expression:"item.network_details.network.name"}})]}},{key:"item.deviceName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{"single-line":"",required:""},model:{value:n.network_details.device.name,callback:function(t){e.$set(n.network_details.device,"name",t)},expression:"item.network_details.device.name"}})]}},{key:"item.pointName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{"single-line":"",rules:[e.rules.required],required:""},model:{value:n.network_details.point.name,callback:function(t){e.$set(n.network_details.point,"name",t)},expression:"item.network_details.point.name"}})]}},{key:"item.bacnetPointName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{rules:[e.rules.required],"single-line":"",required:""},model:{value:n.bacnet_point.name,callback:function(t){e.$set(n.bacnet_point,"name",t)},expression:"item.bacnet_point.name"}})]}},{key:"item.bacnetPointAddress",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{"single-line":"",required:"",rules:[e.rules.required]},model:{value:n.bacnet_point.address,callback:function(t){e.$set(n.bacnet_point,"address",t)},expression:"item.bacnet_point.address"}})]}}],null,!0)})],1)],1),e._v(" "),e.errors.length>=1?i("v-card",{staticClass:"px-8 mt-n15"},[i("v-card-title",{attrs:{color:"red darken-1"}},[e._v("Errors")]),e._v(" "),i("v-card-text",[i("v-data-table",{staticClass:"elevation-1 mb-1",attrs:{"hide-default-footer":"",headers:e.errorTableHeaders,items:e.errors}})],1)],1):e._e(),e._v(" "),i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"darken-1",text:""},on:{click:e.closeDialog}},[e._v(" Cancel ")]),e._v(" "),i("v-btn",{attrs:{color:"blue darken-1",loading:e.isCreatingMapping,text:""},on:{click:e.createMapping}},[e._v(" Save ")])],1)],1):e._e()],1)}),[],!1,null,null,null).exports,B=i("YfxP"),O=i("t3kO"),K=i.n(O),$=i("5u71"),V=i.n($),j=i("yEOx"),q=i.n(j),H=i("n/Zs"),z=function(e){var t=[],i=!0,n=!1,s=void 0;try{for(var r,o=K()(e);!(i=(r=o.next()).done);i=!0){var c=r.value,l=!0,d=!1,u=void 0;try{for(var p,m=K()(c.devices);!(l=(p=m.next()).done);l=!0){var v=p.value,h=!0,g=!1,f=void 0;try{for(var b,P=K()(v.points);!(h=(b=P.next()).done);h=!0){var _=b.value,M={id:_.uuid,uuid:_.uuid,name:c.name+":"+v.name+":"+_.name},x=a()({},c);delete x.devices;var y=a()({},v);delete y.points;var k=a()({},_);M=a()({},M,{network:x,device:y,point:k}),t.push(M)}}catch(e){g=!0,f=e}finally{try{!h&&P.return&&P.return()}finally{if(g)throw f}}}}catch(e){d=!0,u=e}finally{try{!l&&m.return&&m.return()}finally{if(d)throw u}}}}catch(e){n=!0,s=e}finally{try{!i&&o.return&&o.return()}finally{if(n)throw s}}return t},J=function(e){var t=[],i=q()(e),n=!0,s=!1,r=void 0;try{for(var o,c=K()(e);!(n=(o=c.next()).done);n=!0){var l=o.value,d=!0,u=!1,p=void 0;try{for(var m,v=K()(l.devices);!(d=(m=v.next()).done);d=!0){var h=m.value,g=!0,f=!1,b=void 0;try{for(var P,_=K()(h.points);!(g=(P=_.next()).done);g=!0){var M=P.value,x={id:M.uuid,uuid:M.uuid,name:l.name+":"+h.name+":"+M.name},y=a()({},l);delete y.devices;var k=a()({},h);delete k.points;var C=a()({},M);x=a()({},x,{network:y,device:k,point:C}),t.push(x)}}catch(e){f=!0,b=e}finally{try{!g&&_.return&&_.return()}finally{if(f)throw b}}}}catch(e){u=!0,p=e}finally{try{!d&&v.return&&v.return()}finally{if(u)throw p}}}}catch(e){s=!0,r=e}finally{try{!n&&c.return&&c.return()}finally{if(s)throw r}}return{networkPoints:t,networks:i}},U=function(e){var t=[],i=V()(e),n=!0,s=!1,r=void 0;try{for(var o,c=K()(e);!(n=(o=c.next()).done);n=!0){var l=o.value,d=!0,u=!1,p=void 0;try{for(var m,v=K()(l.devices);!(d=(m=v.next()).done);d=!0){var h=m.value,g={id:h.uuid,uuid:h.uuid,name:l.name+":"+h.name},f=a()({},l);delete f.devices;var b=a()({},h);g=a()({},g,{network:f,device:b}),t.push(g)}}catch(e){u=!0,p=e}finally{try{!d&&v.return&&v.return()}finally{if(u)throw p}}}}catch(e){s=!0,r=e}finally{try{!n&&c.return&&c.return()}finally{if(s)throw r}}return{genericNetworks:i,genericDevices:t}},Y=function(e){var t=[],i=[],n=!0,s=!1,r=void 0;try{for(var o,c=K()(e);!(n=(o=c.next()).done);n=!0){var l=o.value;i.push(a()({},l));var d=!0,u=!1,p=void 0;try{for(var m,v=K()(l.points);!(d=(m=v.next()).done);d=!0){var h=m.value;t.push({item:h,deviceName:l.name,pointName:h.name,name:l.name+":"+h.name,id:h.uuid,uuid:h.uuid})}}catch(e){u=!0,p=e}finally{try{!d&&v.return&&v.return()}finally{if(u)throw p}}}}catch(e){s=!0,r=e}finally{try{!n&&c.return&&c.return()}finally{if(s)throw r}}return{loraPoints:t,loraDevices:i}},W=function(){return D.a.get("/point-server/generic/network?with_children=true&points=true").then(z)},Q=function(){return D.a.get("/point-server/generic/network?with_children=true&points=true").then(U)},Z=function(){return D.a.get("/bac-net/point")},X=i("vQiG"),ee={name:"rubix-bacnet-points-mapping",components:{FullScreenContainer:B.a,ServiceMappingForm:p,ServiceMappingGrid:M,PageTitle:s.a,BacnetGenericPointMappingImportDialog:A},props:["on-cancel"],data:function(){return{openImportMappingDialog:!1,isUpdating:!1,dataRows:[],serviceMappings:[],rubixPSGenericPoints:[],bacnetPoints:[],isFetchingGridData:!1,rubixPSGenericPointsMap:{},bacnetPointsMap:{}}},mounted:function(){this.syncMappingBacnetGenericPoints()},methods:{syncMappingBacnetGenericPoints:function(){this.fetchServiceMapping(),this.fetchBacnetPoints(),this.fetchGenericPoints()},fetchBacnetPoints:function(){var e=this;Z().then((function(t){e.bacnetPoints=t.map((function(e){return a()({},e,{id:e.uuid,name:e.object_name})})),e.bacnetPointsMap=(e.bacnetPoints||[]).reduce((function(e,t){return e[t.name.toLowerCase()]=t,e}),{})}))},fetchGenericPoints:function(){var e=this;W().then((function(t){e.rubixPSGenericPoints=t,e.rubixPSGenericPointsMap=(e.rubixPSGenericPoints||[]).reduce((function(e,t){return e[t.name.toLowerCase()]=t,e}),{})}))},createServiceMapping:function(e){var t=this;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.post(""+N,R(e))}(e).then((function(){t.fetchServiceMapping(),t.$toasted.show(X.c.success)})).catch((function(e){t.$toasted.show(X.c.error,{type:"error"})})).finally((function(){}))},updateServiceMapping:function(e,t){var i=this;return function(){var e=arguments[1],t=R(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return D.a.patch(N+"/"+e,t)}(e,t).then((function(){i.fetchServiceMapping(),i.$toasted.show(X.g.success)})).catch((function(e){i.$toasted.show(X.g.error,{type:"error"})}))},fetchServiceMapping:function(){var e=this;this.isFetchingGridData=!0,D.a.get(""+N).then(I).then((function(t){e.serviceMappings=t})).finally((function(){e.isFetchingGridData=!1}))},deleteServiceMapping:function(e){var t=this;return T(e).then((function(){t.fetchServiceMapping(),t.$toasted.show(X.d.success)})).catch((function(e){t.$toasted.show(X.d.error,{type:"error"}),console.error(e)}))},deleteServiceMappings:function(e){var t=this;return function(e){return C.a.all(e.map((function(e){return T(e)})))}(e).then((function(){t.fetchServiceMapping(),t.$toasted.show(X.e.success)})).catch((function(e){t.$toasted.show(X.e.error,{type:"error"})}))},formatExportData:function(e,t){var i=this;return"copy"===t?e.map(L).map((function(e){return E(e,i.rubixPSGenericPointsMap,i.bacnetPointsMap)})):function(e){return e.map((function(e){return S.a.flatten(e)}))}(e.map(L).map((function(e){return E(e,i.rubixPSGenericPointsMap,i.bacnetPointsMap)})))},closeImportMappingDialog:function(){this.openImportMappingDialog=!1},receiveDataRows:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length>=1&&(this.dataRows=G(e),this.openImportMappingDialog=!0)},fixMapping:function(){var e=this;return D.a.get(N+"/fix-mapping").then((function(){e.fetchServiceMapping()}))}}},te=Object(u.a)(ee,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card-text",[i("v-spacer"),e._v(" "),i("service-mapping-form",{attrs:{"service-mappings":e.serviceMappings,"mapping-list-right":e.rubixPSGenericPoints,"mapping-list-left":e.bacnetPoints,"mapping-selection-right-title":"Rubix Rubix Points","mapping-selection-left-title":"BACnet Points","create-service-mapping":e.createServiceMapping,"mapping-left-key":"bacnetPoint","mapping-right-key":"genericPoint"}}),e._v(" "),i("v-divider"),e._v(" "),i("service-mapping-grid",{attrs:{"mapping-right-key":"genericPoint",syncGridItems:e.syncMappingBacnetGenericPoints,"mapping-left-key":"bacnetPoint","format-data-service":e.formatExportData,"file-name":"bacnet-points-generic-points-mapping","mapping-left-title":"BACnet Points","mapping-right-title":"Rubix Rubix Points","mapping-list-left":e.bacnetPoints,"mapping-list-right":e.rubixPSGenericPoints,"delete-item":e.deleteServiceMapping,"delete-items":e.deleteServiceMappings,loading:e.isFetchingGridData,"fix-mapping":e.fixMapping,"update-service-mapping":e.updateServiceMapping,"service-mappings":e.serviceMappings,"receive-data-rows":e.receiveDataRows}}),e._v(" "),e.openImportMappingDialog?i("bacnet-generic-point-mapping-import-dialog",{attrs:{"bacnet-points":e.bacnetPoints,"generic-points":e.rubixPSGenericPoints,"is-open":e.openImportMappingDialog,close:e.closeImportMappingDialog,"sync-mapping-bacnet-generic-points":e.syncMappingBacnetGenericPoints,"data-rows":e.dataRows}}):e._e()],1)}),[],!1,null,null,null).exports,ie=i("snOE"),ne=i.n(ie),ae=i("tZmG"),se=i.n(ae),re=i("tXyU"),oe=i.n(re),ce=i("/gfI"),le=i.n(ce),de={components:{RbxButton:c.a},props:["serviceMappings","isEditForm","parentPoints","child1Points","child2Points","serviceMapping","parentMappingKey","child1MappingKey","child2MappingKey","createServiceMapping","createLoraBacnetGenericPointMapping","parentFieldTitle","child1FieldTitle","child2FieldTitle","onCancel","genericNetworkDevices","loraDevices","genericNetworks"],data:function(){return{uuid:null,valid:!1,mappingErrors:[],loraDeviceNames:[],loraDeviceStates:{},autoCreateDevicesAndPoints:!1,autoCreateBacnetPoints:!1,selectedLoraDevices:[],addNewNetworkToggle:!1,addNewDeviceToggle:!1,isMapMultipleLoraPoints:!1,isMapExistingBacnetPoint:!0,isCreatingMapping:!1,selectedLoraPoint:null,selectedLoraPoints:[],selectedChild1Point:null,selectedChild2Point:null,selectedGenericNetwork:null,selectedGenericDevice:null,genericPointValidation:[l.a.required],genericChildValidation:[l.a.required],fieldValidations:[l.a.required],generatedGenericPoints:[],generatedBacnetPoints:[],editNameFormValid:!1,isEditNameOpen:!1,pointName:"",editPointType:null,currentEditItem:{},arrayRequiredValidation:function(e){return!!(Array.isArray(e)&&e.length>0)||"Required"}}},watch:{selectedLoraPoints:function(e,t){this.onGenericDevicesChange(),this.isMultipleLoraPointsSelected&&(this.selectedChild1Point=null,this.isMapMultipleLoraPoints=!1)},loraDeviceNames:function(e,t){le()(e,t)||(this.loraDeviceStates=this.loraDeviceNames.reduce((function(e,t){return e[t]={name:t,selected:!1},e}),{}))},isMapExistingGenericPointVisible:function(e,t){le()(e,t)||this.checkValidation()}},mounted:function(){this.isEditForm&&this.serviceMapping&&(this.uuid=this.serviceMapping.uuid,this.isMapMultipleLoraPoints=!0,this.selectedLoraPoint=this.serviceMapping[this.parentMappingKey],this.serviceMapping.hasOwnProperty(this.child1MappingKey)&&(this.selectedChild1Point=this.serviceMapping[this.child1MappingKey]),this.serviceMapping.hasOwnProperty(this.child2MappingKey)&&(this.selectedChild2Point=this.serviceMapping[this.child2MappingKey]),this.genericChildValidation=[])},computed:{mappings:function(){return this.serviceMappings},selectedParentMappings:function(){var e=this;return this.serviceMappings.map((function(t){return t[e.parentMappingKey]}))},isMapExistingGenericPointVisible:function(){return this.selectedLoraPoints.length<=1&&!this.isEditForm},selectedChild2Mappings:function(){var e=this;return this.serviceMappings.map((function(t){return t[e.child2MappingKey]}))},selectedChild1Mappings:function(){var e=this;return this.serviceMappings.map((function(t){return t[e.child1MappingKey]}))},updatedParentPointsList:function(){return this.selectedLoraDevices,this.updateParentListItemProperty(this.parentPoints,this.selectedParentMappings)},updatedChild2PointsList:function(){return this.updateLisItemProperty(this.child2Points,this.selectedChild2Mappings)},updatedChild1PointsList:function(){return this.updateLisItemProperty(this.child1Points,this.selectedChild1Mappings)},isAllLoraPointsSelected:function(){return this.selectedLoraPoints.length===this.updatedParentPointsList.length},isMultipleLoraPointsSelected:function(){return this.selectedLoraPoints&&this.selectedLoraPoints.length>1},deviceSelectAllOptions:function(){return this.loraDevices.map((function(e){return{name:e.name,value:e.name,uuid:e.uuid,item:e,selected:!1}}))},genericDevices:function(){return this.selectedGenericNetwork&&this.selectedGenericNetwork.devices||[]},loraSelectionLabel:function(){return this.selectedLoraPoints.length>0?this.parentFieldTitle+" | "+this.selectedLoraPoints.length+" LoRa points selected":this.parentFieldTitle}},methods:{getServiceMappings:function(){return this.autoCreateBacnetPoints?this.generatedBacnetPoints.map((function(e){return{bacnet_point:e.bacnetPoint,lora_point:e.loraPoint.item}})):this.autoCreateDevicesAndPoints?this.generatedGenericPoints.map((function(e){return{generic_point:{network:e.network,device:e.device,point:e.point},lora_point:e.loraPoint.item}})):void 0},addMapping:function(){var e,t=this;if(this.$refs.mappingForm.validate()){if(this.mappingErrors=[],!this.isEditForm&&!this.isMapMultipleLoraPoints&&(this.autoCreateDevicesAndPoints||this.autoCreateBacnetPoints)){this.isCreatingMapping=!0;var i=this.getServiceMappings();return this.createLoraBacnetGenericPointMapping(i,this.autoCreateDevicesAndPoints,this.autoCreateBacnetPoints).then((function(e){e.every((function(e){return!e.success}))?t.extractDisplayError(e):(t.selectedLoraPoints=null,t.selectedLoraPoint=null,t.selectedChild2Point=null,t.selectedChild1Point=null,t.autoCreateDevicesAndPoints=!1,t.autoCreateBacnetPoints=!1,t.selectedLoraDevices=[],t.$refs.mappingForm.reset())})).catch((function(e){})).finally((function(){t.isCreatingMapping=!1}))}this.isEditForm||1!=this.selectedLoraPoints.length||(this.selectedLoraPoint=this.selectedLoraPoints[0].item),this.isCreatingMapping=!0,this.createServiceMapping((e={},o()(e,this.parentMappingKey,this.selectedLoraPoint),o()(e,this.child1MappingKey,this.selectedChild1Point),o()(e,this.child2MappingKey,this.selectedChild2Point),e),this.uuid).then((function(){if(t.isEditForm)return t.onCancel();t.selectedLoraPoints=null,t.selectedLoraPoint=null,t.selectedChild2Point=null,t.selectedChild1Point=null,t.$refs.mappingForm.reset()})).finally((function(){t.isCreatingMapping=!1}))}},extractDisplayError:function(e){var t=e.filter((function(e){return!e.success})).map((function(e){return{lora_point_name:e.data&&e.data.lora_point_name,child_point_name:e.data&&(e.data.generic_point_name||e.data.bacnet_point_name),message:e.message,index:e.rowIndex}}));this.mappingErrors=t},updateParentListItemProperty:function(e,t){if(!t)return e;var i=t.filter((function(e){return e})).map((function(e){return e.id})),n=e.reduce((function(e,t){return i.includes(t.id)?t.disabled=!0:t.disabled=!1,t.group=t.deviceName,e.push(t),e}),[]),a=oe()(n,(function(e){return e.group})),s=se()(a).reduce((function(e,t){var i={text:t,name:t,isHeader:!0,isNonItem:!0};return e.push(i),e.push.apply(e,ne()(a[t])),e.push({divider:!0,isNonItem:!0}),e}),[]);return this.loraDeviceNames=se()(a),s},updateLisItemProperty:function(e,t){if(!t)return e;var i=t.filter((function(e){return e})).map((function(e){return e.id}));return e.reduce((function(e,t){return i.includes(t.id)?t.disabled=!0:t.disabled=!1,e.push(t),e}),[])},checkValidation:function(){(this.selectedChild1Point||this.autoCreateBacnetPoints||this.selectedGenericDevice&&this.selectedChild2Point||this.autoCreateDevicesAndPoints)&&this.genericChildValidation.pop(),(this.selectedChild1Point||this.autoCreateBacnetPoints)&&(this.selectedChild2Point||this.autoCreateDevicesAndPoints)||this.genericChildValidation.push(l.a.required),(this.selectedChild1Point||this.selectedChild2Point||this.autoCreateBacnetPoints||this.selectedGenericNetwork&&this.autoCreateDevicesAndPoints)&&(this.genericChildValidation=[]),this.$refs.mappingForm.resetValidation()},onLoraPointsSelectToggle:function(){var e=this;this.$nextTick((function(){e.isMultipleLoraPointsSelected?e.selectedLoraPoints=[]:e.selectedLoraPoints=e.updatedParentPointsList.slice().filter((function(e){return!e.disabled&&!e.isHeader&&!e.isNonItem}))}))},onGenericDevicesChange:function(){var e=this;Array.isArray(this.selectedLoraPoints)&&this.selectedLoraPoints.length>0&&this.selectedGenericDevice?this.generatedGenericPoints=this.selectedLoraPoints.reduce((function(t,i){var n={};return n.network=e.selectedGenericNetwork,n.device=e.selectedGenericDevice,n.point=i.item,n.name=n.network.name+":"+n.device.name+":"+n.point.name,n.loraPoint=i,t.push(n),t}),[]):this.generatedGenericPoints=[],this.checkValidation()},onMapExistingChange:function(){this.selectedChild2Point=null,this.genericChildValidation.length<1&&this.genericChildValidation.push(l.a.required),this.generatedGenericPoints=[]},onDeviceSelectAllClick:function(e){var t=this;this.$nextTick((function(){t.loraDeviceStates[e].selected=!t.loraDeviceStates[e].selected,t.loraDeviceStates[e].selected?t.selectedLoraDevices.push(e):t.selectedLoraDevices=t.selectedLoraDevices.filter((function(t){return t!==e})),t.selectedLoraPoints=t.updatedParentPointsList.reduce((function(e,i){return t.selectedLoraDevices.indexOf(i.deviceName)>-1&&!i.disabled?(e.push(i),e):e}),[])}))},getGenericDevice:function(e,t){return{driver:"GENERIC",enable:!1,fault:null,history_enable:!1,name:t,network_uuid:e}},getBacnetPointName:function(e,t){return e+"_"+t},getBacnetPoint:function(e,t){return{object_type:"analogOutput",object_name:this.getBacnetPointName(e,t),address:null,relinquish_default:1,priority_array_write:{_1:null,_2:null,_3:null,_4:null,_5:null,_6:null,_7:null,_8:null,_9:null,_10:null,_11:null,_12:null,_13:null,_14:null,_15:null,_16:null},event_state:"normal",units:"noUnits",description:"lora sensor "+t,enable:!0,use_next_available_address:!0}},onAutoCreateToggle:function(){var e=this;this.autoCreateDevicesAndPoints&&(this.autoCreateBacnetPoints=!1,this.selectedChild2Point=null,this.generatedBacnetPoints=[]),this.autoCreateDevicesAndPoints&&this.selectedGenericNetwork?(this.selectedGenericDevice=null,this.generatedGenericPoints=this.selectedLoraPoints.reduce((function(t,i){var n={};return n.network=e.selectedGenericNetwork,n.device=e.getGenericDevice(n.network.uuid,i.deviceName),n.point=a()({},i.item),n.name=n.network.name+":"+n.device.name+":"+n.point.name,n.loraPoint=a()({},i),t.push(n),t}),[])):this.generatedGenericPoints=[],this.checkValidation()},onAutoBacnetCreateToggle:function(){var e=this;this.autoCreateBacnetPoints&&(this.autoCreateDevicesAndPoints=!1,this.selectedChild1Point=null,this.generatedGenericPoints=[]),this.autoCreateBacnetPoints?(this.selectedChild1Point=null,this.generatedBacnetPoints=this.selectedLoraPoints.reduce((function(t,i){var n={};return n.loraPoint=i,n.bacnetPoint=e.getBacnetPoint(i.deviceName,i.item.name),n.name=n.bacnetPoint.object_name,t.push(n),t}),[])):this.generatedBacnetPoints=[],this.checkValidation()},onLoraPointsSelectionClear:function(){this.selectedLoraDevices=[]},onEditName:function(e,t){switch(this.editPointType=e,e){case"genericPoint":this.pointName=t.point.name;break;case"bacnetPoint":this.pointName=t.bacnetPoint.object_name}this.isEditNameOpen=!0,this.currentEditItem=t},onSaveName:function(){switch(this.editPointType){case"genericPoint":this.currentEditItem.point.name=this.pointName,this.currentEditItem.name=this.currentEditItem.network.name+":"+this.currentEditItem.device.name+":"+this.currentEditItem.point.name;break;case"bacnetPoint":this.currentEditItem.bacnetPoint.object_name=this.pointName,this.currentEditItem.name=this.pointName}this.isEditNameOpen=!1}}},ue=Object(u.a)(de,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-form",{ref:"mappingForm",class:"lora-bacnet-mapping-form "+(e.isEditForm?"":"mb-4"),model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[i("v-row",{attrs:{dense:""}},[i("v-col",{attrs:{cols:12}},[e.isEditForm?i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"id","item-text":"name","auto-select-first":"",rules:e.fieldValidations,label:e.parentFieldTitle,items:e.updatedParentPointsList},model:{value:e.selectedLoraPoint,callback:function(t){e.selectedLoraPoint=t},expression:"selectedLoraPoint"}}):e._e(),e._v(" "),e.isEditForm?e._e():i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"id","item-text":"name","auto-select-first":"",rules:[e.arrayRequiredValidation],label:e.loraSelectionLabel,items:e.updatedParentPointsList,multiple:""},on:{"click:clear":e.onLoraPointsSelectionClear},scopedSlots:e._u([{key:"item",fn:function(t){var n=t.item,a=t.attrs;return[n.isHeader?[i("v-list-item",{staticClass:"text-left",attrs:{ripple:""},on:{click:function(t){return e.onDeviceSelectAllClick(n.name)}}},[i("v-icon",{staticClass:"mr-2"},[e._v("\n                "+e._s(e.selectedLoraDevices.indexOf(n.name)>-1?"fa-check-circle":"fa-circle-o")+"\n              ")]),e._v(" "),i("v-list-item-title",[i("span",{staticClass:"caption"},[e._v("Select all lora points of")]),e._v(" "),i("strong",[e._v(e._s(n.name+" "))]),e._v(" "),i("span",{staticClass:"caption"},[e._v("device")])])],1)]:[i("v-list-item-content",{staticClass:"ml-5 text-left"},[i("v-list-item-title",[n.disabled?e._e():i("v-icon",{staticClass:"mr-2"},[e._v("\n                  "+e._s("true"==a["aria-selected"]?"fa-checkbox-marked":"fa-circle-o")+"\n                ")]),e._v(" "),i("span",{staticClass:"caption"},[e._v(e._s(n.deviceName))]),e._v(" "),i("strong",[e._v(e._s(n.pointName))]),e._v(" "),n.disabled?i("span",{staticClass:"already-mapped-label nubeGreen white--text"},[e._v(" Already Mapped ")]):e._e()],1)],1)]]}},{key:"prepend-item",fn:function(){return[i("v-list-item",{staticClass:"text-left",attrs:{ripple:""},on:{click:e.onLoraPointsSelectToggle}},[i("v-icon",{staticClass:"mr-2"},[e._v("\n              "+e._s(e.isMultipleLoraPointsSelected?"fa-check-circle":"fa-circle-o")+"\n            ")]),e._v(" "),i("v-list-item-content",[i("v-list-item-title",[e._v(" Select all ")])],1)],1),e._v(" "),i("v-divider",{staticClass:"mt-2"})]},proxy:!0}],null,!1,898032912),model:{value:e.selectedLoraPoints,callback:function(t){e.selectedLoraPoints=t},expression:"selectedLoraPoints"}})],1),e._v(" "),i("v-col",{attrs:{cols:"12"}},[i("v-card",{attrs:{outlined:""}},[i("v-card-title",{staticClass:"text-left"},[e._v("BACnet Points")]),e._v(" "),i("v-card-text",[i("v-row",{attrs:{dense:""}},[i("v-col",{attrs:{cols:"12"}},[i("v-row",{attrs:{dense:""}},[i("v-col",{attrs:{cols:"6"}},[e.isMapMultipleLoraPoints?e._e():i("v-switch",{staticClass:"pr-4",attrs:{inset:"",label:"Auto create new bacnet point(s) and mapping(s)",color:"primary"},on:{change:e.onAutoBacnetCreateToggle},model:{value:e.autoCreateBacnetPoints,callback:function(t){e.autoCreateBacnetPoints=t},expression:"autoCreateBacnetPoints"}})],1),e._v(" "),i("v-col",{attrs:{cols:"6"}},[i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"id","item-text":"name","auto-select-first":"",label:e.child1FieldTitle,rules:e.genericChildValidation,items:e.updatedChild1PointsList,disabled:!!e.selectedChild2Point||e.isMultipleLoraPointsSelected||e.autoCreateBacnetPoints},on:{change:e.checkValidation,blur:e.checkValidation},model:{value:e.selectedChild1Point,callback:function(t){e.selectedChild1Point=t},expression:"selectedChild1Point"}})],1),e._v(" "),!e.isMapMultipleLoraPoints&&e.generatedBacnetPoints.length>0?i("v-col",{attrs:{cols:"12"}},[i("v-item-group",{staticClass:"text-left",attrs:{multiple:""}},[i("v-subheader",[e._v("Generated BACnet Points")]),e._v(" "),e._l(e.generatedBacnetPoints,(function(t){return i("v-item",{key:t.name,staticClass:"ml-2 mb-2"},[i("v-chip",{attrs:{"active-class":"nubeGreen--text",value:t}},[i("span",[e._v(e._s(t.name))]),e._v(" "),i("v-btn",{staticClass:"pa-1",attrs:{rights:"",icon:"",color:"white"},on:{click:function(i){return e.onEditName("bacnetPoint",t)}}},[i("v-icon",{attrs:{right:""}},[e._v(" fa-pencil ")])],1)],1)],1)}))],2)],1):e._e()],1)],1)],1)],1)],1)],1),e._v(" "),i("v-col",{attrs:{cols:"12"}},[i("v-card",{attrs:{outlined:""}},[i("v-card-title",{staticClass:"text-left"},[e._v("Generic Points")]),e._v(" "),i("v-card-text",[i("v-row",{attrs:{dense:""}},[e.isMapMultipleLoraPoints?e._e():i("v-col",{attrs:{cols:"12"}},[i("div",{staticClass:"existing-generic-mapping-wrapper"},[i("v-row",{attrs:{dense:""}},[i("v-col",{attrs:{cols:"12"}},[i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"uuid",disabled:!(e.selectedLoraPoints&&e.selectedLoraPoints.length>0),"item-text":"name","auto-select-first":"",rules:e.genericChildValidation,label:"Select Existing Generic Network",items:e.genericNetworks},on:{change:e.onAutoCreateToggle},model:{value:e.selectedGenericNetwork,callback:function(t){e.selectedGenericNetwork=t},expression:"selectedGenericNetwork"}})],1)],1),e._v(" "),i("v-row",{attrs:{dense:""}},[i("v-col",{attrs:{cols:"6"}},[i("v-switch",{staticClass:"pr-4",attrs:{inset:"",label:"Auto create new device(s), point(s) and mapping(s)",color:"primary"},on:{change:e.onAutoCreateToggle},model:{value:e.autoCreateDevicesAndPoints,callback:function(t){e.autoCreateDevicesAndPoints=t},expression:"autoCreateDevicesAndPoints"}})],1),e._v(" "),i("v-col",{attrs:{cols:"6"}},[e.autoCreateDevicesAndPoints?e._e():i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"uuid",disabled:!(e.selectedLoraPoints&&e.selectedLoraPoints.length>0),"item-text":"name","auto-select-first":"",rules:e.genericChildValidation,label:"Select Existing Generic Device",items:e.genericDevices},on:{change:e.onGenericDevicesChange},model:{value:e.selectedGenericDevice,callback:function(t){e.selectedGenericDevice=t},expression:"selectedGenericDevice"}})],1)],1),e._v(" "),i("v-row",{attrs:{dense:""}},[!e.isMapMultipleLoraPoints&&e.generatedGenericPoints.length>0&&e.autoCreateDevicesAndPoints?i("v-col",{attrs:{cols:"12"}},[i("v-item-group",{staticClass:"text-left",attrs:{multiple:""}},[i("v-subheader",[e._v("Generated Generic Points")]),e._v(" "),e._l(e.generatedGenericPoints,(function(t){return i("v-item",{key:t.name,staticClass:"ml-2 mb-2"},[i("v-chip",{attrs:{"active-class":"nubeGreen--text",value:t}},[e._v("\n                          "+e._s(t.name)+"\n                          "),i("span",[e._v(e._s(t.name))]),e._v(" "),i("v-btn",{staticClass:"pa-1",attrs:{rights:"",icon:"",color:"white"},on:{click:function(i){return e.onEditName("genericPoint",t)}}},[i("v-icon",{attrs:{right:""}},[e._v(" fa-pencil ")])],1)],1)],1)}))],2)],1):e._e()],1)],1)]),e._v(" "),e.isMapMultipleLoraPoints?i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"id","item-text":"name","auto-select-first":"",label:e.child2FieldTitle,rules:e.genericChildValidation,disabled:!!e.selectedChild1Point,items:e.updatedChild2PointsList},on:{change:e.checkValidation,blur:e.checkValidation},model:{value:e.selectedChild2Point,callback:function(t){e.selectedChild2Point=t},expression:"selectedChild2Point"}}):e._e(),e._v(" "),i("v-col",{attrs:{cols:"12"}},[e.isMapExistingGenericPointVisible?i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"id","item-text":"name","auto-select-first":"",label:"Existing Generic Point",rules:e.genericChildValidation,disabled:!!e.selectedChild1Point||e.autoCreateDevicesAndPoints,items:e.updatedChild2PointsList},on:{change:e.checkValidation,blur:e.checkValidation},model:{value:e.selectedChild2Point,callback:function(t){e.selectedChild2Point=t},expression:"selectedChild2Point"}}):e._e()],1)],1)],1)],1)],1),e._v(" "),i("v-col",{attrs:{cols:"12"}},e._l(e.mappingErrors,(function(t){return i("v-alert",{key:t.index,attrs:{dense:"",outlined:"",type:"warning"}},[e._v("\n        Mapping Error: "),i("strong",{staticClass:"white--text"},[e._v(e._s(t.lora_point_name))]),e._v(" --\n        "),i("strong",{staticClass:"white--text"},[e._v(e._s(t.child_point_name))]),e._v(" |\n        "),i("span",[e._v(e._s(t.message))])])})),1),e._v(" "),e.isEditForm?e._e():i("v-col",{staticClass:"flex justify-center align-center",attrs:{cols:"1"}},[i("v-btn",{staticClass:"btn-height-22 white--text",attrs:{"x-small":"",color:"pink",block:"",loading:e.isCreatingMapping},on:{click:e.addMapping}},[e._v("Add")])],1)],1),e._v(" "),e.isEditForm?i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"darken-1",text:""},on:{click:e.onCancel}},[e._v(" Cancel ")]),e._v(" "),i("v-btn",{attrs:{color:"blue darken-1",loading:e.isCreatingMapping,text:""},on:{click:e.addMapping}},[e._v(" Save ")])],1):e._e(),e._v(" "),i("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.isEditNameOpen,callback:function(t){e.isEditNameOpen=t},expression:"isEditNameOpen"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v("Edit Name")])]),e._v(" "),i("v-card-text",[i("v-form",{ref:"editNameForm",model:{value:e.editNameFormValid,callback:function(t){e.editNameFormValid=t},expression:"editNameFormValid"}},[i("v-text-field",{attrs:{label:"Point Name",required:""},model:{value:e.pointName,callback:function(t){e.pointName=t},expression:"pointName"}})],1)],1),e._v(" "),i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"darken-1",text:""},on:{click:function(){return e.isEditNameOpen=!1}}},[e._v(" Cancel ")]),e._v(" "),i("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.onSaveName}},[e._v(" Save ")])],1)],1)],1)],1)}),[],!1,null,"2bbb347b",null).exports,pe={components:{RbxButton:c.a},props:["serviceMappings","isEditForm","parentPoints","child1Points","child2Points","serviceMapping","parentMappingKey","child1MappingKey","child2MappingKey","createServiceMapping","parentFieldTitle","child1FieldTitle","child2FieldTitle","onCancel"],data:function(){return{uuid:null,valid:!1,isCreatingMapping:!1,selectedParentPoint:null,selectedChild1Point:null,selectedChild2Point:null,genericChildValidation:[l.a.required],fieldValidations:[l.a.required]}},mounted:function(){this.isEditForm&&this.serviceMapping&&(this.uuid=this.serviceMapping.uuid,this.selectedParentPoint=this.serviceMapping[this.parentMappingKey],this.serviceMapping.hasOwnProperty(this.child1MappingKey)&&(this.selectedChild1Point=this.serviceMapping[this.child1MappingKey]),this.serviceMapping.hasOwnProperty(this.child2MappingKey)&&(this.selectedChild2Point=this.serviceMapping[this.child2MappingKey]),this.genericChildValidation=[])},computed:{mappings:function(){return this.serviceMappings},selectedParentMappings:function(){var e=this;return this.serviceMappings.map((function(t){return t[e.parentMappingKey]})).filter((function(e){return e}))},selectedChild2Mappings:function(){var e=this;return this.serviceMappings.map((function(t){return t[e.child2MappingKey]})).filter((function(e){return e}))},selectedChild1Mappings:function(){var e=this;return this.serviceMappings.map((function(t){return t[e.child1MappingKey]})).filter((function(e){return e}))},updatedParentPointsList:function(){return this.updateLisItemProperty(this.parentPoints,this.selectedParentMappings)},updatedChild2PointsList:function(){return this.updateLisItemProperty(this.child2Points,this.selectedChild2Mappings)},updatedChild1PointsList:function(){return this.updateLisItemProperty(this.child1Points,this.selectedChild1Mappings)}},methods:{addMapping:function(){var e,t=this;this.$refs.mappingForm.validate()&&(this.selectedParentMappings.push(this.selectedParentPoint),this.selectedChild1Mappings.push(this.selectedChild1Point),this.selectedChild2Mappings.push(this.selectedChild2Point),this.isCreatingMapping=!0,this.createServiceMapping((e={},o()(e,this.parentMappingKey,this.selectedParentPoint),o()(e,this.child1MappingKey,this.selectedChild1Point),o()(e,this.child2MappingKey,this.selectedChild2Point),e),this.uuid).then((function(){if(t.isEditForm)return t.onCancel();t.selectedParentPoint=null,t.selectedChild2Point=null,t.selectedChild1Point=null,t.$refs.mappingForm.reset()})).finally((function(){t.isCreatingMapping=!1})))},updateLisItemProperty:function(e,t){if(!t)return e;var i=t.filter((function(e){return e})).map((function(e){return e.id}));return e.reduce((function(e,t){return i.includes(t.id)?t.disabled=!0:t.disabled=!1,e.push(t),e}),[])},checkValidation:function(){(this.selectedChild1Point||this.selectedChild2Point)&&this.genericChildValidation.pop(),!this.selectedChild1Point&&!this.selectedChild2Point&&this.genericChildValidation.length<1&&this.genericChildValidation.push(l.a.required),this.$refs.mappingForm.resetValidation()}}},me=Object(u.a)(pe,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-form",{ref:"mappingForm",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[i("v-row",[i("v-col",{attrs:{cols:e.isEditForm?12:4}},[i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"id","item-text":"name","auto-select-first":"",rules:e.fieldValidations,label:e.parentFieldTitle,items:e.updatedParentPointsList},model:{value:e.selectedParentPoint,callback:function(t){e.selectedParentPoint=t},expression:"selectedParentPoint"}})],1),e._v(" "),i("v-col",{attrs:{cols:e.isEditForm?12:3}},[i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"id","item-text":"name","auto-select-first":"",label:e.child1FieldTitle,rules:e.genericChildValidation,items:e.updatedChild1PointsList,disabled:!!e.selectedChild2Point},on:{change:e.checkValidation},model:{value:e.selectedChild1Point,callback:function(t){e.selectedChild1Point=t},expression:"selectedChild1Point"}})],1),e._v(" "),i("v-col",{attrs:{cols:e.isEditForm?12:3}},[i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"id","item-text":"name","auto-select-first":"",label:e.child2FieldTitle,rules:e.genericChildValidation,disabled:!!e.selectedChild1Point,items:e.updatedChild2PointsList},on:{change:e.checkValidation},model:{value:e.selectedChild2Point,callback:function(t){e.selectedChild2Point=t},expression:"selectedChild2Point"}})],1),e._v(" "),e.isEditForm?e._e():i("v-col",{staticClass:"flex justify-center align-center",attrs:{cols:"2"}},[i("rbx-button",{attrs:{block:!0,color:"pink",click:e.addMapping,title:"Add"}})],1)],1),e._v(" "),e.isEditForm?i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"darken-1",text:""},on:{click:e.onCancel}},[e._v(" Cancel ")]),e._v(" "),i("v-btn",{attrs:{color:"blue darken-1",loading:e.isCreatingMapping,text:""},on:{click:e.addMapping}},[e._v(" Save ")])],1):e._e()],1)}),[],!1,null,"bfd14780",null).exports,ve={name:"service-mapping-grid",components:{ConfirmDialog:g.a,GridToolbar:f.a,ParentChildMappingForm:me,AppStatusChip:h.a,TooltipIconButton:b.a},props:["loading","parentMappingKey","child1MappingKey","child2MappingKey","serviceMappings","parentPoints","child1Points","child2Points","updateServiceMapping","deleteItem","deleteItems","parentHeaderTitle","child1HeaderTitle","child2HeaderTitle","fileName","receiveDataRows","formatDataService","fixMapping","syncGridItems"],data:function(){return{search:"",isFixingServiceMaps:!1,openImportMappingDialog:!1,deleteServiceMappingDialog:!1,isDeletingItem:!1,selectedItem:null,selectedItems:[],deletionType:null,editServiceMappingDialog:!1,headers:[{text:this.parentHeaderTitle,align:"start",value:"parentName"},{text:this.child1HeaderTitle,align:"start",value:"child1Name"},{text:this.child2HeaderTitle,align:"start",value:"child2Name"},{text:"Mapping State",align:"center",value:"mapping_state"},{text:"Actions",align:"start",value:"actions",sortable:!1}],tableProps:a()({},P.d)}},computed:{items:function(){var e=this;return this.serviceMappings.map((function(t){return a()({},t,{isMapped:t.mapping_state===P.i.MAPPED,parentName:t[e.parentMappingKey].name,child1Name:t[e.child1MappingKey]&&t[e.child1MappingKey].name||"-",child2Name:t[e.child2MappingKey]&&t[e.child2MappingKey].name||"-"})}))},isDeleteEnabled:function(){return this.selectedItems.length>0}},methods:{toggleDeleteDialog:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.deletionType=t,this.deleteServiceMappingDialog=!this.deleteServiceMappingDialog,e&&this.deleteServiceMappingDialog?this.selectedItem=e:this.selectedItem=null},toggleServiceMappingDialog:function(e){this.editServiceMappingDialog=!this.editServiceMappingDialog,this.editServiceMappingDialog?this.selectedItem=e:this.selectedItem=null},closeDeleteDialog:function(){this.deleteServiceMappingDialog=!1,this.selectedItem=null,this.deletionType=null},handleDeleteItem:function(){switch(this.deletionType){case"single":this.onDeleteRow();break;case"multiple":this.onDeleteRows()}},onDeleteRows:function(){var e=this;this.selectedItems.length>0&&(this.isDeletingItem=!0,this.deleteItems(this.selectedItems).then((function(){e.closeDeleteDialog()})).finally((function(){e.isDeletingItem=!1})))},onDeleteRow:function(){var e=this;this.isDeletingItem=!0,this.deleteItem(this.selectedItem).then((function(){e.closeDeleteDialog()})).finally((function(){e.isDeletingItem=!1}))},onCopy:function(e){var t=this.formatDataService(this.selectedItems.filter((function(e){return e.isMapped})));e(v()(t))},fixLoraMappings:function(){var e=this;this.isFixingServiceMaps=!0,this.fixMapping().finally((function(){e.isFixingServiceMaps=!1}))}}},he=Object(u.a)(ve,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("grid-toolbar",{attrs:{"on-copy":e.onCopy,items:e.items,toolbarTitle:"Mappings","file-name":e.fileName,"format-data-service":e.formatDataService,"receive-data-rows":e.receiveDataRows,"is-delete-enabled":e.isDeleteEnabled,"on-delete":function(){return e.toggleDeleteDialog(null,"multiple")}},scopedSlots:e._u([{key:"search",fn:function(){return[i("v-text-field",{staticClass:"pl-10",attrs:{"append-icon":"fa-search",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]},proxy:!0},{key:"customAction",fn:function(){return[i("v-btn",{staticClass:"mr-2 btn-height-22 white--text",attrs:{"x-small":"",color:"blue"},on:{click:e.fixLoraMappings}},[e._v("\n        Sync\n        "),e.isFixingServiceMaps?i("v-progress-circular",{staticClass:"ml-3",attrs:{indeterminate:"",width:"2",size:"12"}}):i("v-icon",{attrs:{"x-small":"",right:""}},[e._v(" fa-refresh ")])],1),e._v(" "),i("tooltip-icon-button",{attrs:{btnColor:"default",btnIcon:"fa-refresh",btnTooltip:"Refresh mapping table",buttonSize:"small",onClick:function(){return e.syncGridItems()}}})]},proxy:!0}])}),e._v(" "),i("v-data-table",{attrs:{"item-key":"uuid","show-select":"",loading:e.loading,headers:e.headers,items:e.items,search:e.search,"footer-props":e.tableProps.FOOTER_PROPS,itemsPerPage:e.tableProps.ITEMS_PER_PAGE},scopedSlots:e._u([{key:"item.actions",fn:function(t){var n=t.item;return[i("v-btn",{attrs:{icon:"",small:"",color:"primary"},on:{click:function(){return e.toggleServiceMappingDialog(n)}}},[i("v-icon",{attrs:{small:""}},[e._v(" fa-pencil ")])],1),e._v(" "),i("v-btn",{attrs:{icon:"",small:"",color:"error"},on:{click:function(){return e.toggleDeleteDialog(n,"single")}}},[i("v-icon",{attrs:{small:""}},[e._v(" fa-trash-o ")])],1)]}},{key:"item.mapping_state",fn:function(e){var t=e.item;return[i("app-status-chip",{attrs:{state:t.mapping_state}})]}}],null,!0),model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}}),e._v(" "),i("confirm-dialog",{attrs:{"is-open":e.deleteServiceMappingDialog,loading:e.isDeletingItem,"on-close":function(){return e.closeDeleteDialog()},"on-confirm":function(){return e.handleDeleteItem()},"dialog-text":"Do you want to delete the mapping?"}}),e._v(" "),i("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.editServiceMappingDialog,callback:function(t){e.editServiceMappingDialog=t},expression:"editServiceMappingDialog"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v("Edit Mapping")])]),e._v(" "),i("v-card-text",[i("parent-child-mapping-form",{attrs:{"is-edit-form":!0,"on-cancel":function(){return e.toggleServiceMappingDialog()},"service-mapping":e.selectedItem,parentPoints:e.parentPoints,child1Points:e.child1Points,child2Points:e.child2Points,parentMappingKey:e.parentMappingKey,child1MappingKey:e.child1MappingKey,child2MappingKey:e.child2MappingKey,parentFieldTitle:e.parentHeaderTitle,child1FieldTitle:e.child1HeaderTitle,child2FieldTitle:e.child2HeaderTitle,serviceMappings:e.serviceMappings,createServiceMapping:e.updateServiceMapping}})],1)],1)],1)],1)}),[],!1,null,null,null).exports,ge=i("NWgQ"),fe=i.n(ge),be=i("PWxN"),Pe=i.n(be),_e=i("t53O"),Me="/service-mapping/lora-generic-bacnet-mapping",xe={name:"BACNET",valueKey:"bacnetPoint",valuePath:"bacnetPoint.id"},ye={name:"GENERIC",valueKey:"genericPoint",valuePath:"genericPoint.id"};function ke(e,t){if(!e)throw new Error("Mapping type not found");var i=e.valuePath,n=y()(t,i);if(!n)throw new Error("Mapping uuid is not selected");return n}function Ce(e){return e.map((function(e){var t={};return e.type===ye.name&&(t={genericPoint:{id:e.mapped_point_uuid,name:e.mapped_point_name}}),e.type===xe.name&&(t=a()({},t,{bacnetPoint:{id:e.mapped_point_uuid,name:e.mapped_point_name}})),a()({},e,t,{uuid:e.uuid,loraPoint:{id:e.point_uuid,name:e.point_name}})}))}function De(e){var t=function(e){return e.bacnetPoint&&e.bacnetPoint.id?xe:e.genericPoint&&e.genericPoint.id?ye:void 0}(e);return{point_uuid:e.loraPoint.id||e.loraPoint.uuid,type:t.name,mapped_point_uuid:ke(t,e)}}function we(e){var t={};return e.bacnetPoint&&e.bacnetPoint.id&&(t={bacnet_point_uuid:e.bacnetPoint.id,bacnet_point_name:e.bacnetPoint.name}),e.genericPoint&&e.genericPoint.id&&(t=a()({},t,{generic_point_uuid:e.genericPoint.id,generic_point_name:e.genericPoint.name})),e.uuid&&(t=a()({},t,{uuid:e.uuid})),a()({},t,{lora_point_uuid:e.loraPoint.id,lora_point_name:e.loraPoint.name})}function Se(e){return D.a.post(Me+"/file-upload",function(e){return e.map((function(e){var t=a()({},e);return y()(e,"generic_point.point.name")&&y()(e,"generic_point.point.name")&&y()(e,"generic_point.point.name")||(t=Pe()(t,["generic_point"])),y()(e,"bacnet_point.name")||(t=Pe()(t,["bacnet_point"])),t}))}(e))}function Ne(e,t,i,n){var s={};return s.lora_point=a()({},t[e.lora_point_name]),e.bacnet_point_name&&(s.bacnet_point=a()({},i[e.bacnet_point_name])),e.generic_point_name&&(s.generic_point=a()({},n[e.generic_point_name])),(s=q()(s)).lora_point&&s.lora_point.id&&(delete s.lora_point.id,delete s.lora_point.uuid),s.generic_point&&s.generic_point.id&&(delete s.generic_point.id,delete s.generic_point.uuid,delete s.generic_point.device.uuid,delete s.generic_point.network.uuid,delete s.generic_point.point.uuid),s.bacnet_point&&s.bacnet_point.id&&(delete s.bacnet_point.id,delete s.bacnet_point.uuid),s}var Ie=_e.a,Ee=_e.b,Ge=function(e){return D.a.delete(Me+"/"+e.uuid)},Le={name:"lora-generic-bacnet-mapping-import-dialog",props:["dataRows","isOpen","close","bacnetPoints","genericPoints","modusPoints","syncData"],data:function(){return{dataItems:[],valid:!1,isRequestOnce:!1,isCreatingMapping:!1,errors:[],rules:{required:function(e){return!!e||"Required"}},errorTableHeaders:[{text:"Row",value:"rowIndex",sortable:!1},{text:"Error Message",value:"message",sortable:!1}],modbusRtuPorts:[].concat(ne()(P.j)),headers:[{text:"Actions",value:"actions",sortable:!1},{text:"Row",value:"rowNumber",sortable:!1},{text:"Lora Device Name",value:"loraDeviceName",sortable:!1},{text:"Lora Point Name",value:"loraPointName",sortable:!1},{text:"Generic Network Name",value:"genericNetworkName",sortable:!1},{text:"Generic Device Name",value:"genericDeviceName",sortable:!1},{text:"Generic Point Name",value:"genericPointName",sortable:!1},{text:"BACnet Point Name",value:"bacnetPointName",sortable:!1},{text:"BACnet Point Address",value:"bacnetPointAddress",sortable:!1}],tableProps:a()({},P.d)}},mounted:function(){this.dataItems=(this.dataRows||[]).map((function(e){return a()({},e,{generic_point:e.generic_point||{point:{name:""},device:{name:""},network:{name:""}},bacnet_point:e.bacnet_point||{address:null,name:""},isGenericPointDisabled:!e.generic_point,isBacnetPointDisabled:!e.bacnet_point})}))},methods:{clickDeleteImport:function(e){this.dataItems=this.dataItems.filter((function(t,i){return i!==e})),this.errors=this.errors.filter((function(e,t){return itemIndex!==t}))},getErrorFromResult:function(e){return{rowIndex:e.rowIndex+1,message:e.message}},createMapping:function(){var e=this;this.$refs.form.validate()&&(this.isCreatingMapping=!0,this.isRequestOnce=!0,Se(this.dataItems).then((function(t){e.errors=t.reduce((function(t,i){return i.success||t.push(e.getErrorFromResult(i)),t}),[]),t.map((function(e){return e.success})).every((function(e){return e}))&&(e.syncData(),e.closeDialog())})).catch((function(e){})).finally((function(){e.isCreatingMapping=!1})))},closeDialog:function(){this.isRequestOnce&&this.syncData(),this.close()}}},Re={name:"lora-generic-bacnet-points-mapping",components:{LoraGenericBacnetPointMappingForm:ue,LoraGenericBacnetPointMappingGrid:he,LoraGenericBacnetMappingImportDialog:Object(u.a)(Le,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-dialog",{attrs:{persistent:""},model:{value:e.isOpen,callback:function(t){e.isOpen=t},expression:"isOpen"}},[e.isOpen?i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v("Import Mappings")])]),e._v(" "),i("v-card-text",[i("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[i("v-data-table",{staticClass:"elevation-1 mb-4",attrs:{headers:e.headers,items:e.dataItems,"footer-props":e.tableProps.FOOTER_PROPS,itemsPerPage:e.tableProps.ITEMS_PER_PAGE},scopedSlots:e._u([{key:"item.actions",fn:function(t){var n=t.index;return[i("v-icon",{attrs:{small:"",color:"error"},on:{click:function(t){return e.clickDeleteImport(n)}}},[e._v(" fa-trash-o ")])]}},{key:"item.rowNumber",fn:function(t){var n=t.index;return[i("span",[e._v(e._s(+n+1))])]}},{key:"item.loraDeviceName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{"single-line":"",required:""},model:{value:n.lora_point.deviceName,callback:function(t){e.$set(n.lora_point,"deviceName",t)},expression:"item.lora_point.deviceName"}})]}},{key:"item.loraPointName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{"single-line":"",required:""},model:{value:n.lora_point.item.name,callback:function(t){e.$set(n.lora_point.item,"name",t)},expression:"item.lora_point.item.name"}})]}},{key:"item.genericNetworkName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{disabled:n.isGenericPointDisabled,"single-line":""},model:{value:n.generic_point.network.name,callback:function(t){e.$set(n.generic_point.network,"name",t)},expression:"item.generic_point.network.name"}})]}},{key:"item.genericDeviceName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{disabled:n.isGenericPointDisabled,"single-line":""},model:{value:n.generic_point.device.name,callback:function(t){e.$set(n.generic_point.device,"name",t)},expression:"item.generic_point.device.name"}})]}},{key:"item.genericPointName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{disabled:n.isGenericPointDisabled,"single-line":""},model:{value:n.generic_point.point.name,callback:function(t){e.$set(n.generic_point.point,"name",t)},expression:"item.generic_point.point.name"}})]}},{key:"item.bacnetPointName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{disabled:n.isBacnetPointDisabled,"single-line":""},model:{value:n.bacnet_point.name,callback:function(t){e.$set(n.bacnet_point,"name",t)},expression:"item.bacnet_point.name"}})]}},{key:"item.bacnetPointAddress",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{disabled:n.isBacnetPointDisabled,"single-line":""},model:{value:n.bacnet_point.address,callback:function(t){e.$set(n.bacnet_point,"address",t)},expression:"item.bacnet_point.address"}})]}}],null,!0)})],1)],1),e._v(" "),e.errors.length>=1?i("v-card",{staticClass:"px-8 mt-n15"},[i("v-card-title",{attrs:{color:"red darken-1"}},[e._v("Errors")]),e._v(" "),i("v-card-text",[i("v-data-table",{staticClass:"elevation-1 mb-1",attrs:{"hide-default-footer":"",headers:e.errorTableHeaders,items:e.errors}})],1)],1):e._e(),e._v(" "),i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"darken-1",text:""},on:{click:e.closeDialog}},[e._v(" Cancel ")]),e._v(" "),i("v-btn",{attrs:{color:"blue darken-1",loading:e.isCreatingMapping,text:""},on:{click:e.createMapping}},[e._v(" Save ")])],1)],1):e._e()],1)}),[],!1,null,null,null).exports},data:function(){return{dataRows:[],isUpdating:!1,serviceMappings:[],genericPoints:[],bacnetPoints:[],loraPoints:[],loraDevices:[],loraPointsMap:{},genericPointsMap:{},bacnetPointsMap:{},genericNetworks:[],genericNetworkDevices:[],isFetchingGridData:!1,openImportMappingDialog:!1}},mounted:function(){this.syncData()},methods:{syncData:function(){var e=this;this.fetchServiceMapping(),Q().then((function(t){var i=t.genericNetworks,n=t.genericDevices;e.genericNetworks=i,e.genericNetworkDevices=n})).catch((function(e){})),W().then((function(t){e.genericPointsMap=e.createMap(t),e.genericPoints=t})).catch((function(e){})),Z().then((function(t){e.bacnetPoints=t.map((function(e){return a()({},e,{id:e.uuid,name:e.object_name})})),e.bacnetPointsMap=e.createMap(e.bacnetPoints)})).catch((function(e){})),D.a.get("/lora/device").then(Y).then((function(t){var i=t.loraPoints,n=t.loraDevices;e.loraPoints=i,e.loraDevices=n,e.loraPointsMap=e.createMap(e.loraPoints,"name")})).catch((function(e){}))},fetchServiceMapping:function(){var e=this;return this.isFetchingGridData=!0,D.a.get(""+Me).then(Ce).then((function(t){e.serviceMappings=t})).finally((function(){e.isFetchingGridData=!1}))},createServiceMapping:function(e){var t=this;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.post(""+Me,De(e))}(e).then((function(){t.fetchServiceMapping(),t.$toasted.show(X.c.success)})).catch((function(e){t.$toasted.show(X.c.error,{type:"error"})})).finally((function(){}))},updateServiceMapping:function(e,t){var i=this;return function(){var e=arguments[1],t=De(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return D.a.patch(Me+"/"+e,t)}(e,t).then((function(){i.fetchServiceMapping(),i.$toasted.show(X.g.success)})).catch((function(e){i.$toasted.show(X.g.error,{type:"error"})}))},deleteServiceMappings:function(e){var t=this;return function(e){return C.a.all(e.map((function(e){return Ge(e)})))}(e).then((function(){t.fetchServiceMapping(),t.$toasted.show(X.e.success)})).catch((function(e){t.$toasted.show(X.e.error,{type:"error"})}))},deleteServiceMapping:function(e){var t=this;return Ge(e).then((function(){t.fetchServiceMapping(),t.$toasted.show(X.d.success)})).catch((function(e){t.$toasted.show(X.d.error,{type:"error"}),console.error(e)}))},formatExportData:function(e,t){var i=this;return"copy"===t?e.map(we).map((function(e){return Ne(e,i.loraPointsMap,i.bacnetPointsMap,i.genericPointsMap)})):Ie(e.map(we).map((function(e){return Ne(e,i.loraPointsMap,i.bacnetPointsMap,i.genericPointsMap)})))},createLoraBacnetGenericPointMapping:function(e,t,i){var n=this;return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return D.a.post(Me+"/bulk-service-mapping?"+fe.a.stringify(t),e)}(e,{autoCreateDevice:t,autoCreateBacnetPoints:i}).then((function(e){return n.fetchServiceMapping(),e}))},createMap:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"name";return(e||[]).reduce((function(e,i){return e[i[t]]=i,e}),{})},receiveDataRows:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length>=1&&(this.dataRows=Ee(e),this.openImportMappingDialog=!0)},closeImportMappingDialog:function(){this.openImportMappingDialog=!1},fixMapping:function(){var e=this;return D.a.get(Me+"/fix-mapping").then((function(){e.fetchServiceMapping()}))}}},Te=Object(u.a)(Re,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card-text",[i("lora-generic-bacnet-point-mapping-form",{attrs:{serviceMappings:e.serviceMappings,parentPoints:e.loraPoints,child1Points:e.bacnetPoints,child2Points:e.genericPoints,"lora-devices":e.loraDevices,genericNetworkDevices:e.genericNetworkDevices,genericNetworks:e.genericNetworks,parentMappingKey:"loraPoint",child1MappingKey:"bacnetPoint",child2MappingKey:"genericPoint",createServiceMapping:e.createServiceMapping,createLoraBacnetGenericPointMapping:e.createLoraBacnetGenericPointMapping,parentFieldTitle:"LoRa Points",child1FieldTitle:"BACnet Points",child2FieldTitle:"Rubix Points"}}),e._v(" "),i("v-divider"),e._v(" "),i("lora-generic-bacnet-point-mapping-grid",{attrs:{loading:e.isFetchingGridData,"sync-grid-items":e.syncData,"file-name":"lora-bacnet-generic-service-mapping","format-data-service":e.formatExportData,parentPoints:e.loraPoints,child1Points:e.bacnetPoints,child2Points:e.genericPoints,parentMappingKey:"loraPoint",child1MappingKey:"bacnetPoint","fix-mapping":e.fixMapping,child2MappingKey:"genericPoint",serviceMappings:e.serviceMappings,deleteItem:e.deleteServiceMapping,deleteItems:e.deleteServiceMappings,parentHeaderTitle:"LoRa Points",child1HeaderTitle:"BACnet Points",child2HeaderTitle:"Rubix Points","receive-data-rows":e.receiveDataRows,updateServiceMapping:e.updateServiceMapping}}),e._v(" "),e.openImportMappingDialog?i("lora-generic-bacnet-mapping-import-dialog",{attrs:{"lora-points":e.loraPoints,"bacnet-points":e.bacnetPoints,"generic-points":e.genericPoints,close:e.closeImportMappingDialog,"is-open":e.openImportMappingDialog,"data-rows":e.dataRows,"sync-data":e.syncData}}):e._e()],1)}),[],!1,null,null,null).exports,Fe={components:{RbxButton:c.a},props:["serviceMappings","isEditForm","parentPoints","child1Points","child2Points","serviceMapping","parentMappingKey","child1MappingKey","child2MappingKey","createServiceMapping","createModbusBacnetGenericPointMapping","parentFieldTitle","child1FieldTitle","child2FieldTitle","onCancel","genericNetworkDevices","genericNetworks","modbusNetworks"],data:function(){return{uuid:null,valid:!1,mappingErrors:[],modbusDeviceNames:[],modbusNetworkNames:[],modbusDeviceSelectionStates:{},modbusNetworkSelectionStates:{},autoCreateDevicesAndPoints:!1,autoCreateBacnetPoints:!1,selectedModbusDevices:[],selectedModbusNetworks:[],addNewNetworkToggle:!1,addNewDeviceToggle:!1,isMapMultipleModbusPoints:!1,isMapExistingBacnetPoint:!0,isCreatingMapping:!1,selectedModbusPoint:null,selectedModbusPoints:[],selectedChild1Point:null,selectedChild2Point:null,selectedGenericNetwork:null,selectedGenericDevice:null,genericPointValidation:[l.a.required],genericChildValidation:[l.a.required],fieldValidations:[l.a.required],generatedGenericPoints:[],generatedBacnetPoints:[],editNameFormValid:!1,isEditNameOpen:!1,pointName:"",editPointType:null,currentEditItem:{},arrayRequiredValidation:function(e){return!!(Array.isArray(e)&&e.length>0)||"Required"}}},watch:{selectedModbusPoints:function(e,t){this.onGenericDevicesChange(),this.isMultipleModbusPointsSelected&&(this.selectedChild1Point=null,this.isMapMultipleModbusPoints=!1)},modbusDeviceNames:function(e,t){le()(e,t)||(this.modbusDeviceSelectionStates=this.modbusDeviceNames.reduce((function(e,t){return e[t]={name:t,selected:!1},e}),{}))},modbusNetworkNames:function(e,t){le()(e,t)||(this.modbusNetworkSelectionStates=this.modbusNetworkNames.reduce((function(e,t){return e[t]={name:t,selected:!1},e}),{}))},isMapExistingGenericPointVisible:function(e,t){le()(e,t)||this.checkValidation()}},mounted:function(){this.isEditForm&&this.serviceMapping&&(this.uuid=this.serviceMapping.uuid,this.isMapMultipleModbusPoints=!0,this.selectedModbusPoint=this.serviceMapping[this.parentMappingKey],this.serviceMapping.hasOwnProperty(this.child1MappingKey)&&(this.selectedChild1Point=this.serviceMapping[this.child1MappingKey]),this.serviceMapping.hasOwnProperty(this.child2MappingKey)&&(this.selectedChild2Point=this.serviceMapping[this.child2MappingKey]),this.genericChildValidation=[])},computed:{mappings:function(){return this.serviceMappings},selectedParentMappings:function(){var e=this;return this.serviceMappings.map((function(t){return t[e.parentMappingKey]}))},selectedChild2Mappings:function(){var e=this;return this.serviceMappings.map((function(t){return t[e.child2MappingKey]}))},selectedChild1Mappings:function(){var e=this;return this.serviceMappings.map((function(t){return t[e.child1MappingKey]}))},updatedParentPointsList:function(){return this.selectedModbusDevices,this.selectedModbusNetworks,this.updateParentListItemProperty(this.parentPoints,this.selectedParentMappings)},isMapExistingGenericPointVisible:function(){return this.selectedModbusPoints.length<=1&&!this.isEditForm},updatedChild2PointsList:function(){return this.updateLisItemProperty(this.child2Points,this.selectedChild2Mappings)},updatedChild1PointsList:function(){return this.updateLisItemProperty(this.child1Points,this.selectedChild1Mappings)},isAllModbusPointsSelected:function(){return this.selectedModbusPoints.length===this.updatedParentPointsList.length},isMultipleModbusPointsSelected:function(){return this.selectedModbusPoints&&this.selectedModbusPoints.length>1},genericDevices:function(){return this.selectedGenericNetwork&&this.selectedGenericNetwork.devices||[]},modbusSelectionLabel:function(){return this.selectedModbusPoints.length>0?this.parentFieldTitle+" | "+this.selectedModbusPoints.length+" Modbus points selected":this.parentFieldTitle}},methods:{getServiceMappings:function(){return this.autoCreateBacnetPoints?this.generatedBacnetPoints.map((function(e){return{bacnet_point:e.bacnetPoint,modbus_point:e.modbusPoint}})):this.autoCreateDevicesAndPoints?this.generatedGenericPoints.map((function(e){return{generic_point:{network:e.network,device:e.device,point:e.point},modbus_point:e.modbusPoint}})):void 0},addMapping:function(){var e,t=this;if(this.$refs.mappingForm.validate()){if(this.mappingErrors=[],!this.isEditForm&&!this.isMapMultipleModbusPoints&&(this.autoCreateDevicesAndPoints||this.autoCreateBacnetPoints)){this.isCreatingMapping=!0;var i=this.getServiceMappings();return this.createModbusBacnetGenericPointMapping(i,this.autoCreateDevicesAndPoints,this.autoCreateBacnetPoints).then((function(e){e.every((function(e){return!e.success}))?t.extractDisplayError(e):(t.selectedModbusPoints=null,t.selectedModbusPoint=null,t.selectedChild2Point=null,t.selectedChild1Point=null,t.autoCreateDevicesAndPoints=!1,t.autoCreateBacnetPoints=!1,t.selectedModbusDevices=[],t.selectedModbusNetworks=[],t.$refs.mappingForm.reset())})).catch((function(e){})).finally((function(){t.isCreatingMapping=!1}))}this.isEditForm||1!=this.selectedModbusPoints.length||(this.selectedModbusPoint=this.selectedModbusPoints[0]),this.isCreatingMapping=!0,this.createServiceMapping((e={},o()(e,this.parentMappingKey,this.selectedModbusPoint),o()(e,this.child1MappingKey,this.selectedChild1Point),o()(e,this.child2MappingKey,this.selectedChild2Point),e),this.uuid).then((function(){if(t.isEditForm)return t.onCancel();t.selectedModbusPoints=null,t.selectedModbusPoint=null,t.selectedChild2Point=null,t.selectedChild1Point=null,t.$refs.mappingForm.reset()})).finally((function(){t.isCreatingMapping=!1}))}},extractDisplayError:function(e){var t=e.filter((function(e){return!e.success})).map((function(e){return{modbus_point_name:e.data&&e.data.modbus_point_name,child_point_name:e.data&&(e.data.generic_point_name||e.data.bacnet_point_name),message:e.message,index:e.rowIndex}}));this.mappingErrors=t},updateParentListItemProperty:function(e,t){if(!t)return e;var i=t.filter((function(e){return e})).map((function(e){return e.id})),n=[],a=[],s=e.reduce((function(e,t){return i.includes(t.id)?t.disabled=!0:t.disabled=!1,t.networkGroup=t.network.name,t.deviceGroup=t.device.name,e.push(t),e}),[]),r=oe()(s,(function(e){return e.networkGroup})),o=se()(r).reduce((function(e,t){return e[t]=oe()(r[t],(function(e){return e.deviceGroup})),e}),{}),c=se()(o).reduce((function(e,t){var i={text:t,name:t,itemName:""+t,type:"network",isNetwork:!0,isHeader:!0,isNonItem:!0,selected:!1};e.push(i);var s=se()(o[t]).reduce((function(e,i){var a={text:i,type:"device",isDevice:!0,networkName:t,name:i,itemName:t+":::"+i,isHeader:!0,isNonItem:!0,selected:!1};return e.push(a),e.push.apply(e,ne()(o[t][i])),n.push(t+":::"+i),e.push({divider:!0,isNonItem:!0}),e}),[]);return e.push.apply(e,ne()(s)),a.push(""+t),e.push({divider:!0,isNonItem:!0}),e}),[]);return this.modbusDeviceNames=[].concat(n),this.modbusNetworkNames=[].concat(a),c},updateLisItemProperty:function(e,t){if(!t)return e;var i=t.filter((function(e){return e})).map((function(e){return e.id}));return e.reduce((function(e,t){return i.includes(t.id)?t.disabled=!0:t.disabled=!1,e.push(t),e}),[])},checkValidation:function(){(this.selectedChild1Point||this.autoCreateBacnetPoints||this.selectedGenericDevice&&this.selectedChild2Point||this.autoCreateDevicesAndPoints)&&this.genericChildValidation.pop(),(this.selectedChild1Point||this.autoCreateBacnetPoints)&&(this.selectedChild2Point||this.autoCreateDevicesAndPoints)||this.genericChildValidation.push(l.a.required),(this.selectedChild1Point||this.selectedChild2Point||this.selectedGenericNetwork&&this.autoCreateDevicesAndPoints||this.autoCreateBacnetPoints)&&(this.genericChildValidation=[]),this.$refs.mappingForm.resetValidation()},onModbusPointsSelectToggle:function(){var e=this;this.$nextTick((function(){e.isMultipleModbusPointsSelected?e.selectedModbusPoints=[]:e.selectedModbusPoints=e.updatedParentPointsList.slice().filter((function(e){return!e.disabled&&!e.isHeader&&!e.isNonItem}))}))},onGenericDevicesChange:function(){var e=this;Array.isArray(this.selectedModbusPoints)&&this.selectedModbusPoints.length>0&&this.selectedGenericDevice?this.generatedGenericPoints=this.selectedModbusPoints.reduce((function(t,i){var n={};return n.network=e.selectedGenericNetwork,n.device=e.selectedGenericDevice,n.point=i,n.name=n.network.name+":"+n.device.name+":"+i.name,n.modbusPoint=i,t.push(n),t}),[]):this.generatedGenericPoints=[],this.checkValidation()},onMapExistingChange:function(){this.selectedChild2Point=null,this.genericChildValidation.length<1&&this.genericChildValidation.push(l.a.required),this.generatedGenericPoints=[]},onDeviceSelectAllClick:function(e){var t=this;this.$nextTick((function(){var i=e.itemName;switch(e.type){case"network":t.onSeletAllModbusNetwork(i);break;case"device":t.onSelectedAllModbusDevices(i)}}))},onSeletAllModbusNetwork:function(e){this.modbusNetworkSelectionStates[e].selected=!this.modbusNetworkSelectionStates[e].selected,this.modbusNetworkSelectionStates[e].selected?this.selectedModbusNetworks.push(e):this.selectedModbusNetworks=this.selectedModbusNetworks.filter((function(t){return t!==e}));var t=this.modbusDeviceNames.reduce((function(t,i){return i.split(":::")[0]===e?(t.push(i),t):t}),[]),i=!0,n=!1,a=void 0;try{for(var s,r=K()(t);!(i=(s=r.next()).done);i=!0){var o=s.value;this.onSelectedAllModbusDevices(o)}}catch(e){n=!0,a=e}finally{try{!i&&r.return&&r.return()}finally{if(n)throw a}}},onSelectedAllModbusDevices:function(e){var t=this;this.modbusDeviceSelectionStates[e].selected=!this.modbusDeviceSelectionStates[e].selected,this.modbusDeviceSelectionStates[e].selected?this.selectedModbusDevices.push(e):this.selectedModbusDevices=this.selectedModbusDevices.filter((function(t){return t!==e})),this.selectedModbusPoints=this.updatedParentPointsList.filter((function(e){return!e.isNonItem})).reduce((function(e,i){return!i.isHeader&&!i.disabled&&t.selectedModbusDevices.length>0&&t.selectedModbusDevices.findIndex((function(e){return e.split(":::")[0]===i.network.name&&e.split(":::")[1]===i.device.name}))>-1&&e.push(i),e}),[])},getGenericDevice:function(e,t){return{driver:"GENERIC",enable:!1,fault:null,history_enable:!1,name:t,network_uuid:e}},getBacnetPointName:function(e,t,i){return e+"_"+t+"_"+i},getBacnetPoint:function(e,t,i){return{object_type:"analogOutput",object_name:this.getBacnetPointName(e,t,i),address:null,relinquish_default:1,priority_array_write:{_1:null,_2:null,_3:null,_4:null,_5:null,_6:null,_7:null,_8:null,_9:null,_10:null,_11:null,_12:null,_13:null,_14:null,_15:null,_16:null},event_state:"normal",units:"noUnits",description:"modbus mapping "+i,enable:!0,use_next_available_address:!0}},onAutoCreateToggle:function(){var e=this;this.autoCreateDevicesAndPoints&&(this.autoCreateBacnetPoints=!1,this.generatedBacnetPoints=[],this.selectedChild2Point=null),this.autoCreateDevicesAndPoints&&this.selectedGenericNetwork?(this.selectedGenericDevice=null,this.generatedGenericPoints=this.selectedModbusPoints.reduce((function(t,i){var n={};return n.network=e.selectedGenericNetwork,n.device=e.getGenericDevice(n.network.uuid,i.device.name),n.point=a()({},i.point),n.name=n.network.name+":"+n.device.name+":"+n.point.name,n.modbusPoint=a()({},i),t.push(n),t}),[])):this.generatedGenericPoints=[],this.checkValidation()},onAutoBacnetCreateToggle:function(){var e=this;this.autoCreateBacnetPoints&&(this.autoCreateDevicesAndPoints=!1,this.generatedGenericPoints=[],this.selectedChild1Point=null),this.autoCreateBacnetPoints?(this.selectedChild1Point=null,this.generatedBacnetPoints=this.selectedModbusPoints.reduce((function(t,i){var n={};return n.modbusPoint=i,n.bacnetPoint=e.getBacnetPoint(i.network.name,i.device.name,i.point.name),n.name=n.bacnetPoint.object_name,t.push(n),t}),[])):this.generatedBacnetPoints=[],this.checkValidation()},onModbusPointsSelectionClear:function(){this.selectedModbusDevices=[],this.selectedModbusNetworks=[]},onEditName:function(e,t){switch(this.editPointType=e,e){case"genericPoint":this.pointName=t.point.name;break;case"bacnetPoint":this.pointName=t.bacnetPoint.object_name}this.isEditNameOpen=!0,this.currentEditItem=t},onSaveName:function(){switch(this.editPointType){case"genericPoint":this.currentEditItem.point.name=this.pointName,this.currentEditItem.name=this.currentEditItem.network.name+":"+this.currentEditItem.device.name+":"+this.currentEditItem.point.name;break;case"bacnetPoint":this.currentEditItem.bacnetPoint.object_name=this.pointName,this.currentEditItem.name=this.pointName}this.isEditNameOpen=!1}}},Ae=Object(u.a)(Fe,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-form",{ref:"mappingForm",class:e.isEditForm?"":"mb-4",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[i("v-row",{attrs:{dense:""}},[i("v-col",{attrs:{cols:12}},[e.isEditForm?i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"id","item-text":"name","auto-select-first":"",rules:e.fieldValidations,label:e.parentFieldTitle,items:e.updatedParentPointsList},model:{value:e.selectedModbusPoint,callback:function(t){e.selectedModbusPoint=t},expression:"selectedModbusPoint"}}):e._e(),e._v(" "),e.isEditForm?e._e():i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"id","item-text":"name","auto-select-first":"",rules:[e.arrayRequiredValidation],label:e.modbusSelectionLabel,items:e.updatedParentPointsList,multiple:""},on:{"click:clear":e.onModbusPointsSelectionClear},scopedSlots:e._u([{key:"item",fn:function(t){var n=t.item,a=t.attrs;return[n.isHeader?[i("v-list-item",{class:n.isDevice?"pl-8":"",attrs:{ripple:""},on:{click:function(t){return e.onDeviceSelectAllClick(n)}}},[n.isDevice?i("v-icon",{staticClass:"mr-2"},[e._v("\n                "+e._s(e.selectedModbusDevices.indexOf(n.networkName+":::"+n.name)>-1?"fa-check-circle":"fa-circle-o")+"\n              ")]):e._e(),e._v(" "),n.isNetwork?i("v-icon",{staticClass:"mr-2"},[e._v("\n                "+e._s(e.selectedModbusNetworks.indexOf(""+n.name)>-1?"fa-check-circle":"fa-circle-o")+"\n              ")]):e._e(),e._v(" "),i("v-list-item-title",[n.isDevice?i("span",{staticClass:"caption"},[e._v("Select all modbus points of")]):e._e(),e._v(" "),n.isNetwork?i("span",{staticClass:"caption"},[e._v("Select all modbus devices of")]):e._e(),e._v(" "),i("strong",[e._v(e._s(n.name+" "))])])],1)]:[i("v-list-item-content",{staticClass:"ml-12"},[i("v-list-item-title",[n.disabled?e._e():i("v-icon",{staticClass:"mr-2"},[e._v("\n                  "+e._s("true"==a["aria-selected"]?"fa-checkbox-marked":"fa-circle-o")+"\n                ")]),e._v(" "),i("span",{staticClass:"caption"},[e._v(e._s(n.network.name))]),e._v(" "),i("span",{staticClass:"caption"},[e._v(e._s(n.device.name))]),e._v(" "),i("strong",[e._v(e._s(n.point.name))]),e._v(" "),n.disabled?i("span",{staticClass:"already-mapped-label"},[e._v(" Already Mapped ")]):e._e()],1)],1)]]}},{key:"prepend-item",fn:function(){return[i("v-list-item",{attrs:{ripple:""},on:{click:e.onModbusPointsSelectToggle}},[i("v-icon",{staticClass:"mr-2"},[e._v("\n              "+e._s(e.isMultipleModbusPointsSelected?"fa-check-circle":"fa-circle-o")+"\n            ")]),e._v(" "),i("v-list-item-content",[i("v-list-item-title",[e._v(" Select all ")])],1)],1),e._v(" "),i("v-divider",{staticClass:"mt-2"})]},proxy:!0}],null,!1,3685982287),model:{value:e.selectedModbusPoints,callback:function(t){e.selectedModbusPoints=t},expression:"selectedModbusPoints"}})],1),e._v(" "),i("v-col",{attrs:{cols:"12"}},[i("v-card",{attrs:{outlined:""}},[i("v-card-title",{staticClass:"text-left"},[e._v("BACnet Points")]),e._v(" "),i("v-card-text",[i("v-row",{attrs:{dense:""}},[i("v-col",{attrs:{cols:"12"}},[i("v-row",{attrs:{dense:""}},[i("v-col",{attrs:{cols:"6"}},[i("v-switch",{staticClass:"pr-4",attrs:{inset:"",label:"Auto create new bacnet point(s) and mapping(s)",color:"primary"},on:{change:e.onAutoBacnetCreateToggle},model:{value:e.autoCreateBacnetPoints,callback:function(t){e.autoCreateBacnetPoints=t},expression:"autoCreateBacnetPoints"}})],1),e._v(" "),i("v-col",{attrs:{cols:"6"}},[i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"id","item-text":"name","auto-select-first":"",label:e.child1FieldTitle,rules:e.genericChildValidation,items:e.updatedChild1PointsList,disabled:!!e.selectedChild2Point||e.isMultipleModbusPointsSelected||e.autoCreateBacnetPoints},on:{change:e.checkValidation,blur:e.checkValidation},model:{value:e.selectedChild1Point,callback:function(t){e.selectedChild1Point=t},expression:"selectedChild1Point"}})],1)],1)],1),e._v(" "),!e.isMapMultipleModbusPoints&&e.generatedBacnetPoints.length>0?i("v-col",{attrs:{cols:"12"}},[i("v-item-group",{staticClass:"text-left",attrs:{multiple:""}},[i("v-subheader",[e._v("Generated BACnet Points")]),e._v(" "),e._l(e.generatedBacnetPoints,(function(t){return i("v-item",{key:t.name,staticClass:"ml-2 mb-2"},[i("v-chip",{attrs:{"active-class":"nubeGreen--text",value:t}},[i("span",[e._v(e._s(t.name))]),e._v(" "),i("v-btn",{staticClass:"pa-1",attrs:{rights:"",icon:"",color:"white"},on:{click:function(i){return e.onEditName("bacnetPoint",t)}}},[i("v-icon",{attrs:{right:""}},[e._v(" fa-pencil ")])],1)],1)],1)}))],2)],1):e._e()],1)],1)],1)],1),e._v(" "),i("v-col",{attrs:{cols:"12"}},[i("v-card",{attrs:{outlined:""}},[i("v-card-title",{staticClass:"text-left"},[e._v("Generic Points")]),e._v(" "),i("v-card-text",[i("v-row",{attrs:{dense:""}},[e.isMapMultipleModbusPoints?e._e():i("v-col",{attrs:{cols:"12"}},[i("v-row",{attrs:{dense:""}},[i("div",{staticClass:"existing-generic-mapping-wrapper"},[i("v-row",{attrs:{dense:""}},[i("v-col",{attrs:{cols:"12"}},[i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"uuid",disabled:!(e.selectedModbusPoints&&e.selectedModbusPoints.length>0),"item-text":"name","auto-select-first":"",rules:e.genericChildValidation,label:"Select Existing Generic Network",items:e.genericNetworks},on:{change:e.onAutoCreateToggle},model:{value:e.selectedGenericNetwork,callback:function(t){e.selectedGenericNetwork=t},expression:"selectedGenericNetwork"}})],1)],1),e._v(" "),i("v-row",{attrs:{dense:""}},[i("v-col",{attrs:{cols:"6"}},[i("v-switch",{staticClass:"pr-4",attrs:{inset:"",label:"Auto create new device(s), point(s) and mapping(s)",color:"primary"},on:{change:e.onAutoCreateToggle},model:{value:e.autoCreateDevicesAndPoints,callback:function(t){e.autoCreateDevicesAndPoints=t},expression:"autoCreateDevicesAndPoints"}})],1),e._v(" "),i("v-col",{attrs:{cols:"6"}},[e.autoCreateDevicesAndPoints?e._e():i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"uuid",disabled:!(e.selectedModbusPoints&&e.selectedModbusPoints.length>0),"item-text":"name","auto-select-first":"",rules:e.genericChildValidation,label:"Select Existing Generic Device",items:e.genericDevices},on:{change:e.onGenericDevicesChange},model:{value:e.selectedGenericDevice,callback:function(t){e.selectedGenericDevice=t},expression:"selectedGenericDevice"}})],1)],1)],1),e._v(" "),e.isMapMultipleModbusPoints?i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"id","item-text":"name","auto-select-first":"",label:e.child2FieldTitle,rules:e.genericChildValidation,disabled:!!e.selectedChild1Point,items:e.updatedChild2PointsList},on:{change:e.checkValidation,blur:e.checkValidation},model:{value:e.selectedChild2Point,callback:function(t){e.selectedChild2Point=t},expression:"selectedChild2Point"}}):e._e(),e._v(" "),!e.isMapMultipleModbusPoints&&e.generatedGenericPoints.length>0&&e.autoCreateDevicesAndPoints?i("v-col",{attrs:{cols:"12"}},[i("v-item-group",{staticClass:"text-left",attrs:{multiple:""}},[i("v-subheader",[e._v("Generated Generic Points")]),e._v(" "),e._l(e.generatedGenericPoints,(function(t){return i("v-item",{key:t.name,staticClass:"ml-2 mb-2"},[i("v-chip",{attrs:{"active-class":"nubeGreen--text",value:t}},[i("span",[e._v(e._s(t.name))]),e._v(" "),i("v-btn",{staticClass:"pa-1",attrs:{rights:"",icon:"",color:"white"},on:{click:function(i){return e.onEditName("genericPoint",t)}}},[i("v-icon",{attrs:{right:""}},[e._v(" fa-pencil ")])],1)],1)],1)}))],2)],1):e._e()],1)],1),e._v(" "),i("v-col",{attrs:{cols:"12"}},[e.isMapExistingGenericPointVisible?i("v-autocomplete",{attrs:{clearable:"","return-object":"","item-value":"id","item-text":"name","auto-select-first":"",label:"Existing Generic Point",rules:e.genericChildValidation,disabled:!!e.selectedChild1Point||e.autoCreateDevicesAndPoints,items:e.updatedChild2PointsList},on:{change:e.checkValidation,blur:e.checkValidation},model:{value:e.selectedChild2Point,callback:function(t){e.selectedChild2Point=t},expression:"selectedChild2Point"}}):e._e()],1)],1)],1)],1)],1),e._v(" "),i("v-col",{attrs:{cols:"12"}},e._l(e.mappingErrors,(function(t){return i("v-alert",{key:t.index,attrs:{dense:"",outlined:"",type:"warning"}},[e._v("\n        Mapping Error: "),i("strong",{staticClass:"white--text"},[e._v(e._s(t.modbus_point_name))]),e._v(" --\n        "),i("strong",{staticClass:"white--text"},[e._v(e._s(t.child_point_name))]),e._v(" |\n        "),i("span",[e._v(e._s(t.message))])])})),1),e._v(" "),e.isEditForm?e._e():i("v-col",{staticClass:"flex justify-center align-center",attrs:{cols:"1"}},[i("v-btn",{staticClass:"btn-height-22 white--text",attrs:{"x-small":"",color:"pink",block:"",loading:e.isCreatingMapping},on:{click:e.addMapping}},[e._v("Add")])],1)],1),e._v(" "),e.isEditForm?i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"darken-1",text:""},on:{click:e.onCancel}},[e._v(" Cancel ")]),e._v(" "),i("v-btn",{attrs:{color:"blue darken-1",loading:e.isCreatingMapping,text:""},on:{click:e.addMapping}},[e._v(" Save ")])],1):e._e(),e._v(" "),i("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.isEditNameOpen,callback:function(t){e.isEditNameOpen=t},expression:"isEditNameOpen"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v("Edit Name")])]),e._v(" "),i("v-card-text",[i("v-form",{ref:"editNameForm",model:{value:e.editNameFormValid,callback:function(t){e.editNameFormValid=t},expression:"editNameFormValid"}},[i("v-text-field",{attrs:{label:"Point Name",required:""},model:{value:e.pointName,callback:function(t){e.pointName=t},expression:"pointName"}})],1)],1),e._v(" "),i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"darken-1",text:""},on:{click:function(){return e.isEditNameOpen=!1}}},[e._v(" Cancel ")]),e._v(" "),i("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.onSaveName}},[e._v(" Save ")])],1)],1)],1)],1)}),[],!1,null,"4925110a",null).exports,Be="/service-mapping/modbus-generic-bacnet-mapping",Oe={name:"BACNET",valueKey:"bacnetPoint",valuePath:"bacnetPoint.id"},Ke={name:"GENERIC",valueKey:"genericPoint",valuePath:"genericPoint.id"};function $e(e,t){if(!e)throw new Error("Mapping type not found");var i=e.valuePath,n=y()(t,i);if(!n)throw new Error("Mapping uuid is not selected");return n}function Ve(e){return e.map((function(e){var t={};return e.type==Ke.name&&(t={genericPoint:{id:e.mapped_point_uuid,name:e.mapped_point_name}}),e.type==Oe.name&&(t=a()({},t,{bacnetPoint:{id:e.mapped_point_uuid,name:e.mapped_point_name}})),a()({},e,t,{uuid:e.uuid,modbusPoint:{id:e.point_uuid,name:e.point_name}})}))}function je(e){var t=function(e){return e.bacnetPoint&&e.bacnetPoint.id?Oe:e.genericPoint&&e.genericPoint.id?Ke:void 0}(e);return{point_uuid:e.modbusPoint.id,type:t.name,mapped_point_uuid:$e(t,e)}}function qe(e){var t={};return e.bacnetPoint&&e.bacnetPoint.id&&(t={bacnet_point_uuid:e.bacnetPoint.id,bacnet_point_name:e.bacnetPoint.name}),e.genericPoint&&e.genericPoint.id&&(t=a()({},t,{generic_point_uuid:e.genericPoint.id,generic_point_name:e.genericPoint.name})),e.uuid&&(t=a()({},t,{uuid:e.uuid})),a()({},t,{modbus_point_uuid:e.modbusPoint.id,modbus_point_name:e.modbusPoint.name})}function He(e,t,i,n){var s={};return s.modbus_point=a()({},t[e.modbus_point_name]),e.bacnet_point_name&&(s.bacnet_point=a()({},i[e.bacnet_point_name])),e.generic_point_name&&(s.generic_point=a()({},n[e.generic_point_name])),(s=q()(s)).modbus_point&&s.modbus_point.id&&(delete s.modbus_point.id,delete s.modbus_point.uuid,delete s.modbus_point.device.uuid,delete s.modbus_point.network.uuid,delete s.modbus_point.point.uuid),s.generic_point&&s.generic_point.id&&(delete s.generic_point.id,delete s.generic_point.uuid,delete s.generic_point.device.uuid,delete s.generic_point.network.uuid,delete s.generic_point.point.uuid),s.bacnet_point&&s.bacnet_point.id&&(delete s.bacnet_point.id,delete s.bacnet_point.uuid),s}function ze(e){return e.map((function(e){return S.a.unflatten(e,{transformKey:function(e){return e.trim()}})}))}var Je=function(e){return D.a.delete(Be+"/"+e.uuid)},Ue=function(e){return D.a.post(Be+"/file-upload",function(e){return e.map((function(e){var t=a()({},e);return y()(e,"generic_point.point.name")&&y()(e,"generic_point.point.name")&&y()(e,"generic_point.point.name")||(t=Pe()(t,["generic_point"])),y()(e,"bacnet_point.name")||(t=Pe()(t,["bacnet_point"])),t}))}(e))},Ye={name:"modus-generic-bacnet-point-mapping-import-dialog",props:["dataRows","isOpen","close","bacnetPoints","genericPoints","modusPoints","syncData"],data:function(){return{valid:!1,dataItems:[],isRequestOnce:!1,isCreatingMapping:!1,errors:[],rules:{required:function(e){return!!e||"Required"}},errorTableHeaders:[{text:"Row",value:"rowIndex",sortable:!1},{text:"Error Message",value:"message",sortable:!1}],modbusRtuPorts:[].concat(ne()(P.j)),headers:[{text:"Actions",value:"actions",sortable:!1},{text:"Row",value:"rowNumber",sortable:!1},{text:"Modbus Network Name",value:"modbusNetworkName",sortable:!1},{text:"Modbus Network RTU Port",value:"modbusNetworkRTUPort",sortable:!1},{text:"Modbus Device Name",value:"modbusDeviceName",sortable:!1},{text:"Modbus Device Address",value:"modbusDeviceAddress",sortable:!1},{text:"Modbus Point Name",value:"modbusPointName",sortable:!1},{text:"Modbus Point Regiter",value:"modbusPointRegister",sortable:!1},{text:"Generic Network Name",value:"genericNetworkName",sortable:!1},{text:"Generic Device Name",value:"genericDeviceName",sortable:!1},{text:"Generic Point Name",value:"genericPointName",sortable:!1},{text:"BACnet Point Name",value:"bacnetPointName",sortable:!1},{text:"BACnet Point Address",value:"bacnetPointAddress",sortable:!1}],tableProps:a()({},P.d)}},mounted:function(){this.dataItems=(this.dataRows||[]).map((function(e){return a()({},e,{generic_point:e.generic_point||{point:{name:""},device:{name:""},network:{name:""}},bacnet_point:e.bacnet_point||{address:null,name:""},isGenericPointDisabled:!e.generic_point,isBacnetPointDisabled:!e.bacnet_point})}))},methods:{clickDeleteImport:function(e){this.dataItems=this.dataItems.filter((function(t,i){return i!==e})),this.errors=this.errors.filter((function(e,t){return itemIndex!==t}))},getErrorFromResult:function(e){return{rowIndex:e.rowIndex+1,message:e.message}},createMapping:function(){var e=this;this.$refs.form.validate()&&(this.isCreatingMapping=!0,this.isRequestOnce=!0,Ue(this.dataItems).then((function(t){e.errors=t.reduce((function(t,i){return i.success||t.push(e.getErrorFromResult(i)),t}),[]),t.map((function(e){return e.success})).every((function(e){return e}))&&(e.syncData(),e.closeDialog())})).catch((function(e){})).finally((function(){e.isCreatingMapping=!1})))},closeDialog:function(){this.isRequestOnce&&this.syncData(),this.close()}}},We=Object(u.a)(Ye,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-dialog",{attrs:{persistent:""},model:{value:e.isOpen,callback:function(t){e.isOpen=t},expression:"isOpen"}},[e.isOpen?i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v("Import Mappings")])]),e._v(" "),i("v-card-text",[i("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[i("v-data-table",{staticClass:"elevation-1 mb-4",attrs:{headers:e.headers,items:e.dataItems,"footer-props":e.tableProps.FOOTER_PROPS,itemsPerPage:e.tableProps.ITEMS_PER_PAGE},scopedSlots:e._u([{key:"item.actions",fn:function(t){var n=t.index;return[i("v-icon",{attrs:{small:"",color:"error"},on:{click:function(t){return e.clickDeleteImport(n)}}},[e._v(" fa-trash-o ")])]}},{key:"item.rowNumber",fn:function(t){var n=t.index;return[i("span",[e._v(e._s(+n+1))])]}},{key:"item.modbusNetworkRTUPort",fn:function(t){var n=t.item;return[i("v-combobox",{attrs:{items:e.modbusRtuPorts,label:"rtu port"},model:{value:n.modbus_point.network.rtu_port,callback:function(t){e.$set(n.modbus_point.network,"rtu_port",t)},expression:"item.modbus_point.network.rtu_port"}})]}},{key:"item.modbusNetworkName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{"single-line":"",required:""},model:{value:n.modbus_point.network.name,callback:function(t){e.$set(n.modbus_point.network,"name",t)},expression:"item.modbus_point.network.name"}})]}},{key:"item.modbusDeviceName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{"single-line":"",required:""},model:{value:n.modbus_point.device.name,callback:function(t){e.$set(n.modbus_point.device,"name",t)},expression:"item.modbus_point.device.name"}})]}},{key:"item.modbusDeviceAddress",fn:function(t){var n=t.item;return[i("v-text-field",{attrs:{"single-line":"",type:"number",min:"0"},model:{value:n.modbus_point.device.address,callback:function(t){e.$set(n.modbus_point.device,"address",t)},expression:"item.modbus_point.device.address"}})]}},{key:"item.modbusPointName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{"single-line":"",rules:[e.rules.required],required:""},model:{value:n.modbus_point.point.name,callback:function(t){e.$set(n.modbus_point.point,"name",t)},expression:"item.modbus_point.point.name"}})]}},{key:"item.modbusPointRegister",fn:function(t){var n=t.item;return[i("v-text-field",{attrs:{"single-line":"",type:"number",min:"0"},model:{value:n.modbus_point.point.register,callback:function(t){e.$set(n.modbus_point.point,"register",t)},expression:"item.modbus_point.point.register"}})]}},{key:"item.genericNetworkName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{disabled:n.isGenericPointDisabled,"single-line":""},model:{value:n.generic_point.network.name,callback:function(t){e.$set(n.generic_point.network,"name",t)},expression:"item.generic_point.network.name"}})]}},{key:"item.genericDeviceName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{disabled:n.isGenericPointDisabled,"single-line":""},model:{value:n.generic_point.device.name,callback:function(t){e.$set(n.generic_point.device,"name",t)},expression:"item.generic_point.device.name"}})]}},{key:"item.genericPointName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{disabled:n.isGenericPointDisabled,"single-line":""},model:{value:n.generic_point.point.name,callback:function(t){e.$set(n.generic_point.point,"name",t)},expression:"item.generic_point.point.name"}})]}},{key:"item.bacnetPointName",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{disabled:n.isBacnetPointDisabled,"single-line":""},model:{value:n.bacnet_point.name,callback:function(t){e.$set(n.bacnet_point,"name",t)},expression:"item.bacnet_point.name"}})]}},{key:"item.bacnetPointAddress",fn:function(t){var n=t.item;return[i("v-text-field",{staticStyle:{width:"100px"},attrs:{disabled:n.isBacnetPointDisabled,"single-line":""},model:{value:n.bacnet_point.address,callback:function(t){e.$set(n.bacnet_point,"address",t)},expression:"item.bacnet_point.address"}})]}}],null,!0)})],1)],1),e._v(" "),e.errors.length>=1?i("v-card",{staticClass:"px-8 mt-n15"},[i("v-card-title",{attrs:{color:"red darken-1"}},[e._v("Errors")]),e._v(" "),i("v-card-text",[i("v-data-table",{staticClass:"elevation-1 mb-1",attrs:{"hide-default-footer":"",headers:e.errorTableHeaders,items:e.errors}})],1)],1):e._e(),e._v(" "),i("v-card-actions",[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"darken-1",text:""},on:{click:e.closeDialog}},[e._v(" Cancel ")]),e._v(" "),i("v-btn",{attrs:{color:"blue darken-1",loading:e.isCreatingMapping,text:""},on:{click:e.createMapping}},[e._v(" Save ")])],1)],1):e._e()],1)}),[],!1,null,null,null).exports,Qe={name:"service-mapping-grid",components:{ConfirmDialog:g.a,ParentChildMappingForm:me,GridToolbar:f.a,AppStatusChip:h.a,TooltipIconButton:b.a},props:["loading","parentMappingKey","child1MappingKey","child2MappingKey","serviceMappings","parentPoints","child1Points","child2Points","updateServiceMapping","deleteItem","deleteItems","parentHeaderTitle","child1HeaderTitle","child2HeaderTitle","fileName","receiveDataRows","formatDataService","fixMapping","syncGridItems"],data:function(){return{search:"",isFixingServiceMaps:!1,deleteServiceMappingDialog:!1,isDeletingItem:!1,selectedItem:null,selectedItems:[],deletionType:null,editServiceMappingDialog:!1,headers:[{text:this.parentHeaderTitle,align:"start",value:"parentName"},{text:this.child1HeaderTitle,align:"start",value:"child1Name"},{text:this.child2HeaderTitle,align:"start",value:"child2Name"},{text:"Mapping State",align:"center",value:"mapping_state"},{text:"Actions",align:"start",value:"actions",sortable:!1}],tableProps:a()({},P.d)}},computed:{items:function(){var e=this;return this.serviceMappings.map((function(t){return a()({},t,{isMapped:t.mapping_state===P.i.MAPPED,parentName:t[e.parentMappingKey].name,child1Name:t[e.child1MappingKey]&&t[e.child1MappingKey].name||"-",child2Name:t[e.child2MappingKey]&&t[e.child2MappingKey].name||"-"})}))},isDeleteEnabled:function(){return this.selectedItems.length>0}},methods:{toggleDeleteDialog:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.deletionType=t,this.deleteServiceMappingDialog=!this.deleteServiceMappingDialog,e&&this.deleteServiceMappingDialog?this.selectedItem=e:this.selectedItem=null},toggleServiceMappingDialog:function(e){this.editServiceMappingDialog=!this.editServiceMappingDialog,this.editServiceMappingDialog?this.selectedItem=e:this.selectedItem=null},closeDeleteDialog:function(){this.deleteServiceMappingDialog=!1,this.selectedItem=null,this.deletionType=null},handleDeleteItem:function(){switch(this.deletionType){case"single":this.onDeleteRow();break;case"multiple":this.onDeleteRows()}},onDeleteRows:function(){var e=this;this.selectedItems.length>0&&(this.isDeletingItem=!0,this.deleteItems(this.selectedItems).then((function(){e.closeDeleteDialog()})).finally((function(){e.isDeletingItem=!1})))},onDeleteRow:function(){var e=this;this.isDeletingItem=!0,this.deleteItem(this.selectedItem).then((function(){e.closeDeleteDialog()})).finally((function(){e.isDeletingItem=!1}))},onCopy:function(e){var t=this.formatDataService(this.selectedItems.filter((function(e){return e.isMapped})));e(v()(t))},fixServiceMappings:function(){var e=this;"function"==typeof this.fixMapping&&(this.isFixingServiceMaps=!0,this.fixMapping().finally((function(){e.isFixingServiceMaps=!1})))}}},Ze={name:"modbus-generic-bacnet-points-mapping",components:{ParentChildMappingForm:me,ParentChildMappingGrid:Object(u.a)(Qe,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("grid-toolbar",{attrs:{"on-copy":e.onCopy,items:e.items,toolbarTitle:"Mappings","file-name":e.fileName,"format-data-service":e.formatDataService,"receive-data-rows":e.receiveDataRows,"is-delete-enabled":e.isDeleteEnabled,"on-delete":function(){return e.toggleDeleteDialog(null,"multiple")}},scopedSlots:e._u([{key:"search",fn:function(){return[i("v-text-field",{staticClass:"pl-10",attrs:{"append-icon":"fa-search",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]},proxy:!0},{key:"customAction",fn:function(){return[i("v-btn",{staticClass:"mr-1 btn-height-22 white--text",attrs:{"x-small":"",color:"blue"},on:{click:e.fixServiceMappings}},[e._v("\n        Sync\n        "),e.isFixingServiceMaps?i("v-progress-circular",{staticClass:"ml-3",attrs:{width:"2",indeterminate:"",size:"12"}}):i("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[e._v(" fa-refresh ")])],1),e._v(" "),i("tooltip-icon-button",{attrs:{btnColor:"default",btnIcon:"fa-refresh",btnTooltip:"Refresh mapping table",buttonSize:"small",onClick:function(){return e.syncGridItems()}}})]},proxy:!0}])}),e._v(" "),i("v-data-table",{attrs:{"item-key":"uuid","show-select":"",loading:e.loading,search:e.search,headers:e.headers,items:e.items,"footer-props":e.tableProps.FOOTER_PROPS,itemsPerPage:e.tableProps.ITEMS_PER_PAGE},scopedSlots:e._u([{key:"item.actions",fn:function(t){var n=t.item;return[i("v-btn",{attrs:{icon:"",small:"",color:"primary"},on:{click:function(){return e.toggleServiceMappingDialog(n)}}},[i("v-icon",{attrs:{small:"",dark:""}},[e._v(" fa-pencil ")])],1),e._v(" "),i("v-btn",{attrs:{icon:"",small:"",color:"error"},on:{click:function(){return e.toggleDeleteDialog(n,"single")}}},[i("v-icon",{attrs:{small:"",dark:""}},[e._v(" fa-trash-o ")])],1)]}},{key:"item.mapping_state",fn:function(e){var t=e.item;return[i("app-status-chip",{attrs:{state:t.mapping_state}})]}}],null,!0),model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}}),e._v(" "),i("confirm-dialog",{attrs:{"is-open":e.deleteServiceMappingDialog,loading:e.isDeletingItem,"on-close":function(){return e.closeDeleteDialog()},"on-confirm":function(){return e.handleDeleteItem()},"dialog-text":"Do you want to delete the mapping?"}}),e._v(" "),i("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.editServiceMappingDialog,callback:function(t){e.editServiceMappingDialog=t},expression:"editServiceMappingDialog"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v("Edit Mapping")])]),e._v(" "),i("v-card-text",[e.editServiceMappingDialog?i("parent-child-mapping-form",{attrs:{"is-edit-form":!0,"on-cancel":function(){return e.toggleServiceMappingDialog()},"service-mapping":e.selectedItem,parentPoints:e.parentPoints,child1Points:e.child1Points,child2Points:e.child2Points,parentMappingKey:e.parentMappingKey,child1MappingKey:e.child1MappingKey,child2MappingKey:e.child2MappingKey,parentFieldTitle:e.parentHeaderTitle,child1FieldTitle:e.child1HeaderTitle,child2FieldTitle:e.child2HeaderTitle,serviceMappings:e.serviceMappings,createServiceMapping:e.updateServiceMapping}}):e._e()],1)],1)],1)],1)}),[],!1,null,null,null).exports,ModbusGenericBcnetPointMappingForm:Ae,ModbusGenericBacnetPointMappingImportDialog:We,ModbusGenericBacnetPointMappingForm:Ae},data:function(){return{dataRows:[],genericNetworks:[],isUpdating:!1,serviceMappings:[],genericPoints:[],genericPointsMap:{},genericNetworkDevices:[],bacnetPoints:[],bacnetPointsMap:{},modbusPoints:[],modbusPointsMap:{},modbusNetworks:[],isFetchingGridData:!1,openImportMappingDialog:!1}},mounted:function(){this.syncData()},methods:{syncData:function(){this.fetchServiceMapping(),this.fetchBacnetPoints(),this.fetchGenericPoints(),this.fetchModbusPoints(),this.fetchGenericDevices()},fetchGenericDevices:function(){var e=this;Q().then((function(t){var i=t.genericNetworks;e.genericNetworks=i})).catch((function(e){}))},fetchServiceMapping:function(){var e=this;return this.isFetchingGridData=!0,D.a.get(""+Be).then(Ve).then((function(t){e.serviceMappings=t})).finally((function(){e.isFetchingGridData=!1}))},fetchGenericPoints:function(){var e=this;W().then((function(t){e.genericPoints=t,e.genericPointsMap=e.createMap(e.genericPoints)})).catch((function(e){}))},fetchBacnetPoints:function(){var e=this;Z().then((function(t){e.bacnetPoints=t.map((function(e){return a()({},e,{id:e.uuid,name:e.object_name})})),e.bacnetPointsMap=e.createMap(e.bacnetPoints)})).catch((function(e){}))},fetchModbusPoints:function(){var e=this;H.h({with_children:!0,points:!0}).then(J).then((function(t){var i=t.networkPoints,n=t.networks;e.modbusPoints=i,e.modbusNetworks=n,e.modbusPointsMap=e.createMap(e.modbusPoints)})).catch((function(e){}))},createServiceMapping:function(e){var t=this;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return D.a.post(""+Be,je(e))}(e).then((function(){t.fetchServiceMapping(),t.$toasted.show(X.c.success)})).catch((function(e){t.$toasted.show(X.c.error,{type:"error"})})).finally((function(){}))},updateServiceMapping:function(e,t){var i=this;return function(){var e=arguments[1],t=je(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return D.a.patch(Be+"/"+e,t)}(e,t).then((function(){i.fetchServiceMapping(),i.$toasted.show(X.g.success)})).catch((function(e){i.$toasted.show(X.g.error,{type:"error"})}))},deleteServiceMapping:function(e){var t=this;return Je(e).then((function(){t.fetchServiceMapping(),t.$toasted.show(X.d.success)})).catch((function(e){t.$toasted.show(X.d.error,{type:"error"}),console.error(e)}))},deleteServiceMappings:function(e){var t=this;return function(e){return C.a.all(e.map((function(e){return Je(e)})))}(e).then((function(){t.fetchServiceMapping(),t.$toasted.show(X.e.success)})).catch((function(e){t.$toasted.show(X.e.error,{type:"error"})}))},formatExportData:function(e,t){var i=this;return"copy"===t?e.map(qe).map((function(e){return He(e,i.modbusPointsMap,i.bacnetPointsMap,i.genericPointsMap)})):function(e){return e.map((function(e){return S.a.flatten(e)}))}(e.map(qe).map((function(e){return He(e,i.modbusPointsMap,i.bacnetPointsMap,i.genericPointsMap)})))},createMap:function(e){return(e||[]).reduce((function(e,t){return e[t.name]=t,e}),{})},receiveDataRows:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length>=1&&(this.dataRows=ze(e),this.openImportMappingDialog=!0)},closeImportMappingDialog:function(){this.openImportMappingDialog=!1},createModbusBacnetGenericPointMapping:function(e,t,i){var n=this;return function(e,t){return D.a.post(Be+"/bulk-service-mapping?"+fe.a.stringify(t),e)}(e,{autoCreateGenericDevice:t,autoCreateBacnetDevice:i}).then((function(e){return n.fetchServiceMapping(),e}))},fixMapping:function(){var e=this;return D.a.get(Be+"/fix-mapping").then((function(){e.fetchServiceMapping()}))}}},Xe={name:"service-mapping",components:{RubixBacnetPointsMapping:te,LoraGenericBacnetPointsMapping:Te,ModbusGenericBacnetPointsMapping:Object(u.a)(Ze,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card-text",[i("modbus-generic-bacnet-point-mapping-form",{attrs:{parentPoints:e.modbusPoints,child1Points:e.bacnetPoints,child2Points:e.genericPoints,parentMappingKey:"modbusPoint",child1MappingKey:"bacnetPoint",child2MappingKey:"genericPoint",parentFieldTitle:"Modbus Points",child1FieldTitle:"BACnet Points",child2FieldTitle:"Rubix Points",createModbusBacnetGenericPointMapping:e.createModbusBacnetGenericPointMapping,"modbus-networks":e.modbusNetworks,serviceMappings:e.serviceMappings,createServiceMapping:e.createServiceMapping,genericNetworks:e.genericNetworks}}),e._v(" "),i("v-divider"),e._v(" "),i("parent-child-mapping-grid",{attrs:{loading:e.isFetchingGridData,syncGridItems:e.syncData,fileName:"modus-bacnet-generic-service-mapping","format-data-service":e.formatExportData,parentPoints:e.modbusPoints,child1Points:e.bacnetPoints,child2Points:e.genericPoints,parentMappingKey:"modbusPoint",child1MappingKey:"bacnetPoint",child2MappingKey:"genericPoint",serviceMappings:e.serviceMappings,deleteItem:e.deleteServiceMapping,deleteItems:e.deleteServiceMappings,parentHeaderTitle:"Modbus Points",child1HeaderTitle:"BACnet Points","fix-mapping":e.fixMapping,child2HeaderTitle:"Rubix Points",updateServiceMapping:e.updateServiceMapping,"receive-data-rows":e.receiveDataRows}}),e._v(" "),e.openImportMappingDialog?i("modbus-generic-bacnet-point-mapping-import-dialog",{attrs:{"bacnet-points":e.bacnetPoints,"generic-points":e.genericPoints,"modbus-points":e.modbusPoints,"is-open":e.openImportMappingDialog,close:e.closeImportMappingDialog,"sync-data":e.syncData,"data-rows":e.dataRows}}):e._e()],1)}),[],!1,null,null,null).exports,PageTitle:s.a},data:function(){return{tab:0,tabs:["rubix-bacnet-points-mapping","lora-generic-bacnet-mapping","modbus-generic-bacnet-mapping"],isDisabled:!1}},watch:{"$route.query.tab":function(e){this.tab=this.tabs.indexOf(e)},tab:function(e,t){var i=this.$route.query.tab;if(i!==this.tabs[e]){var n=this.tabs[e];this.$router.push({path:"service-mapping",query:{tab:n}})}}},mounted:function(){var e=this.$route.query.tab;this.tab=this.tabs.indexOf(e)}},et=Object(u.a)(Xe,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-tabs",{attrs:{right:"",color:e.$vuetify.theme.dark?"":"nubeGreen"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[i("v-tab",{key:0},[e._v("Modbus Points <> Rubix | BACnet Points")]),e._v(" "),i("v-tab",{key:1},[e._v("BACnet Points <> Rubix Points")]),e._v(" "),i("v-tab",{key:2},[e._v("LoRa Points <> Rubix | BACnet Points")])],1),e._v(" "),i("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[i("v-tab-item",{key:0},[i("page-title",{staticClass:"ml-4",attrs:{title:"Modbus Points <> Rubix | BACnet Points"}}),e._v(" "),i("modbus-generic-bacnet-points-mapping")],1),e._v(" "),i("v-tab-item",{key:1},[i("page-title",{staticClass:"ml-4",attrs:{title:"BACnet Points <> Rubix Points"}}),e._v(" "),i("rubix-bacnet-points-mapping")],1),e._v(" "),i("v-tab-item",{key:2},[i("page-title",{staticClass:"ml-4",attrs:{title:"LoRa Points <> Rubix | BACnet Points"}}),e._v(" "),i("lora-generic-bacnet-points-mapping")],1)],1)],1)}),[],!1,null,null,null);t.default=et.exports},t53O:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return r}));var n=i("mWu/"),a=i.n(n);function s(e){return e.map((function(e){return a.a.flatten(e)}))}function r(e){return e.map((function(e){return a.a.unflatten(e,{transformKey:function(e){return e.trim()}})}))}},vQiG:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a})),i.d(t,"f",(function(){return s})),i.d(t,"c",(function(){return r})),i.d(t,"g",(function(){return o})),i.d(t,"d",(function(){return c})),i.d(t,"e",(function(){return l}));var n={success:"Successfully updated status change.",error:"Status change unsuccessful."},a={success:"Successfully updated setting.",error:"Status change unsuccessful."},s={success:"Upgrade successful.",error:"Upgrade unsuccessful."},r={success:"Successfully created mapping.",error:"Mapping could not be created."},o={success:"Successfully updated mapping.",error:"Mapping could not be updated."},c={success:"Successfully deleted mapping",error:"Mapping could not be deleted"},l={success:"Successfully deleted mapping(s)",error:"Mapping(s) could not be deleted"}}}]);
//# sourceMappingURL=14.b29ab0cafd4a4ea6cbcc.js.map