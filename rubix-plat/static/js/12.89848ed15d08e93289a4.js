(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"+SqX":function(e,t,a){"use strict";var i={name:"page-title",props:["title"]},s=a("psIG"),n=Object(s.a)(i,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("h1",{staticClass:"text-h5 text-left py-3"},[e._v(e._s(e.title))])}),[],!1,null,null,null);t.a=n.exports},0:function(e,t){},"0iKi":function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"d",(function(){return v})),a.d(t,"f",(function(){return d})),a.d(t,"b",(function(){return u}));var i=a("OBCi"),s=a.n(i),n=a("uzYq"),r="/slave-devices",o=function(e){var t={global_uuid:e.global_uuid};return n.a.post(r,t)},l=function(e){return s.a.all(e.map((function(e){return o(e)})))},c=function(){return n.a.get(r)},v=function(){return n.a.get(r+"/discover")},d=function(e){var t=e.global_uuid;return n.a.delete(r+"/"+t)},u=function(e){return s.a.all(e.map((function(e){return d(e)})))}},1:function(e,t){},2:function(e,t){},"3saC":function(e,t,a){"use strict";var i={props:["on-copy"],methods:{copyToClipboard:function(e){var t=this;this.$copyText(e,this.$refs.copyClipboard).then((function(){t.$toasted.show("Copied to clipboard!",{type:"success"})}),(function(){t.$toasted.show("Cannot copy to clipboard.",{type:"error"})}))}}},s=a("psIG"),n=Object(s.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{ref:"copyClipboard"},[a("v-btn",{staticClass:"white-text",attrs:{"x-small":"",color:"#009688"},on:{click:function(){return e.onCopy(e.copyToClipboard)}}},[a("span",[e._v("Copy Â ")]),e._v(" "),a("v-icon",{attrs:{small:""}},[e._v("mdi-export")])],1)],1)}),[],!1,null,null,null);t.a=n.exports},"7Ipj":function(e,t,a){"use strict";var i=a("Q12t"),s=a("3saC"),n=a("Isj4"),r={name:"import-dialog",props:["receiveDataRows"],data:function(){return{file:null,dialogImportExcel:!1,dialogImportJSON:!1,dataImport:""}},methods:{importFile:function(){var e=new FileReader;e.readAsBinaryString(this.file),e.onload=this.handleFileLoad},handleFileLoad:function(e){var t=e.target.result,a=n.read(t,{type:"binary"}),i=Array.isArray(a.SheetNames)&&a.SheetNames.length>0&&a.SheetNames[0];if(!i)return this.$toasted.show("Invalid Excel File. Please reupload.",{type:"error"});var s=n.utils.sheet_to_row_object_array(a.Sheets[i]);this.receiveDataRows(s),this.dialogImportExcel=!1},importJson:function(){try{var e=JSON.parse(this.dataImport);this.receiveDataRows(e),this.dialogImportJSON=!1}catch(e){return this.$toasted.show("Invalid JSON",{type:"error"})}}}},o=a("psIG"),l=Object(o.a)(r,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on,s=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"white--text mr-2",attrs:{"x-small":"",color:"primary"}},"v-btn",s,!1),i),[e._v("Import"),a("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[e._v("mdi-import")])],1)]}}])},[e._v(" "),a("v-list",[a("v-list-item",{attrs:{link:""}},[a("v-list-item-title",{on:{click:function(t){e.dialogImportJSON=!0,e.dataImport=""}}},[e._v("Json")])],1),e._v(" "),a("v-list-item",{attrs:{link:""}},[a("v-list-item-title",{on:{click:function(t){e.dialogImportExcel=!0,e.file=null}}},[e._v("Excel")])],1)],1)],1),e._v(" "),a("v-dialog",{attrs:{width:"500px"},model:{value:e.dialogImportExcel,callback:function(t){e.dialogImportExcel=t},expression:"dialogImportExcel"}},[a("v-card",[a("v-card-title",[e._v("Choose excel file")]),e._v(" "),a("v-card-text",[a("v-file-input",{attrs:{outlined:"",dense:"",label:"File input",accept:".xls,.xlsx"},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}})],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"darken-1",text:""},on:{click:function(t){e.dialogImportExcel=!1}}},[e._v("Close")]),e._v(" "),a("v-btn",{attrs:{color:"primary darken-1",text:"",disabled:!e.file},on:{click:e.importFile}},[e._v("Import")])],1)],1)],1),e._v(" "),a("v-dialog",{attrs:{width:"500px"},model:{value:e.dialogImportJSON,callback:function(t){e.dialogImportJSON=t},expression:"dialogImportJSON"}},[a("v-card",[a("v-card-title",[e._v("Import via JSON")]),e._v(" "),a("v-card-text",[a("v-container",[a("v-textarea",{attrs:{outlined:"",name:"input-7-4",label:"import data"},model:{value:e.dataImport,callback:function(t){e.dataImport=t},expression:"dataImport"}})],1)],1)],1),e._v(" "),a("v-card-actions",[a("v-btn",{attrs:{color:"primary darken-1",text:"",disabled:!e.dataImport},on:{click:e.importJson}},[e._v("Import")])],1)],1)],1)}),[],!1,null,null,null).exports,c={name:"grid-toolbar",props:["toolbarTitle","onCopy","items","fileName","formatDataService","receiveDataRows","onDelete","isDeleteEnabled","onSearch","hideExportData"],components:{ExportData:i.a,CopyClipboard:s.a,ImportDialog:l}},v=Object(o.a)(c,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-toolbar",{attrs:{flat:""}},[a("v-toolbar-title",{staticClass:"mr-6"},[e._v(e._s(e.toolbarTitle))]),e._v(" "),e.onCopy?a("copy-clipboard",{staticClass:"mr-2",attrs:{"on-copy":e.onCopy}}):e._e(),e._v(" "),e.items&&e.items.length>0&&!e.hideExportData?a("export-data",{attrs:{data:e.items,"file-name":e.fileName,"format-data-service":e.formatDataService}}):e._e(),e._v(" "),e.receiveDataRows?a("import-dialog",{attrs:{receiveDataRows:e.receiveDataRows}}):e._e(),e._v(" "),e.onDelete?a("v-btn",{staticClass:"white--text",attrs:{disabled:!e.isDeleteEnabled,"x-small":"",color:"error"},on:{click:e.onDelete}},[e._v("\n    Delete\n    "),a("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[e._v(" mdi-delete ")])],1):e._e(),e._v(" "),e._t("customAction"),e._v(" "),e._t("search")],2)}),[],!1,null,null,null);t.a=v.exports},OvPX:function(e,t,a){"use strict";a.r(t);var i=a("Kz1y"),s=a.n(i),n=a("tZmG"),r=a.n(n),o=a("06Hw"),l=a.n(o),c=a("YYXh"),v=a.n(c),d=a("+SqX"),u=a("7Ipj"),m={name:"slave-devices",components:{GridToolbar:u.a},props:["items","removeSlaves","isFetching"],data:function(){return{search:"",selectedItems:[],headers:[{text:"Client Name",align:"start",sortable:!0,value:"client_name"},{text:"Status",align:"center",value:"onlineStatus",sortable:!1},{text:"Device Name",align:"center",value:"device_name",sortable:!0},{text:"Site Name",align:"center",value:"site_name",sortable:!1},{text:"Latitude",align:"center",value:"site_lat",sortable:!1},{text:"Longitude",align:"center",value:"site_lon",sortable:!1},{text:"Site Address",align:"center",value:"site_address",sortable:!1},{text:"Actions",align:"center",value:"actions",sortable:!1}]}}},p=a("psIG"),f=Object(p.a)(m,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("grid-toolbar",{attrs:{toolbarTitle:"Slave Devices"},scopedSlots:e._u([{key:"search",fn:function(){return[a("v-text-field",{staticClass:"pl-10",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]},proxy:!0},{key:"customAction",fn:function(){return[a("v-btn",{staticClass:"white--text",attrs:{disabled:0==e.selectedItems.length,"x-small":"",color:"pink"},on:{click:function(){return e.removeSlaves(e.selectedItems)}}},[e._v("\n        Remove as slave\n        "),a("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[e._v(" mdi-delete ")])],1)]},proxy:!0}])}),e._v(" "),a("v-data-table",{staticClass:"elevation-1",attrs:{"item-key":"global_uuid","show-select":"",loading:e.isFetching,search:e.search,headers:e.headers,items:e.items,"sort-by":"calories","footer-props":{showFirstLastPage:!0,firstIcon:"mdi-chevron-double-left",lastIcon:"mdi-chevron-double-right",prevIcon:"mdi-chevron-left",nextIcon:"mdi-chevron-right"}},scopedSlots:e._u([{key:"item.onlineStatus",fn:function(t){return[t.item.is_online?a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"green"}},[e._v("Online")])],1)]):a("div",[a("span",{staticClass:"font-weight-medium"},[a("v-chip",{attrs:{outlined:"",color:"yellow"}},[e._v("Offline")])],1)])]}},{key:"item.actions",fn:function(t){var i=t.item;return[a("v-btn",{attrs:{color:"pink",loading:i.isDeleting},on:{click:function(){return e.removeSlaves(i)}}},[e._v(" Remove as slave ")])]}}]),model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}})],1)}),[],!1,null,null,null).exports,h={name:"discover-devices",components:{GridToolbar:u.a},props:["items","createSlaves","isFetching"],data:function(){return{search:"",dialog:!1,isFetchingDevices:!1,selectedItems:[],headers:[{text:"Client Name",align:"start",sortable:!0,value:"client_name"},{text:"Device Name",align:"center",value:"device_name",sortable:!0},{text:"Site Name",align:"center",value:"site_name",sortable:!1},{text:"Latitude",align:"center",value:"site_lat",sortable:!1},{text:"Longitude",align:"center",value:"site_lon",sortable:!1},{text:"Site Address",align:"center",value:"site_address",sortable:!1},{text:"Actions",align:"center",value:"actions",sortable:!1}]}}},b=Object(p.a)(h,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("grid-toolbar",{attrs:{toolbarTitle:"Discover Devices"},scopedSlots:e._u([{key:"search",fn:function(){return[a("v-text-field",{staticClass:"pl-10",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]},proxy:!0},{key:"customAction",fn:function(){return[a("v-btn",{staticClass:"white--text",attrs:{disabled:0==e.selectedItems.length,"x-small":"",color:"green"},on:{click:function(){return e.createSlaves(e.selectedItems)}}},[e._v("\n        Add as slave\n        "),a("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[e._v(" mdi-plus ")])],1)]},proxy:!0}])}),e._v(" "),a("v-data-table",{staticClass:"elevation-1",attrs:{"item-key":"global_uuid","show-select":"",loading:e.isFetching,search:e.search,headers:e.headers,items:e.items,"sort-by":"calories","footer-props":{showFirstLastPage:!0,firstIcon:"mdi-chevron-double-left",lastIcon:"mdi-chevron-double-right",prevIcon:"mdi-chevron-left",nextIcon:"mdi-chevron-right"}},scopedSlots:e._u([{key:"item.actions",fn:function(t){var i=t.item;return[i.isAddToSlaveVisible?a("v-btn",{attrs:{color:"green",loading:i.isUpdating},on:{click:function(){return e.createSlaves(i)}}},[e._v("\n        Add as slave\n      ")]):a("div",[e._v("No actions available")])]}}]),model:{value:e.selectedItems,callback:function(t){e.selectedItems=t},expression:"selectedItems"}})],1)}),[],!1,null,null,null).exports,_=a("0iKi"),g={name:"master-slave-page",components:{PageTitle:d.a,DiscoverDevices:b,SlaveDevices:f},watch:{"$route.query.tab":function(e){this.tab=this.tabs.indexOf(e)},tab:function(e,t){var a=this.$route.query.tab;if(a!==this.tabs[e]){var i=this.tabs[e];this.$router.push({path:"master-slaves",query:{tab:i}})}}},data:function(){return{tab:0,tabs:["discover-devices","slave-devices"],slaveDevices:[],devicesMap:{},slaveDevicesMap:{},discoveredDevices:[],isFetchingSlaveDevices:!1,isFetchingDevices:!1}},mounted:function(){var e=this.$route.query.tab;this.tab=this.tabs.indexOf(e)},created:function(){this.syncDevices()},methods:{formatAddress:function(e){var t="";return e.site_address&&(t+=e.site_address),e.site_city&&(t+=", "+e.site_city),e.site_country&&(t+=", "+e.site_country),t},syncDevices:function(){var e=this;return v()(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isFetchingSlaveDevices=!0,e.isFetchingDevices=!0,t.next=4,e.fetchSlaveDevices();case 4:return t.next=6,e.fetchDevices();case 6:case"end":return t.stop()}}),t,e)})))()},fetchSlaveDevices:function(){var e=this;return _.e().then((function(t){e.slaveDevicesMap=t,e.slaveDevices=r()(t).map((function(a){return s()({},e.slaveDevicesMap[a],{isDeleting:!1,site_address:e.formatAddress(t[a])})}))})).catch((function(t){e.$toasted.show("Error fetching slave devices",{type:"error"})})).finally((function(){e.isFetchingSlaveDevices=!1}))},fetchDevices:function(){var e=this;return _.d().then((function(t){e.devicesMap=t,e.discoveredDevices=r()(e.devicesMap).map((function(t){return s()({},e.devicesMap[t],{isUpdating:!1,isAddToSlaveVisible:!e.slaveDevicesMap[t],site_address:e.formatAddress(e.devicesMap[t])})}))})).catch((function(t){e.$toasted.show("Error fetching remote devices",{type:"error"})})).finally((function(){e.isFetchingDevices=!1}))},createSlaves:function(e){var t=this;e.isUpdating=!0;return(Array.isArray(e)&&e.length>0?_.a:_.c)(e).then((function(){t.$toasted.show("Successfully updated the device status."),t.syncDevices()})).catch((function(){t.$toasted.show("Error occured while updating the device status",{type:"error"})})).finally((function(){e.isUpdating=!1}))},removeSlaves:function(e){var t=this;e.isDeleting=!0;return(Array.isArray(e)&&e.length>0?_.b:_.f)(e).then((function(){t.$toasted.show("Successfully remove the device as slave."),t.syncDevices()})).catch((function(){t.$toasted.show("Error occured while updating the device status",{type:"error"})})).finally((function(){e.isDeleting=!1}))}}},x=Object(p.a)(g,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("page-title",{attrs:{title:"Master Slave Mapping"}}),e._v(" "),a("v-tabs",{attrs:{dark:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab",{key:0},[e._v("Discover Devices ")]),e._v(" "),a("v-tab",{key:1},[e._v("Slave Devices ")])],1),e._v(" "),a("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab-item",{key:0},[a("discover-devices",{attrs:{items:e.discoveredDevices,"create-slaves":e.createSlaves,"is-fetching":e.isFetchingDevices}})],1),e._v(" "),a("v-tab-item",{key:1},[a("slave-devices",{attrs:{items:e.slaveDevices,removeSlaves:e.removeSlaves,"is-fetching":e.isFetchingSlaveDevices}})],1)],1)],1)}),[],!1,null,null,null);t.default=x.exports},Q12t:function(e,t,a){"use strict";var i=a("/9Wh"),s=a.n(i),n=a("+n12"),r={name:"export-data",props:["data","fileName","formatDataService"],methods:{clickDownload:function(e,t){var a=e;switch("function"==typeof this.formatDataService&&(a=this.formatDataService(e)),t){case"csv":return Object(n.c)(this.fileName,a);case"excel":return Object(n.e)(this.fileName,a);case"json":return Object(n.f)(this.fileName,s()(a))}}}},o=a("psIG"),l=Object(o.a)(r,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on,s=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"white--text mr-2",attrs:{"x-small":"",color:"#009688",dark:""}},"v-btn",s,!1),i),[a("span",[e._v("Download")]),e._v(" "),a("v-icon",{attrs:{"x-small":"",right:"",dark:""}},[e._v("mdi-download")])],1)]}}])},[e._v(" "),a("v-list",[a("v-list-item",{attrs:{link:""}},[a("v-list-item-title",{on:{click:function(t){return e.clickDownload(e.data,"json")}}},[e._v("Json")])],1),e._v(" "),a("v-list-item",{attrs:{link:""}},[a("v-list-item-title",{on:{click:function(t){return e.clickDownload(e.data,"excel")}}},[e._v("Excel")])],1),e._v(" "),a("v-list-item",{attrs:{link:""}},[a("v-list-item-title",{on:{click:function(t){return e.clickDownload(e.data,"csv")}}},[e._v("CSV")])],1)],1)],1)}),[],!1,null,null,null);t.a=l.exports}}]);
//# sourceMappingURL=12.89848ed15d08e93289a4.js.map